2025-08-20 19:18:46.357 +05:30 [INF] User profile is available. Using 'C:\Users\sunde\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-08-20 19:18:46.430 +05:30 [INF] 🚀 Webhook Queue Worker started.
2025-08-20 19:18:46.460 +05:30 [INF] 🧹 FailedWebhookLogCleanupService started.
2025-08-20 19:18:47.877 +05:30 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2025-08-20 19:18:48.804 +05:30 [WRN] The query uses the 'First'/'FirstOrDefault' operator without 'OrderBy' and filter operators. This may lead to unpredictable results.
2025-08-20 19:18:49.139 +05:30 [INF] Now listening on: http://localhost:7113
2025-08-20 19:18:49.140 +05:30 [INF] Now listening on: http://localhost:5295
2025-08-20 19:18:49.142 +05:30 [INF] Application started. Press Ctrl+C to shut down.
2025-08-20 19:18:49.143 +05:30 [INF] Hosting environment: Development
2025-08-20 19:18:49.144 +05:30 [INF] Content root path: D:\xbytechat\xbytechat-api\xbytechat-api
2025-08-20 19:18:49.158 +05:30 [INF] Executed DbCommand (30ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."AutoCleanupEnabled", w."LastCleanupAt"
FROM "WebhookSettings" AS w
LIMIT 1
2025-08-20 19:18:49.187 +05:30 [INF] Executed DbCommand (59ms) [Parameters=[@__cutoff_0='2025-08-13T13:48:46.7034217Z' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."CreatedAt", f."ErrorMessage", f."FailureType", f."RawJson", f."SourceModule"
FROM "FailedWebhookLogs" AS f
WHERE f."CreatedAt" < @__cutoff_0
2025-08-20 19:18:50.805 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/swagger/index.html - null null
2025-08-20 19:18:51.075 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/swagger/index.html - 200 null text/html;charset=utf-8 279.7241ms
2025-08-20 19:18:51.224 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/_vs/browserLink - null null
2025-08-20 19:18:51.224 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/_framework/aspnetcore-browser-refresh.js - null null
2025-08-20 19:18:51.235 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/_framework/aspnetcore-browser-refresh.js - 200 13762 application/javascript; charset=utf-8 11.0974ms
2025-08-20 19:18:51.301 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/_vs/browserLink - 200 null text/javascript; charset=UTF-8 77.3425ms
2025-08-20 19:18:51.422 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/swagger/v1/swagger.json - null null
2025-08-20 19:18:51.685 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 262.5231ms
2025-08-20 19:20:43.782 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/api/auth/login - null null
2025-08-20 19:20:43.789 +05:30 [WRN] Failed to determine the https port for redirect.
2025-08-20 19:20:43.886 +05:30 [INF] CORS policy execution successful.
2025-08-20 19:20:43.892 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/api/auth/login - 204 null null 110.1894ms
2025-08-20 19:20:43.929 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/api/auth/login - application/json 53
2025-08-20 19:20:43.944 +05:30 [INF] CORS policy execution successful.
2025-08-20 19:20:44.014 +05:30 [INF] Executing endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.Login (xbytechat.api)'
2025-08-20 19:20:44.042 +05:30 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(xbytechat.api.AuthModule.DTOs.UserLoginDto) on controller xbytechat.api.AuthModule.Controllers.AuthController (xbytechat.api).
2025-08-20 19:20:44.152 +05:30 [INF] 🔑 Login attempt for email: admin@xbytechat.com
2025-08-20 19:20:44.284 +05:30 [INF] Executed DbCommand (27ms) [Parameters=[@__dto_Email_0='admin@xbytechat.com', @__hashedPassword_1='JAvlGPq9JyTdtvBO6x2llnRI1+gxwIyPqCKAn3THIKk='], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."BusinessId", u."CreatedAt", u."DeletedAt", u."Email", u."IsDeleted", u."Name", u."PasswordHash", u."RefreshToken", u."RefreshTokenExpiry", u."RoleId", u."Status", r."Id", r."CreatedAt", r."Description", r."IsActive", r."IsSystemDefined", r."Name"
FROM "Users" AS u
LEFT JOIN "Roles" AS r ON u."RoleId" = r."Id"
WHERE u."Email" = @__dto_Email_0 AND u."PasswordHash" = @__hashedPassword_1 AND NOT (u."IsDeleted")
LIMIT 1
2025-08-20 19:20:44.432 +05:30 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT p."Code"
FROM "Permissions" AS p
WHERE p."IsActive"
ORDER BY p."Code"
2025-08-20 19:20:44.444 +05:30 [INF] ✅ Token generated for: admin@xbytechat.com
2025-08-20 19:20:44.488 +05:30 [INF] ✅ Login successful for admin@xbytechat.com, Role: superadmin, PlanId: null
2025-08-20 19:20:44.500 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType1`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-20 19:20:44.512 +05:30 [INF] Executed action xbytechat.api.AuthModule.Controllers.AuthController.Login (xbytechat.api) in 463.1693ms
2025-08-20 19:20:44.514 +05:30 [INF] Executed endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.Login (xbytechat.api)'
2025-08-20 19:20:44.523 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/api/auth/login - 200 null application/json; charset=utf-8 593.4934ms
2025-08-20 19:20:44.528 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/api/plan/me/permissions - null null
2025-08-20 19:20:44.533 +05:30 [INF] CORS policy execution successful.
2025-08-20 19:20:44.536 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/api/plan/me/permissions - 204 null null 7.4973ms
2025-08-20 19:20:44.542 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/plan/me/permissions - null null
2025-08-20 19:20:44.548 +05:30 [INF] CORS policy execution successful.
2025-08-20 19:20:44.614 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.AccessControl.Controllers.PlanController.GetMyPlanPermissions (xbytechat.api)'
2025-08-20 19:20:44.622 +05:30 [INF] Route matched with {action = "GetMyPlanPermissions", controller = "Plan"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMyPlanPermissions(System.Threading.CancellationToken) on controller xbytechat.api.Features.AccessControl.Controllers.PlanController (xbytechat.api).
2025-08-20 19:20:44.629 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType25`2[[System.Nullable`1[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String[], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-20 19:20:44.640 +05:30 [INF] Executed action xbytechat.api.Features.AccessControl.Controllers.PlanController.GetMyPlanPermissions (xbytechat.api) in 15.2512ms
2025-08-20 19:20:44.642 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.AccessControl.Controllers.PlanController.GetMyPlanPermissions (xbytechat.api)'
2025-08-20 19:20:44.644 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/plan/me/permissions - 200 null application/json; charset=utf-8 101.6886ms
2025-08-20 19:21:04.648 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/api/auth/login - null null
2025-08-20 19:21:04.652 +05:30 [INF] CORS policy execution successful.
2025-08-20 19:21:04.654 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/api/auth/login - 204 null null 6.3257ms
2025-08-20 19:21:04.660 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/api/auth/login - application/json 47
2025-08-20 19:21:04.664 +05:30 [INF] CORS policy execution successful.
2025-08-20 19:21:04.668 +05:30 [INF] Executing endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.Login (xbytechat.api)'
2025-08-20 19:21:04.670 +05:30 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(xbytechat.api.AuthModule.DTOs.UserLoginDto) on controller xbytechat.api.AuthModule.Controllers.AuthController (xbytechat.api).
2025-08-20 19:21:04.678 +05:30 [INF] 🔑 Login attempt for email: test@test.com
2025-08-20 19:21:04.706 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__dto_Email_0='test@test.com', @__hashedPassword_1='JAvlGPq9JyTdtvBO6x2llnRI1+gxwIyPqCKAn3THIKk='], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."BusinessId", u."CreatedAt", u."DeletedAt", u."Email", u."IsDeleted", u."Name", u."PasswordHash", u."RefreshToken", u."RefreshTokenExpiry", u."RoleId", u."Status", r."Id", r."CreatedAt", r."Description", r."IsActive", r."IsSystemDefined", r."Name"
FROM "Users" AS u
LEFT JOIN "Roles" AS r ON u."RoleId" = r."Id"
WHERE u."Email" = @__dto_Email_0 AND u."PasswordHash" = @__hashedPassword_1 AND NOT (u."IsDeleted")
LIMIT 1
2025-08-20 19:21:04.743 +05:30 [INF] Executed DbCommand (11ms) [Parameters=[@__user_BusinessId_Value_0='1fd4aee7-d6b6-4aa6-9c78-76e7e592341d'], CommandType='"Text"', CommandTimeout='30']
SELECT b."Id", b."Address", b."ApprovedAt", b."ApprovedBy", b."BusinessEmail", b."BusinessName", b."CompanyName", b."CompanyPhone", b."CreatedAt", b."CreatedBy", b."CreatedByPartnerId", b."DeletedAt", b."DeletedBy", b."Industry", b."IsApproved", b."IsDeleted", b."LastLoginAt", b."LogoUrl", b."Notes", b."Phone", b."PlanId", b."RepresentativeName", b."Source", b."Status", b."Tags", b."Website", p."Id", p."Code", p."CreatedAt", p."Description", p."IsActive", p."Name"
FROM "Businesses" AS b
LEFT JOIN "Plans" AS p ON b."PlanId" = p."Id"
WHERE b."Id" = @__user_BusinessId_Value_0
LIMIT 1
2025-08-20 19:21:04.929 +05:30 [INF] Executed DbCommand (16ms) [Parameters=[@__userId_0='b2ad27f9-6ad9-4a1e-8beb-f0e0520adb5f'], CommandType='"Text"', CommandTimeout='30']
SELECT DISTINCT t0."Code", t0."Group"
FROM "Users" AS u
INNER JOIN "Businesses" AS b ON u."BusinessId" = b."Id"
INNER JOIN (
    SELECT p."PermissionId", p."PlanId"
    FROM "PlanPermissions" AS p
    WHERE p."IsActive"
) AS t ON b."PlanId" = t."PlanId"
INNER JOIN (
    SELECT p0."Id", p0."Code", p0."Group"
    FROM "Permissions" AS p0
    WHERE p0."IsActive"
) AS t0 ON t."PermissionId" = t0."Id"
WHERE u."Id" = @__userId_0 AND EXISTS (
    SELECT 1
    FROM "RolePermissions" AS r
    WHERE r."IsActive" AND NOT (r."IsRevoked") AND r."RoleId" = u."RoleId" AND r."PermissionId" = t0."Id")
2025-08-20 19:21:04.935 +05:30 [INF] ✅ Token generated for: test@test.com
2025-08-20 19:21:04.938 +05:30 [INF] ✅ Login successful for test@test.com, Role: business, PlanId: "b1ed0526-abd0-472f-a9ea-5bfebeeffe41"
2025-08-20 19:21:04.940 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType1`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-20 19:21:04.942 +05:30 [INF] Executed action xbytechat.api.AuthModule.Controllers.AuthController.Login (xbytechat.api) in 269.8649ms
2025-08-20 19:21:04.944 +05:30 [INF] Executed endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.Login (xbytechat.api)'
2025-08-20 19:21:04.945 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/api/auth/login - 200 null application/json; charset=utf-8 285.6589ms
2025-08-20 19:21:04.950 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/api/plan/me/permissions - null null
2025-08-20 19:21:04.953 +05:30 [INF] CORS policy execution successful.
2025-08-20 19:21:04.954 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/api/plan/me/permissions - 204 null null 4.065ms
2025-08-20 19:21:04.962 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/plan/me/permissions - null null
2025-08-20 19:21:04.965 +05:30 [INF] CORS policy execution successful.
2025-08-20 19:21:04.969 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.AccessControl.Controllers.PlanController.GetMyPlanPermissions (xbytechat.api)'
2025-08-20 19:21:04.971 +05:30 [INF] Route matched with {action = "GetMyPlanPermissions", controller = "Plan"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMyPlanPermissions(System.Threading.CancellationToken) on controller xbytechat.api.Features.AccessControl.Controllers.PlanController (xbytechat.api).
2025-08-20 19:21:04.989 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__planId_0='b1ed0526-abd0-472f-a9ea-5bfebeeffe41'], CommandType='"Text"', CommandTimeout='30']
SELECT p0."Id", p0."Code", p0."CreatedAt", p0."Description", p0."Group", p0."IsActive", p0."Name"
FROM "PlanPermissions" AS p
INNER JOIN "Permissions" AS p0 ON p."PermissionId" = p0."Id"
WHERE p."PlanId" = @__planId_0 AND p."IsActive"
2025-08-20 19:21:05.015 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType25`2[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-20 19:21:05.025 +05:30 [INF] Executed action xbytechat.api.Features.AccessControl.Controllers.PlanController.GetMyPlanPermissions (xbytechat.api) in 51.0001ms
2025-08-20 19:21:05.027 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.AccessControl.Controllers.PlanController.GetMyPlanPermissions (xbytechat.api)'
2025-08-20 19:21:05.029 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/plan/me/permissions - 200 null application/json; charset=utf-8 67.6382ms
2025-08-20 19:23:11.014 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/api/auth/login - null null
2025-08-20 19:23:11.019 +05:30 [INF] CORS policy execution successful.
2025-08-20 19:23:11.020 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/api/auth/login - 204 null null 6.2856ms
2025-08-20 19:23:11.025 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/api/auth/login - application/json 53
2025-08-20 19:23:11.034 +05:30 [INF] CORS policy execution successful.
2025-08-20 19:23:11.036 +05:30 [INF] Executing endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.Login (xbytechat.api)'
2025-08-20 19:23:11.037 +05:30 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(xbytechat.api.AuthModule.DTOs.UserLoginDto) on controller xbytechat.api.AuthModule.Controllers.AuthController (xbytechat.api).
2025-08-20 19:23:11.051 +05:30 [INF] 🔑 Login attempt for email: admin@xbytechat.com
2025-08-20 19:23:11.057 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__dto_Email_0='admin@xbytechat.com', @__hashedPassword_1='JAvlGPq9JyTdtvBO6x2llnRI1+gxwIyPqCKAn3THIKk='], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."BusinessId", u."CreatedAt", u."DeletedAt", u."Email", u."IsDeleted", u."Name", u."PasswordHash", u."RefreshToken", u."RefreshTokenExpiry", u."RoleId", u."Status", r."Id", r."CreatedAt", r."Description", r."IsActive", r."IsSystemDefined", r."Name"
FROM "Users" AS u
LEFT JOIN "Roles" AS r ON u."RoleId" = r."Id"
WHERE u."Email" = @__dto_Email_0 AND u."PasswordHash" = @__hashedPassword_1 AND NOT (u."IsDeleted")
LIMIT 1
2025-08-20 19:23:11.064 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT p."Code"
FROM "Permissions" AS p
WHERE p."IsActive"
ORDER BY p."Code"
2025-08-20 19:23:11.067 +05:30 [INF] ✅ Token generated for: admin@xbytechat.com
2025-08-20 19:23:11.068 +05:30 [INF] ✅ Login successful for admin@xbytechat.com, Role: superadmin, PlanId: null
2025-08-20 19:23:11.070 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType1`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-20 19:23:11.073 +05:30 [INF] Executed action xbytechat.api.AuthModule.Controllers.AuthController.Login (xbytechat.api) in 32.6288ms
2025-08-20 19:23:11.075 +05:30 [INF] Executed endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.Login (xbytechat.api)'
2025-08-20 19:23:11.077 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/api/auth/login - 200 null application/json; charset=utf-8 51.7984ms
2025-08-20 19:23:11.082 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/api/plan/me/permissions - null null
2025-08-20 19:23:11.085 +05:30 [INF] CORS policy execution successful.
2025-08-20 19:23:11.087 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/api/plan/me/permissions - 204 null null 4.9918ms
2025-08-20 19:23:11.093 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/plan/me/permissions - null null
2025-08-20 19:23:11.096 +05:30 [INF] CORS policy execution successful.
2025-08-20 19:23:11.099 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.AccessControl.Controllers.PlanController.GetMyPlanPermissions (xbytechat.api)'
2025-08-20 19:23:11.100 +05:30 [INF] Route matched with {action = "GetMyPlanPermissions", controller = "Plan"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMyPlanPermissions(System.Threading.CancellationToken) on controller xbytechat.api.Features.AccessControl.Controllers.PlanController (xbytechat.api).
2025-08-20 19:23:11.105 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType25`2[[System.Nullable`1[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String[], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-20 19:23:11.108 +05:30 [INF] Executed action xbytechat.api.Features.AccessControl.Controllers.PlanController.GetMyPlanPermissions (xbytechat.api) in 5.2164ms
2025-08-20 19:23:11.110 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.AccessControl.Controllers.PlanController.GetMyPlanPermissions (xbytechat.api)'
2025-08-20 19:23:11.112 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/plan/me/permissions - 200 null application/json; charset=utf-8 19.3518ms
2025-08-20 19:24:20.427 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/api/auth/login - null null
2025-08-20 19:24:20.430 +05:30 [INF] CORS policy execution successful.
2025-08-20 19:24:20.431 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/api/auth/login - 204 null null 4.604ms
2025-08-20 19:24:20.439 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/api/auth/login - application/json 47
2025-08-20 19:24:20.442 +05:30 [INF] CORS policy execution successful.
2025-08-20 19:24:20.443 +05:30 [INF] Executing endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.Login (xbytechat.api)'
2025-08-20 19:24:20.444 +05:30 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(xbytechat.api.AuthModule.DTOs.UserLoginDto) on controller xbytechat.api.AuthModule.Controllers.AuthController (xbytechat.api).
2025-08-20 19:24:20.447 +05:30 [INF] 🔑 Login attempt for email: test@test.com
2025-08-20 19:24:20.542 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[@__dto_Email_0='test@test.com', @__hashedPassword_1='JAvlGPq9JyTdtvBO6x2llnRI1+gxwIyPqCKAn3THIKk='], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."BusinessId", u."CreatedAt", u."DeletedAt", u."Email", u."IsDeleted", u."Name", u."PasswordHash", u."RefreshToken", u."RefreshTokenExpiry", u."RoleId", u."Status", r."Id", r."CreatedAt", r."Description", r."IsActive", r."IsSystemDefined", r."Name"
FROM "Users" AS u
LEFT JOIN "Roles" AS r ON u."RoleId" = r."Id"
WHERE u."Email" = @__dto_Email_0 AND u."PasswordHash" = @__hashedPassword_1 AND NOT (u."IsDeleted")
LIMIT 1
2025-08-20 19:24:20.548 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__user_BusinessId_Value_0='1fd4aee7-d6b6-4aa6-9c78-76e7e592341d'], CommandType='"Text"', CommandTimeout='30']
SELECT b."Id", b."Address", b."ApprovedAt", b."ApprovedBy", b."BusinessEmail", b."BusinessName", b."CompanyName", b."CompanyPhone", b."CreatedAt", b."CreatedBy", b."CreatedByPartnerId", b."DeletedAt", b."DeletedBy", b."Industry", b."IsApproved", b."IsDeleted", b."LastLoginAt", b."LogoUrl", b."Notes", b."Phone", b."PlanId", b."RepresentativeName", b."Source", b."Status", b."Tags", b."Website", p."Id", p."Code", p."CreatedAt", p."Description", p."IsActive", p."Name"
FROM "Businesses" AS b
LEFT JOIN "Plans" AS p ON b."PlanId" = p."Id"
WHERE b."Id" = @__user_BusinessId_Value_0
LIMIT 1
2025-08-20 19:24:20.558 +05:30 [INF] Executed DbCommand (5ms) [Parameters=[@__userId_0='b2ad27f9-6ad9-4a1e-8beb-f0e0520adb5f'], CommandType='"Text"', CommandTimeout='30']
SELECT DISTINCT t0."Code", t0."Group"
FROM "Users" AS u
INNER JOIN "Businesses" AS b ON u."BusinessId" = b."Id"
INNER JOIN (
    SELECT p."PermissionId", p."PlanId"
    FROM "PlanPermissions" AS p
    WHERE p."IsActive"
) AS t ON b."PlanId" = t."PlanId"
INNER JOIN (
    SELECT p0."Id", p0."Code", p0."Group"
    FROM "Permissions" AS p0
    WHERE p0."IsActive"
) AS t0 ON t."PermissionId" = t0."Id"
WHERE u."Id" = @__userId_0 AND EXISTS (
    SELECT 1
    FROM "RolePermissions" AS r
    WHERE r."IsActive" AND NOT (r."IsRevoked") AND r."RoleId" = u."RoleId" AND r."PermissionId" = t0."Id")
2025-08-20 19:24:20.561 +05:30 [INF] ✅ Token generated for: test@test.com
2025-08-20 19:24:20.562 +05:30 [INF] ✅ Login successful for test@test.com, Role: business, PlanId: "b1ed0526-abd0-472f-a9ea-5bfebeeffe41"
2025-08-20 19:24:20.563 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType1`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-20 19:24:20.565 +05:30 [INF] Executed action xbytechat.api.AuthModule.Controllers.AuthController.Login (xbytechat.api) in 118.7098ms
2025-08-20 19:24:20.567 +05:30 [INF] Executed endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.Login (xbytechat.api)'
2025-08-20 19:24:20.569 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/api/auth/login - 200 null application/json; charset=utf-8 130.1997ms
2025-08-20 19:24:20.573 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/api/plan/me/permissions - null null
2025-08-20 19:24:20.576 +05:30 [INF] CORS policy execution successful.
2025-08-20 19:24:20.577 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/api/plan/me/permissions - 204 null null 4.091ms
2025-08-20 19:24:20.581 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/plan/me/permissions - null null
2025-08-20 19:24:20.586 +05:30 [INF] CORS policy execution successful.
2025-08-20 19:24:20.587 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.AccessControl.Controllers.PlanController.GetMyPlanPermissions (xbytechat.api)'
2025-08-20 19:24:20.590 +05:30 [INF] Route matched with {action = "GetMyPlanPermissions", controller = "Plan"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMyPlanPermissions(System.Threading.CancellationToken) on controller xbytechat.api.Features.AccessControl.Controllers.PlanController (xbytechat.api).
2025-08-20 19:24:20.592 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType25`2[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-20 19:24:20.594 +05:30 [INF] Executed action xbytechat.api.Features.AccessControl.Controllers.PlanController.GetMyPlanPermissions (xbytechat.api) in 2.7369ms
2025-08-20 19:24:20.596 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.AccessControl.Controllers.PlanController.GetMyPlanPermissions (xbytechat.api)'
2025-08-20 19:24:20.597 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/plan/me/permissions - 200 null application/json; charset=utf-8 16.6475ms
2025-08-20 19:24:49.243 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/api/Campaign/paginated?page=1&pageSize=10&status= - null null
2025-08-20 19:24:49.254 +05:30 [INF] CORS policy execution successful.
2025-08-20 19:24:49.255 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/api/Campaign/paginated?page=1&pageSize=10&status= - 204 null null 12.8157ms
2025-08-20 19:24:49.268 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/Campaign/paginated?page=1&pageSize=10&status= - null null
2025-08-20 19:24:49.275 +05:30 [INF] CORS policy execution successful.
2025-08-20 19:24:49.278 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetPaginatedCampaigns (xbytechat.api)'
2025-08-20 19:24:49.288 +05:30 [INF] Route matched with {action = "GetPaginatedCampaigns", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPaginatedCampaigns(xbytechat.api.Shared.PaginatedRequest) on controller xbytechat.api.Features.CampaignModule.Controllers.CampaignController (xbytechat.api).
2025-08-20 19:24:49.341 +05:30 [INF] Executing UnauthorizedObjectResult, writing value of type '<>f__AnonymousType14`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-20 19:24:49.346 +05:30 [INF] Executed action xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetPaginatedCampaigns (xbytechat.api) in 55.3423ms
2025-08-20 19:24:49.348 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetPaginatedCampaigns (xbytechat.api)'
2025-08-20 19:24:49.350 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/Campaign/paginated?page=1&pageSize=10&status= - 401 null application/json; charset=utf-8 82.1136ms
2025-08-20 19:31:45.238 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/api/auth/login - null null
2025-08-20 19:31:45.247 +05:30 [INF] CORS policy execution successful.
2025-08-20 19:31:45.248 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/api/auth/login - 204 null null 10.3362ms
2025-08-20 19:31:45.260 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/api/auth/login - application/json 53
2025-08-20 19:31:45.265 +05:30 [INF] CORS policy execution successful.
2025-08-20 19:31:45.266 +05:30 [INF] Executing endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.Login (xbytechat.api)'
2025-08-20 19:31:45.268 +05:30 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(xbytechat.api.AuthModule.DTOs.UserLoginDto) on controller xbytechat.api.AuthModule.Controllers.AuthController (xbytechat.api).
2025-08-20 19:31:45.271 +05:30 [INF] 🔑 Login attempt for email: admin@xbytechat.com
2025-08-20 19:31:45.375 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[@__dto_Email_0='admin@xbytechat.com', @__hashedPassword_1='JAvlGPq9JyTdtvBO6x2llnRI1+gxwIyPqCKAn3THIKk='], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."BusinessId", u."CreatedAt", u."DeletedAt", u."Email", u."IsDeleted", u."Name", u."PasswordHash", u."RefreshToken", u."RefreshTokenExpiry", u."RoleId", u."Status", r."Id", r."CreatedAt", r."Description", r."IsActive", r."IsSystemDefined", r."Name"
FROM "Users" AS u
LEFT JOIN "Roles" AS r ON u."RoleId" = r."Id"
WHERE u."Email" = @__dto_Email_0 AND u."PasswordHash" = @__hashedPassword_1 AND NOT (u."IsDeleted")
LIMIT 1
2025-08-20 19:31:45.382 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT p."Code"
FROM "Permissions" AS p
WHERE p."IsActive"
ORDER BY p."Code"
2025-08-20 19:31:45.384 +05:30 [INF] ✅ Token generated for: admin@xbytechat.com
2025-08-20 19:31:45.386 +05:30 [INF] ✅ Login successful for admin@xbytechat.com, Role: superadmin, PlanId: null
2025-08-20 19:31:45.387 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType1`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-20 19:31:45.389 +05:30 [INF] Executed action xbytechat.api.AuthModule.Controllers.AuthController.Login (xbytechat.api) in 119.4325ms
2025-08-20 19:31:45.391 +05:30 [INF] Executed endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.Login (xbytechat.api)'
2025-08-20 19:31:45.392 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/api/auth/login - 200 null application/json; charset=utf-8 132.3895ms
2025-08-20 19:31:45.398 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/api/plan/me/permissions - null null
2025-08-20 19:31:45.402 +05:30 [INF] CORS policy execution successful.
2025-08-20 19:31:45.403 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/api/plan/me/permissions - 204 null null 5.0001ms
2025-08-20 19:31:45.408 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/plan/me/permissions - null null
2025-08-20 19:31:45.414 +05:30 [INF] CORS policy execution successful.
2025-08-20 19:31:45.416 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.AccessControl.Controllers.PlanController.GetMyPlanPermissions (xbytechat.api)'
2025-08-20 19:31:45.418 +05:30 [INF] Route matched with {action = "GetMyPlanPermissions", controller = "Plan"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMyPlanPermissions(System.Threading.CancellationToken) on controller xbytechat.api.Features.AccessControl.Controllers.PlanController (xbytechat.api).
2025-08-20 19:31:45.421 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType25`2[[System.Nullable`1[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String[], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-20 19:31:45.423 +05:30 [INF] Executed action xbytechat.api.Features.AccessControl.Controllers.PlanController.GetMyPlanPermissions (xbytechat.api) in 2.8883ms
2025-08-20 19:31:45.424 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.AccessControl.Controllers.PlanController.GetMyPlanPermissions (xbytechat.api)'
2025-08-20 19:31:45.427 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/plan/me/permissions - 200 null application/json; charset=utf-8 18.6652ms
2025-08-20 19:31:53.600 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/api/whatsappsettings/me - null null
2025-08-20 19:31:53.610 +05:30 [INF] CORS policy execution successful.
2025-08-20 19:31:53.614 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/api/whatsappsettings/me - 204 null null 14.5153ms
2025-08-20 19:31:53.625 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/whatsappsettings/me - null null
2025-08-20 19:31:53.631 +05:30 [INF] CORS policy execution successful.
2025-08-20 19:31:53.634 +05:30 [INF] Executing endpoint 'xbytechat_api.WhatsAppSettings.Controllers.WhatsAppSettingsController.GetMySettings (xbytechat.api)'
2025-08-20 19:31:53.639 +05:30 [INF] Route matched with {action = "GetMySettings", controller = "WhatsAppSettings"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMySettings() on controller xbytechat_api.WhatsAppSettings.Controllers.WhatsAppSettingsController (xbytechat.api).
2025-08-20 19:31:53.747 +05:30 [INF] Executed action xbytechat_api.WhatsAppSettings.Controllers.WhatsAppSettingsController.GetMySettings (xbytechat.api) in 105.4107ms
2025-08-20 19:31:53.751 +05:30 [INF] Executed endpoint 'xbytechat_api.WhatsAppSettings.Controllers.WhatsAppSettingsController.GetMySettings (xbytechat.api)'
2025-08-20 19:31:53.794 +05:30 [ERR] ❌ An unhandled exception occurred
System.UnauthorizedAccessException: Invalid or missing businessId in token.
   at xbytechat.api.Shared.ClaimsBusinessDetails.GetBusinessId(ClaimsPrincipal user) in D:\xbytechat\xbytechat-api\xbytechat-api\Shared\ClaimsBusinessDetails.cs:line 12
   at xbytechat_api.WhatsAppSettings.Controllers.WhatsAppSettingsController.GetMySettings() in D:\xbytechat\xbytechat-api\xbytechat-api\WhatsAppSettings\Controllers\WhatsAppSettingsController.cs:line 85
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Program.<>c.<<<Main>$>b__0_9>d.MoveNext() in D:\xbytechat\xbytechat-api\xbytechat-api\Program.cs:line 370
--- End of stack trace from previous location ---
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at GlobalExceptionMiddleware.Invoke(HttpContext context) in D:\xbytechat\xbytechat-api\xbytechat-api\Middlewares\GlobalExceptionMiddleware.cs:line 32
2025-08-20 19:31:53.876 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/whatsappsettings/me - 500 null application/json; charset=utf-8 251.6904ms
2025-08-20 19:32:01.642 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/api/plan/me/permissions - null null
2025-08-20 19:32:01.646 +05:30 [INF] CORS policy execution successful.
2025-08-20 19:32:01.649 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/api/plan/me/permissions - 204 null null 7.1441ms
2025-08-20 19:32:01.655 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/plan/me/permissions - null null
2025-08-20 19:32:01.659 +05:30 [INF] CORS policy execution successful.
2025-08-20 19:32:01.661 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.AccessControl.Controllers.PlanController.GetMyPlanPermissions (xbytechat.api)'
2025-08-20 19:32:01.663 +05:30 [INF] Route matched with {action = "GetMyPlanPermissions", controller = "Plan"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMyPlanPermissions(System.Threading.CancellationToken) on controller xbytechat.api.Features.AccessControl.Controllers.PlanController (xbytechat.api).
2025-08-20 19:32:01.668 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType25`2[[System.Nullable`1[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String[], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-20 19:32:01.670 +05:30 [INF] Executed action xbytechat.api.Features.AccessControl.Controllers.PlanController.GetMyPlanPermissions (xbytechat.api) in 4.2714ms
2025-08-20 19:32:01.672 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.AccessControl.Controllers.PlanController.GetMyPlanPermissions (xbytechat.api)'
2025-08-20 19:32:01.674 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/plan/me/permissions - 200 null application/json; charset=utf-8 18.5135ms
2025-08-20 19:32:01.849 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/api/whatsappsettings/me - null null
2025-08-20 19:32:01.853 +05:30 [INF] CORS policy execution successful.
2025-08-20 19:32:01.855 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/api/whatsappsettings/me - 204 null null 5.6598ms
2025-08-20 19:32:01.863 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/whatsappsettings/me - null null
2025-08-20 19:32:01.867 +05:30 [INF] CORS policy execution successful.
2025-08-20 19:32:01.869 +05:30 [INF] Executing endpoint 'xbytechat_api.WhatsAppSettings.Controllers.WhatsAppSettingsController.GetMySettings (xbytechat.api)'
2025-08-20 19:32:01.871 +05:30 [INF] Route matched with {action = "GetMySettings", controller = "WhatsAppSettings"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMySettings() on controller xbytechat_api.WhatsAppSettings.Controllers.WhatsAppSettingsController (xbytechat.api).
2025-08-20 19:32:01.910 +05:30 [INF] Executed action xbytechat_api.WhatsAppSettings.Controllers.WhatsAppSettingsController.GetMySettings (xbytechat.api) in 37.1692ms
2025-08-20 19:32:01.913 +05:30 [INF] Executed endpoint 'xbytechat_api.WhatsAppSettings.Controllers.WhatsAppSettingsController.GetMySettings (xbytechat.api)'
2025-08-20 19:32:01.965 +05:30 [ERR] ❌ An unhandled exception occurred
System.UnauthorizedAccessException: Invalid or missing businessId in token.
   at xbytechat.api.Shared.ClaimsBusinessDetails.GetBusinessId(ClaimsPrincipal user) in D:\xbytechat\xbytechat-api\xbytechat-api\Shared\ClaimsBusinessDetails.cs:line 12
   at xbytechat_api.WhatsAppSettings.Controllers.WhatsAppSettingsController.GetMySettings() in D:\xbytechat\xbytechat-api\xbytechat-api\WhatsAppSettings\Controllers\WhatsAppSettingsController.cs:line 85
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Program.<>c.<<<Main>$>b__0_9>d.MoveNext() in D:\xbytechat\xbytechat-api\xbytechat-api\Program.cs:line 370
--- End of stack trace from previous location ---
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at GlobalExceptionMiddleware.Invoke(HttpContext context) in D:\xbytechat\xbytechat-api\xbytechat-api\Middlewares\GlobalExceptionMiddleware.cs:line 32
2025-08-20 19:32:01.975 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/whatsappsettings/me - 500 null application/json; charset=utf-8 112.4561ms
2025-08-20 19:32:08.528 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/api/plan/me/permissions - null null
2025-08-20 19:32:08.535 +05:30 [INF] CORS policy execution successful.
2025-08-20 19:32:08.537 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/api/plan/me/permissions - 204 null null 9.3032ms
2025-08-20 19:32:08.541 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/plan/me/permissions - null null
2025-08-20 19:32:08.545 +05:30 [INF] CORS policy execution successful.
2025-08-20 19:32:08.547 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.AccessControl.Controllers.PlanController.GetMyPlanPermissions (xbytechat.api)'
2025-08-20 19:32:08.550 +05:30 [INF] Route matched with {action = "GetMyPlanPermissions", controller = "Plan"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMyPlanPermissions(System.Threading.CancellationToken) on controller xbytechat.api.Features.AccessControl.Controllers.PlanController (xbytechat.api).
2025-08-20 19:32:08.554 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType25`2[[System.Nullable`1[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String[], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-20 19:32:08.556 +05:30 [INF] Executed action xbytechat.api.Features.AccessControl.Controllers.PlanController.GetMyPlanPermissions (xbytechat.api) in 3.1074ms
2025-08-20 19:32:08.558 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.AccessControl.Controllers.PlanController.GetMyPlanPermissions (xbytechat.api)'
2025-08-20 19:32:08.561 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/plan/me/permissions - 200 null application/json; charset=utf-8 19.5702ms
2025-08-20 19:32:08.649 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/api/whatsappsettings/me - null null
2025-08-20 19:32:08.654 +05:30 [INF] CORS policy execution successful.
2025-08-20 19:32:08.655 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/api/whatsappsettings/me - 204 null null 6.6022ms
2025-08-20 19:32:08.660 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/whatsappsettings/me - null null
2025-08-20 19:32:08.672 +05:30 [INF] CORS policy execution successful.
2025-08-20 19:32:08.674 +05:30 [INF] Executing endpoint 'xbytechat_api.WhatsAppSettings.Controllers.WhatsAppSettingsController.GetMySettings (xbytechat.api)'
2025-08-20 19:32:08.679 +05:30 [INF] Route matched with {action = "GetMySettings", controller = "WhatsAppSettings"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMySettings() on controller xbytechat_api.WhatsAppSettings.Controllers.WhatsAppSettingsController (xbytechat.api).
2025-08-20 19:32:08.719 +05:30 [INF] Executed action xbytechat_api.WhatsAppSettings.Controllers.WhatsAppSettingsController.GetMySettings (xbytechat.api) in 37.1037ms
2025-08-20 19:32:08.721 +05:30 [INF] Executed endpoint 'xbytechat_api.WhatsAppSettings.Controllers.WhatsAppSettingsController.GetMySettings (xbytechat.api)'
2025-08-20 19:32:08.764 +05:30 [ERR] ❌ An unhandled exception occurred
System.UnauthorizedAccessException: Invalid or missing businessId in token.
   at xbytechat.api.Shared.ClaimsBusinessDetails.GetBusinessId(ClaimsPrincipal user) in D:\xbytechat\xbytechat-api\xbytechat-api\Shared\ClaimsBusinessDetails.cs:line 12
   at xbytechat_api.WhatsAppSettings.Controllers.WhatsAppSettingsController.GetMySettings() in D:\xbytechat\xbytechat-api\xbytechat-api\WhatsAppSettings\Controllers\WhatsAppSettingsController.cs:line 85
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Program.<>c.<<<Main>$>b__0_9>d.MoveNext() in D:\xbytechat\xbytechat-api\xbytechat-api\Program.cs:line 370
--- End of stack trace from previous location ---
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at GlobalExceptionMiddleware.Invoke(HttpContext context) in D:\xbytechat\xbytechat-api\xbytechat-api\Middlewares\GlobalExceptionMiddleware.cs:line 32
2025-08-20 19:32:08.774 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/whatsappsettings/me - 500 null application/json; charset=utf-8 113.912ms
2025-08-20 20:02:40.207 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/api/plan/me/permissions - null null
2025-08-20 20:02:40.221 +05:30 [INF] CORS policy execution successful.
2025-08-20 20:02:40.222 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/api/plan/me/permissions - 204 null null 14.6245ms
2025-08-20 20:02:40.235 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/plan/me/permissions - null null
2025-08-20 20:02:40.239 +05:30 [INF] CORS policy execution successful.
2025-08-20 20:02:40.241 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.AccessControl.Controllers.PlanController.GetMyPlanPermissions (xbytechat.api)'
2025-08-20 20:02:40.242 +05:30 [INF] Route matched with {action = "GetMyPlanPermissions", controller = "Plan"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMyPlanPermissions(System.Threading.CancellationToken) on controller xbytechat.api.Features.AccessControl.Controllers.PlanController (xbytechat.api).
2025-08-20 20:02:40.246 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType25`2[[System.Nullable`1[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String[], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-20 20:02:40.249 +05:30 [INF] Executed action xbytechat.api.Features.AccessControl.Controllers.PlanController.GetMyPlanPermissions (xbytechat.api) in 3.803ms
2025-08-20 20:02:40.252 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.AccessControl.Controllers.PlanController.GetMyPlanPermissions (xbytechat.api)'
2025-08-20 20:02:40.253 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/plan/me/permissions - 200 null application/json; charset=utf-8 18.1564ms
2025-08-20 20:02:40.398 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/api/whatsappsettings/me - null null
2025-08-20 20:02:40.402 +05:30 [INF] CORS policy execution successful.
2025-08-20 20:02:40.404 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/api/whatsappsettings/me - 204 null null 6.0939ms
2025-08-20 20:02:40.409 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/whatsappsettings/me - null null
2025-08-20 20:02:40.413 +05:30 [INF] CORS policy execution successful.
2025-08-20 20:02:40.414 +05:30 [INF] Executing endpoint 'xbytechat_api.WhatsAppSettings.Controllers.WhatsAppSettingsController.GetMySettings (xbytechat.api)'
2025-08-20 20:02:40.415 +05:30 [INF] Route matched with {action = "GetMySettings", controller = "WhatsAppSettings"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMySettings() on controller xbytechat_api.WhatsAppSettings.Controllers.WhatsAppSettingsController (xbytechat.api).
2025-08-20 20:02:40.459 +05:30 [INF] Executed action xbytechat_api.WhatsAppSettings.Controllers.WhatsAppSettingsController.GetMySettings (xbytechat.api) in 40.9452ms
2025-08-20 20:02:40.462 +05:30 [INF] Executed endpoint 'xbytechat_api.WhatsAppSettings.Controllers.WhatsAppSettingsController.GetMySettings (xbytechat.api)'
2025-08-20 20:02:40.506 +05:30 [ERR] ❌ An unhandled exception occurred
System.UnauthorizedAccessException: Invalid or missing businessId in token.
   at xbytechat.api.Shared.ClaimsBusinessDetails.GetBusinessId(ClaimsPrincipal user) in D:\xbytechat\xbytechat-api\xbytechat-api\Shared\ClaimsBusinessDetails.cs:line 12
   at xbytechat_api.WhatsAppSettings.Controllers.WhatsAppSettingsController.GetMySettings() in D:\xbytechat\xbytechat-api\xbytechat-api\WhatsAppSettings\Controllers\WhatsAppSettingsController.cs:line 85
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Program.<>c.<<<Main>$>b__0_9>d.MoveNext() in D:\xbytechat\xbytechat-api\xbytechat-api\Program.cs:line 370
--- End of stack trace from previous location ---
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at GlobalExceptionMiddleware.Invoke(HttpContext context) in D:\xbytechat\xbytechat-api\xbytechat-api\Middlewares\GlobalExceptionMiddleware.cs:line 32
2025-08-20 20:02:40.518 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/whatsappsettings/me - 500 null application/json; charset=utf-8 109.1983ms
2025-08-20 20:02:45.715 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/api/plan/me/permissions - null null
2025-08-20 20:02:45.721 +05:30 [INF] CORS policy execution successful.
2025-08-20 20:02:45.722 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/api/plan/me/permissions - 204 null null 6.737ms
2025-08-20 20:02:45.726 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/plan/me/permissions - null null
2025-08-20 20:02:45.730 +05:30 [INF] CORS policy execution successful.
2025-08-20 20:02:45.732 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.AccessControl.Controllers.PlanController.GetMyPlanPermissions (xbytechat.api)'
2025-08-20 20:02:45.734 +05:30 [INF] Route matched with {action = "GetMyPlanPermissions", controller = "Plan"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMyPlanPermissions(System.Threading.CancellationToken) on controller xbytechat.api.Features.AccessControl.Controllers.PlanController (xbytechat.api).
2025-08-20 20:02:45.738 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType25`2[[System.Nullable`1[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String[], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-20 20:02:45.740 +05:30 [INF] Executed action xbytechat.api.Features.AccessControl.Controllers.PlanController.GetMyPlanPermissions (xbytechat.api) in 2.9998ms
2025-08-20 20:02:45.742 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.AccessControl.Controllers.PlanController.GetMyPlanPermissions (xbytechat.api)'
2025-08-20 20:02:45.744 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/plan/me/permissions - 200 null application/json; charset=utf-8 17.7505ms
2025-08-20 20:02:45.809 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/api/whatsappsettings/me - null null
2025-08-20 20:02:45.816 +05:30 [INF] CORS policy execution successful.
2025-08-20 20:02:45.821 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/api/whatsappsettings/me - 204 null null 12.6873ms
2025-08-20 20:02:45.831 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/whatsappsettings/me - null null
2025-08-20 20:02:45.836 +05:30 [INF] CORS policy execution successful.
2025-08-20 20:02:45.838 +05:30 [INF] Executing endpoint 'xbytechat_api.WhatsAppSettings.Controllers.WhatsAppSettingsController.GetMySettings (xbytechat.api)'
2025-08-20 20:02:45.841 +05:30 [INF] Route matched with {action = "GetMySettings", controller = "WhatsAppSettings"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMySettings() on controller xbytechat_api.WhatsAppSettings.Controllers.WhatsAppSettingsController (xbytechat.api).
2025-08-20 20:02:45.884 +05:30 [INF] Executed action xbytechat_api.WhatsAppSettings.Controllers.WhatsAppSettingsController.GetMySettings (xbytechat.api) in 37.4428ms
2025-08-20 20:02:45.887 +05:30 [INF] Executed endpoint 'xbytechat_api.WhatsAppSettings.Controllers.WhatsAppSettingsController.GetMySettings (xbytechat.api)'
2025-08-20 20:02:45.941 +05:30 [ERR] ❌ An unhandled exception occurred
System.UnauthorizedAccessException: Invalid or missing businessId in token.
   at xbytechat.api.Shared.ClaimsBusinessDetails.GetBusinessId(ClaimsPrincipal user) in D:\xbytechat\xbytechat-api\xbytechat-api\Shared\ClaimsBusinessDetails.cs:line 12
   at xbytechat_api.WhatsAppSettings.Controllers.WhatsAppSettingsController.GetMySettings() in D:\xbytechat\xbytechat-api\xbytechat-api\WhatsAppSettings\Controllers\WhatsAppSettingsController.cs:line 85
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Program.<>c.<<<Main>$>b__0_9>d.MoveNext() in D:\xbytechat\xbytechat-api\xbytechat-api\Program.cs:line 370
--- End of stack trace from previous location ---
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at GlobalExceptionMiddleware.Invoke(HttpContext context) in D:\xbytechat\xbytechat-api\xbytechat-api\Middlewares\GlobalExceptionMiddleware.cs:line 32
2025-08-20 20:02:45.952 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/whatsappsettings/me - 500 null application/json; charset=utf-8 121.6367ms
2025-08-20 20:19:42.194 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/api/plan/me/permissions - null null
2025-08-20 20:19:42.200 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/api/plan/me/permissions - null null
2025-08-20 20:19:42.208 +05:30 [INF] CORS policy execution successful.
2025-08-20 20:19:42.212 +05:30 [INF] CORS policy execution successful.
2025-08-20 20:19:42.213 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/api/plan/me/permissions - 204 null null 18.6664ms
2025-08-20 20:19:42.214 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/api/plan/me/permissions - 204 null null 13.8496ms
2025-08-20 20:19:42.225 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/plan/me/permissions - null null
2025-08-20 20:19:42.229 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/plan/me/permissions - null null
2025-08-20 20:19:42.234 +05:30 [INF] CORS policy execution successful.
2025-08-20 20:19:42.238 +05:30 [INF] CORS policy execution successful.
2025-08-20 20:19:42.239 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.AccessControl.Controllers.PlanController.GetMyPlanPermissions (xbytechat.api)'
2025-08-20 20:19:42.241 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.AccessControl.Controllers.PlanController.GetMyPlanPermissions (xbytechat.api)'
2025-08-20 20:19:42.242 +05:30 [INF] Route matched with {action = "GetMyPlanPermissions", controller = "Plan"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMyPlanPermissions(System.Threading.CancellationToken) on controller xbytechat.api.Features.AccessControl.Controllers.PlanController (xbytechat.api).
2025-08-20 20:19:42.244 +05:30 [INF] Route matched with {action = "GetMyPlanPermissions", controller = "Plan"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMyPlanPermissions(System.Threading.CancellationToken) on controller xbytechat.api.Features.AccessControl.Controllers.PlanController (xbytechat.api).
2025-08-20 20:19:42.249 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType25`2[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-20 20:19:42.252 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType25`2[[System.Nullable`1[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String[], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-20 20:19:42.254 +05:30 [INF] Executed action xbytechat.api.Features.AccessControl.Controllers.PlanController.GetMyPlanPermissions (xbytechat.api) in 6.3839ms
2025-08-20 20:19:42.256 +05:30 [INF] Executed action xbytechat.api.Features.AccessControl.Controllers.PlanController.GetMyPlanPermissions (xbytechat.api) in 4.3829ms
2025-08-20 20:19:42.258 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.AccessControl.Controllers.PlanController.GetMyPlanPermissions (xbytechat.api)'
2025-08-20 20:19:42.260 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.AccessControl.Controllers.PlanController.GetMyPlanPermissions (xbytechat.api)'
2025-08-20 20:19:42.263 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/plan/me/permissions - 200 null application/json; charset=utf-8 37.9815ms
2025-08-20 20:19:42.264 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/plan/me/permissions - 200 null application/json; charset=utf-8 34.931ms
2025-08-20 20:19:42.398 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/api/whatsappsettings/me - null null
2025-08-20 20:19:42.403 +05:30 [INF] CORS policy execution successful.
2025-08-20 20:19:42.404 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/api/whatsappsettings/me - 204 null null 5.3958ms
2025-08-20 20:19:42.409 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/whatsappsettings/me - null null
2025-08-20 20:19:42.413 +05:30 [INF] CORS policy execution successful.
2025-08-20 20:19:42.415 +05:30 [INF] Executing endpoint 'xbytechat_api.WhatsAppSettings.Controllers.WhatsAppSettingsController.GetMySettings (xbytechat.api)'
2025-08-20 20:19:42.417 +05:30 [INF] Route matched with {action = "GetMySettings", controller = "WhatsAppSettings"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMySettings() on controller xbytechat_api.WhatsAppSettings.Controllers.WhatsAppSettingsController (xbytechat.api).
2025-08-20 20:19:42.451 +05:30 [INF] Executed action xbytechat_api.WhatsAppSettings.Controllers.WhatsAppSettingsController.GetMySettings (xbytechat.api) in 31.5956ms
2025-08-20 20:19:42.453 +05:30 [INF] Executed endpoint 'xbytechat_api.WhatsAppSettings.Controllers.WhatsAppSettingsController.GetMySettings (xbytechat.api)'
2025-08-20 20:19:42.519 +05:30 [ERR] ❌ An unhandled exception occurred
System.UnauthorizedAccessException: Invalid or missing businessId in token.
   at xbytechat.api.Shared.ClaimsBusinessDetails.GetBusinessId(ClaimsPrincipal user) in D:\xbytechat\xbytechat-api\xbytechat-api\Shared\ClaimsBusinessDetails.cs:line 12
   at xbytechat_api.WhatsAppSettings.Controllers.WhatsAppSettingsController.GetMySettings() in D:\xbytechat\xbytechat-api\xbytechat-api\WhatsAppSettings\Controllers\WhatsAppSettingsController.cs:line 85
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Program.<>c.<<<Main>$>b__0_9>d.MoveNext() in D:\xbytechat\xbytechat-api\xbytechat-api\Program.cs:line 370
--- End of stack trace from previous location ---
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at GlobalExceptionMiddleware.Invoke(HttpContext context) in D:\xbytechat\xbytechat-api\xbytechat-api\Middlewares\GlobalExceptionMiddleware.cs:line 32
2025-08-20 20:19:42.530 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/whatsappsettings/me - 500 null application/json; charset=utf-8 121.135ms
2025-08-20 20:42:38.546 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/api/auth/login - null null
2025-08-20 20:42:38.556 +05:30 [INF] CORS policy execution successful.
2025-08-20 20:42:38.557 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/api/auth/login - 204 null null 12.1233ms
2025-08-20 20:42:38.568 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/api/auth/login - application/json 53
2025-08-20 20:42:38.572 +05:30 [INF] CORS policy execution successful.
2025-08-20 20:42:38.573 +05:30 [INF] Executing endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.Login (xbytechat.api)'
2025-08-20 20:42:38.575 +05:30 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(xbytechat.api.AuthModule.DTOs.UserLoginDto) on controller xbytechat.api.AuthModule.Controllers.AuthController (xbytechat.api).
2025-08-20 20:42:38.579 +05:30 [INF] 🔑 Login attempt for email: admin@xbytechat.com
2025-08-20 20:42:38.733 +05:30 [INF] Executed DbCommand (42ms) [Parameters=[@__dto_Email_0='admin@xbytechat.com', @__hashedPassword_1='JAvlGPq9JyTdtvBO6x2llnRI1+gxwIyPqCKAn3THIKk='], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."BusinessId", u."CreatedAt", u."DeletedAt", u."Email", u."IsDeleted", u."Name", u."PasswordHash", u."RefreshToken", u."RefreshTokenExpiry", u."RoleId", u."Status", r."Id", r."CreatedAt", r."Description", r."IsActive", r."IsSystemDefined", r."Name"
FROM "Users" AS u
LEFT JOIN "Roles" AS r ON u."RoleId" = r."Id"
WHERE u."Email" = @__dto_Email_0 AND u."PasswordHash" = @__hashedPassword_1 AND NOT (u."IsDeleted")
LIMIT 1
2025-08-20 20:42:38.741 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT p."Code"
FROM "Permissions" AS p
WHERE p."IsActive"
ORDER BY p."Code"
2025-08-20 20:42:38.744 +05:30 [INF] ✅ Token generated for: admin@xbytechat.com
2025-08-20 20:42:38.746 +05:30 [INF] ✅ Login successful for admin@xbytechat.com, Role: superadmin, PlanId: null
2025-08-20 20:42:38.748 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType1`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-20 20:42:38.750 +05:30 [INF] Executed action xbytechat.api.AuthModule.Controllers.AuthController.Login (xbytechat.api) in 172.6952ms
2025-08-20 20:42:38.752 +05:30 [INF] Executed endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.Login (xbytechat.api)'
2025-08-20 20:42:38.754 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/api/auth/login - 200 null application/json; charset=utf-8 186.3424ms
2025-08-20 20:42:38.759 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/api/plan/me/permissions - null null
2025-08-20 20:42:38.763 +05:30 [INF] CORS policy execution successful.
2025-08-20 20:42:38.764 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/api/plan/me/permissions - 204 null null 5.4249ms
2025-08-20 20:42:38.769 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/plan/me/permissions - null null
2025-08-20 20:42:38.779 +05:30 [INF] CORS policy execution successful.
2025-08-20 20:42:38.781 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.AccessControl.Controllers.PlanController.GetMyPlanPermissions (xbytechat.api)'
2025-08-20 20:42:38.782 +05:30 [INF] Route matched with {action = "GetMyPlanPermissions", controller = "Plan"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMyPlanPermissions(System.Threading.CancellationToken) on controller xbytechat.api.Features.AccessControl.Controllers.PlanController (xbytechat.api).
2025-08-20 20:42:38.785 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType25`2[[System.Nullable`1[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String[], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-20 20:42:38.787 +05:30 [INF] Executed action xbytechat.api.Features.AccessControl.Controllers.PlanController.GetMyPlanPermissions (xbytechat.api) in 2.4383ms
2025-08-20 20:42:38.789 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.AccessControl.Controllers.PlanController.GetMyPlanPermissions (xbytechat.api)'
2025-08-20 20:42:38.790 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/plan/me/permissions - 200 null application/json; charset=utf-8 21.6634ms
