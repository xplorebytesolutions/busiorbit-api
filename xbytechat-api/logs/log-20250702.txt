2025-07-02 16:47:46.574 +05:30 [INF] User profile is available. Using 'C:\Users\sunde\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-07-02 16:47:46.631 +05:30 [INF] 🚀 Webhook Queue Worker started.
2025-07-02 16:47:46.650 +05:30 [INF] 🧹 FailedWebhookLogCleanupService started.
2025-07-02 16:47:47.624 +05:30 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2025-07-02 16:47:48.269 +05:30 [WRN] The query uses the 'First'/'FirstOrDefault' operator without 'OrderBy' and filter operators. This may lead to unpredictable results.
2025-07-02 16:47:48.536 +05:30 [INF] Now listening on: http://localhost:7113
2025-07-02 16:47:48.537 +05:30 [INF] Now listening on: http://localhost:5295
2025-07-02 16:47:48.539 +05:30 [INF] Application started. Press Ctrl+C to shut down.
2025-07-02 16:47:48.540 +05:30 [INF] Hosting environment: Development
2025-07-02 16:47:48.541 +05:30 [INF] Content root path: D:\xbytechat\xbytechat-api\xbytechat-api
2025-07-02 16:47:48.571 +05:30 [INF] Executed DbCommand (25ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."AutoCleanupEnabled", w."LastCleanupAt"
FROM "WebhookSettings" AS w
LIMIT 1
2025-07-02 16:47:48.593 +05:30 [INF] Executed DbCommand (51ms) [Parameters=[@__cutoff_0='2025-06-25T11:17:46.8101100Z' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."CreatedAt", f."ErrorMessage", f."FailureType", f."RawJson", f."SourceModule"
FROM "FailedWebhookLogs" AS f
WHERE f."CreatedAt" < @__cutoff_0
2025-07-02 16:47:50.691 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/swagger - null null
2025-07-02 16:47:51.063 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/swagger - 301 0 null 397.276ms
2025-07-02 16:47:51.073 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/swagger/index.html - null null
2025-07-02 16:47:51.183 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/swagger/index.html - 200 null text/html;charset=utf-8 110.0066ms
2025-07-02 16:47:51.359 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/_framework/aspnetcore-browser-refresh.js - null null
2025-07-02 16:47:51.359 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/_vs/browserLink - null null
2025-07-02 16:47:51.370 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/_framework/aspnetcore-browser-refresh.js - 200 13762 application/javascript; charset=utf-8 10.5253ms
2025-07-02 16:47:51.435 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/_vs/browserLink - 200 null text/javascript; charset=UTF-8 76.0275ms
2025-07-02 16:47:51.661 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/swagger/v1/swagger.json - null null
2025-07-02 16:47:51.954 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 293.132ms
2025-07-02 16:48:14.247 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/auth/session - null null
2025-07-02 16:48:14.260 +05:30 [WRN] Failed to determine the https port for redirect.
2025-07-02 16:48:14.330 +05:30 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-07-02 16:48:14.337 +05:30 [INF] AuthenticationScheme: Bearer was challenged.
2025-07-02 16:48:14.338 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/auth/session - 401 0 null 91.4409ms
2025-07-02 16:48:21.639 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/api/auth/login - null null
2025-07-02 16:48:21.655 +05:30 [INF] CORS policy execution successful.
2025-07-02 16:48:21.661 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/api/auth/login - 204 null null 21.6331ms
2025-07-02 16:48:21.666 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/api/auth/login - application/json 47
2025-07-02 16:48:21.672 +05:30 [INF] CORS policy execution successful.
2025-07-02 16:48:21.682 +05:30 [INF] Executing endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.Login (xbytechat.api)'
2025-07-02 16:48:21.715 +05:30 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(xbytechat.api.AuthModule.DTOs.UserLoginDto) on controller xbytechat.api.AuthModule.Controllers.AuthController (xbytechat.api).
2025-07-02 16:48:21.834 +05:30 [INF] 🔑 Login attempt for email: ratan@tcs.com
2025-07-02 16:48:21.970 +05:30 [INF] Executed DbCommand (22ms) [Parameters=[@__dto_Email_0='ratan@tcs.com', @__hashedPassword_1='JAvlGPq9JyTdtvBO6x2llnRI1+gxwIyPqCKAn3THIKk='], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."BusinessId", u."CreatedAt", u."DeletedAt", u."Email", u."IsDeleted", u."Name", u."PasswordHash", u."RefreshToken", u."RefreshTokenExpiry", u."RoleId", u."Status", r."Id", r."CreatedAt", r."Description", r."IsActive", r."IsSystemDefined", r."Name"
FROM "Users" AS u
LEFT JOIN "Roles" AS r ON u."RoleId" = r."Id"
WHERE u."Email" = @__dto_Email_0 AND u."PasswordHash" = @__hashedPassword_1 AND NOT (u."IsDeleted")
LIMIT 1
2025-07-02 16:48:22.165 +05:30 [INF] Executed DbCommand (47ms) [Parameters=[@__user_BusinessId_Value_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT b."Id", b."Address", b."ApprovedAt", b."ApprovedBy", b."BusinessEmail", b."BusinessName", b."CompanyName", b."CompanyPhone", b."CreatedAt", b."CreatedBy", b."CreatedByPartnerId", b."DeletedAt", b."DeletedBy", b."Industry", b."IsApproved", b."IsDeleted", b."LastLoginAt", b."LogoUrl", b."Notes", b."Phone", b."RepresentativeName", b."Source", b."Status", b."Tags", b."Website", b0."Id", b0."BusinessId", b0."CreatedAt", b0."Plan", b0."QuotaResetDate", b0."RemainingMessages", b0."TotalMonthlyQuota", b0."UpdatedAt", b0."WalletBalance"
FROM "Businesses" AS b
LEFT JOIN "BusinessPlanInfos" AS b0 ON b."Id" = b0."BusinessId"
WHERE b."Id" = @__user_BusinessId_Value_0
LIMIT 1
2025-07-02 16:48:22.302 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[@__user_RoleId_0='00000000-0000-0000-0000-000000000004' (Nullable = true)], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."AssignedAt", r."AssignedBy", r."IsActive", r."IsRevoked", r."PermissionId", r."RoleId"
FROM "RolePermissions" AS r
WHERE r."RoleId" = @__user_RoleId_0 AND NOT (r."IsRevoked")
2025-07-02 16:48:22.330 +05:30 [INF] Executed DbCommand (5ms) [Parameters=[@__userId_0='2870e1d8-0e80-4b12-88bd-70a8113307d6'], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."AssignedAt", u."AssignedBy", u."IsGranted", u."IsRevoked", u."PermissionId", u."UserId"
FROM "UserPermissions" AS u
WHERE u."UserId" = @__userId_0 AND NOT (u."IsRevoked")
2025-07-02 16:48:22.445 +05:30 [INF] Executed DbCommand (65ms) [Parameters=[@__permissionIds_0={ '30000000-0000-0000-0000-000000000000', '30000000-0000-0000-0000-000000000004', '30000000-0000-0000-0000-000000000001', '30000000-0000-0000-0000-000000000007' } (DbType = Object)], CommandType='"Text"', CommandTimeout='30']
SELECT p."Id", p."Code", p."CreatedAt", p."Description", p."Group", p."IsActive", p."Name"
FROM "Permissions" AS p
WHERE p."Id" = ANY (@__permissionIds_0)
2025-07-02 16:48:22.477 +05:30 [INF] ✅ Token generated for: ratan@tcs.com
2025-07-02 16:48:22.531 +05:30 [INF] ✅ Login successful for ratan@tcs.com, Role: business, Plan: Smart
2025-07-02 16:48:22.545 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`3[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 16:48:22.575 +05:30 [INF] Executed action xbytechat.api.AuthModule.Controllers.AuthController.Login (xbytechat.api) in 851.5087ms
2025-07-02 16:48:22.581 +05:30 [INF] Executed endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.Login (xbytechat.api)'
2025-07-02 16:48:22.592 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/api/auth/login - 200 null application/json; charset=utf-8 925.7356ms
2025-07-02 16:48:22.911 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/auth/session - null null
2025-07-02 16:48:22.986 +05:30 [INF] Executing endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 16:48:22.989 +05:30 [INF] Route matched with {action = "GetSession", controller = "Auth"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetSession() on controller xbytechat.api.AuthModule.Controllers.AuthController (xbytechat.api).
2025-07-02 16:48:22.997 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`4[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 16:48:23.002 +05:30 [INF] Executed action xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api) in 9.8503ms
2025-07-02 16:48:23.005 +05:30 [INF] Executed endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 16:48:23.007 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/auth/session - 200 null application/json; charset=utf-8 95.6802ms
2025-07-02 16:48:23.151 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/feature-access/me - null null
2025-07-02 16:48:23.175 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 16:48:23.181 +05:30 [INF] Route matched with {action = "GetMyFeatures", controller = "FeatureAccess"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto]]] GetMyFeatures() on controller xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController (xbytechat.api).
2025-07-02 16:48:23.206 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT b."Id", b."Address", b."ApprovedAt", b."ApprovedBy", b."BusinessEmail", b."BusinessName", b."CompanyName", b."CompanyPhone", b."CreatedAt", b."CreatedBy", b."CreatedByPartnerId", b."DeletedAt", b."DeletedBy", b."Industry", b."IsApproved", b."IsDeleted", b."LastLoginAt", b."LogoUrl", b."Notes", b."Phone", b."RepresentativeName", b."Source", b."Status", b."Tags", b."Website", b0."Id", b0."BusinessId", b0."CreatedAt", b0."Plan", b0."QuotaResetDate", b0."RemainingMessages", b0."TotalMonthlyQuota", b0."UpdatedAt", b0."WalletBalance"
FROM "Businesses" AS b
LEFT JOIN "BusinessPlanInfos" AS b0 ON b."Id" = b0."BusinessId"
WHERE b."Id" = @__businessId_0
LIMIT 1
2025-07-02 16:48:23.212 +05:30 [INF] 📦 Resolved plan for Business "c13be597-6ae2-42bb-9d43-925815f24ff8": Smart
2025-07-02 16:48:23.229 +05:30 [INF] Executed DbCommand (7ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."BusinessId", f."CreatedAt", f."Description", f."FeatureName", f."Group", f."IsEnabled", f."Notes", f."Plan"
FROM "FeatureAccess" AS f
WHERE f."BusinessId" = @__businessId_0
2025-07-02 16:48:23.252 +05:30 [INF] 🔧 Feature override: AddProduct = False
2025-07-02 16:48:23.254 +05:30 [INF] 🔧 Feature override: Campaigns = True
2025-07-02 16:48:23.255 +05:30 [INF] 🔧 Feature override: Catalog = True
2025-07-02 16:48:23.256 +05:30 [INF] 🔧 Feature override: CRM = True
2025-07-02 16:48:23.257 +05:30 [INF] 🔧 Feature override: CRMInsights = True
2025-07-02 16:48:23.257 +05:30 [INF] 🔧 Feature override: CTAFlow = True
2025-07-02 16:48:23.258 +05:30 [INF] 🔧 Feature override: FlowInsights = True
2025-07-02 16:48:23.259 +05:30 [INF] 🔧 Feature override: Messaging = True
2025-07-02 16:48:23.260 +05:30 [INF] 🔧 Feature override: ProfileCompletion = True
2025-07-02 16:48:23.261 +05:30 [INF] 🔧 Feature override: UpgradePlan = True
2025-07-02 16:48:23.262 +05:30 [INF] 🔧 Feature override: WhatsAppSettings = True
2025-07-02 16:48:23.269 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 16:48:23.279 +05:30 [INF] Executed action xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api) in 94.2004ms
2025-07-02 16:48:23.281 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 16:48:23.283 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/feature-access/me - 200 null application/json; charset=utf-8 131.9234ms
2025-07-02 16:48:27.670 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/contacts?tab=all&search= - null null
2025-07-02 16:48:27.678 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/tags - null null
2025-07-02 16:48:27.680 +05:30 [INF] CORS policy execution successful.
2025-07-02 16:48:27.685 +05:30 [INF] Executing endpoint 'xbytechat.api.CRM.Controllers.TagsController.GetAllTags (xbytechat.api)'
2025-07-02 16:48:27.686 +05:30 [INF] Executing endpoint 'xbytechat.api.CRM.Controllers.ContactsController.GetAllContacts (xbytechat.api)'
2025-07-02 16:48:27.694 +05:30 [INF] Route matched with {action = "GetAllTags", controller = "Tags"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllTags() on controller xbytechat.api.CRM.Controllers.TagsController (xbytechat.api).
2025-07-02 16:48:27.697 +05:30 [INF] Route matched with {action = "GetAllContacts", controller = "Contacts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllContacts(System.String, Int32, Int32) on controller xbytechat.api.CRM.Controllers.ContactsController (xbytechat.api).
2025-07-02 16:48:27.715 +05:30 [INF] GetPagedContactsAsync: businessId="c13be597-6ae2-42bb-9d43-925815f24ff8", tab=all, page=1, pageSize=25
2025-07-02 16:48:27.735 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."Name", t."ColorHex", t."Category", t."Notes", t."IsSystemTag", t."IsActive", t."CreatedAt", t."LastUsedAt"
FROM "Tags" AS t
WHERE t."BusinessId" = @__businessId_0 AND t."IsActive"
ORDER BY t."CreatedAt" DESC
2025-07-02 16:48:27.745 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Helpers.ResponseResult'.
2025-07-02 16:48:27.767 +05:30 [INF] Executed DbCommand (7ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Contacts" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."IsActive"
2025-07-02 16:48:27.772 +05:30 [INF] Executed action xbytechat.api.CRM.Controllers.TagsController.GetAllTags (xbytechat.api) in 75.1249ms
2025-07-02 16:48:27.774 +05:30 [INF] Executed endpoint 'xbytechat.api.CRM.Controllers.TagsController.GetAllTags (xbytechat.api)'
2025-07-02 16:48:27.776 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/tags - 200 null application/json; charset=utf-8 99.4644ms
2025-07-02 16:48:27.837 +05:30 [INF] Executed DbCommand (8ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__p_2='25', @__p_1='0'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."AssignedAgentId", t."BusinessId", t."CreatedAt", t."Email", t."Group", t."IsActive", t."IsArchived", t."IsAutomationPaused", t."IsFavorite", t."LastCTAInteraction", t."LastCTAType", t."LastClickedProductId", t."LastContactedAt", t."LeadSource", t."Name", t."NextFollowUpAt", t."Notes", t."PhoneNumber", t."Tags", t0."Id", t0."AssignedAt", t0."AssignedBy", t0."BusinessId", t0."ContactId", t0."TagId", t0."Id0", t0."BusinessId0", t0."Category", t0."ColorHex", t0."CreatedAt", t0."IsActive", t0."IsSystemTag", t0."LastUsedAt", t0."Name", t0."Notes"
FROM (
    SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."Tags"
    FROM "Contacts" AS c
    WHERE c."BusinessId" = @__businessId_0 AND c."IsActive"
    ORDER BY c."Name"
    LIMIT @__p_2 OFFSET @__p_1
) AS t
LEFT JOIN (
    SELECT c0."Id", c0."AssignedAt", c0."AssignedBy", c0."BusinessId", c0."ContactId", c0."TagId", t1."Id" AS "Id0", t1."BusinessId" AS "BusinessId0", t1."Category", t1."ColorHex", t1."CreatedAt", t1."IsActive", t1."IsSystemTag", t1."LastUsedAt", t1."Name", t1."Notes"
    FROM "ContactTags" AS c0
    INNER JOIN "Tags" AS t1 ON c0."TagId" = t1."Id"
) AS t0 ON t."Id" = t0."ContactId"
ORDER BY t."Name", t."Id", t0."Id"
2025-07-02 16:48:27.922 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Helpers.ResponseResult'.
2025-07-02 16:48:27.933 +05:30 [INF] Executed action xbytechat.api.CRM.Controllers.ContactsController.GetAllContacts (xbytechat.api) in 233.2446ms
2025-07-02 16:48:27.935 +05:30 [INF] Executed endpoint 'xbytechat.api.CRM.Controllers.ContactsController.GetAllContacts (xbytechat.api)'
2025-07-02 16:48:27.937 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/contacts?tab=all&search= - 200 null application/json; charset=utf-8 267.6891ms
2025-07-02 16:48:30.955 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/tags - null null
2025-07-02 16:48:30.960 +05:30 [INF] Executing endpoint 'xbytechat.api.CRM.Controllers.TagsController.GetAllTags (xbytechat.api)'
2025-07-02 16:48:30.962 +05:30 [INF] Route matched with {action = "GetAllTags", controller = "Tags"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllTags() on controller xbytechat.api.CRM.Controllers.TagsController (xbytechat.api).
2025-07-02 16:48:30.973 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."Name", t."ColorHex", t."Category", t."Notes", t."IsSystemTag", t."IsActive", t."CreatedAt", t."LastUsedAt"
FROM "Tags" AS t
WHERE t."BusinessId" = @__businessId_0 AND t."IsActive"
ORDER BY t."CreatedAt" DESC
2025-07-02 16:48:30.978 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Helpers.ResponseResult'.
2025-07-02 16:48:30.981 +05:30 [INF] Executed action xbytechat.api.CRM.Controllers.TagsController.GetAllTags (xbytechat.api) in 16.541ms
2025-07-02 16:48:30.983 +05:30 [INF] Executed endpoint 'xbytechat.api.CRM.Controllers.TagsController.GetAllTags (xbytechat.api)'
2025-07-02 16:48:30.985 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/tags - 200 null application/json; charset=utf-8 29.6894ms
2025-07-02 16:48:36.422 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/contacts?tab=all&search= - null null
2025-07-02 16:48:36.430 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/tags - null null
2025-07-02 16:48:36.433 +05:30 [INF] CORS policy execution successful.
2025-07-02 16:48:36.438 +05:30 [INF] Executing endpoint 'xbytechat.api.CRM.Controllers.TagsController.GetAllTags (xbytechat.api)'
2025-07-02 16:48:36.438 +05:30 [INF] Executing endpoint 'xbytechat.api.CRM.Controllers.ContactsController.GetAllContacts (xbytechat.api)'
2025-07-02 16:48:36.440 +05:30 [INF] Route matched with {action = "GetAllTags", controller = "Tags"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllTags() on controller xbytechat.api.CRM.Controllers.TagsController (xbytechat.api).
2025-07-02 16:48:36.442 +05:30 [INF] Route matched with {action = "GetAllContacts", controller = "Contacts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllContacts(System.String, Int32, Int32) on controller xbytechat.api.CRM.Controllers.ContactsController (xbytechat.api).
2025-07-02 16:48:36.448 +05:30 [INF] GetPagedContactsAsync: businessId="c13be597-6ae2-42bb-9d43-925815f24ff8", tab=all, page=1, pageSize=25
2025-07-02 16:48:36.452 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."Name", t."ColorHex", t."Category", t."Notes", t."IsSystemTag", t."IsActive", t."CreatedAt", t."LastUsedAt"
FROM "Tags" AS t
WHERE t."BusinessId" = @__businessId_0 AND t."IsActive"
ORDER BY t."CreatedAt" DESC
2025-07-02 16:48:36.458 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Contacts" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."IsActive"
2025-07-02 16:48:36.460 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Helpers.ResponseResult'.
2025-07-02 16:48:36.465 +05:30 [INF] Executed action xbytechat.api.CRM.Controllers.TagsController.GetAllTags (xbytechat.api) in 20.7355ms
2025-07-02 16:48:36.468 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__p_2='25', @__p_1='0'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."AssignedAgentId", t."BusinessId", t."CreatedAt", t."Email", t."Group", t."IsActive", t."IsArchived", t."IsAutomationPaused", t."IsFavorite", t."LastCTAInteraction", t."LastCTAType", t."LastClickedProductId", t."LastContactedAt", t."LeadSource", t."Name", t."NextFollowUpAt", t."Notes", t."PhoneNumber", t."Tags", t0."Id", t0."AssignedAt", t0."AssignedBy", t0."BusinessId", t0."ContactId", t0."TagId", t0."Id0", t0."BusinessId0", t0."Category", t0."ColorHex", t0."CreatedAt", t0."IsActive", t0."IsSystemTag", t0."LastUsedAt", t0."Name", t0."Notes"
FROM (
    SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."Tags"
    FROM "Contacts" AS c
    WHERE c."BusinessId" = @__businessId_0 AND c."IsActive"
    ORDER BY c."Name"
    LIMIT @__p_2 OFFSET @__p_1
) AS t
LEFT JOIN (
    SELECT c0."Id", c0."AssignedAt", c0."AssignedBy", c0."BusinessId", c0."ContactId", c0."TagId", t1."Id" AS "Id0", t1."BusinessId" AS "BusinessId0", t1."Category", t1."ColorHex", t1."CreatedAt", t1."IsActive", t1."IsSystemTag", t1."LastUsedAt", t1."Name", t1."Notes"
    FROM "ContactTags" AS c0
    INNER JOIN "Tags" AS t1 ON c0."TagId" = t1."Id"
) AS t0 ON t."Id" = t0."ContactId"
ORDER BY t."Name", t."Id", t0."Id"
2025-07-02 16:48:36.474 +05:30 [INF] Executed endpoint 'xbytechat.api.CRM.Controllers.TagsController.GetAllTags (xbytechat.api)'
2025-07-02 16:48:36.478 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/tags - 200 null application/json; charset=utf-8 48.3869ms
2025-07-02 16:48:36.478 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Helpers.ResponseResult'.
2025-07-02 16:48:36.484 +05:30 [INF] Executed action xbytechat.api.CRM.Controllers.ContactsController.GetAllContacts (xbytechat.api) in 37.248ms
2025-07-02 16:48:36.486 +05:30 [INF] Executed endpoint 'xbytechat.api.CRM.Controllers.ContactsController.GetAllContacts (xbytechat.api)'
2025-07-02 16:48:36.488 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/contacts?tab=all&search= - 200 null application/json; charset=utf-8 65.7913ms
2025-07-02 16:48:48.866 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/WhatsAppTemplateFetcher/get-template-all - null null
2025-07-02 16:48:48.869 +05:30 [INF] CORS policy execution successful.
2025-07-02 16:48:48.871 +05:30 [INF] Executing endpoint 'xbytechat_api.WhatsAppSettings.Controllers.WhatsAppTemplateFetcherController.GetAllTemplatesAsync (xbytechat.api)'
2025-07-02 16:48:48.877 +05:30 [INF] Route matched with {action = "GetAllTemplates", controller = "WhatsAppTemplateFetcher"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllTemplatesAsync() on controller xbytechat_api.WhatsAppSettings.Controllers.WhatsAppTemplateFetcherController (xbytechat.api).
2025-07-02 16:48:48.955 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiToken", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."IsActive"
2025-07-02 16:48:48.984 +05:30 [INF] Start processing HTTP request GET https://graph.facebook.com/v22.0/999432368375320/message_templates
2025-07-02 16:48:48.988 +05:30 [INF] Sending HTTP request GET https://graph.facebook.com/v22.0/999432368375320/message_templates
2025-07-02 16:48:50.581 +05:30 [INF] Received HTTP response headers after 1588.6322ms - 401
2025-07-02 16:48:50.583 +05:30 [INF] End processing HTTP request after 1600.6353ms - 401
2025-07-02 16:48:50.590 +05:30 [INF] 📦 Meta Template API Raw JSON for "c13be597-6ae2-42bb-9d43-925815f24ff8":
{"error":{"message":"Error validating access token: Session has expired on Monday, 30-Jun-25 11:00:00 PDT. The current time is Wednesday, 02-Jul-25 04:18:54 PDT.","type":"OAuthException","code":190,"error_subcode":463,"fbtrace_id":"A--PtFmcuJCcEtdVpM2BUfk"}}
2025-07-02 16:48:50.593 +05:30 [ERR] ❌ Failed to fetch templates for BusinessId "c13be597-6ae2-42bb-9d43-925815f24ff8": {"error":{"message":"Error validating access token: Session has expired on Monday, 30-Jun-25 11:00:00 PDT. The current time is Wednesday, 02-Jul-25 04:18:54 PDT.","type":"OAuthException","code":190,"error_subcode":463,"fbtrace_id":"A--PtFmcuJCcEtdVpM2BUfk"}}
2025-07-02 16:48:50.595 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType64`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[TemplateForUIResponseDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 16:48:50.600 +05:30 [INF] Executed action xbytechat_api.WhatsAppSettings.Controllers.WhatsAppTemplateFetcherController.GetAllTemplatesAsync (xbytechat.api) in 1720.9415ms
2025-07-02 16:48:50.603 +05:30 [INF] Executed endpoint 'xbytechat_api.WhatsAppSettings.Controllers.WhatsAppTemplateFetcherController.GetAllTemplatesAsync (xbytechat.api)'
2025-07-02 16:48:50.606 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/WhatsAppTemplateFetcher/get-template-all - 200 null application/json; charset=utf-8 1739.8355ms
2025-07-02 16:48:51.407 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/campaign/get-image-campaign - null null
2025-07-02 16:48:51.414 +05:30 [INF] CORS policy execution successful.
2025-07-02 16:48:51.421 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetAll (xbytechat.api)'
2025-07-02 16:48:51.430 +05:30 [INF] Route matched with {action = "GetAll", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAll(System.String) on controller xbytechat.api.Features.CampaignModule.Controllers.CampaignController (xbytechat.api).
2025-07-02 16:48:51.485 +05:30 [INF] Executed DbCommand (11ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Name", c."Status", c."ScheduledAt", c."CreatedAt", c."ImageUrl", c."ImageCaption", c0."Title" AS "CtaTitle", (
    SELECT count(*)::int
    FROM "CampaignRecipients" AS c1
    WHERE c."Id" = c1."CampaignId") AS "RecipientCount"
FROM "Campaigns" AS c
LEFT JOIN "CTADefinitions" AS c0 ON c."CtaId" = c0."Id"
WHERE c."BusinessId" = @__businessId_0
ORDER BY c."CreatedAt" DESC
2025-07-02 16:48:51.491 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.CampaignModule.DTOs.CampaignSummaryDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 16:48:51.496 +05:30 [INF] Executed action xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetAll (xbytechat.api) in 63.1745ms
2025-07-02 16:48:51.498 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetAll (xbytechat.api)'
2025-07-02 16:48:51.500 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/campaign/get-image-campaign - 200 null application/json; charset=utf-8 93.2549ms
2025-07-02 16:48:57.033 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/campaign/assign-contacts - null null
2025-07-02 16:48:57.041 +05:30 [INF] CORS policy execution successful.
2025-07-02 16:48:57.043 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetCampaignById (xbytechat.api)'
2025-07-02 16:48:57.049 +05:30 [INF] Route matched with {action = "GetCampaignById", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[xbytechat.api.Features.CampaignModule.DTOs.CampaignDto]] GetCampaignById(System.Guid) on controller xbytechat.api.Features.CampaignModule.Controllers.CampaignController (xbytechat.api).
2025-07-02 16:48:57.070 +05:30 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-07-02 16:48:57.098 +05:30 [INF] Executed action xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetCampaignById (xbytechat.api) in 45.7784ms
2025-07-02 16:48:57.100 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetCampaignById (xbytechat.api)'
2025-07-02 16:48:57.102 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/campaign/assign-contacts - 400 null application/problem+json; charset=utf-8 69.2226ms
2025-07-02 16:48:59.673 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/Campaign/paginated?page=1&pageSize=10&status= - null null
2025-07-02 16:48:59.677 +05:30 [INF] CORS policy execution successful.
2025-07-02 16:48:59.679 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetPaginatedCampaigns (xbytechat.api)'
2025-07-02 16:48:59.691 +05:30 [INF] Route matched with {action = "GetPaginatedCampaigns", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPaginatedCampaigns(xbytechat.api.Shared.PaginatedRequest) on controller xbytechat.api.Features.CampaignModule.Controllers.CampaignController (xbytechat.api).
2025-07-02 16:48:59.727 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Campaigns" AS c
WHERE c."BusinessId" = @__businessId_0
2025-07-02 16:48:59.738 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__p_2='10', @__p_1='0'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Name", c."Status", c."ScheduledAt", c."CreatedAt"
FROM "Campaigns" AS c
WHERE c."BusinessId" = @__businessId_0
ORDER BY c."CreatedAt" DESC
LIMIT @__p_2 OFFSET @__p_1
2025-07-02 16:48:59.742 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Shared.PaginatedResponse`1[[xbytechat.api.Features.CampaignModule.DTOs.CampaignSummaryDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 16:48:59.747 +05:30 [INF] Executed action xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetPaginatedCampaigns (xbytechat.api) in 53.3998ms
2025-07-02 16:48:59.749 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetPaginatedCampaigns (xbytechat.api)'
2025-07-02 16:48:59.751 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/Campaign/paginated?page=1&pageSize=10&status= - 200 null application/json; charset=utf-8 78.7038ms
2025-07-02 16:49:02.771 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/contacts - null null
2025-07-02 16:49:02.774 +05:30 [INF] CORS policy execution successful.
2025-07-02 16:49:02.776 +05:30 [INF] Executing endpoint 'xbytechat.api.CRM.Controllers.ContactsController.GetAllContacts (xbytechat.api)'
2025-07-02 16:49:02.778 +05:30 [INF] Route matched with {action = "GetAllContacts", controller = "Contacts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllContacts(System.String, Int32, Int32) on controller xbytechat.api.CRM.Controllers.ContactsController (xbytechat.api).
2025-07-02 16:49:02.781 +05:30 [INF] GetPagedContactsAsync: businessId="c13be597-6ae2-42bb-9d43-925815f24ff8", tab=all, page=1, pageSize=25
2025-07-02 16:49:02.785 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Contacts" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."IsActive"
2025-07-02 16:49:02.794 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__p_2='25', @__p_1='0'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."AssignedAgentId", t."BusinessId", t."CreatedAt", t."Email", t."Group", t."IsActive", t."IsArchived", t."IsAutomationPaused", t."IsFavorite", t."LastCTAInteraction", t."LastCTAType", t."LastClickedProductId", t."LastContactedAt", t."LeadSource", t."Name", t."NextFollowUpAt", t."Notes", t."PhoneNumber", t."Tags", t0."Id", t0."AssignedAt", t0."AssignedBy", t0."BusinessId", t0."ContactId", t0."TagId", t0."Id0", t0."BusinessId0", t0."Category", t0."ColorHex", t0."CreatedAt", t0."IsActive", t0."IsSystemTag", t0."LastUsedAt", t0."Name", t0."Notes"
FROM (
    SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."Tags"
    FROM "Contacts" AS c
    WHERE c."BusinessId" = @__businessId_0 AND c."IsActive"
    ORDER BY c."Name"
    LIMIT @__p_2 OFFSET @__p_1
) AS t
LEFT JOIN (
    SELECT c0."Id", c0."AssignedAt", c0."AssignedBy", c0."BusinessId", c0."ContactId", c0."TagId", t1."Id" AS "Id0", t1."BusinessId" AS "BusinessId0", t1."Category", t1."ColorHex", t1."CreatedAt", t1."IsActive", t1."IsSystemTag", t1."LastUsedAt", t1."Name", t1."Notes"
    FROM "ContactTags" AS c0
    INNER JOIN "Tags" AS t1 ON c0."TagId" = t1."Id"
) AS t0 ON t."Id" = t0."ContactId"
ORDER BY t."Name", t."Id", t0."Id"
2025-07-02 16:49:02.801 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Helpers.ResponseResult'.
2025-07-02 16:49:02.803 +05:30 [INF] Executed action xbytechat.api.CRM.Controllers.ContactsController.GetAllContacts (xbytechat.api) in 22.7637ms
2025-07-02 16:49:02.808 +05:30 [INF] Executed endpoint 'xbytechat.api.CRM.Controllers.ContactsController.GetAllContacts (xbytechat.api)'
2025-07-02 16:49:02.811 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/contacts - 200 null application/json; charset=utf-8 39.9245ms
2025-07-02 16:49:11.508 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/ctamanagement/get-all - null null
2025-07-02 16:49:11.515 +05:30 [INF] CORS policy execution successful.
2025-07-02 16:49:11.517 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CTAManagement.Controllers.CTAManagementController.GetAll (xbytechat.api)'
2025-07-02 16:49:11.523 +05:30 [INF] Route matched with {action = "GetAll", controller = "CTAManagement"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAll() on controller xbytechat.api.Features.CTAManagement.Controllers.CTAManagementController (xbytechat.api).
2025-07-02 16:49:11.543 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Title", c."ButtonText", c."ButtonType", c."TargetUrl", c."Description", c."IsActive"
FROM "CTADefinitions" AS c
WHERE c."IsActive" AND c."BusinessId" = @__businessId_0
2025-07-02 16:49:11.550 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.CTAManagement.DTOs.CTADefinitionDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 16:49:11.556 +05:30 [INF] Executed action xbytechat.api.Features.CTAManagement.Controllers.CTAManagementController.GetAll (xbytechat.api) in 30.2307ms
2025-07-02 16:49:11.558 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CTAManagement.Controllers.CTAManagementController.GetAll (xbytechat.api)'
2025-07-02 16:49:11.560 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/ctamanagement/get-all - 200 null application/json; charset=utf-8 52.1187ms
2025-07-02 16:49:36.458 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/tracking/logs - null null
2025-07-02 16:49:36.465 +05:30 [INF] CORS policy execution successful.
2025-07-02 16:49:36.467 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Tracking.Controllers.TrackingViewerController.GetAll (xbytechat.api)'
2025-07-02 16:49:36.473 +05:30 [INF] Route matched with {action = "GetAll", controller = "TrackingViewer"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAll(System.Nullable`1[System.Guid]) on controller xbytechat.api.Features.Tracking.Controllers.TrackingViewerController (xbytechat.api).
2025-07-02 16:49:36.512 +05:30 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."ContactPhone", CASE
    WHEN c."Id" IS NOT NULL THEN c."Name"
    ELSE '(N/A)'
END AS "ContactName", t."ButtonText", t."CTAType", t."SourceType", t."ClickedAt", t."DeviceType", t."Country", CASE
    WHEN c0."Id" IS NOT NULL THEN c0."Name"
    ELSE '(Unknown)'
END AS "CampaignName"
FROM "TrackingLogs" AS t
LEFT JOIN "Contacts" AS c ON t."ContactId" = c."Id"
LEFT JOIN "Campaigns" AS c0 ON t."CampaignId" = c0."Id"
ORDER BY t."ClickedAt" DESC
2025-07-02 16:49:36.521 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType30`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType66`10[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.DateTime, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 16:49:36.529 +05:30 [INF] Executed action xbytechat.api.Features.Tracking.Controllers.TrackingViewerController.GetAll (xbytechat.api) in 53.5734ms
2025-07-02 16:49:36.531 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Tracking.Controllers.TrackingViewerController.GetAll (xbytechat.api)'
2025-07-02 16:49:36.533 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/tracking/logs - 200 null application/json; charset=utf-8 75.5551ms
2025-07-02 16:49:44.015 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/flow-analytics/summary - null null
2025-07-02 16:49:44.023 +05:30 [INF] CORS policy execution successful.
2025-07-02 16:49:44.028 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.FlowAnalytics.Controllers.FlowAnalyticsController.GetSummary (xbytechat.api)'
2025-07-02 16:49:44.034 +05:30 [INF] Route matched with {action = "GetSummary", controller = "FlowAnalytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetSummary() on controller xbytechat.api.Features.FlowAnalytics.Controllers.FlowAnalyticsController (xbytechat.api).
2025-07-02 16:49:44.042 +05:30 [INF] 📊 Generating Flow Analytics Summary for BusinessId: "c13be597-6ae2-42bb-9d43-925815f24ff8"
2025-07-02 16:49:44.059 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."BusinessId", f."ContactPhone", f."ErrorMessage", f."ExecutedAt", f."FlowId", f."RawResponse", f."StepId", f."StepName", f."Success", f."TemplateName", f."TemplateType", f."TrackingLogId", f."TriggeredByButton"
FROM "FlowExecutionLogs" AS f
WHERE f."BusinessId" = @__businessId_0
2025-07-02 16:49:44.066 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Features.FlowAnalytics.DTOs.FlowAnalyticsSummaryDto'.
2025-07-02 16:49:44.070 +05:30 [INF] Executed action xbytechat.api.Features.FlowAnalytics.Controllers.FlowAnalyticsController.GetSummary (xbytechat.api) in 32.998ms
2025-07-02 16:49:44.072 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.FlowAnalytics.Controllers.FlowAnalyticsController.GetSummary (xbytechat.api)'
2025-07-02 16:49:44.073 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/flow-analytics/summary - 200 null application/json; charset=utf-8 58.5606ms
2025-07-02 16:49:44.078 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/flow-analytics/most-triggered-steps - null null
2025-07-02 16:49:44.083 +05:30 [INF] CORS policy execution successful.
2025-07-02 16:49:44.085 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.FlowAnalytics.Controllers.FlowAnalyticsController.GetMostTriggeredSteps (xbytechat.api)'
2025-07-02 16:49:44.090 +05:30 [INF] Route matched with {action = "GetMostTriggeredSteps", controller = "FlowAnalytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMostTriggeredSteps() on controller xbytechat.api.Features.FlowAnalytics.Controllers.FlowAnalyticsController (xbytechat.api).
2025-07-02 16:49:44.134 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__p_1='5'], CommandType='"Text"', CommandTimeout='30']
SELECT f."StepId", f."StepName", count(*)::int AS "TriggerCount", max(f."ExecutedAt") AS "LastTriggeredAt"
FROM "FlowExecutionLogs" AS f
WHERE f."BusinessId" = @__businessId_0
GROUP BY f."StepId", f."StepName"
ORDER BY count(*)::int DESC
LIMIT @__p_1
2025-07-02 16:49:44.138 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.FlowAnalytics.DTOs.MostTriggeredStepDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 16:49:44.141 +05:30 [INF] Executed action xbytechat.api.Features.FlowAnalytics.Controllers.FlowAnalyticsController.GetMostTriggeredSteps (xbytechat.api) in 48.5511ms
2025-07-02 16:49:44.143 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.FlowAnalytics.Controllers.FlowAnalyticsController.GetMostTriggeredSteps (xbytechat.api)'
2025-07-02 16:49:44.144 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/flow-analytics/most-triggered-steps - 200 null application/json; charset=utf-8 66.5697ms
2025-07-02 16:49:44.149 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/flow-analytics/step-journey-breakdown - null null
2025-07-02 16:49:44.152 +05:30 [INF] CORS policy execution successful.
2025-07-02 16:49:44.154 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.FlowAnalytics.Controllers.FlowAnalyticsController.GetStepJourneyBreakdown (xbytechat.api)'
2025-07-02 16:49:44.159 +05:30 [INF] Route matched with {action = "GetStepJourneyBreakdown", controller = "FlowAnalytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetStepJourneyBreakdown(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller xbytechat.api.Features.FlowAnalytics.Controllers.FlowAnalyticsController (xbytechat.api).
2025-07-02 16:49:44.169 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."BusinessId", f."ContactPhone", f."ErrorMessage", f."ExecutedAt", f."FlowId", f."RawResponse", f."StepId", f."StepName", f."Success", f."TemplateName", f."TemplateType", f."TrackingLogId", f."TriggeredByButton"
FROM "FlowExecutionLogs" AS f
WHERE f."BusinessId" = @__businessId_0
2025-07-02 16:49:44.175 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.FlowAnalytics.DTOs.FlowAnalyticsStepJourneyDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 16:49:44.182 +05:30 [INF] Executed action xbytechat.api.Features.FlowAnalytics.Controllers.FlowAnalyticsController.GetStepJourneyBreakdown (xbytechat.api) in 19.8926ms
2025-07-02 16:49:44.184 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.FlowAnalytics.Controllers.FlowAnalyticsController.GetStepJourneyBreakdown (xbytechat.api)'
2025-07-02 16:49:44.186 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/flow-analytics/step-journey-breakdown - 200 null application/json; charset=utf-8 37.5133ms
2025-07-02 16:50:04.021 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/auth/session - null null
2025-07-02 16:50:04.024 +05:30 [INF] Executing endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 16:50:04.026 +05:30 [INF] Route matched with {action = "GetSession", controller = "Auth"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetSession() on controller xbytechat.api.AuthModule.Controllers.AuthController (xbytechat.api).
2025-07-02 16:50:04.034 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`4[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 16:50:04.038 +05:30 [INF] Executed action xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api) in 8.8206ms
2025-07-02 16:50:04.040 +05:30 [INF] Executed endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 16:50:04.041 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/auth/session - 200 null application/json; charset=utf-8 20.3883ms
2025-07-02 16:50:04.150 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/feature-access/me - null null
2025-07-02 16:50:04.158 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 16:50:04.160 +05:30 [INF] Route matched with {action = "GetMyFeatures", controller = "FeatureAccess"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto]]] GetMyFeatures() on controller xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController (xbytechat.api).
2025-07-02 16:50:04.170 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT b."Id", b."Address", b."ApprovedAt", b."ApprovedBy", b."BusinessEmail", b."BusinessName", b."CompanyName", b."CompanyPhone", b."CreatedAt", b."CreatedBy", b."CreatedByPartnerId", b."DeletedAt", b."DeletedBy", b."Industry", b."IsApproved", b."IsDeleted", b."LastLoginAt", b."LogoUrl", b."Notes", b."Phone", b."RepresentativeName", b."Source", b."Status", b."Tags", b."Website", b0."Id", b0."BusinessId", b0."CreatedAt", b0."Plan", b0."QuotaResetDate", b0."RemainingMessages", b0."TotalMonthlyQuota", b0."UpdatedAt", b0."WalletBalance"
FROM "Businesses" AS b
LEFT JOIN "BusinessPlanInfos" AS b0 ON b."Id" = b0."BusinessId"
WHERE b."Id" = @__businessId_0
LIMIT 1
2025-07-02 16:50:04.177 +05:30 [INF] 📦 Resolved plan for Business "c13be597-6ae2-42bb-9d43-925815f24ff8": Smart
2025-07-02 16:50:04.183 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."BusinessId", f."CreatedAt", f."Description", f."FeatureName", f."Group", f."IsEnabled", f."Notes", f."Plan"
FROM "FeatureAccess" AS f
WHERE f."BusinessId" = @__businessId_0
2025-07-02 16:50:04.195 +05:30 [INF] 🔧 Feature override: AddProduct = False
2025-07-02 16:50:04.196 +05:30 [INF] 🔧 Feature override: Campaigns = True
2025-07-02 16:50:04.197 +05:30 [INF] 🔧 Feature override: Catalog = True
2025-07-02 16:50:04.198 +05:30 [INF] 🔧 Feature override: CRM = True
2025-07-02 16:50:04.199 +05:30 [INF] 🔧 Feature override: CRMInsights = True
2025-07-02 16:50:04.200 +05:30 [INF] 🔧 Feature override: CTAFlow = True
2025-07-02 16:50:04.201 +05:30 [INF] 🔧 Feature override: FlowInsights = True
2025-07-02 16:50:04.202 +05:30 [INF] 🔧 Feature override: Messaging = True
2025-07-02 16:50:04.203 +05:30 [INF] 🔧 Feature override: ProfileCompletion = True
2025-07-02 16:50:04.204 +05:30 [INF] 🔧 Feature override: UpgradePlan = True
2025-07-02 16:50:04.205 +05:30 [INF] 🔧 Feature override: WhatsAppSettings = True
2025-07-02 16:50:04.208 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 16:50:04.210 +05:30 [INF] Executed action xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api) in 47.1663ms
2025-07-02 16:50:04.212 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 16:50:04.214 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/feature-access/me - 200 null application/json; charset=utf-8 63.51ms
2025-07-02 16:50:17.151 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/auth/session - null null
2025-07-02 16:50:17.155 +05:30 [INF] Executing endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 16:50:17.157 +05:30 [INF] Route matched with {action = "GetSession", controller = "Auth"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetSession() on controller xbytechat.api.AuthModule.Controllers.AuthController (xbytechat.api).
2025-07-02 16:50:17.160 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`4[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 16:50:17.162 +05:30 [INF] Executed action xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api) in 2.6052ms
2025-07-02 16:50:17.164 +05:30 [INF] Executed endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 16:50:17.165 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/auth/session - 200 null application/json; charset=utf-8 14.3857ms
2025-07-02 16:50:17.194 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/feature-access/me - null null
2025-07-02 16:50:17.201 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 16:50:17.203 +05:30 [INF] Route matched with {action = "GetMyFeatures", controller = "FeatureAccess"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto]]] GetMyFeatures() on controller xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController (xbytechat.api).
2025-07-02 16:50:17.213 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT b."Id", b."Address", b."ApprovedAt", b."ApprovedBy", b."BusinessEmail", b."BusinessName", b."CompanyName", b."CompanyPhone", b."CreatedAt", b."CreatedBy", b."CreatedByPartnerId", b."DeletedAt", b."DeletedBy", b."Industry", b."IsApproved", b."IsDeleted", b."LastLoginAt", b."LogoUrl", b."Notes", b."Phone", b."RepresentativeName", b."Source", b."Status", b."Tags", b."Website", b0."Id", b0."BusinessId", b0."CreatedAt", b0."Plan", b0."QuotaResetDate", b0."RemainingMessages", b0."TotalMonthlyQuota", b0."UpdatedAt", b0."WalletBalance"
FROM "Businesses" AS b
LEFT JOIN "BusinessPlanInfos" AS b0 ON b."Id" = b0."BusinessId"
WHERE b."Id" = @__businessId_0
LIMIT 1
2025-07-02 16:50:17.219 +05:30 [INF] 📦 Resolved plan for Business "c13be597-6ae2-42bb-9d43-925815f24ff8": Smart
2025-07-02 16:50:17.224 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."BusinessId", f."CreatedAt", f."Description", f."FeatureName", f."Group", f."IsEnabled", f."Notes", f."Plan"
FROM "FeatureAccess" AS f
WHERE f."BusinessId" = @__businessId_0
2025-07-02 16:50:17.227 +05:30 [INF] 🔧 Feature override: AddProduct = False
2025-07-02 16:50:17.228 +05:30 [INF] 🔧 Feature override: Campaigns = True
2025-07-02 16:50:17.228 +05:30 [INF] 🔧 Feature override: Catalog = True
2025-07-02 16:50:17.230 +05:30 [INF] 🔧 Feature override: CRM = True
2025-07-02 16:50:17.231 +05:30 [INF] 🔧 Feature override: CRMInsights = True
2025-07-02 16:50:17.233 +05:30 [INF] 🔧 Feature override: CTAFlow = True
2025-07-02 16:50:17.234 +05:30 [INF] 🔧 Feature override: FlowInsights = True
2025-07-02 16:50:17.235 +05:30 [INF] 🔧 Feature override: Messaging = True
2025-07-02 16:50:17.236 +05:30 [INF] 🔧 Feature override: ProfileCompletion = True
2025-07-02 16:50:17.237 +05:30 [INF] 🔧 Feature override: UpgradePlan = True
2025-07-02 16:50:17.238 +05:30 [INF] 🔧 Feature override: WhatsAppSettings = True
2025-07-02 16:50:17.240 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 16:50:17.242 +05:30 [INF] Executed action xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api) in 35.472ms
2025-07-02 16:50:17.244 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 16:50:17.245 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/feature-access/me - 200 null application/json; charset=utf-8 51.9129ms
2025-07-02 16:50:18.808 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/auth/session - null null
2025-07-02 16:50:18.813 +05:30 [INF] Executing endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 16:50:18.815 +05:30 [INF] Route matched with {action = "GetSession", controller = "Auth"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetSession() on controller xbytechat.api.AuthModule.Controllers.AuthController (xbytechat.api).
2025-07-02 16:50:18.818 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`4[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 16:50:18.820 +05:30 [INF] Executed action xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api) in 2.9861ms
2025-07-02 16:50:18.823 +05:30 [INF] Executed endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 16:50:18.824 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/auth/session - 200 null application/json; charset=utf-8 16.5058ms
2025-07-02 16:50:18.851 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/feature-access/me - null null
2025-07-02 16:50:18.856 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 16:50:18.858 +05:30 [INF] Route matched with {action = "GetMyFeatures", controller = "FeatureAccess"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto]]] GetMyFeatures() on controller xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController (xbytechat.api).
2025-07-02 16:50:18.866 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT b."Id", b."Address", b."ApprovedAt", b."ApprovedBy", b."BusinessEmail", b."BusinessName", b."CompanyName", b."CompanyPhone", b."CreatedAt", b."CreatedBy", b."CreatedByPartnerId", b."DeletedAt", b."DeletedBy", b."Industry", b."IsApproved", b."IsDeleted", b."LastLoginAt", b."LogoUrl", b."Notes", b."Phone", b."RepresentativeName", b."Source", b."Status", b."Tags", b."Website", b0."Id", b0."BusinessId", b0."CreatedAt", b0."Plan", b0."QuotaResetDate", b0."RemainingMessages", b0."TotalMonthlyQuota", b0."UpdatedAt", b0."WalletBalance"
FROM "Businesses" AS b
LEFT JOIN "BusinessPlanInfos" AS b0 ON b."Id" = b0."BusinessId"
WHERE b."Id" = @__businessId_0
LIMIT 1
2025-07-02 16:50:18.872 +05:30 [INF] 📦 Resolved plan for Business "c13be597-6ae2-42bb-9d43-925815f24ff8": Smart
2025-07-02 16:50:18.876 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."BusinessId", f."CreatedAt", f."Description", f."FeatureName", f."Group", f."IsEnabled", f."Notes", f."Plan"
FROM "FeatureAccess" AS f
WHERE f."BusinessId" = @__businessId_0
2025-07-02 16:50:18.880 +05:30 [INF] 🔧 Feature override: AddProduct = False
2025-07-02 16:50:18.882 +05:30 [INF] 🔧 Feature override: Campaigns = True
2025-07-02 16:50:18.883 +05:30 [INF] 🔧 Feature override: Catalog = True
2025-07-02 16:50:18.884 +05:30 [INF] 🔧 Feature override: CRM = True
2025-07-02 16:50:18.885 +05:30 [INF] 🔧 Feature override: CRMInsights = True
2025-07-02 16:50:18.886 +05:30 [INF] 🔧 Feature override: CTAFlow = True
2025-07-02 16:50:18.887 +05:30 [INF] 🔧 Feature override: FlowInsights = True
2025-07-02 16:50:18.888 +05:30 [INF] 🔧 Feature override: Messaging = True
2025-07-02 16:50:18.889 +05:30 [INF] 🔧 Feature override: ProfileCompletion = True
2025-07-02 16:50:18.891 +05:30 [INF] 🔧 Feature override: UpgradePlan = True
2025-07-02 16:50:18.892 +05:30 [INF] 🔧 Feature override: WhatsAppSettings = True
2025-07-02 16:50:18.893 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 16:50:18.895 +05:30 [INF] Executed action xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api) in 34.8648ms
2025-07-02 16:50:18.897 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 16:50:18.899 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/feature-access/me - 200 null application/json; charset=utf-8 48.6338ms
2025-07-02 16:50:39.793 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/cta-flow/all-draft - null null
2025-07-02 16:50:39.808 +05:30 [INF] CORS policy execution successful.
2025-07-02 16:50:39.810 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController.GetAllDraftFlows (xbytechat.api)'
2025-07-02 16:50:39.816 +05:30 [INF] Route matched with {action = "GetAllDraftFlows", controller = "CTAFlow"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllDraftFlows() on controller xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController (xbytechat.api).
2025-07-02 16:50:39.992 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."FlowName", c."CreatedAt", c."IsPublished"
FROM "CTAFlowConfigs" AS c
WHERE c."BusinessId" = @__businessId_0 AND NOT (c."IsPublished") AND c."IsActive"
ORDER BY c."CreatedAt" DESC
2025-07-02 16:50:39.997 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.CTAFlowBuilder.DTOs.VisualFlowSummaryDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 16:50:40.000 +05:30 [INF] Executed action xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController.GetAllDraftFlows (xbytechat.api) in 181.1525ms
2025-07-02 16:50:40.003 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController.GetAllDraftFlows (xbytechat.api)'
2025-07-02 16:50:40.005 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/cta-flow/all-draft - 200 null application/json; charset=utf-8 211.9944ms
2025-07-02 16:50:41.087 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/cta-flow/all-published - null null
2025-07-02 16:50:41.094 +05:30 [INF] CORS policy execution successful.
2025-07-02 16:50:41.096 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController.GetPublishedFlows (xbytechat.api)'
2025-07-02 16:50:41.102 +05:30 [INF] Route matched with {action = "GetPublishedFlows", controller = "CTAFlow"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPublishedFlows() on controller xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController (xbytechat.api).
2025-07-02 16:50:41.113 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."FlowName", c."IsPublished", c."CreatedAt"
FROM "CTAFlowConfigs" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."IsPublished"
ORDER BY c."CreatedAt" DESC
2025-07-02 16:50:41.119 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.CTAFlowBuilder.DTOs.VisualFlowSummaryDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 16:50:41.122 +05:30 [INF] Executed action xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController.GetPublishedFlows (xbytechat.api) in 17.2884ms
2025-07-02 16:50:41.124 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController.GetPublishedFlows (xbytechat.api)'
2025-07-02 16:50:41.126 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/cta-flow/all-published - 200 null application/json; charset=utf-8 38.5451ms
2025-07-02 16:51:18.594 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/cta-flow/all-draft - null null
2025-07-02 16:51:18.601 +05:30 [INF] CORS policy execution successful.
2025-07-02 16:51:18.603 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController.GetAllDraftFlows (xbytechat.api)'
2025-07-02 16:51:18.604 +05:30 [INF] Route matched with {action = "GetAllDraftFlows", controller = "CTAFlow"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllDraftFlows() on controller xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController (xbytechat.api).
2025-07-02 16:51:18.614 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."FlowName", c."CreatedAt", c."IsPublished"
FROM "CTAFlowConfigs" AS c
WHERE c."BusinessId" = @__businessId_0 AND NOT (c."IsPublished") AND c."IsActive"
ORDER BY c."CreatedAt" DESC
2025-07-02 16:51:18.620 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.CTAFlowBuilder.DTOs.VisualFlowSummaryDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 16:51:18.622 +05:30 [INF] Executed action xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController.GetAllDraftFlows (xbytechat.api) in 15.2435ms
2025-07-02 16:51:18.624 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController.GetAllDraftFlows (xbytechat.api)'
2025-07-02 16:51:18.625 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/cta-flow/all-draft - 200 null application/json; charset=utf-8 31.4414ms
2025-07-02 16:51:23.982 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/cta-flow/drafts - null null
2025-07-02 16:51:23.989 +05:30 [INF] CORS policy execution successful.
2025-07-02 16:51:23.992 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/cta-flow/drafts - 404 0 null 9.9905ms
2025-07-02 16:51:24.004 +05:30 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:7113/api/cta-flow/drafts, Response status code: 404
2025-07-02 16:52:19.537 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/cta-flow/all-draft - null null
2025-07-02 16:52:19.541 +05:30 [INF] CORS policy execution successful.
2025-07-02 16:52:19.543 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController.GetAllDraftFlows (xbytechat.api)'
2025-07-02 16:52:19.545 +05:30 [INF] Route matched with {action = "GetAllDraftFlows", controller = "CTAFlow"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllDraftFlows() on controller xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController (xbytechat.api).
2025-07-02 16:52:19.554 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."FlowName", c."CreatedAt", c."IsPublished"
FROM "CTAFlowConfigs" AS c
WHERE c."BusinessId" = @__businessId_0 AND NOT (c."IsPublished") AND c."IsActive"
ORDER BY c."CreatedAt" DESC
2025-07-02 16:52:19.559 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.CTAFlowBuilder.DTOs.VisualFlowSummaryDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 16:52:19.561 +05:30 [INF] Executed action xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController.GetAllDraftFlows (xbytechat.api) in 14.5446ms
2025-07-02 16:52:19.564 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController.GetAllDraftFlows (xbytechat.api)'
2025-07-02 16:52:19.566 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/cta-flow/all-draft - 200 null application/json; charset=utf-8 29.5448ms
2025-07-02 16:54:43.591 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/cta-flow/all-draft - null null
2025-07-02 16:54:43.595 +05:30 [INF] CORS policy execution successful.
2025-07-02 16:54:43.606 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController.GetAllDraftFlows (xbytechat.api)'
2025-07-02 16:54:43.607 +05:30 [INF] Route matched with {action = "GetAllDraftFlows", controller = "CTAFlow"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllDraftFlows() on controller xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController (xbytechat.api).
2025-07-02 16:54:43.739 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."FlowName", c."CreatedAt", c."IsPublished"
FROM "CTAFlowConfigs" AS c
WHERE c."BusinessId" = @__businessId_0 AND NOT (c."IsPublished") AND c."IsActive"
ORDER BY c."CreatedAt" DESC
2025-07-02 16:54:43.742 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.CTAFlowBuilder.DTOs.VisualFlowSummaryDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 16:54:43.743 +05:30 [INF] Executed action xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController.GetAllDraftFlows (xbytechat.api) in 133.5038ms
2025-07-02 16:54:43.745 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController.GetAllDraftFlows (xbytechat.api)'
2025-07-02 16:54:43.746 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/cta-flow/all-draft - 200 null application/json; charset=utf-8 155.3358ms
2025-07-02 16:54:45.159 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/cta-flow/all-published - null null
2025-07-02 16:54:45.164 +05:30 [INF] CORS policy execution successful.
2025-07-02 16:54:45.166 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController.GetPublishedFlows (xbytechat.api)'
2025-07-02 16:54:45.169 +05:30 [INF] Route matched with {action = "GetPublishedFlows", controller = "CTAFlow"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPublishedFlows() on controller xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController (xbytechat.api).
2025-07-02 16:54:45.176 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."FlowName", c."IsPublished", c."CreatedAt"
FROM "CTAFlowConfigs" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."IsPublished"
ORDER BY c."CreatedAt" DESC
2025-07-02 16:54:45.180 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.CTAFlowBuilder.DTOs.VisualFlowSummaryDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 16:54:45.182 +05:30 [INF] Executed action xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController.GetPublishedFlows (xbytechat.api) in 10.2104ms
2025-07-02 16:54:45.185 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController.GetPublishedFlows (xbytechat.api)'
2025-07-02 16:54:45.187 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/cta-flow/all-published - 200 null application/json; charset=utf-8 28.1274ms
2025-07-02 16:55:02.947 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/cta-flow/all-draft - null null
2025-07-02 16:55:02.951 +05:30 [INF] CORS policy execution successful.
2025-07-02 16:55:02.954 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController.GetAllDraftFlows (xbytechat.api)'
2025-07-02 16:55:02.956 +05:30 [INF] Route matched with {action = "GetAllDraftFlows", controller = "CTAFlow"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllDraftFlows() on controller xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController (xbytechat.api).
2025-07-02 16:55:02.961 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."FlowName", c."CreatedAt", c."IsPublished"
FROM "CTAFlowConfigs" AS c
WHERE c."BusinessId" = @__businessId_0 AND NOT (c."IsPublished") AND c."IsActive"
ORDER BY c."CreatedAt" DESC
2025-07-02 16:55:02.966 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.CTAFlowBuilder.DTOs.VisualFlowSummaryDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 16:55:02.969 +05:30 [INF] Executed action xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController.GetAllDraftFlows (xbytechat.api) in 9.7919ms
2025-07-02 16:55:02.972 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController.GetAllDraftFlows (xbytechat.api)'
2025-07-02 16:55:02.974 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/cta-flow/all-draft - 200 null application/json; charset=utf-8 27.4351ms
2025-07-02 16:55:11.539 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/auth/session - null null
2025-07-02 16:55:11.544 +05:30 [INF] Executing endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 16:55:11.545 +05:30 [INF] Route matched with {action = "GetSession", controller = "Auth"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetSession() on controller xbytechat.api.AuthModule.Controllers.AuthController (xbytechat.api).
2025-07-02 16:55:11.550 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`4[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 16:55:11.552 +05:30 [INF] Executed action xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api) in 3.501ms
2025-07-02 16:55:11.554 +05:30 [INF] Executed endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 16:55:11.555 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/auth/session - 200 null application/json; charset=utf-8 16.4742ms
2025-07-02 16:55:11.636 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/feature-access/me - null null
2025-07-02 16:55:11.642 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 16:55:11.644 +05:30 [INF] Route matched with {action = "GetMyFeatures", controller = "FeatureAccess"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto]]] GetMyFeatures() on controller xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController (xbytechat.api).
2025-07-02 16:55:11.655 +05:30 [INF] Executed DbCommand (5ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT b."Id", b."Address", b."ApprovedAt", b."ApprovedBy", b."BusinessEmail", b."BusinessName", b."CompanyName", b."CompanyPhone", b."CreatedAt", b."CreatedBy", b."CreatedByPartnerId", b."DeletedAt", b."DeletedBy", b."Industry", b."IsApproved", b."IsDeleted", b."LastLoginAt", b."LogoUrl", b."Notes", b."Phone", b."RepresentativeName", b."Source", b."Status", b."Tags", b."Website", b0."Id", b0."BusinessId", b0."CreatedAt", b0."Plan", b0."QuotaResetDate", b0."RemainingMessages", b0."TotalMonthlyQuota", b0."UpdatedAt", b0."WalletBalance"
FROM "Businesses" AS b
LEFT JOIN "BusinessPlanInfos" AS b0 ON b."Id" = b0."BusinessId"
WHERE b."Id" = @__businessId_0
LIMIT 1
2025-07-02 16:55:11.664 +05:30 [INF] 📦 Resolved plan for Business "c13be597-6ae2-42bb-9d43-925815f24ff8": Smart
2025-07-02 16:55:11.669 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."BusinessId", f."CreatedAt", f."Description", f."FeatureName", f."Group", f."IsEnabled", f."Notes", f."Plan"
FROM "FeatureAccess" AS f
WHERE f."BusinessId" = @__businessId_0
2025-07-02 16:55:11.672 +05:30 [INF] 🔧 Feature override: AddProduct = False
2025-07-02 16:55:11.673 +05:30 [INF] 🔧 Feature override: Campaigns = True
2025-07-02 16:55:11.674 +05:30 [INF] 🔧 Feature override: Catalog = True
2025-07-02 16:55:11.675 +05:30 [INF] 🔧 Feature override: CRM = True
2025-07-02 16:55:11.676 +05:30 [INF] 🔧 Feature override: CRMInsights = True
2025-07-02 16:55:11.677 +05:30 [INF] 🔧 Feature override: CTAFlow = True
2025-07-02 16:55:11.679 +05:30 [INF] 🔧 Feature override: FlowInsights = True
2025-07-02 16:55:11.681 +05:30 [INF] 🔧 Feature override: Messaging = True
2025-07-02 16:55:11.682 +05:30 [INF] 🔧 Feature override: ProfileCompletion = True
2025-07-02 16:55:11.684 +05:30 [INF] 🔧 Feature override: UpgradePlan = True
2025-07-02 16:55:11.685 +05:30 [INF] 🔧 Feature override: WhatsAppSettings = True
2025-07-02 16:55:11.687 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 16:55:11.690 +05:30 [INF] Executed action xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api) in 42.503ms
2025-07-02 16:55:11.692 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 16:55:11.693 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/feature-access/me - 200 null application/json; charset=utf-8 56.7741ms
2025-07-02 16:55:18.477 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/cta-flow/all-draft - null null
2025-07-02 16:55:18.484 +05:30 [INF] CORS policy execution successful.
2025-07-02 16:55:18.487 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController.GetAllDraftFlows (xbytechat.api)'
2025-07-02 16:55:18.489 +05:30 [INF] Route matched with {action = "GetAllDraftFlows", controller = "CTAFlow"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllDraftFlows() on controller xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController (xbytechat.api).
2025-07-02 16:55:18.499 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."FlowName", c."CreatedAt", c."IsPublished"
FROM "CTAFlowConfigs" AS c
WHERE c."BusinessId" = @__businessId_0 AND NOT (c."IsPublished") AND c."IsActive"
ORDER BY c."CreatedAt" DESC
2025-07-02 16:55:18.507 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.CTAFlowBuilder.DTOs.VisualFlowSummaryDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 16:55:18.509 +05:30 [INF] Executed action xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController.GetAllDraftFlows (xbytechat.api) in 15.5153ms
2025-07-02 16:55:18.511 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController.GetAllDraftFlows (xbytechat.api)'
2025-07-02 16:55:18.513 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/cta-flow/all-draft - 200 null application/json; charset=utf-8 35.7973ms
2025-07-02 16:55:27.779 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/cta-flow/all-draft - null null
2025-07-02 16:55:27.788 +05:30 [INF] CORS policy execution successful.
2025-07-02 16:55:27.791 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController.GetAllDraftFlows (xbytechat.api)'
2025-07-02 16:55:27.796 +05:30 [INF] Route matched with {action = "GetAllDraftFlows", controller = "CTAFlow"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllDraftFlows() on controller xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController (xbytechat.api).
2025-07-02 16:55:27.805 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."FlowName", c."CreatedAt", c."IsPublished"
FROM "CTAFlowConfigs" AS c
WHERE c."BusinessId" = @__businessId_0 AND NOT (c."IsPublished") AND c."IsActive"
ORDER BY c."CreatedAt" DESC
2025-07-02 16:55:27.810 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.CTAFlowBuilder.DTOs.VisualFlowSummaryDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 16:55:27.812 +05:30 [INF] Executed action xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController.GetAllDraftFlows (xbytechat.api) in 13.7444ms
2025-07-02 16:55:27.814 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController.GetAllDraftFlows (xbytechat.api)'
2025-07-02 16:55:27.816 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/cta-flow/all-draft - 200 null application/json; charset=utf-8 37.0216ms
2025-07-02 16:57:04.889 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/cta-flow/all-draft - null null
2025-07-02 16:57:04.897 +05:30 [INF] CORS policy execution successful.
2025-07-02 16:57:04.898 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController.GetAllDraftFlows (xbytechat.api)'
2025-07-02 16:57:04.900 +05:30 [INF] Route matched with {action = "GetAllDraftFlows", controller = "CTAFlow"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllDraftFlows() on controller xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController (xbytechat.api).
2025-07-02 16:57:04.911 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."FlowName", c."CreatedAt", c."IsPublished"
FROM "CTAFlowConfigs" AS c
WHERE c."BusinessId" = @__businessId_0 AND NOT (c."IsPublished") AND c."IsActive"
ORDER BY c."CreatedAt" DESC
2025-07-02 16:57:04.927 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.CTAFlowBuilder.DTOs.VisualFlowSummaryDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 16:57:04.932 +05:30 [INF] Executed action xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController.GetAllDraftFlows (xbytechat.api) in 26.0211ms
2025-07-02 16:57:04.934 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController.GetAllDraftFlows (xbytechat.api)'
2025-07-02 16:57:04.936 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/cta-flow/all-draft - 200 null application/json; charset=utf-8 46.8039ms
2025-07-02 16:57:25.833 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/auth/session - null null
2025-07-02 16:57:25.837 +05:30 [INF] Executing endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 16:57:25.838 +05:30 [INF] Route matched with {action = "GetSession", controller = "Auth"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetSession() on controller xbytechat.api.AuthModule.Controllers.AuthController (xbytechat.api).
2025-07-02 16:57:25.841 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`4[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 16:57:25.843 +05:30 [INF] Executed action xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api) in 2.7846ms
2025-07-02 16:57:25.845 +05:30 [INF] Executed endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 16:57:25.846 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/auth/session - 200 null application/json; charset=utf-8 13.4979ms
2025-07-02 16:57:25.922 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/feature-access/me - null null
2025-07-02 16:57:25.928 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 16:57:25.930 +05:30 [INF] Route matched with {action = "GetMyFeatures", controller = "FeatureAccess"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto]]] GetMyFeatures() on controller xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController (xbytechat.api).
2025-07-02 16:57:25.936 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT b."Id", b."Address", b."ApprovedAt", b."ApprovedBy", b."BusinessEmail", b."BusinessName", b."CompanyName", b."CompanyPhone", b."CreatedAt", b."CreatedBy", b."CreatedByPartnerId", b."DeletedAt", b."DeletedBy", b."Industry", b."IsApproved", b."IsDeleted", b."LastLoginAt", b."LogoUrl", b."Notes", b."Phone", b."RepresentativeName", b."Source", b."Status", b."Tags", b."Website", b0."Id", b0."BusinessId", b0."CreatedAt", b0."Plan", b0."QuotaResetDate", b0."RemainingMessages", b0."TotalMonthlyQuota", b0."UpdatedAt", b0."WalletBalance"
FROM "Businesses" AS b
LEFT JOIN "BusinessPlanInfos" AS b0 ON b."Id" = b0."BusinessId"
WHERE b."Id" = @__businessId_0
LIMIT 1
2025-07-02 16:57:25.947 +05:30 [INF] 📦 Resolved plan for Business "c13be597-6ae2-42bb-9d43-925815f24ff8": Smart
2025-07-02 16:57:25.951 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."BusinessId", f."CreatedAt", f."Description", f."FeatureName", f."Group", f."IsEnabled", f."Notes", f."Plan"
FROM "FeatureAccess" AS f
WHERE f."BusinessId" = @__businessId_0
2025-07-02 16:57:25.953 +05:30 [INF] 🔧 Feature override: AddProduct = False
2025-07-02 16:57:25.955 +05:30 [INF] 🔧 Feature override: Campaigns = True
2025-07-02 16:57:25.957 +05:30 [INF] 🔧 Feature override: Catalog = True
2025-07-02 16:57:25.958 +05:30 [INF] 🔧 Feature override: CRM = True
2025-07-02 16:57:25.959 +05:30 [INF] 🔧 Feature override: CRMInsights = True
2025-07-02 16:57:25.960 +05:30 [INF] 🔧 Feature override: CTAFlow = True
2025-07-02 16:57:25.961 +05:30 [INF] 🔧 Feature override: FlowInsights = True
2025-07-02 16:57:25.962 +05:30 [INF] 🔧 Feature override: Messaging = True
2025-07-02 16:57:25.964 +05:30 [INF] 🔧 Feature override: ProfileCompletion = True
2025-07-02 16:57:25.965 +05:30 [INF] 🔧 Feature override: UpgradePlan = True
2025-07-02 16:57:25.966 +05:30 [INF] 🔧 Feature override: WhatsAppSettings = True
2025-07-02 16:57:25.968 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 16:57:25.970 +05:30 [INF] Executed action xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api) in 37.2338ms
2025-07-02 16:57:25.971 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 16:57:25.973 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/feature-access/me - 200 null application/json; charset=utf-8 50.4115ms
2025-07-02 16:57:26.016 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/cta-flow/all-draft - null null
2025-07-02 16:57:26.021 +05:30 [INF] CORS policy execution successful.
2025-07-02 16:57:26.025 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController.GetAllDraftFlows (xbytechat.api)'
2025-07-02 16:57:26.027 +05:30 [INF] Route matched with {action = "GetAllDraftFlows", controller = "CTAFlow"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllDraftFlows() on controller xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController (xbytechat.api).
2025-07-02 16:57:26.033 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."FlowName", c."CreatedAt", c."IsPublished"
FROM "CTAFlowConfigs" AS c
WHERE c."BusinessId" = @__businessId_0 AND NOT (c."IsPublished") AND c."IsActive"
ORDER BY c."CreatedAt" DESC
2025-07-02 16:57:26.037 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.CTAFlowBuilder.DTOs.VisualFlowSummaryDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 16:57:26.040 +05:30 [INF] Executed action xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController.GetAllDraftFlows (xbytechat.api) in 9.3758ms
2025-07-02 16:57:26.049 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController.GetAllDraftFlows (xbytechat.api)'
2025-07-02 16:57:26.051 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/cta-flow/all-draft - 200 null application/json; charset=utf-8 34.9525ms
2025-07-02 16:57:31.713 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/cta-flow/all-draft - null null
2025-07-02 16:57:31.721 +05:30 [INF] CORS policy execution successful.
2025-07-02 16:57:31.723 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController.GetAllDraftFlows (xbytechat.api)'
2025-07-02 16:57:31.725 +05:30 [INF] Route matched with {action = "GetAllDraftFlows", controller = "CTAFlow"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllDraftFlows() on controller xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController (xbytechat.api).
2025-07-02 16:57:31.735 +05:30 [INF] Executed DbCommand (6ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."FlowName", c."CreatedAt", c."IsPublished"
FROM "CTAFlowConfigs" AS c
WHERE c."BusinessId" = @__businessId_0 AND NOT (c."IsPublished") AND c."IsActive"
ORDER BY c."CreatedAt" DESC
2025-07-02 16:57:31.754 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.CTAFlowBuilder.DTOs.VisualFlowSummaryDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 16:57:31.757 +05:30 [INF] Executed action xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController.GetAllDraftFlows (xbytechat.api) in 29.3962ms
2025-07-02 16:57:31.759 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController.GetAllDraftFlows (xbytechat.api)'
2025-07-02 16:57:31.761 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/cta-flow/all-draft - 200 null application/json; charset=utf-8 48.0759ms
2025-07-02 16:57:34.166 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/cta-flow/all-draft - null null
2025-07-02 16:57:34.173 +05:30 [INF] CORS policy execution successful.
2025-07-02 16:57:34.175 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController.GetAllDraftFlows (xbytechat.api)'
2025-07-02 16:57:34.178 +05:30 [INF] Route matched with {action = "GetAllDraftFlows", controller = "CTAFlow"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllDraftFlows() on controller xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController (xbytechat.api).
2025-07-02 16:57:34.186 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."FlowName", c."CreatedAt", c."IsPublished"
FROM "CTAFlowConfigs" AS c
WHERE c."BusinessId" = @__businessId_0 AND NOT (c."IsPublished") AND c."IsActive"
ORDER BY c."CreatedAt" DESC
2025-07-02 16:57:34.191 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.CTAFlowBuilder.DTOs.VisualFlowSummaryDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 16:57:34.194 +05:30 [INF] Executed action xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController.GetAllDraftFlows (xbytechat.api) in 12.1403ms
2025-07-02 16:57:34.196 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController.GetAllDraftFlows (xbytechat.api)'
2025-07-02 16:57:34.197 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/cta-flow/all-draft - 200 null application/json; charset=utf-8 31.2903ms
2025-07-02 16:57:38.399 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/cta-flow/all-draft - null null
2025-07-02 16:57:38.405 +05:30 [INF] CORS policy execution successful.
2025-07-02 16:57:38.407 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController.GetAllDraftFlows (xbytechat.api)'
2025-07-02 16:57:38.418 +05:30 [INF] Route matched with {action = "GetAllDraftFlows", controller = "CTAFlow"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllDraftFlows() on controller xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController (xbytechat.api).
2025-07-02 16:57:38.435 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."FlowName", c."CreatedAt", c."IsPublished"
FROM "CTAFlowConfigs" AS c
WHERE c."BusinessId" = @__businessId_0 AND NOT (c."IsPublished") AND c."IsActive"
ORDER BY c."CreatedAt" DESC
2025-07-02 16:57:38.461 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.CTAFlowBuilder.DTOs.VisualFlowSummaryDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 16:57:38.465 +05:30 [INF] Executed action xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController.GetAllDraftFlows (xbytechat.api) in 39.9866ms
2025-07-02 16:57:38.470 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController.GetAllDraftFlows (xbytechat.api)'
2025-07-02 16:57:38.473 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/cta-flow/all-draft - 200 null application/json; charset=utf-8 74.2598ms
2025-07-02 16:57:40.256 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/cta-flow/all-draft - null null
2025-07-02 16:57:40.263 +05:30 [INF] CORS policy execution successful.
2025-07-02 16:57:40.265 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController.GetAllDraftFlows (xbytechat.api)'
2025-07-02 16:57:40.267 +05:30 [INF] Route matched with {action = "GetAllDraftFlows", controller = "CTAFlow"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllDraftFlows() on controller xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController (xbytechat.api).
2025-07-02 16:57:40.274 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."FlowName", c."CreatedAt", c."IsPublished"
FROM "CTAFlowConfigs" AS c
WHERE c."BusinessId" = @__businessId_0 AND NOT (c."IsPublished") AND c."IsActive"
ORDER BY c."CreatedAt" DESC
2025-07-02 16:57:40.279 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.CTAFlowBuilder.DTOs.VisualFlowSummaryDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 16:57:40.281 +05:30 [INF] Executed action xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController.GetAllDraftFlows (xbytechat.api) in 10.9801ms
2025-07-02 16:57:40.284 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController.GetAllDraftFlows (xbytechat.api)'
2025-07-02 16:57:40.286 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/cta-flow/all-draft - 200 null application/json; charset=utf-8 29.7428ms
2025-07-02 16:57:44.487 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/auth/session - null null
2025-07-02 16:57:44.492 +05:30 [INF] Executing endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 16:57:44.494 +05:30 [INF] Route matched with {action = "GetSession", controller = "Auth"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetSession() on controller xbytechat.api.AuthModule.Controllers.AuthController (xbytechat.api).
2025-07-02 16:57:44.497 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`4[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 16:57:44.499 +05:30 [INF] Executed action xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api) in 2.8729ms
2025-07-02 16:57:44.501 +05:30 [INF] Executed endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 16:57:44.502 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/auth/session - 200 null application/json; charset=utf-8 14.9119ms
2025-07-02 16:57:44.543 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/feature-access/me - null null
2025-07-02 16:57:44.547 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 16:57:44.549 +05:30 [INF] Route matched with {action = "GetMyFeatures", controller = "FeatureAccess"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto]]] GetMyFeatures() on controller xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController (xbytechat.api).
2025-07-02 16:57:44.564 +05:30 [INF] Executed DbCommand (10ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT b."Id", b."Address", b."ApprovedAt", b."ApprovedBy", b."BusinessEmail", b."BusinessName", b."CompanyName", b."CompanyPhone", b."CreatedAt", b."CreatedBy", b."CreatedByPartnerId", b."DeletedAt", b."DeletedBy", b."Industry", b."IsApproved", b."IsDeleted", b."LastLoginAt", b."LogoUrl", b."Notes", b."Phone", b."RepresentativeName", b."Source", b."Status", b."Tags", b."Website", b0."Id", b0."BusinessId", b0."CreatedAt", b0."Plan", b0."QuotaResetDate", b0."RemainingMessages", b0."TotalMonthlyQuota", b0."UpdatedAt", b0."WalletBalance"
FROM "Businesses" AS b
LEFT JOIN "BusinessPlanInfos" AS b0 ON b."Id" = b0."BusinessId"
WHERE b."Id" = @__businessId_0
LIMIT 1
2025-07-02 16:57:44.571 +05:30 [INF] 📦 Resolved plan for Business "c13be597-6ae2-42bb-9d43-925815f24ff8": Smart
2025-07-02 16:57:44.576 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."BusinessId", f."CreatedAt", f."Description", f."FeatureName", f."Group", f."IsEnabled", f."Notes", f."Plan"
FROM "FeatureAccess" AS f
WHERE f."BusinessId" = @__businessId_0
2025-07-02 16:57:44.580 +05:30 [INF] 🔧 Feature override: AddProduct = False
2025-07-02 16:57:44.581 +05:30 [INF] 🔧 Feature override: Campaigns = True
2025-07-02 16:57:44.582 +05:30 [INF] 🔧 Feature override: Catalog = True
2025-07-02 16:57:44.583 +05:30 [INF] 🔧 Feature override: CRM = True
2025-07-02 16:57:44.585 +05:30 [INF] 🔧 Feature override: CRMInsights = True
2025-07-02 16:57:44.586 +05:30 [INF] 🔧 Feature override: CTAFlow = True
2025-07-02 16:57:44.587 +05:30 [INF] 🔧 Feature override: FlowInsights = True
2025-07-02 16:57:44.589 +05:30 [INF] 🔧 Feature override: Messaging = True
2025-07-02 16:57:44.590 +05:30 [INF] 🔧 Feature override: ProfileCompletion = True
2025-07-02 16:57:44.591 +05:30 [INF] 🔧 Feature override: UpgradePlan = True
2025-07-02 16:57:44.593 +05:30 [INF] 🔧 Feature override: WhatsAppSettings = True
2025-07-02 16:57:44.595 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 16:57:44.598 +05:30 [INF] Executed action xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api) in 45.524ms
2025-07-02 16:57:44.600 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 16:57:44.601 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/feature-access/me - 200 null application/json; charset=utf-8 58.5573ms
2025-07-02 16:57:49.005 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/cta-flow/all-draft - null null
2025-07-02 16:57:49.017 +05:30 [INF] CORS policy execution successful.
2025-07-02 16:57:49.019 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController.GetAllDraftFlows (xbytechat.api)'
2025-07-02 16:57:49.025 +05:30 [INF] Route matched with {action = "GetAllDraftFlows", controller = "CTAFlow"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllDraftFlows() on controller xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController (xbytechat.api).
2025-07-02 16:57:49.033 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."FlowName", c."CreatedAt", c."IsPublished"
FROM "CTAFlowConfigs" AS c
WHERE c."BusinessId" = @__businessId_0 AND NOT (c."IsPublished") AND c."IsActive"
ORDER BY c."CreatedAt" DESC
2025-07-02 16:57:49.040 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.CTAFlowBuilder.DTOs.VisualFlowSummaryDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 16:57:49.042 +05:30 [INF] Executed action xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController.GetAllDraftFlows (xbytechat.api) in 14.1233ms
2025-07-02 16:57:49.046 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController.GetAllDraftFlows (xbytechat.api)'
2025-07-02 16:57:49.047 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/cta-flow/all-draft - 200 null application/json; charset=utf-8 41.6635ms
2025-07-02 16:57:52.107 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/cta-flow/all-published - null null
2025-07-02 16:57:52.111 +05:30 [INF] CORS policy execution successful.
2025-07-02 16:57:52.112 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController.GetPublishedFlows (xbytechat.api)'
2025-07-02 16:57:52.114 +05:30 [INF] Route matched with {action = "GetPublishedFlows", controller = "CTAFlow"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPublishedFlows() on controller xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController (xbytechat.api).
2025-07-02 16:57:52.122 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."FlowName", c."IsPublished", c."CreatedAt"
FROM "CTAFlowConfigs" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."IsPublished"
ORDER BY c."CreatedAt" DESC
2025-07-02 16:57:52.126 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.CTAFlowBuilder.DTOs.VisualFlowSummaryDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 16:57:52.128 +05:30 [INF] Executed action xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController.GetPublishedFlows (xbytechat.api) in 11.8324ms
2025-07-02 16:57:52.130 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController.GetPublishedFlows (xbytechat.api)'
2025-07-02 16:57:52.132 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/cta-flow/all-published - 200 null application/json; charset=utf-8 24.5996ms
2025-07-02 16:57:52.841 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/cta-flow/all-draft - null null
2025-07-02 16:57:52.846 +05:30 [INF] CORS policy execution successful.
2025-07-02 16:57:52.848 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController.GetAllDraftFlows (xbytechat.api)'
2025-07-02 16:57:52.849 +05:30 [INF] Route matched with {action = "GetAllDraftFlows", controller = "CTAFlow"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllDraftFlows() on controller xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController (xbytechat.api).
2025-07-02 16:57:52.860 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."FlowName", c."CreatedAt", c."IsPublished"
FROM "CTAFlowConfigs" AS c
WHERE c."BusinessId" = @__businessId_0 AND NOT (c."IsPublished") AND c."IsActive"
ORDER BY c."CreatedAt" DESC
2025-07-02 16:57:52.863 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.CTAFlowBuilder.DTOs.VisualFlowSummaryDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 16:57:52.865 +05:30 [INF] Executed action xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController.GetAllDraftFlows (xbytechat.api) in 10.3605ms
2025-07-02 16:57:52.867 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController.GetAllDraftFlows (xbytechat.api)'
2025-07-02 16:57:52.868 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/cta-flow/all-draft - 200 null application/json; charset=utf-8 26.3722ms
2025-07-02 16:57:53.368 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/cta-flow/all-published - null null
2025-07-02 16:57:53.372 +05:30 [INF] CORS policy execution successful.
2025-07-02 16:57:53.373 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController.GetPublishedFlows (xbytechat.api)'
2025-07-02 16:57:53.374 +05:30 [INF] Route matched with {action = "GetPublishedFlows", controller = "CTAFlow"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPublishedFlows() on controller xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController (xbytechat.api).
2025-07-02 16:57:53.379 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."FlowName", c."IsPublished", c."CreatedAt"
FROM "CTAFlowConfigs" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."IsPublished"
ORDER BY c."CreatedAt" DESC
2025-07-02 16:57:53.384 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.CTAFlowBuilder.DTOs.VisualFlowSummaryDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 16:57:53.385 +05:30 [INF] Executed action xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController.GetPublishedFlows (xbytechat.api) in 9.1381ms
2025-07-02 16:57:53.387 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController.GetPublishedFlows (xbytechat.api)'
2025-07-02 16:57:53.389 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/cta-flow/all-published - 200 null application/json; charset=utf-8 20.4252ms
2025-07-02 16:57:54.529 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/cta-flow/all-draft - null null
2025-07-02 16:57:54.534 +05:30 [INF] CORS policy execution successful.
2025-07-02 16:57:54.535 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController.GetAllDraftFlows (xbytechat.api)'
2025-07-02 16:57:54.537 +05:30 [INF] Route matched with {action = "GetAllDraftFlows", controller = "CTAFlow"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllDraftFlows() on controller xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController (xbytechat.api).
2025-07-02 16:57:54.543 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."FlowName", c."CreatedAt", c."IsPublished"
FROM "CTAFlowConfigs" AS c
WHERE c."BusinessId" = @__businessId_0 AND NOT (c."IsPublished") AND c."IsActive"
ORDER BY c."CreatedAt" DESC
2025-07-02 16:57:54.547 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.CTAFlowBuilder.DTOs.VisualFlowSummaryDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 16:57:54.549 +05:30 [INF] Executed action xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController.GetAllDraftFlows (xbytechat.api) in 10.094ms
2025-07-02 16:57:54.551 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController.GetAllDraftFlows (xbytechat.api)'
2025-07-02 16:57:54.552 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/cta-flow/all-draft - 200 null application/json; charset=utf-8 22.6057ms
2025-07-02 16:57:54.637 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/cta-flow/all-draft - null null
2025-07-02 16:57:54.641 +05:30 [INF] CORS policy execution successful.
2025-07-02 16:57:54.642 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController.GetAllDraftFlows (xbytechat.api)'
2025-07-02 16:57:54.644 +05:30 [INF] Route matched with {action = "GetAllDraftFlows", controller = "CTAFlow"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllDraftFlows() on controller xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController (xbytechat.api).
2025-07-02 16:57:54.650 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."FlowName", c."CreatedAt", c."IsPublished"
FROM "CTAFlowConfigs" AS c
WHERE c."BusinessId" = @__businessId_0 AND NOT (c."IsPublished") AND c."IsActive"
ORDER BY c."CreatedAt" DESC
2025-07-02 16:57:54.654 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.CTAFlowBuilder.DTOs.VisualFlowSummaryDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 16:57:54.656 +05:30 [INF] Executed action xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController.GetAllDraftFlows (xbytechat.api) in 10.0711ms
2025-07-02 16:57:54.658 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController.GetAllDraftFlows (xbytechat.api)'
2025-07-02 16:57:54.659 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/cta-flow/all-draft - 200 null application/json; charset=utf-8 22.2229ms
2025-07-02 16:57:55.156 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/cta-flow/all-published - null null
2025-07-02 16:57:55.161 +05:30 [INF] CORS policy execution successful.
2025-07-02 16:57:55.163 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController.GetPublishedFlows (xbytechat.api)'
2025-07-02 16:57:55.165 +05:30 [INF] Route matched with {action = "GetPublishedFlows", controller = "CTAFlow"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPublishedFlows() on controller xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController (xbytechat.api).
2025-07-02 16:57:55.172 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."FlowName", c."IsPublished", c."CreatedAt"
FROM "CTAFlowConfigs" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."IsPublished"
ORDER BY c."CreatedAt" DESC
2025-07-02 16:57:55.177 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.CTAFlowBuilder.DTOs.VisualFlowSummaryDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 16:57:55.179 +05:30 [INF] Executed action xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController.GetPublishedFlows (xbytechat.api) in 10.7272ms
2025-07-02 16:57:55.181 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController.GetPublishedFlows (xbytechat.api)'
2025-07-02 16:57:55.183 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/cta-flow/all-published - 200 null application/json; charset=utf-8 26.8581ms
2025-07-02 16:58:14.898 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/cta-flow/all-draft - null null
2025-07-02 16:58:14.909 +05:30 [INF] CORS policy execution successful.
2025-07-02 16:58:14.912 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController.GetAllDraftFlows (xbytechat.api)'
2025-07-02 16:58:14.913 +05:30 [INF] Route matched with {action = "GetAllDraftFlows", controller = "CTAFlow"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllDraftFlows() on controller xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController (xbytechat.api).
2025-07-02 16:58:14.920 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."FlowName", c."CreatedAt", c."IsPublished"
FROM "CTAFlowConfigs" AS c
WHERE c."BusinessId" = @__businessId_0 AND NOT (c."IsPublished") AND c."IsActive"
ORDER BY c."CreatedAt" DESC
2025-07-02 16:58:14.924 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.CTAFlowBuilder.DTOs.VisualFlowSummaryDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 16:58:14.926 +05:30 [INF] Executed action xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController.GetAllDraftFlows (xbytechat.api) in 10.0754ms
2025-07-02 16:58:14.927 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController.GetAllDraftFlows (xbytechat.api)'
2025-07-02 16:58:14.929 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/cta-flow/all-draft - 200 null application/json; charset=utf-8 30.6826ms
2025-07-02 16:59:23.623 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/WhatsAppTemplateFetcher/get-template-all - null null
2025-07-02 16:59:23.638 +05:30 [INF] CORS policy execution successful.
2025-07-02 16:59:23.640 +05:30 [INF] Executing endpoint 'xbytechat_api.WhatsAppSettings.Controllers.WhatsAppTemplateFetcherController.GetAllTemplatesAsync (xbytechat.api)'
2025-07-02 16:59:23.642 +05:30 [INF] Route matched with {action = "GetAllTemplates", controller = "WhatsAppTemplateFetcher"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllTemplatesAsync() on controller xbytechat_api.WhatsAppSettings.Controllers.WhatsAppTemplateFetcherController (xbytechat.api).
2025-07-02 16:59:23.649 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiToken", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."IsActive"
2025-07-02 16:59:23.661 +05:30 [INF] Start processing HTTP request GET https://graph.facebook.com/v22.0/999432368375320/message_templates
2025-07-02 16:59:23.663 +05:30 [INF] Sending HTTP request GET https://graph.facebook.com/v22.0/999432368375320/message_templates
2025-07-02 16:59:24.409 +05:30 [INF] Received HTTP response headers after 744.8541ms - 401
2025-07-02 16:59:24.412 +05:30 [INF] End processing HTTP request after 750.8364ms - 401
2025-07-02 16:59:24.413 +05:30 [INF] 📦 Meta Template API Raw JSON for "c13be597-6ae2-42bb-9d43-925815f24ff8":
{"error":{"message":"Error validating access token: Session has expired on Monday, 30-Jun-25 11:00:00 PDT. The current time is Wednesday, 02-Jul-25 04:29:28 PDT.","type":"OAuthException","code":190,"error_subcode":463,"fbtrace_id":"ABTFm4_dzWbCOs8IjMijs2o"}}
2025-07-02 16:59:24.415 +05:30 [ERR] ❌ Failed to fetch templates for BusinessId "c13be597-6ae2-42bb-9d43-925815f24ff8": {"error":{"message":"Error validating access token: Session has expired on Monday, 30-Jun-25 11:00:00 PDT. The current time is Wednesday, 02-Jul-25 04:29:28 PDT.","type":"OAuthException","code":190,"error_subcode":463,"fbtrace_id":"ABTFm4_dzWbCOs8IjMijs2o"}}
2025-07-02 16:59:24.417 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType64`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[TemplateForUIResponseDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 16:59:24.419 +05:30 [INF] Executed action xbytechat_api.WhatsAppSettings.Controllers.WhatsAppTemplateFetcherController.GetAllTemplatesAsync (xbytechat.api) in 774.6451ms
2025-07-02 16:59:24.421 +05:30 [INF] Executed endpoint 'xbytechat_api.WhatsAppSettings.Controllers.WhatsAppTemplateFetcherController.GetAllTemplatesAsync (xbytechat.api)'
2025-07-02 16:59:24.423 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/WhatsAppTemplateFetcher/get-template-all - 200 null application/json; charset=utf-8 800.3651ms
2025-07-02 16:59:41.897 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/cta-flow/all-draft - null null
2025-07-02 16:59:41.903 +05:30 [INF] CORS policy execution successful.
2025-07-02 16:59:41.907 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController.GetAllDraftFlows (xbytechat.api)'
2025-07-02 16:59:41.909 +05:30 [INF] Route matched with {action = "GetAllDraftFlows", controller = "CTAFlow"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllDraftFlows() on controller xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController (xbytechat.api).
2025-07-02 16:59:41.918 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."FlowName", c."CreatedAt", c."IsPublished"
FROM "CTAFlowConfigs" AS c
WHERE c."BusinessId" = @__businessId_0 AND NOT (c."IsPublished") AND c."IsActive"
ORDER BY c."CreatedAt" DESC
2025-07-02 16:59:41.922 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.CTAFlowBuilder.DTOs.VisualFlowSummaryDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 16:59:41.924 +05:30 [INF] Executed action xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController.GetAllDraftFlows (xbytechat.api) in 12.0748ms
2025-07-02 16:59:41.926 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController.GetAllDraftFlows (xbytechat.api)'
2025-07-02 16:59:41.928 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/cta-flow/all-draft - 200 null application/json; charset=utf-8 30.9531ms
2025-07-02 16:59:47.947 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/cta-flow/all-draft - null null
2025-07-02 16:59:47.951 +05:30 [INF] CORS policy execution successful.
2025-07-02 16:59:47.953 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController.GetAllDraftFlows (xbytechat.api)'
2025-07-02 16:59:47.955 +05:30 [INF] Route matched with {action = "GetAllDraftFlows", controller = "CTAFlow"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllDraftFlows() on controller xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController (xbytechat.api).
2025-07-02 16:59:48.134 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."FlowName", c."CreatedAt", c."IsPublished"
FROM "CTAFlowConfigs" AS c
WHERE c."BusinessId" = @__businessId_0 AND NOT (c."IsPublished") AND c."IsActive"
ORDER BY c."CreatedAt" DESC
2025-07-02 16:59:48.138 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.CTAFlowBuilder.DTOs.VisualFlowSummaryDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 16:59:48.140 +05:30 [INF] Executed action xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController.GetAllDraftFlows (xbytechat.api) in 182.3656ms
2025-07-02 16:59:48.142 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController.GetAllDraftFlows (xbytechat.api)'
2025-07-02 16:59:48.143 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/cta-flow/all-draft - 200 null application/json; charset=utf-8 196.3795ms
2025-07-02 16:59:49.047 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/cta-flow/all-published - null null
2025-07-02 16:59:49.051 +05:30 [INF] CORS policy execution successful.
2025-07-02 16:59:49.052 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController.GetPublishedFlows (xbytechat.api)'
2025-07-02 16:59:49.054 +05:30 [INF] Route matched with {action = "GetPublishedFlows", controller = "CTAFlow"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPublishedFlows() on controller xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController (xbytechat.api).
2025-07-02 16:59:49.059 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."FlowName", c."IsPublished", c."CreatedAt"
FROM "CTAFlowConfigs" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."IsPublished"
ORDER BY c."CreatedAt" DESC
2025-07-02 16:59:49.065 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.CTAFlowBuilder.DTOs.VisualFlowSummaryDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 16:59:49.067 +05:30 [INF] Executed action xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController.GetPublishedFlows (xbytechat.api) in 10.7841ms
2025-07-02 16:59:49.068 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController.GetPublishedFlows (xbytechat.api)'
2025-07-02 16:59:49.070 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/cta-flow/all-published - 200 null application/json; charset=utf-8 23.2149ms
2025-07-02 16:59:49.386 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/cta-flow/all-draft - null null
2025-07-02 16:59:49.390 +05:30 [INF] CORS policy execution successful.
2025-07-02 16:59:49.393 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController.GetAllDraftFlows (xbytechat.api)'
2025-07-02 16:59:49.395 +05:30 [INF] Route matched with {action = "GetAllDraftFlows", controller = "CTAFlow"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllDraftFlows() on controller xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController (xbytechat.api).
2025-07-02 16:59:49.401 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."FlowName", c."CreatedAt", c."IsPublished"
FROM "CTAFlowConfigs" AS c
WHERE c."BusinessId" = @__businessId_0 AND NOT (c."IsPublished") AND c."IsActive"
ORDER BY c."CreatedAt" DESC
2025-07-02 16:59:49.405 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.CTAFlowBuilder.DTOs.VisualFlowSummaryDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 16:59:49.409 +05:30 [INF] Executed action xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController.GetAllDraftFlows (xbytechat.api) in 11.0363ms
2025-07-02 16:59:49.412 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController.GetAllDraftFlows (xbytechat.api)'
2025-07-02 16:59:49.414 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/cta-flow/all-draft - 200 null application/json; charset=utf-8 28.2765ms
2025-07-02 16:59:56.537 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/cta-flow/drafts - null null
2025-07-02 16:59:56.541 +05:30 [INF] CORS policy execution successful.
2025-07-02 16:59:56.543 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/cta-flow/drafts - 404 0 null 6.4538ms
2025-07-02 16:59:56.570 +05:30 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:7113/api/cta-flow/drafts, Response status code: 404
2025-07-02 17:00:19.545 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/cta-flow/drafts - null null
2025-07-02 17:00:19.548 +05:30 [INF] CORS policy execution successful.
2025-07-02 17:00:19.569 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/cta-flow/drafts - 404 0 null 24.3538ms
2025-07-02 17:00:19.573 +05:30 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:7113/api/cta-flow/drafts, Response status code: 404
2025-07-02 17:00:25.875 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/catalog-tracking/recent?limit=10 - null null
2025-07-02 17:00:25.892 +05:30 [INF] CORS policy execution successful.
2025-07-02 17:00:25.896 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Catalog.Controllers.CatalogTrackingController.GetRecentLogs (xbytechat.api)'
2025-07-02 17:00:25.904 +05:30 [INF] Route matched with {action = "GetRecentLogs", controller = "CatalogTracking"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetRecentLogs(Int32) on controller xbytechat.api.Features.Catalog.Controllers.CatalogTrackingController (xbytechat.api).
2025-07-02 17:00:25.928 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='10'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."BotId", c."BusinessId", c."ButtonText", c."CTAJourney", c."CampaignId", c."CampaignSendLogId", c."CategoryBrowsed", c."ClickedAt", c."ContactId", c."CtaId", c."FollowUpSent", c."LastInteractionType", c."MessageLogId", c."PlanSnapshot", c."ProductBrowsed", c."ProductId", c."RefMessageId", c."Source", c."TemplateId", c."UserId", c."UserName", c."UserPhone"
FROM "CatalogClickLogs" AS c
ORDER BY c."ClickedAt" DESC
LIMIT @__p_0
2025-07-02 17:00:25.933 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Helpers.ResponseResult'.
2025-07-02 17:00:25.936 +05:30 [INF] Executed action xbytechat.api.Features.Catalog.Controllers.CatalogTrackingController.GetRecentLogs (xbytechat.api) in 29.0379ms
2025-07-02 17:00:25.938 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Catalog.Controllers.CatalogTrackingController.GetRecentLogs (xbytechat.api)'
2025-07-02 17:00:25.940 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/catalog-tracking/recent?limit=10 - 200 null application/json; charset=utf-8 65.3617ms
2025-07-02 17:03:28.682 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/auth/session - null null
2025-07-02 17:03:28.690 +05:30 [INF] Executing endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 17:03:28.691 +05:30 [INF] Route matched with {action = "GetSession", controller = "Auth"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetSession() on controller xbytechat.api.AuthModule.Controllers.AuthController (xbytechat.api).
2025-07-02 17:03:28.695 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`4[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 17:03:28.697 +05:30 [INF] Executed action xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api) in 2.5651ms
2025-07-02 17:03:28.698 +05:30 [INF] Executed endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 17:03:28.700 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/auth/session - 200 null application/json; charset=utf-8 18.9791ms
2025-07-02 17:03:28.727 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/feature-access/me - null null
2025-07-02 17:03:28.731 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 17:03:28.732 +05:30 [INF] Route matched with {action = "GetMyFeatures", controller = "FeatureAccess"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto]]] GetMyFeatures() on controller xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController (xbytechat.api).
2025-07-02 17:03:28.739 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT b."Id", b."Address", b."ApprovedAt", b."ApprovedBy", b."BusinessEmail", b."BusinessName", b."CompanyName", b."CompanyPhone", b."CreatedAt", b."CreatedBy", b."CreatedByPartnerId", b."DeletedAt", b."DeletedBy", b."Industry", b."IsApproved", b."IsDeleted", b."LastLoginAt", b."LogoUrl", b."Notes", b."Phone", b."RepresentativeName", b."Source", b."Status", b."Tags", b."Website", b0."Id", b0."BusinessId", b0."CreatedAt", b0."Plan", b0."QuotaResetDate", b0."RemainingMessages", b0."TotalMonthlyQuota", b0."UpdatedAt", b0."WalletBalance"
FROM "Businesses" AS b
LEFT JOIN "BusinessPlanInfos" AS b0 ON b."Id" = b0."BusinessId"
WHERE b."Id" = @__businessId_0
LIMIT 1
2025-07-02 17:03:28.743 +05:30 [INF] 📦 Resolved plan for Business "c13be597-6ae2-42bb-9d43-925815f24ff8": Smart
2025-07-02 17:03:28.746 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."BusinessId", f."CreatedAt", f."Description", f."FeatureName", f."Group", f."IsEnabled", f."Notes", f."Plan"
FROM "FeatureAccess" AS f
WHERE f."BusinessId" = @__businessId_0
2025-07-02 17:03:28.749 +05:30 [INF] 🔧 Feature override: AddProduct = False
2025-07-02 17:03:28.750 +05:30 [INF] 🔧 Feature override: Campaigns = True
2025-07-02 17:03:28.751 +05:30 [INF] 🔧 Feature override: Catalog = True
2025-07-02 17:03:28.752 +05:30 [INF] 🔧 Feature override: CRM = True
2025-07-02 17:03:28.753 +05:30 [INF] 🔧 Feature override: CRMInsights = True
2025-07-02 17:03:28.754 +05:30 [INF] 🔧 Feature override: CTAFlow = True
2025-07-02 17:03:28.755 +05:30 [INF] 🔧 Feature override: FlowInsights = True
2025-07-02 17:03:28.756 +05:30 [INF] 🔧 Feature override: Messaging = True
2025-07-02 17:03:28.757 +05:30 [INF] 🔧 Feature override: ProfileCompletion = True
2025-07-02 17:03:28.758 +05:30 [INF] 🔧 Feature override: UpgradePlan = True
2025-07-02 17:03:28.759 +05:30 [INF] 🔧 Feature override: WhatsAppSettings = True
2025-07-02 17:03:28.761 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 17:03:28.763 +05:30 [INF] Executed action xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api) in 27.9152ms
2025-07-02 17:03:28.765 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 17:03:28.767 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/feature-access/me - 200 null application/json; charset=utf-8 39.4698ms
2025-07-02 17:03:36.163 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/catalog-tracking/recent?limit=10 - null null
2025-07-02 17:03:36.169 +05:30 [INF] CORS policy execution successful.
2025-07-02 17:03:36.170 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Catalog.Controllers.CatalogTrackingController.GetRecentLogs (xbytechat.api)'
2025-07-02 17:03:36.172 +05:30 [INF] Route matched with {action = "GetRecentLogs", controller = "CatalogTracking"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetRecentLogs(Int32) on controller xbytechat.api.Features.Catalog.Controllers.CatalogTrackingController (xbytechat.api).
2025-07-02 17:03:36.182 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='10'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."BotId", c."BusinessId", c."ButtonText", c."CTAJourney", c."CampaignId", c."CampaignSendLogId", c."CategoryBrowsed", c."ClickedAt", c."ContactId", c."CtaId", c."FollowUpSent", c."LastInteractionType", c."MessageLogId", c."PlanSnapshot", c."ProductBrowsed", c."ProductId", c."RefMessageId", c."Source", c."TemplateId", c."UserId", c."UserName", c."UserPhone"
FROM "CatalogClickLogs" AS c
ORDER BY c."ClickedAt" DESC
LIMIT @__p_0
2025-07-02 17:03:36.186 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Helpers.ResponseResult'.
2025-07-02 17:03:36.189 +05:30 [INF] Executed action xbytechat.api.Features.Catalog.Controllers.CatalogTrackingController.GetRecentLogs (xbytechat.api) in 14.301ms
2025-07-02 17:03:36.191 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Catalog.Controllers.CatalogTrackingController.GetRecentLogs (xbytechat.api)'
2025-07-02 17:03:36.193 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/catalog-tracking/recent?limit=10 - 200 null application/json; charset=utf-8 30.1892ms
2025-07-02 17:04:01.412 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/flow-analytics/summary - null null
2025-07-02 17:04:01.425 +05:30 [INF] CORS policy execution successful.
2025-07-02 17:04:01.427 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.FlowAnalytics.Controllers.FlowAnalyticsController.GetSummary (xbytechat.api)'
2025-07-02 17:04:01.428 +05:30 [INF] Route matched with {action = "GetSummary", controller = "FlowAnalytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetSummary() on controller xbytechat.api.Features.FlowAnalytics.Controllers.FlowAnalyticsController (xbytechat.api).
2025-07-02 17:04:01.432 +05:30 [INF] 📊 Generating Flow Analytics Summary for BusinessId: "c13be597-6ae2-42bb-9d43-925815f24ff8"
2025-07-02 17:04:01.437 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."BusinessId", f."ContactPhone", f."ErrorMessage", f."ExecutedAt", f."FlowId", f."RawResponse", f."StepId", f."StepName", f."Success", f."TemplateName", f."TemplateType", f."TrackingLogId", f."TriggeredByButton"
FROM "FlowExecutionLogs" AS f
WHERE f."BusinessId" = @__businessId_0
2025-07-02 17:04:01.449 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Features.FlowAnalytics.DTOs.FlowAnalyticsSummaryDto'.
2025-07-02 17:04:01.451 +05:30 [INF] Executed action xbytechat.api.Features.FlowAnalytics.Controllers.FlowAnalyticsController.GetSummary (xbytechat.api) in 20.1958ms
2025-07-02 17:04:01.453 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.FlowAnalytics.Controllers.FlowAnalyticsController.GetSummary (xbytechat.api)'
2025-07-02 17:04:01.455 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/flow-analytics/summary - 200 null application/json; charset=utf-8 42.6825ms
2025-07-02 17:04:01.459 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/flow-analytics/most-triggered-steps - null null
2025-07-02 17:04:01.462 +05:30 [INF] CORS policy execution successful.
2025-07-02 17:04:01.464 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.FlowAnalytics.Controllers.FlowAnalyticsController.GetMostTriggeredSteps (xbytechat.api)'
2025-07-02 17:04:01.465 +05:30 [INF] Route matched with {action = "GetMostTriggeredSteps", controller = "FlowAnalytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMostTriggeredSteps() on controller xbytechat.api.Features.FlowAnalytics.Controllers.FlowAnalyticsController (xbytechat.api).
2025-07-02 17:04:01.474 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__p_1='5'], CommandType='"Text"', CommandTimeout='30']
SELECT f."StepId", f."StepName", count(*)::int AS "TriggerCount", max(f."ExecutedAt") AS "LastTriggeredAt"
FROM "FlowExecutionLogs" AS f
WHERE f."BusinessId" = @__businessId_0
GROUP BY f."StepId", f."StepName"
ORDER BY count(*)::int DESC
LIMIT @__p_1
2025-07-02 17:04:01.477 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.FlowAnalytics.DTOs.MostTriggeredStepDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 17:04:01.479 +05:30 [INF] Executed action xbytechat.api.Features.FlowAnalytics.Controllers.FlowAnalyticsController.GetMostTriggeredSteps (xbytechat.api) in 11.0935ms
2025-07-02 17:04:01.481 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.FlowAnalytics.Controllers.FlowAnalyticsController.GetMostTriggeredSteps (xbytechat.api)'
2025-07-02 17:04:01.482 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/flow-analytics/most-triggered-steps - 200 null application/json; charset=utf-8 22.9052ms
2025-07-02 17:04:01.486 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/flow-analytics/step-journey-breakdown - null null
2025-07-02 17:04:01.490 +05:30 [INF] CORS policy execution successful.
2025-07-02 17:04:01.492 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.FlowAnalytics.Controllers.FlowAnalyticsController.GetStepJourneyBreakdown (xbytechat.api)'
2025-07-02 17:04:01.493 +05:30 [INF] Route matched with {action = "GetStepJourneyBreakdown", controller = "FlowAnalytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetStepJourneyBreakdown(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller xbytechat.api.Features.FlowAnalytics.Controllers.FlowAnalyticsController (xbytechat.api).
2025-07-02 17:04:01.498 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."BusinessId", f."ContactPhone", f."ErrorMessage", f."ExecutedAt", f."FlowId", f."RawResponse", f."StepId", f."StepName", f."Success", f."TemplateName", f."TemplateType", f."TrackingLogId", f."TriggeredByButton"
FROM "FlowExecutionLogs" AS f
WHERE f."BusinessId" = @__businessId_0
2025-07-02 17:04:01.503 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.FlowAnalytics.DTOs.FlowAnalyticsStepJourneyDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 17:04:01.505 +05:30 [INF] Executed action xbytechat.api.Features.FlowAnalytics.Controllers.FlowAnalyticsController.GetStepJourneyBreakdown (xbytechat.api) in 9.5897ms
2025-07-02 17:04:01.507 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.FlowAnalytics.Controllers.FlowAnalyticsController.GetStepJourneyBreakdown (xbytechat.api)'
2025-07-02 17:04:01.508 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/flow-analytics/step-journey-breakdown - 200 null application/json; charset=utf-8 21.9753ms
2025-07-02 17:06:30.402 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null null
2025-07-02 17:06:30.415 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/contacts - null null
2025-07-02 17:06:30.424 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null null
2025-07-02 17:06:30.424 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/inbox/unread-counts - null null
2025-07-02 17:06:30.431 +05:30 [INF] CORS policy execution successful.
2025-07-02 17:06:30.433 +05:30 [INF] CORS policy execution successful.
2025-07-02 17:06:30.469 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 204 null null 67.6368ms
2025-07-02 17:06:30.475 +05:30 [INF] Executing endpoint 'xbytechat.api.CRM.Controllers.ContactsController.GetAllContacts (xbytechat.api)'
2025-07-02 17:06:30.436 +05:30 [INF] CORS policy execution successful.
2025-07-02 17:06:30.441 +05:30 [INF] CORS policy execution successful.
2025-07-02 17:06:30.475 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null 0
2025-07-02 17:06:30.499 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null 0
2025-07-02 17:06:30.493 +05:30 [INF] Route matched with {action = "GetAllContacts", controller = "Contacts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllContacts(System.String, Int32, Int32) on controller xbytechat.api.CRM.Controllers.ContactsController (xbytechat.api).
2025-07-02 17:06:30.494 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 204 null null 71.7674ms
2025-07-02 17:06:30.496 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Inbox.Controllers.InboxController.GetUnreadCounts (xbytechat.api)'
2025-07-02 17:06:30.509 +05:30 [INF] CORS policy execution successful.
2025-07-02 17:06:30.512 +05:30 [INF] GetPagedContactsAsync: businessId="c13be597-6ae2-42bb-9d43-925815f24ff8", tab=all, page=1, pageSize=25
2025-07-02 17:06:30.505 +05:30 [INF] CORS policy execution successful.
2025-07-02 17:06:30.535 +05:30 [INF] Executing endpoint '/hubs/inbox/negotiate'
2025-07-02 17:06:30.535 +05:30 [INF] Executing endpoint '/hubs/inbox/negotiate'
2025-07-02 17:06:30.545 +05:30 [INF] Route matched with {action = "GetUnreadCounts", controller = "Inbox"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUnreadCounts() on controller xbytechat.api.Features.Inbox.Controllers.InboxController (xbytechat.api).
2025-07-02 17:06:30.554 +05:30 [INF] Executed endpoint '/hubs/inbox/negotiate'
2025-07-02 17:06:30.554 +05:30 [INF] Executed endpoint '/hubs/inbox/negotiate'
2025-07-02 17:06:30.556 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 200 316 application/json 81.0729ms
2025-07-02 17:06:30.558 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 200 316 application/json 59.069ms
2025-07-02 17:06:30.561 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/hubs/inbox?id=IViHu067a3ucP-IU9bmKlA - null null
2025-07-02 17:06:30.575 +05:30 [INF] CORS policy execution successful.
2025-07-02 17:06:30.576 +05:30 [INF] Executing endpoint '/hubs/inbox'
2025-07-02 17:06:30.613 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/hubs/inbox?id=daQvs-YNE_0_al2xSD3rMA - null null
2025-07-02 17:06:30.618 +05:30 [INF] CORS policy execution successful.
2025-07-02 17:06:30.619 +05:30 [INF] Executing endpoint '/hubs/inbox'
2025-07-02 17:06:30.714 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Contacts" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."IsActive"
2025-07-02 17:06:30.722 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__p_2='25', @__p_1='0'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."AssignedAgentId", t."BusinessId", t."CreatedAt", t."Email", t."Group", t."IsActive", t."IsArchived", t."IsAutomationPaused", t."IsFavorite", t."LastCTAInteraction", t."LastCTAType", t."LastClickedProductId", t."LastContactedAt", t."LeadSource", t."Name", t."NextFollowUpAt", t."Notes", t."PhoneNumber", t."Tags", t0."Id", t0."AssignedAt", t0."AssignedBy", t0."BusinessId", t0."ContactId", t0."TagId", t0."Id0", t0."BusinessId0", t0."Category", t0."ColorHex", t0."CreatedAt", t0."IsActive", t0."IsSystemTag", t0."LastUsedAt", t0."Name", t0."Notes"
FROM (
    SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."Tags"
    FROM "Contacts" AS c
    WHERE c."BusinessId" = @__businessId_0 AND c."IsActive"
    ORDER BY c."Name"
    LIMIT @__p_2 OFFSET @__p_1
) AS t
LEFT JOIN (
    SELECT c0."Id", c0."AssignedAt", c0."AssignedBy", c0."BusinessId", c0."ContactId", c0."TagId", t1."Id" AS "Id0", t1."BusinessId" AS "BusinessId0", t1."Category", t1."ColorHex", t1."CreatedAt", t1."IsActive", t1."IsSystemTag", t1."LastUsedAt", t1."Name", t1."Notes"
    FROM "ContactTags" AS c0
    INNER JOIN "Tags" AS t1 ON c0."TagId" = t1."Id"
) AS t0 ON t."Id" = t0."ContactId"
ORDER BY t."Name", t."Id", t0."Id"
2025-07-02 17:06:30.726 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Helpers.ResponseResult'.
2025-07-02 17:06:30.728 +05:30 [INF] Executed action xbytechat.api.CRM.Controllers.ContactsController.GetAllContacts (xbytechat.api) in 216.3895ms
2025-07-02 17:06:30.729 +05:30 [INF] Executed endpoint 'xbytechat.api.CRM.Controllers.ContactsController.GetAllContacts (xbytechat.api)'
2025-07-02 17:06:30.731 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/contacts - 200 null application/json; charset=utf-8 316.0578ms
2025-07-02 17:06:30.816 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[@__userId_0='2870e1d8-0e80-4b12-88bd-70a8113307d6'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."BusinessId", c."ContactId", c."LastReadAt", c."UserId"
FROM "ContactReads" AS c
WHERE c."UserId" = @__userId_0
2025-07-02 17:06:30.832 +05:30 [INF] Executed DbCommand (6ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."CreatedAt", m."ErrorMessage", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."IsIncoming" AND m."ContactId" IS NOT NULL
2025-07-02 17:06:30.839 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.Dictionary`2[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 17:06:30.844 +05:30 [INF] Executed action xbytechat.api.Features.Inbox.Controllers.InboxController.GetUnreadCounts (xbytechat.api) in 296.3348ms
2025-07-02 17:06:30.846 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Inbox.Controllers.InboxController.GetUnreadCounts (xbytechat.api)'
2025-07-02 17:06:30.848 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/inbox/unread-counts - 200 null application/json; charset=utf-8 425.8333ms
2025-07-02 17:06:37.808 +05:30 [INF] Executed endpoint '/hubs/inbox'
2025-07-02 17:06:37.808 +05:30 [INF] Executed endpoint '/hubs/inbox'
2025-07-02 17:06:37.810 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/hubs/inbox?id=daQvs-YNE_0_al2xSD3rMA - 101 null null 7196.8531ms
2025-07-02 17:06:37.811 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/hubs/inbox?id=IViHu067a3ucP-IU9bmKlA - 101 null null 7250.1293ms
2025-07-02 17:06:48.837 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/reporting/messages/history?page=1&pageSize=10 - null null
2025-07-02 17:06:48.860 +05:30 [INF] CORS policy execution successful.
2025-07-02 17:06:48.862 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.ReportingModule.Controllers.MessageAnalyticsController.GetPaginatedLogs (xbytechat.api)'
2025-07-02 17:06:48.871 +05:30 [INF] Route matched with {action = "GetPaginatedLogs", controller = "MessageAnalytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPaginatedLogs(xbytechat.api.Shared.PaginatedRequest) on controller xbytechat.api.Features.ReportingModule.Controllers.MessageAnalyticsController (xbytechat.api).
2025-07-02 17:06:48.889 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0
2025-07-02 17:06:48.902 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__p_2='10', @__p_1='0'], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."RecipientNumber", m."MessageContent", m."CreatedAt", m."CampaignId", m."Status", m."SentAt"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0
ORDER BY m."CreatedAt" DESC
LIMIT @__p_2 OFFSET @__p_1
2025-07-02 17:06:48.908 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType30`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[xbytechat.api.Shared.PaginatedResponse`1[[xbytechat.api.Features.ReportingModule.DTOs.RecentMessageLogDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 17:06:48.915 +05:30 [INF] Executed action xbytechat.api.Features.ReportingModule.Controllers.MessageAnalyticsController.GetPaginatedLogs (xbytechat.api) in 39.6007ms
2025-07-02 17:06:48.917 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.ReportingModule.Controllers.MessageAnalyticsController.GetPaginatedLogs (xbytechat.api)'
2025-07-02 17:06:48.918 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/reporting/messages/history?page=1&pageSize=10 - 200 null application/json; charset=utf-8 81.3121ms
2025-07-02 17:07:05.028 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/contacts - null null
2025-07-02 17:07:05.029 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/WhatsAppTemplateFetcher/get-template-all - null null
2025-07-02 17:07:05.035 +05:30 [INF] CORS policy execution successful.
2025-07-02 17:07:05.039 +05:30 [INF] CORS policy execution successful.
2025-07-02 17:07:05.040 +05:30 [INF] Executing endpoint 'xbytechat.api.CRM.Controllers.ContactsController.GetAllContacts (xbytechat.api)'
2025-07-02 17:07:05.041 +05:30 [INF] Executing endpoint 'xbytechat_api.WhatsAppSettings.Controllers.WhatsAppTemplateFetcherController.GetAllTemplatesAsync (xbytechat.api)'
2025-07-02 17:07:05.044 +05:30 [INF] Route matched with {action = "GetAllContacts", controller = "Contacts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllContacts(System.String, Int32, Int32) on controller xbytechat.api.CRM.Controllers.ContactsController (xbytechat.api).
2025-07-02 17:07:05.046 +05:30 [INF] Route matched with {action = "GetAllTemplates", controller = "WhatsAppTemplateFetcher"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllTemplatesAsync() on controller xbytechat_api.WhatsAppSettings.Controllers.WhatsAppTemplateFetcherController (xbytechat.api).
2025-07-02 17:07:05.049 +05:30 [INF] GetPagedContactsAsync: businessId="c13be597-6ae2-42bb-9d43-925815f24ff8", tab=all, page=1, pageSize=25
2025-07-02 17:07:05.055 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiToken", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."IsActive"
2025-07-02 17:07:05.060 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Contacts" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."IsActive"
2025-07-02 17:07:05.064 +05:30 [INF] Start processing HTTP request GET https://graph.facebook.com/v22.0/999432368375320/message_templates
2025-07-02 17:07:05.068 +05:30 [INF] Sending HTTP request GET https://graph.facebook.com/v22.0/999432368375320/message_templates
2025-07-02 17:07:05.071 +05:30 [INF] Executed DbCommand (5ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__p_2='25', @__p_1='0'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."AssignedAgentId", t."BusinessId", t."CreatedAt", t."Email", t."Group", t."IsActive", t."IsArchived", t."IsAutomationPaused", t."IsFavorite", t."LastCTAInteraction", t."LastCTAType", t."LastClickedProductId", t."LastContactedAt", t."LeadSource", t."Name", t."NextFollowUpAt", t."Notes", t."PhoneNumber", t."Tags", t0."Id", t0."AssignedAt", t0."AssignedBy", t0."BusinessId", t0."ContactId", t0."TagId", t0."Id0", t0."BusinessId0", t0."Category", t0."ColorHex", t0."CreatedAt", t0."IsActive", t0."IsSystemTag", t0."LastUsedAt", t0."Name", t0."Notes"
FROM (
    SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."Tags"
    FROM "Contacts" AS c
    WHERE c."BusinessId" = @__businessId_0 AND c."IsActive"
    ORDER BY c."Name"
    LIMIT @__p_2 OFFSET @__p_1
) AS t
LEFT JOIN (
    SELECT c0."Id", c0."AssignedAt", c0."AssignedBy", c0."BusinessId", c0."ContactId", c0."TagId", t1."Id" AS "Id0", t1."BusinessId" AS "BusinessId0", t1."Category", t1."ColorHex", t1."CreatedAt", t1."IsActive", t1."IsSystemTag", t1."LastUsedAt", t1."Name", t1."Notes"
    FROM "ContactTags" AS c0
    INNER JOIN "Tags" AS t1 ON c0."TagId" = t1."Id"
) AS t0 ON t."Id" = t0."ContactId"
ORDER BY t."Name", t."Id", t0."Id"
2025-07-02 17:07:05.076 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Helpers.ResponseResult'.
2025-07-02 17:07:05.079 +05:30 [INF] Executed action xbytechat.api.CRM.Controllers.ContactsController.GetAllContacts (xbytechat.api) in 30.5625ms
2025-07-02 17:07:05.081 +05:30 [INF] Executed endpoint 'xbytechat.api.CRM.Controllers.ContactsController.GetAllContacts (xbytechat.api)'
2025-07-02 17:07:05.083 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/contacts - 200 null application/json; charset=utf-8 55.2954ms
2025-07-02 17:07:06.342 +05:30 [INF] Received HTTP response headers after 1272.3639ms - 401
2025-07-02 17:07:06.345 +05:30 [INF] End processing HTTP request after 1281.7882ms - 401
2025-07-02 17:07:06.348 +05:30 [INF] 📦 Meta Template API Raw JSON for "c13be597-6ae2-42bb-9d43-925815f24ff8":
{"error":{"message":"Error validating access token: Session has expired on Monday, 30-Jun-25 11:00:00 PDT. The current time is Wednesday, 02-Jul-25 04:37:10 PDT.","type":"OAuthException","code":190,"error_subcode":463,"fbtrace_id":"AKbTL1RiBGJMM9g_ugu-HH_"}}
2025-07-02 17:07:06.350 +05:30 [ERR] ❌ Failed to fetch templates for BusinessId "c13be597-6ae2-42bb-9d43-925815f24ff8": {"error":{"message":"Error validating access token: Session has expired on Monday, 30-Jun-25 11:00:00 PDT. The current time is Wednesday, 02-Jul-25 04:37:10 PDT.","type":"OAuthException","code":190,"error_subcode":463,"fbtrace_id":"AKbTL1RiBGJMM9g_ugu-HH_"}}
2025-07-02 17:07:06.352 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType64`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[TemplateForUIResponseDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 17:07:06.355 +05:30 [INF] Executed action xbytechat_api.WhatsAppSettings.Controllers.WhatsAppTemplateFetcherController.GetAllTemplatesAsync (xbytechat.api) in 1303.5218ms
2025-07-02 17:07:06.357 +05:30 [INF] Executed endpoint 'xbytechat_api.WhatsAppSettings.Controllers.WhatsAppTemplateFetcherController.GetAllTemplatesAsync (xbytechat.api)'
2025-07-02 17:07:06.358 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/WhatsAppTemplateFetcher/get-template-all - 200 null application/json; charset=utf-8 1329.552ms
2025-07-02 17:07:18.320 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/contacts - null null
2025-07-02 17:07:18.328 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/reporting/messages/recent?limit=10 - null null
2025-07-02 17:07:18.329 +05:30 [INF] CORS policy execution successful.
2025-07-02 17:07:18.339 +05:30 [INF] CORS policy execution successful.
2025-07-02 17:07:18.339 +05:30 [INF] Executing endpoint 'xbytechat.api.CRM.Controllers.ContactsController.GetAllContacts (xbytechat.api)'
2025-07-02 17:07:18.340 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.ReportingModule.Controllers.MessageAnalyticsController.GetRecentLogs (xbytechat.api)'
2025-07-02 17:07:18.342 +05:30 [INF] Route matched with {action = "GetAllContacts", controller = "Contacts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllContacts(System.String, Int32, Int32) on controller xbytechat.api.CRM.Controllers.ContactsController (xbytechat.api).
2025-07-02 17:07:18.346 +05:30 [INF] GetPagedContactsAsync: businessId="c13be597-6ae2-42bb-9d43-925815f24ff8", tab=all, page=1, pageSize=25
2025-07-02 17:07:18.348 +05:30 [INF] Route matched with {action = "GetRecentLogs", controller = "MessageAnalytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetRecentLogs(Int32) on controller xbytechat.api.Features.ReportingModule.Controllers.MessageAnalyticsController (xbytechat.api).
2025-07-02 17:07:18.360 +05:30 [INF] Executed DbCommand (6ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Contacts" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."IsActive"
2025-07-02 17:07:18.370 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__p_2='25', @__p_1='0'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."AssignedAgentId", t."BusinessId", t."CreatedAt", t."Email", t."Group", t."IsActive", t."IsArchived", t."IsAutomationPaused", t."IsFavorite", t."LastCTAInteraction", t."LastCTAType", t."LastClickedProductId", t."LastContactedAt", t."LeadSource", t."Name", t."NextFollowUpAt", t."Notes", t."PhoneNumber", t."Tags", t0."Id", t0."AssignedAt", t0."AssignedBy", t0."BusinessId", t0."ContactId", t0."TagId", t0."Id0", t0."BusinessId0", t0."Category", t0."ColorHex", t0."CreatedAt", t0."IsActive", t0."IsSystemTag", t0."LastUsedAt", t0."Name", t0."Notes"
FROM (
    SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."Tags"
    FROM "Contacts" AS c
    WHERE c."BusinessId" = @__businessId_0 AND c."IsActive"
    ORDER BY c."Name"
    LIMIT @__p_2 OFFSET @__p_1
) AS t
LEFT JOIN (
    SELECT c0."Id", c0."AssignedAt", c0."AssignedBy", c0."BusinessId", c0."ContactId", c0."TagId", t1."Id" AS "Id0", t1."BusinessId" AS "BusinessId0", t1."Category", t1."ColorHex", t1."CreatedAt", t1."IsActive", t1."IsSystemTag", t1."LastUsedAt", t1."Name", t1."Notes"
    FROM "ContactTags" AS c0
    INNER JOIN "Tags" AS t1 ON c0."TagId" = t1."Id"
) AS t0 ON t."Id" = t0."ContactId"
ORDER BY t."Name", t."Id", t0."Id"
2025-07-02 17:07:18.374 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__p_1='10'], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."RecipientNumber", m."MessageContent", m."CreatedAt", m."CampaignId", m."Status", m."SentAt"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0
ORDER BY m."CreatedAt" DESC
LIMIT @__p_1
2025-07-02 17:07:18.377 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Helpers.ResponseResult'.
2025-07-02 17:07:18.380 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType30`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[xbytechat.api.Features.ReportingModule.DTOs.RecentMessageLogDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 17:07:18.382 +05:30 [INF] Executed action xbytechat.api.CRM.Controllers.ContactsController.GetAllContacts (xbytechat.api) in 35.9283ms
2025-07-02 17:07:18.386 +05:30 [INF] Executed action xbytechat.api.Features.ReportingModule.Controllers.MessageAnalyticsController.GetRecentLogs (xbytechat.api) in 25.9761ms
2025-07-02 17:07:18.387 +05:30 [INF] Executed endpoint 'xbytechat.api.CRM.Controllers.ContactsController.GetAllContacts (xbytechat.api)'
2025-07-02 17:07:18.388 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.ReportingModule.Controllers.MessageAnalyticsController.GetRecentLogs (xbytechat.api)'
2025-07-02 17:07:18.390 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/contacts - 200 null application/json; charset=utf-8 70.335ms
2025-07-02 17:07:18.392 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/reporting/messages/recent?limit=10 - 200 null application/json; charset=utf-8 63.9704ms
2025-07-02 17:07:27.494 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/cta-flow/drafts - null null
2025-07-02 17:07:27.516 +05:30 [INF] CORS policy execution successful.
2025-07-02 17:07:27.518 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/cta-flow/drafts - 404 0 null 23.4517ms
2025-07-02 17:07:27.527 +05:30 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:7113/api/cta-flow/drafts, Response status code: 404
2025-07-02 17:08:23.150 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/WhatsAppTemplateFetcher/get-template-all - null null
2025-07-02 17:08:23.164 +05:30 [INF] CORS policy execution successful.
2025-07-02 17:08:23.166 +05:30 [INF] Executing endpoint 'xbytechat_api.WhatsAppSettings.Controllers.WhatsAppTemplateFetcherController.GetAllTemplatesAsync (xbytechat.api)'
2025-07-02 17:08:23.167 +05:30 [INF] Route matched with {action = "GetAllTemplates", controller = "WhatsAppTemplateFetcher"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllTemplatesAsync() on controller xbytechat_api.WhatsAppSettings.Controllers.WhatsAppTemplateFetcherController (xbytechat.api).
2025-07-02 17:08:23.173 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiToken", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."IsActive"
2025-07-02 17:08:23.179 +05:30 [INF] Start processing HTTP request GET https://graph.facebook.com/v22.0/999432368375320/message_templates
2025-07-02 17:08:23.180 +05:30 [INF] Sending HTTP request GET https://graph.facebook.com/v22.0/999432368375320/message_templates
2025-07-02 17:08:23.964 +05:30 [INF] Received HTTP response headers after 781.5965ms - 401
2025-07-02 17:08:23.965 +05:30 [INF] End processing HTTP request after 786.1362ms - 401
2025-07-02 17:08:23.966 +05:30 [INF] 📦 Meta Template API Raw JSON for "c13be597-6ae2-42bb-9d43-925815f24ff8":
{"error":{"message":"Error validating access token: Session has expired on Monday, 30-Jun-25 11:00:00 PDT. The current time is Wednesday, 02-Jul-25 04:38:28 PDT.","type":"OAuthException","code":190,"error_subcode":463,"fbtrace_id":"AyXtEm9nM8oOAWVDrteQDYy"}}
2025-07-02 17:08:23.968 +05:30 [ERR] ❌ Failed to fetch templates for BusinessId "c13be597-6ae2-42bb-9d43-925815f24ff8": {"error":{"message":"Error validating access token: Session has expired on Monday, 30-Jun-25 11:00:00 PDT. The current time is Wednesday, 02-Jul-25 04:38:28 PDT.","type":"OAuthException","code":190,"error_subcode":463,"fbtrace_id":"AyXtEm9nM8oOAWVDrteQDYy"}}
2025-07-02 17:08:23.969 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType64`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[TemplateForUIResponseDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 17:08:23.971 +05:30 [INF] Executed action xbytechat_api.WhatsAppSettings.Controllers.WhatsAppTemplateFetcherController.GetAllTemplatesAsync (xbytechat.api) in 801.2867ms
2025-07-02 17:08:23.973 +05:30 [INF] Executed endpoint 'xbytechat_api.WhatsAppSettings.Controllers.WhatsAppTemplateFetcherController.GetAllTemplatesAsync (xbytechat.api)'
2025-07-02 17:08:23.974 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/WhatsAppTemplateFetcher/get-template-all - 200 null application/json; charset=utf-8 823.7714ms
2025-07-02 17:08:25.867 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/campaign/get-image-campaign - null null
2025-07-02 17:08:25.873 +05:30 [INF] CORS policy execution successful.
2025-07-02 17:08:25.874 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetAll (xbytechat.api)'
2025-07-02 17:08:25.876 +05:30 [INF] Route matched with {action = "GetAll", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAll(System.String) on controller xbytechat.api.Features.CampaignModule.Controllers.CampaignController (xbytechat.api).
2025-07-02 17:08:25.884 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Name", c."Status", c."ScheduledAt", c."CreatedAt", c."ImageUrl", c."ImageCaption", c0."Title" AS "CtaTitle", (
    SELECT count(*)::int
    FROM "CampaignRecipients" AS c1
    WHERE c."Id" = c1."CampaignId") AS "RecipientCount"
FROM "Campaigns" AS c
LEFT JOIN "CTADefinitions" AS c0 ON c."CtaId" = c0."Id"
WHERE c."BusinessId" = @__businessId_0
ORDER BY c."CreatedAt" DESC
2025-07-02 17:08:25.886 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.CampaignModule.DTOs.CampaignSummaryDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 17:08:25.888 +05:30 [INF] Executed action xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetAll (xbytechat.api) in 10.426ms
2025-07-02 17:08:25.890 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetAll (xbytechat.api)'
2025-07-02 17:08:25.892 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/campaign/get-image-campaign - 200 null application/json; charset=utf-8 24.6761ms
2025-07-02 17:08:29.577 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/campaign/assign-contacts - null null
2025-07-02 17:08:29.586 +05:30 [INF] CORS policy execution successful.
2025-07-02 17:08:29.589 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetCampaignById (xbytechat.api)'
2025-07-02 17:08:29.593 +05:30 [INF] Route matched with {action = "GetCampaignById", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[xbytechat.api.Features.CampaignModule.DTOs.CampaignDto]] GetCampaignById(System.Guid) on controller xbytechat.api.Features.CampaignModule.Controllers.CampaignController (xbytechat.api).
2025-07-02 17:08:29.598 +05:30 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-07-02 17:08:29.601 +05:30 [INF] Executed action xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetCampaignById (xbytechat.api) in 4.982ms
2025-07-02 17:08:29.603 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetCampaignById (xbytechat.api)'
2025-07-02 17:08:29.604 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/campaign/assign-contacts - 400 null application/problem+json; charset=utf-8 27.3274ms
2025-07-02 17:08:40.105 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/campaign/get-image-campaign - null null
2025-07-02 17:08:40.117 +05:30 [INF] CORS policy execution successful.
2025-07-02 17:08:40.119 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetAll (xbytechat.api)'
2025-07-02 17:08:40.120 +05:30 [INF] Route matched with {action = "GetAll", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAll(System.String) on controller xbytechat.api.Features.CampaignModule.Controllers.CampaignController (xbytechat.api).
2025-07-02 17:08:40.131 +05:30 [INF] Executed DbCommand (5ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Name", c."Status", c."ScheduledAt", c."CreatedAt", c."ImageUrl", c."ImageCaption", c0."Title" AS "CtaTitle", (
    SELECT count(*)::int
    FROM "CampaignRecipients" AS c1
    WHERE c."Id" = c1."CampaignId") AS "RecipientCount"
FROM "Campaigns" AS c
LEFT JOIN "CTADefinitions" AS c0 ON c."CtaId" = c0."Id"
WHERE c."BusinessId" = @__businessId_0
ORDER BY c."CreatedAt" DESC
2025-07-02 17:08:40.136 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.CampaignModule.DTOs.CampaignSummaryDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 17:08:40.138 +05:30 [INF] Executed action xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetAll (xbytechat.api) in 13.4981ms
2025-07-02 17:08:40.140 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetAll (xbytechat.api)'
2025-07-02 17:08:40.142 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/campaign/get-image-campaign - 200 null application/json; charset=utf-8 36.669ms
2025-07-02 17:08:49.213 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/campaign/assign-contacts - null null
2025-07-02 17:08:49.217 +05:30 [INF] CORS policy execution successful.
2025-07-02 17:08:49.219 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetCampaignById (xbytechat.api)'
2025-07-02 17:08:49.221 +05:30 [INF] Route matched with {action = "GetCampaignById", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[xbytechat.api.Features.CampaignModule.DTOs.CampaignDto]] GetCampaignById(System.Guid) on controller xbytechat.api.Features.CampaignModule.Controllers.CampaignController (xbytechat.api).
2025-07-02 17:08:49.226 +05:30 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-07-02 17:08:49.229 +05:30 [INF] Executed action xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetCampaignById (xbytechat.api) in 5.9373ms
2025-07-02 17:08:49.232 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetCampaignById (xbytechat.api)'
2025-07-02 17:08:49.234 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/campaign/assign-contacts - 400 null application/problem+json; charset=utf-8 21.0068ms
2025-07-02 17:09:00.186 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/contacts - null null
2025-07-02 17:09:00.192 +05:30 [INF] CORS policy execution successful.
2025-07-02 17:09:00.195 +05:30 [INF] Executing endpoint 'xbytechat.api.CRM.Controllers.ContactsController.GetAllContacts (xbytechat.api)'
2025-07-02 17:09:00.198 +05:30 [INF] Route matched with {action = "GetAllContacts", controller = "Contacts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllContacts(System.String, Int32, Int32) on controller xbytechat.api.CRM.Controllers.ContactsController (xbytechat.api).
2025-07-02 17:09:00.201 +05:30 [INF] GetPagedContactsAsync: businessId="c13be597-6ae2-42bb-9d43-925815f24ff8", tab=all, page=1, pageSize=25
2025-07-02 17:09:00.207 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Contacts" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."IsActive"
2025-07-02 17:09:00.218 +05:30 [INF] Executed DbCommand (6ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__p_2='25', @__p_1='0'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."AssignedAgentId", t."BusinessId", t."CreatedAt", t."Email", t."Group", t."IsActive", t."IsArchived", t."IsAutomationPaused", t."IsFavorite", t."LastCTAInteraction", t."LastCTAType", t."LastClickedProductId", t."LastContactedAt", t."LeadSource", t."Name", t."NextFollowUpAt", t."Notes", t."PhoneNumber", t."Tags", t0."Id", t0."AssignedAt", t0."AssignedBy", t0."BusinessId", t0."ContactId", t0."TagId", t0."Id0", t0."BusinessId0", t0."Category", t0."ColorHex", t0."CreatedAt", t0."IsActive", t0."IsSystemTag", t0."LastUsedAt", t0."Name", t0."Notes"
FROM (
    SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."Tags"
    FROM "Contacts" AS c
    WHERE c."BusinessId" = @__businessId_0 AND c."IsActive"
    ORDER BY c."Name"
    LIMIT @__p_2 OFFSET @__p_1
) AS t
LEFT JOIN (
    SELECT c0."Id", c0."AssignedAt", c0."AssignedBy", c0."BusinessId", c0."ContactId", c0."TagId", t1."Id" AS "Id0", t1."BusinessId" AS "BusinessId0", t1."Category", t1."ColorHex", t1."CreatedAt", t1."IsActive", t1."IsSystemTag", t1."LastUsedAt", t1."Name", t1."Notes"
    FROM "ContactTags" AS c0
    INNER JOIN "Tags" AS t1 ON c0."TagId" = t1."Id"
) AS t0 ON t."Id" = t0."ContactId"
ORDER BY t."Name", t."Id", t0."Id"
2025-07-02 17:09:00.222 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Helpers.ResponseResult'.
2025-07-02 17:09:00.225 +05:30 [INF] Executed action xbytechat.api.CRM.Controllers.ContactsController.GetAllContacts (xbytechat.api) in 24.2857ms
2025-07-02 17:09:00.227 +05:30 [INF] Executed endpoint 'xbytechat.api.CRM.Controllers.ContactsController.GetAllContacts (xbytechat.api)'
2025-07-02 17:09:00.229 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/contacts - 200 null application/json; charset=utf-8 42.6626ms
2025-07-02 17:18:12.086 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/campaign/get-image-campaign - null null
2025-07-02 17:18:12.099 +05:30 [INF] CORS policy execution successful.
2025-07-02 17:18:12.100 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetAll (xbytechat.api)'
2025-07-02 17:18:12.102 +05:30 [INF] Route matched with {action = "GetAll", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAll(System.String) on controller xbytechat.api.Features.CampaignModule.Controllers.CampaignController (xbytechat.api).
2025-07-02 17:18:12.281 +05:30 [INF] Executed DbCommand (5ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Name", c."Status", c."ScheduledAt", c."CreatedAt", c."ImageUrl", c."ImageCaption", c0."Title" AS "CtaTitle", (
    SELECT count(*)::int
    FROM "CampaignRecipients" AS c1
    WHERE c."Id" = c1."CampaignId") AS "RecipientCount"
FROM "Campaigns" AS c
LEFT JOIN "CTADefinitions" AS c0 ON c."CtaId" = c0."Id"
WHERE c."BusinessId" = @__businessId_0
ORDER BY c."CreatedAt" DESC
2025-07-02 17:18:12.285 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.CampaignModule.DTOs.CampaignSummaryDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 17:18:12.286 +05:30 [INF] Executed action xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetAll (xbytechat.api) in 182.6384ms
2025-07-02 17:18:12.288 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetAll (xbytechat.api)'
2025-07-02 17:18:12.289 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/campaign/get-image-campaign - 200 null application/json; charset=utf-8 203.3419ms
2025-07-02 17:18:16.615 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/Campaign/paginated?page=1&pageSize=10&status= - null null
2025-07-02 17:18:16.621 +05:30 [INF] CORS policy execution successful.
2025-07-02 17:18:16.626 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetPaginatedCampaigns (xbytechat.api)'
2025-07-02 17:18:16.629 +05:30 [INF] Route matched with {action = "GetPaginatedCampaigns", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPaginatedCampaigns(xbytechat.api.Shared.PaginatedRequest) on controller xbytechat.api.Features.CampaignModule.Controllers.CampaignController (xbytechat.api).
2025-07-02 17:18:16.636 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Campaigns" AS c
WHERE c."BusinessId" = @__businessId_0
2025-07-02 17:18:16.643 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__p_2='10', @__p_1='0'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Name", c."Status", c."ScheduledAt", c."CreatedAt"
FROM "Campaigns" AS c
WHERE c."BusinessId" = @__businessId_0
ORDER BY c."CreatedAt" DESC
LIMIT @__p_2 OFFSET @__p_1
2025-07-02 17:18:16.648 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Shared.PaginatedResponse`1[[xbytechat.api.Features.CampaignModule.DTOs.CampaignSummaryDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 17:18:16.650 +05:30 [INF] Executed action xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetPaginatedCampaigns (xbytechat.api) in 18.0132ms
2025-07-02 17:18:16.652 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetPaginatedCampaigns (xbytechat.api)'
2025-07-02 17:18:16.655 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/Campaign/paginated?page=1&pageSize=10&status= - 200 null application/json; charset=utf-8 40.0045ms
2025-07-02 17:18:23.163 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/Campaign/paginated?page=1&pageSize=10&status= - null null
2025-07-02 17:18:23.172 +05:30 [INF] CORS policy execution successful.
2025-07-02 17:18:23.174 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetPaginatedCampaigns (xbytechat.api)'
2025-07-02 17:18:23.177 +05:30 [INF] Route matched with {action = "GetPaginatedCampaigns", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPaginatedCampaigns(xbytechat.api.Shared.PaginatedRequest) on controller xbytechat.api.Features.CampaignModule.Controllers.CampaignController (xbytechat.api).
2025-07-02 17:18:23.186 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Campaigns" AS c
WHERE c."BusinessId" = @__businessId_0
2025-07-02 17:18:23.224 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__p_2='10', @__p_1='0'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Name", c."Status", c."ScheduledAt", c."CreatedAt"
FROM "Campaigns" AS c
WHERE c."BusinessId" = @__businessId_0
ORDER BY c."CreatedAt" DESC
LIMIT @__p_2 OFFSET @__p_1
2025-07-02 17:18:23.230 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Shared.PaginatedResponse`1[[xbytechat.api.Features.CampaignModule.DTOs.CampaignSummaryDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 17:18:23.232 +05:30 [INF] Executed action xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetPaginatedCampaigns (xbytechat.api) in 51.4833ms
2025-07-02 17:18:23.235 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetPaginatedCampaigns (xbytechat.api)'
2025-07-02 17:18:23.237 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/Campaign/paginated?page=1&pageSize=10&status= - 200 null application/json; charset=utf-8 74.3788ms
2025-07-02 17:18:41.155 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/Campaign/paginated?page=1&pageSize=10&status= - null null
2025-07-02 17:18:41.160 +05:30 [INF] CORS policy execution successful.
2025-07-02 17:18:41.162 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetPaginatedCampaigns (xbytechat.api)'
2025-07-02 17:18:41.164 +05:30 [INF] Route matched with {action = "GetPaginatedCampaigns", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPaginatedCampaigns(xbytechat.api.Shared.PaginatedRequest) on controller xbytechat.api.Features.CampaignModule.Controllers.CampaignController (xbytechat.api).
2025-07-02 17:18:41.173 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Campaigns" AS c
WHERE c."BusinessId" = @__businessId_0
2025-07-02 17:18:41.180 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__p_2='10', @__p_1='0'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Name", c."Status", c."ScheduledAt", c."CreatedAt"
FROM "Campaigns" AS c
WHERE c."BusinessId" = @__businessId_0
ORDER BY c."CreatedAt" DESC
LIMIT @__p_2 OFFSET @__p_1
2025-07-02 17:18:41.183 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Shared.PaginatedResponse`1[[xbytechat.api.Features.CampaignModule.DTOs.CampaignSummaryDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 17:18:41.186 +05:30 [INF] Executed action xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetPaginatedCampaigns (xbytechat.api) in 19.0666ms
2025-07-02 17:18:41.189 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetPaginatedCampaigns (xbytechat.api)'
2025-07-02 17:18:41.190 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/Campaign/paginated?page=1&pageSize=10&status= - 200 null application/json; charset=utf-8 35.1871ms
2025-07-02 17:21:56.689 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/flow-analytics/summary - null null
2025-07-02 17:21:56.698 +05:30 [INF] CORS policy execution successful.
2025-07-02 17:21:56.699 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.FlowAnalytics.Controllers.FlowAnalyticsController.GetSummary (xbytechat.api)'
2025-07-02 17:21:56.701 +05:30 [INF] Route matched with {action = "GetSummary", controller = "FlowAnalytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetSummary() on controller xbytechat.api.Features.FlowAnalytics.Controllers.FlowAnalyticsController (xbytechat.api).
2025-07-02 17:21:56.704 +05:30 [INF] 📊 Generating Flow Analytics Summary for BusinessId: "c13be597-6ae2-42bb-9d43-925815f24ff8"
2025-07-02 17:21:56.708 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."BusinessId", f."ContactPhone", f."ErrorMessage", f."ExecutedAt", f."FlowId", f."RawResponse", f."StepId", f."StepName", f."Success", f."TemplateName", f."TemplateType", f."TrackingLogId", f."TriggeredByButton"
FROM "FlowExecutionLogs" AS f
WHERE f."BusinessId" = @__businessId_0
2025-07-02 17:21:56.716 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Features.FlowAnalytics.DTOs.FlowAnalyticsSummaryDto'.
2025-07-02 17:21:56.718 +05:30 [INF] Executed action xbytechat.api.Features.FlowAnalytics.Controllers.FlowAnalyticsController.GetSummary (xbytechat.api) in 14.2013ms
2025-07-02 17:21:56.719 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.FlowAnalytics.Controllers.FlowAnalyticsController.GetSummary (xbytechat.api)'
2025-07-02 17:21:56.721 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/flow-analytics/summary - 200 null application/json; charset=utf-8 32.2989ms
2025-07-02 17:21:56.726 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/flow-analytics/most-triggered-steps - null null
2025-07-02 17:21:56.728 +05:30 [INF] CORS policy execution successful.
2025-07-02 17:21:56.730 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.FlowAnalytics.Controllers.FlowAnalyticsController.GetMostTriggeredSteps (xbytechat.api)'
2025-07-02 17:21:56.731 +05:30 [INF] Route matched with {action = "GetMostTriggeredSteps", controller = "FlowAnalytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMostTriggeredSteps() on controller xbytechat.api.Features.FlowAnalytics.Controllers.FlowAnalyticsController (xbytechat.api).
2025-07-02 17:21:56.737 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__p_1='5'], CommandType='"Text"', CommandTimeout='30']
SELECT f."StepId", f."StepName", count(*)::int AS "TriggerCount", max(f."ExecutedAt") AS "LastTriggeredAt"
FROM "FlowExecutionLogs" AS f
WHERE f."BusinessId" = @__businessId_0
GROUP BY f."StepId", f."StepName"
ORDER BY count(*)::int DESC
LIMIT @__p_1
2025-07-02 17:21:56.739 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.FlowAnalytics.DTOs.MostTriggeredStepDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 17:21:56.741 +05:30 [INF] Executed action xbytechat.api.Features.FlowAnalytics.Controllers.FlowAnalyticsController.GetMostTriggeredSteps (xbytechat.api) in 7.6092ms
2025-07-02 17:21:56.743 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.FlowAnalytics.Controllers.FlowAnalyticsController.GetMostTriggeredSteps (xbytechat.api)'
2025-07-02 17:21:56.744 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/flow-analytics/most-triggered-steps - 200 null application/json; charset=utf-8 18.8698ms
2025-07-02 17:21:56.749 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/flow-analytics/step-journey-breakdown - null null
2025-07-02 17:21:56.751 +05:30 [INF] CORS policy execution successful.
2025-07-02 17:21:56.752 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.FlowAnalytics.Controllers.FlowAnalyticsController.GetStepJourneyBreakdown (xbytechat.api)'
2025-07-02 17:21:56.754 +05:30 [INF] Route matched with {action = "GetStepJourneyBreakdown", controller = "FlowAnalytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetStepJourneyBreakdown(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller xbytechat.api.Features.FlowAnalytics.Controllers.FlowAnalyticsController (xbytechat.api).
2025-07-02 17:21:56.759 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."BusinessId", f."ContactPhone", f."ErrorMessage", f."ExecutedAt", f."FlowId", f."RawResponse", f."StepId", f."StepName", f."Success", f."TemplateName", f."TemplateType", f."TrackingLogId", f."TriggeredByButton"
FROM "FlowExecutionLogs" AS f
WHERE f."BusinessId" = @__businessId_0
2025-07-02 17:21:56.763 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.FlowAnalytics.DTOs.FlowAnalyticsStepJourneyDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 17:21:56.764 +05:30 [INF] Executed action xbytechat.api.Features.FlowAnalytics.Controllers.FlowAnalyticsController.GetStepJourneyBreakdown (xbytechat.api) in 8.16ms
2025-07-02 17:21:56.766 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.FlowAnalytics.Controllers.FlowAnalyticsController.GetStepJourneyBreakdown (xbytechat.api)'
2025-07-02 17:21:56.767 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/flow-analytics/step-journey-breakdown - 200 null application/json; charset=utf-8 18.5335ms
2025-07-02 17:22:29.701 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/campaign-logs/campaign/5b762111-ca31-42e3-aead-a65f67b4ff48 - null null
2025-07-02 17:22:29.702 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/campaign-logs/campaign/5b762111-ca31-42e3-aead-a65f67b4ff48/summary - null null
2025-07-02 17:22:29.716 +05:30 [INF] CORS policy execution successful.
2025-07-02 17:22:29.720 +05:30 [INF] CORS policy execution successful.
2025-07-02 17:22:29.720 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CampaignTracking.Controllers.CampaignSendLogController.GetLogsByCampaign (xbytechat.api)'
2025-07-02 17:22:29.722 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CampaignTracking.Controllers.CampaignSendLogController.GetCampaignSummary (xbytechat.api)'
2025-07-02 17:22:29.727 +05:30 [INF] Route matched with {action = "GetLogsByCampaign", controller = "CampaignSendLog"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetLogsByCampaign(System.Guid) on controller xbytechat.api.Features.CampaignTracking.Controllers.CampaignSendLogController (xbytechat.api).
2025-07-02 17:22:29.728 +05:30 [INF] Route matched with {action = "GetCampaignSummary", controller = "CampaignSendLog"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCampaignSummary(System.Guid) on controller xbytechat.api.Features.CampaignTracking.Controllers.CampaignSendLogController (xbytechat.api).
2025-07-02 17:22:29.777 +05:30 [INF] Executed DbCommand (9ms) [Parameters=[@__campaignId_0='5b762111-ca31-42e3-aead-a65f67b4ff48'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."CampaignId", c."ContactId", c0."Name" AS "ContactName", c0."PhoneNumber" AS "ContactPhone", c."MessageBody", c."TemplateId", c."SendStatus", c."ErrorMessage", c."CreatedAt", c."SentAt", c."DeliveredAt", c."ReadAt", c."IpAddress", c."DeviceInfo", c."MacAddress", c."SourceChannel", c."IsClicked", c."ClickedAt", c."ClickType"
FROM "CampaignSendLogs" AS c
INNER JOIN "Contacts" AS c0 ON c."ContactId" = c0."Id"
WHERE c."CampaignId" = @__campaignId_0
2025-07-02 17:22:29.788 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.CampaignTracking.DTOs.CampaignSendLogDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 17:22:29.797 +05:30 [INF] Executed action xbytechat.api.Features.CampaignTracking.Controllers.CampaignSendLogController.GetLogsByCampaign (xbytechat.api) in 66.4674ms
2025-07-02 17:22:29.799 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CampaignTracking.Controllers.CampaignSendLogController.GetLogsByCampaign (xbytechat.api)'
2025-07-02 17:22:29.800 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/campaign-logs/campaign/5b762111-ca31-42e3-aead-a65f67b4ff48 - 200 null application/json; charset=utf-8 99.0783ms
2025-07-02 17:22:29.951 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__campaignId_0='5b762111-ca31-42e3-aead-a65f67b4ff48'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."CampaignId" = @__campaignId_0
2025-07-02 17:22:30.022 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Features.CampaignTracking.DTOs.CampaignLogSummaryDto'.
2025-07-02 17:22:30.026 +05:30 [INF] Executed action xbytechat.api.Features.CampaignTracking.Controllers.CampaignSendLogController.GetCampaignSummary (xbytechat.api) in 293.1024ms
2025-07-02 17:22:30.028 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CampaignTracking.Controllers.CampaignSendLogController.GetCampaignSummary (xbytechat.api)'
2025-07-02 17:22:30.029 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/campaign-logs/campaign/5b762111-ca31-42e3-aead-a65f67b4ff48/summary - 200 null application/json; charset=utf-8 327.472ms
2025-07-02 17:24:38.982 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/Campaign/paginated?page=1&pageSize=10&status= - null null
2025-07-02 17:24:38.993 +05:30 [INF] CORS policy execution successful.
2025-07-02 17:24:38.995 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetPaginatedCampaigns (xbytechat.api)'
2025-07-02 17:24:38.996 +05:30 [INF] Route matched with {action = "GetPaginatedCampaigns", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPaginatedCampaigns(xbytechat.api.Shared.PaginatedRequest) on controller xbytechat.api.Features.CampaignModule.Controllers.CampaignController (xbytechat.api).
2025-07-02 17:24:39.005 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Campaigns" AS c
WHERE c."BusinessId" = @__businessId_0
2025-07-02 17:24:39.010 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__p_2='10', @__p_1='0'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Name", c."Status", c."ScheduledAt", c."CreatedAt"
FROM "Campaigns" AS c
WHERE c."BusinessId" = @__businessId_0
ORDER BY c."CreatedAt" DESC
LIMIT @__p_2 OFFSET @__p_1
2025-07-02 17:24:39.015 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Shared.PaginatedResponse`1[[xbytechat.api.Features.CampaignModule.DTOs.CampaignSummaryDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 17:24:39.017 +05:30 [INF] Executed action xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetPaginatedCampaigns (xbytechat.api) in 18.0805ms
2025-07-02 17:24:39.018 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetPaginatedCampaigns (xbytechat.api)'
2025-07-02 17:24:39.020 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/Campaign/paginated?page=1&pageSize=10&status= - 200 null application/json; charset=utf-8 38.0763ms
2025-07-02 17:25:07.531 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/tracking/logs - null null
2025-07-02 17:25:07.545 +05:30 [INF] CORS policy execution successful.
2025-07-02 17:25:07.547 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Tracking.Controllers.TrackingViewerController.GetAll (xbytechat.api)'
2025-07-02 17:25:07.548 +05:30 [INF] Route matched with {action = "GetAll", controller = "TrackingViewer"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAll(System.Nullable`1[System.Guid]) on controller xbytechat.api.Features.Tracking.Controllers.TrackingViewerController (xbytechat.api).
2025-07-02 17:25:07.557 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."ContactPhone", CASE
    WHEN c."Id" IS NOT NULL THEN c."Name"
    ELSE '(N/A)'
END AS "ContactName", t."ButtonText", t."CTAType", t."SourceType", t."ClickedAt", t."DeviceType", t."Country", CASE
    WHEN c0."Id" IS NOT NULL THEN c0."Name"
    ELSE '(Unknown)'
END AS "CampaignName"
FROM "TrackingLogs" AS t
LEFT JOIN "Contacts" AS c ON t."ContactId" = c."Id"
LEFT JOIN "Campaigns" AS c0 ON t."CampaignId" = c0."Id"
ORDER BY t."ClickedAt" DESC
2025-07-02 17:25:07.560 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType30`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType66`10[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.DateTime, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 17:25:07.562 +05:30 [INF] Executed action xbytechat.api.Features.Tracking.Controllers.TrackingViewerController.GetAll (xbytechat.api) in 11.1191ms
2025-07-02 17:25:07.566 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Tracking.Controllers.TrackingViewerController.GetAll (xbytechat.api)'
2025-07-02 17:25:07.568 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/tracking/logs - 200 null application/json; charset=utf-8 36.5893ms
2025-07-02 17:25:09.873 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/Campaign/paginated?page=1&pageSize=10&status= - null null
2025-07-02 17:25:09.879 +05:30 [INF] CORS policy execution successful.
2025-07-02 17:25:09.882 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetPaginatedCampaigns (xbytechat.api)'
2025-07-02 17:25:09.883 +05:30 [INF] Route matched with {action = "GetPaginatedCampaigns", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPaginatedCampaigns(xbytechat.api.Shared.PaginatedRequest) on controller xbytechat.api.Features.CampaignModule.Controllers.CampaignController (xbytechat.api).
2025-07-02 17:25:09.894 +05:30 [INF] Executed DbCommand (6ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Campaigns" AS c
WHERE c."BusinessId" = @__businessId_0
2025-07-02 17:25:09.913 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__p_2='10', @__p_1='0'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Name", c."Status", c."ScheduledAt", c."CreatedAt"
FROM "Campaigns" AS c
WHERE c."BusinessId" = @__businessId_0
ORDER BY c."CreatedAt" DESC
LIMIT @__p_2 OFFSET @__p_1
2025-07-02 17:25:09.917 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Shared.PaginatedResponse`1[[xbytechat.api.Features.CampaignModule.DTOs.CampaignSummaryDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 17:25:09.918 +05:30 [INF] Executed action xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetPaginatedCampaigns (xbytechat.api) in 32.3265ms
2025-07-02 17:25:09.920 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetPaginatedCampaigns (xbytechat.api)'
2025-07-02 17:25:09.921 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/Campaign/paginated?page=1&pageSize=10&status= - 200 null application/json; charset=utf-8 48.3794ms
2025-07-02 17:25:47.166 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/Campaign/paginated?page=1&pageSize=10&status= - null null
2025-07-02 17:25:47.169 +05:30 [INF] CORS policy execution successful.
2025-07-02 17:25:47.171 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetPaginatedCampaigns (xbytechat.api)'
2025-07-02 17:25:47.172 +05:30 [INF] Route matched with {action = "GetPaginatedCampaigns", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPaginatedCampaigns(xbytechat.api.Shared.PaginatedRequest) on controller xbytechat.api.Features.CampaignModule.Controllers.CampaignController (xbytechat.api).
2025-07-02 17:25:47.183 +05:30 [INF] Executed DbCommand (6ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Campaigns" AS c
WHERE c."BusinessId" = @__businessId_0
2025-07-02 17:25:47.197 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__p_2='10', @__p_1='0'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Name", c."Status", c."ScheduledAt", c."CreatedAt"
FROM "Campaigns" AS c
WHERE c."BusinessId" = @__businessId_0
ORDER BY c."CreatedAt" DESC
LIMIT @__p_2 OFFSET @__p_1
2025-07-02 17:25:47.200 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Shared.PaginatedResponse`1[[xbytechat.api.Features.CampaignModule.DTOs.CampaignSummaryDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 17:25:47.203 +05:30 [INF] Executed action xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetPaginatedCampaigns (xbytechat.api) in 28.0031ms
2025-07-02 17:25:47.204 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetPaginatedCampaigns (xbytechat.api)'
2025-07-02 17:25:47.206 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/Campaign/paginated?page=1&pageSize=10&status= - 200 null application/json; charset=utf-8 39.8779ms
2025-07-02 17:25:49.348 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/campaign-logs/campaign/5b762111-ca31-42e3-aead-a65f67b4ff48 - null null
2025-07-02 17:25:49.352 +05:30 [INF] CORS policy execution successful.
2025-07-02 17:25:49.353 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/campaign-logs/campaign/5b762111-ca31-42e3-aead-a65f67b4ff48/summary - null null
2025-07-02 17:25:49.353 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CampaignTracking.Controllers.CampaignSendLogController.GetLogsByCampaign (xbytechat.api)'
2025-07-02 17:25:49.364 +05:30 [INF] Route matched with {action = "GetLogsByCampaign", controller = "CampaignSendLog"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetLogsByCampaign(System.Guid) on controller xbytechat.api.Features.CampaignTracking.Controllers.CampaignSendLogController (xbytechat.api).
2025-07-02 17:25:49.364 +05:30 [INF] CORS policy execution successful.
2025-07-02 17:25:49.368 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CampaignTracking.Controllers.CampaignSendLogController.GetCampaignSummary (xbytechat.api)'
2025-07-02 17:25:49.369 +05:30 [INF] Route matched with {action = "GetCampaignSummary", controller = "CampaignSendLog"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCampaignSummary(System.Guid) on controller xbytechat.api.Features.CampaignTracking.Controllers.CampaignSendLogController (xbytechat.api).
2025-07-02 17:25:49.373 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__campaignId_0='5b762111-ca31-42e3-aead-a65f67b4ff48'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."CampaignId", c."ContactId", c0."Name" AS "ContactName", c0."PhoneNumber" AS "ContactPhone", c."MessageBody", c."TemplateId", c."SendStatus", c."ErrorMessage", c."CreatedAt", c."SentAt", c."DeliveredAt", c."ReadAt", c."IpAddress", c."DeviceInfo", c."MacAddress", c."SourceChannel", c."IsClicked", c."ClickedAt", c."ClickType"
FROM "CampaignSendLogs" AS c
INNER JOIN "Contacts" AS c0 ON c."ContactId" = c0."Id"
WHERE c."CampaignId" = @__campaignId_0
2025-07-02 17:25:49.387 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.CampaignTracking.DTOs.CampaignSendLogDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 17:25:49.391 +05:30 [INF] Executed action xbytechat.api.Features.CampaignTracking.Controllers.CampaignSendLogController.GetLogsByCampaign (xbytechat.api) in 25.8412ms
2025-07-02 17:25:49.393 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CampaignTracking.Controllers.CampaignSendLogController.GetLogsByCampaign (xbytechat.api)'
2025-07-02 17:25:49.395 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/campaign-logs/campaign/5b762111-ca31-42e3-aead-a65f67b4ff48 - 200 null application/json; charset=utf-8 47.4726ms
2025-07-02 17:25:49.551 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__campaignId_0='5b762111-ca31-42e3-aead-a65f67b4ff48'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."CampaignId" = @__campaignId_0
2025-07-02 17:25:49.555 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Features.CampaignTracking.DTOs.CampaignLogSummaryDto'.
2025-07-02 17:25:49.557 +05:30 [INF] Executed action xbytechat.api.Features.CampaignTracking.Controllers.CampaignSendLogController.GetCampaignSummary (xbytechat.api) in 183.0078ms
2025-07-02 17:25:49.559 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CampaignTracking.Controllers.CampaignSendLogController.GetCampaignSummary (xbytechat.api)'
2025-07-02 17:25:49.560 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/campaign-logs/campaign/5b762111-ca31-42e3-aead-a65f67b4ff48/summary - 200 null application/json; charset=utf-8 207.7913ms
2025-07-02 17:25:50.826 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/Campaign/paginated?page=1&pageSize=10&status= - null null
2025-07-02 17:25:50.833 +05:30 [INF] CORS policy execution successful.
2025-07-02 17:25:50.837 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetPaginatedCampaigns (xbytechat.api)'
2025-07-02 17:25:50.839 +05:30 [INF] Route matched with {action = "GetPaginatedCampaigns", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPaginatedCampaigns(xbytechat.api.Shared.PaginatedRequest) on controller xbytechat.api.Features.CampaignModule.Controllers.CampaignController (xbytechat.api).
2025-07-02 17:25:50.845 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Campaigns" AS c
WHERE c."BusinessId" = @__businessId_0
2025-07-02 17:25:50.853 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__p_2='10', @__p_1='0'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Name", c."Status", c."ScheduledAt", c."CreatedAt"
FROM "Campaigns" AS c
WHERE c."BusinessId" = @__businessId_0
ORDER BY c."CreatedAt" DESC
LIMIT @__p_2 OFFSET @__p_1
2025-07-02 17:25:50.860 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Shared.PaginatedResponse`1[[xbytechat.api.Features.CampaignModule.DTOs.CampaignSummaryDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 17:25:50.864 +05:30 [INF] Executed action xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetPaginatedCampaigns (xbytechat.api) in 22.286ms
2025-07-02 17:25:50.866 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetPaginatedCampaigns (xbytechat.api)'
2025-07-02 17:25:50.868 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/Campaign/paginated?page=1&pageSize=10&status= - 200 null application/json; charset=utf-8 41.959ms
2025-07-02 17:25:58.240 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/Campaign/paginated?page=1&pageSize=10&status= - null null
2025-07-02 17:25:58.244 +05:30 [INF] CORS policy execution successful.
2025-07-02 17:25:58.245 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetPaginatedCampaigns (xbytechat.api)'
2025-07-02 17:25:58.247 +05:30 [INF] Route matched with {action = "GetPaginatedCampaigns", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPaginatedCampaigns(xbytechat.api.Shared.PaginatedRequest) on controller xbytechat.api.Features.CampaignModule.Controllers.CampaignController (xbytechat.api).
2025-07-02 17:25:58.260 +05:30 [INF] Executed DbCommand (6ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Campaigns" AS c
WHERE c."BusinessId" = @__businessId_0
2025-07-02 17:25:58.273 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__p_2='10', @__p_1='0'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Name", c."Status", c."ScheduledAt", c."CreatedAt"
FROM "Campaigns" AS c
WHERE c."BusinessId" = @__businessId_0
ORDER BY c."CreatedAt" DESC
LIMIT @__p_2 OFFSET @__p_1
2025-07-02 17:25:58.277 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Shared.PaginatedResponse`1[[xbytechat.api.Features.CampaignModule.DTOs.CampaignSummaryDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 17:25:58.280 +05:30 [INF] Executed action xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetPaginatedCampaigns (xbytechat.api) in 29.4537ms
2025-07-02 17:25:58.283 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetPaginatedCampaigns (xbytechat.api)'
2025-07-02 17:25:58.285 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/Campaign/paginated?page=1&pageSize=10&status= - 200 null application/json; charset=utf-8 45.5538ms
2025-07-02 17:26:24.889 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/contacts - null null
2025-07-02 17:26:24.902 +05:30 [INF] CORS policy execution successful.
2025-07-02 17:26:24.904 +05:30 [INF] Executing endpoint 'xbytechat.api.CRM.Controllers.ContactsController.GetAllContacts (xbytechat.api)'
2025-07-02 17:26:24.908 +05:30 [INF] Route matched with {action = "GetAllContacts", controller = "Contacts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllContacts(System.String, Int32, Int32) on controller xbytechat.api.CRM.Controllers.ContactsController (xbytechat.api).
2025-07-02 17:26:24.913 +05:30 [INF] GetPagedContactsAsync: businessId="c13be597-6ae2-42bb-9d43-925815f24ff8", tab=all, page=1, pageSize=25
2025-07-02 17:26:24.921 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Contacts" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."IsActive"
2025-07-02 17:26:24.941 +05:30 [INF] Executed DbCommand (7ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__p_2='25', @__p_1='0'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."AssignedAgentId", t."BusinessId", t."CreatedAt", t."Email", t."Group", t."IsActive", t."IsArchived", t."IsAutomationPaused", t."IsFavorite", t."LastCTAInteraction", t."LastCTAType", t."LastClickedProductId", t."LastContactedAt", t."LeadSource", t."Name", t."NextFollowUpAt", t."Notes", t."PhoneNumber", t."Tags", t0."Id", t0."AssignedAt", t0."AssignedBy", t0."BusinessId", t0."ContactId", t0."TagId", t0."Id0", t0."BusinessId0", t0."Category", t0."ColorHex", t0."CreatedAt", t0."IsActive", t0."IsSystemTag", t0."LastUsedAt", t0."Name", t0."Notes"
FROM (
    SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."Tags"
    FROM "Contacts" AS c
    WHERE c."BusinessId" = @__businessId_0 AND c."IsActive"
    ORDER BY c."Name"
    LIMIT @__p_2 OFFSET @__p_1
) AS t
LEFT JOIN (
    SELECT c0."Id", c0."AssignedAt", c0."AssignedBy", c0."BusinessId", c0."ContactId", c0."TagId", t1."Id" AS "Id0", t1."BusinessId" AS "BusinessId0", t1."Category", t1."ColorHex", t1."CreatedAt", t1."IsActive", t1."IsSystemTag", t1."LastUsedAt", t1."Name", t1."Notes"
    FROM "ContactTags" AS c0
    INNER JOIN "Tags" AS t1 ON c0."TagId" = t1."Id"
) AS t0 ON t."Id" = t0."ContactId"
ORDER BY t."Name", t."Id", t0."Id"
2025-07-02 17:26:24.945 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Helpers.ResponseResult'.
2025-07-02 17:26:24.947 +05:30 [INF] Executed action xbytechat.api.CRM.Controllers.ContactsController.GetAllContacts (xbytechat.api) in 35.0249ms
2025-07-02 17:26:24.949 +05:30 [INF] Executed endpoint 'xbytechat.api.CRM.Controllers.ContactsController.GetAllContacts (xbytechat.api)'
2025-07-02 17:26:24.950 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/contacts - 200 null application/json; charset=utf-8 61.7111ms
2025-07-02 17:26:27.618 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/Campaign/paginated?page=1&pageSize=10&status= - null null
2025-07-02 17:26:27.625 +05:30 [INF] CORS policy execution successful.
2025-07-02 17:26:27.628 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetPaginatedCampaigns (xbytechat.api)'
2025-07-02 17:26:27.632 +05:30 [INF] Route matched with {action = "GetPaginatedCampaigns", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPaginatedCampaigns(xbytechat.api.Shared.PaginatedRequest) on controller xbytechat.api.Features.CampaignModule.Controllers.CampaignController (xbytechat.api).
2025-07-02 17:26:27.638 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Campaigns" AS c
WHERE c."BusinessId" = @__businessId_0
2025-07-02 17:26:27.671 +05:30 [INF] Executed DbCommand (27ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__p_2='10', @__p_1='0'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Name", c."Status", c."ScheduledAt", c."CreatedAt"
FROM "Campaigns" AS c
WHERE c."BusinessId" = @__businessId_0
ORDER BY c."CreatedAt" DESC
LIMIT @__p_2 OFFSET @__p_1
2025-07-02 17:26:27.675 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Shared.PaginatedResponse`1[[xbytechat.api.Features.CampaignModule.DTOs.CampaignSummaryDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 17:26:27.677 +05:30 [INF] Executed action xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetPaginatedCampaigns (xbytechat.api) in 42.2221ms
2025-07-02 17:26:27.679 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetPaginatedCampaigns (xbytechat.api)'
2025-07-02 17:26:27.684 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/Campaign/paginated?page=1&pageSize=10&status= - 200 null application/json; charset=utf-8 66.337ms
2025-07-02 17:26:35.678 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/Campaign/paginated?page=1&pageSize=10&status= - null null
2025-07-02 17:26:35.683 +05:30 [INF] CORS policy execution successful.
2025-07-02 17:26:35.685 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetPaginatedCampaigns (xbytechat.api)'
2025-07-02 17:26:35.686 +05:30 [INF] Route matched with {action = "GetPaginatedCampaigns", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPaginatedCampaigns(xbytechat.api.Shared.PaginatedRequest) on controller xbytechat.api.Features.CampaignModule.Controllers.CampaignController (xbytechat.api).
2025-07-02 17:26:35.693 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Campaigns" AS c
WHERE c."BusinessId" = @__businessId_0
2025-07-02 17:26:35.700 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__p_2='10', @__p_1='0'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Name", c."Status", c."ScheduledAt", c."CreatedAt"
FROM "Campaigns" AS c
WHERE c."BusinessId" = @__businessId_0
ORDER BY c."CreatedAt" DESC
LIMIT @__p_2 OFFSET @__p_1
2025-07-02 17:26:35.703 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Shared.PaginatedResponse`1[[xbytechat.api.Features.CampaignModule.DTOs.CampaignSummaryDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 17:26:35.705 +05:30 [INF] Executed action xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetPaginatedCampaigns (xbytechat.api) in 16.3692ms
2025-07-02 17:26:35.707 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetPaginatedCampaigns (xbytechat.api)'
2025-07-02 17:26:35.709 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/Campaign/paginated?page=1&pageSize=10&status= - 200 null application/json; charset=utf-8 31.3392ms
2025-07-02 17:26:43.139 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/auth/session - null null
2025-07-02 17:26:43.144 +05:30 [INF] Executing endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 17:26:43.145 +05:30 [INF] Route matched with {action = "GetSession", controller = "Auth"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetSession() on controller xbytechat.api.AuthModule.Controllers.AuthController (xbytechat.api).
2025-07-02 17:26:43.148 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`4[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 17:26:43.151 +05:30 [INF] Executed action xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api) in 3.2288ms
2025-07-02 17:26:43.153 +05:30 [INF] Executed endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 17:26:43.155 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/auth/session - 200 null application/json; charset=utf-8 15.4144ms
2025-07-02 17:26:43.233 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/feature-access/me - null null
2025-07-02 17:26:43.242 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 17:26:43.244 +05:30 [INF] Route matched with {action = "GetMyFeatures", controller = "FeatureAccess"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto]]] GetMyFeatures() on controller xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController (xbytechat.api).
2025-07-02 17:26:43.253 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT b."Id", b."Address", b."ApprovedAt", b."ApprovedBy", b."BusinessEmail", b."BusinessName", b."CompanyName", b."CompanyPhone", b."CreatedAt", b."CreatedBy", b."CreatedByPartnerId", b."DeletedAt", b."DeletedBy", b."Industry", b."IsApproved", b."IsDeleted", b."LastLoginAt", b."LogoUrl", b."Notes", b."Phone", b."RepresentativeName", b."Source", b."Status", b."Tags", b."Website", b0."Id", b0."BusinessId", b0."CreatedAt", b0."Plan", b0."QuotaResetDate", b0."RemainingMessages", b0."TotalMonthlyQuota", b0."UpdatedAt", b0."WalletBalance"
FROM "Businesses" AS b
LEFT JOIN "BusinessPlanInfos" AS b0 ON b."Id" = b0."BusinessId"
WHERE b."Id" = @__businessId_0
LIMIT 1
2025-07-02 17:26:43.259 +05:30 [INF] 📦 Resolved plan for Business "c13be597-6ae2-42bb-9d43-925815f24ff8": Smart
2025-07-02 17:26:43.264 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."BusinessId", f."CreatedAt", f."Description", f."FeatureName", f."Group", f."IsEnabled", f."Notes", f."Plan"
FROM "FeatureAccess" AS f
WHERE f."BusinessId" = @__businessId_0
2025-07-02 17:26:43.266 +05:30 [INF] 🔧 Feature override: AddProduct = False
2025-07-02 17:26:43.267 +05:30 [INF] 🔧 Feature override: Campaigns = True
2025-07-02 17:26:43.268 +05:30 [INF] 🔧 Feature override: Catalog = True
2025-07-02 17:26:43.269 +05:30 [INF] 🔧 Feature override: CRM = True
2025-07-02 17:26:43.270 +05:30 [INF] 🔧 Feature override: CRMInsights = True
2025-07-02 17:26:43.271 +05:30 [INF] 🔧 Feature override: CTAFlow = True
2025-07-02 17:26:43.272 +05:30 [INF] 🔧 Feature override: FlowInsights = True
2025-07-02 17:26:43.273 +05:30 [INF] 🔧 Feature override: Messaging = True
2025-07-02 17:26:43.274 +05:30 [INF] 🔧 Feature override: ProfileCompletion = True
2025-07-02 17:26:43.275 +05:30 [INF] 🔧 Feature override: UpgradePlan = True
2025-07-02 17:26:43.276 +05:30 [INF] 🔧 Feature override: WhatsAppSettings = True
2025-07-02 17:26:43.278 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 17:26:43.279 +05:30 [INF] Executed action xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api) in 31.609ms
2025-07-02 17:26:43.281 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 17:26:43.282 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/feature-access/me - 200 null application/json; charset=utf-8 49.0635ms
2025-07-02 17:27:24.172 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/WhatsAppTemplateFetcher/get-template-all - null null
2025-07-02 17:27:24.177 +05:30 [INF] CORS policy execution successful.
2025-07-02 17:27:24.178 +05:30 [INF] Executing endpoint 'xbytechat_api.WhatsAppSettings.Controllers.WhatsAppTemplateFetcherController.GetAllTemplatesAsync (xbytechat.api)'
2025-07-02 17:27:24.180 +05:30 [INF] Route matched with {action = "GetAllTemplates", controller = "WhatsAppTemplateFetcher"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllTemplatesAsync() on controller xbytechat_api.WhatsAppSettings.Controllers.WhatsAppTemplateFetcherController (xbytechat.api).
2025-07-02 17:27:24.187 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiToken", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."IsActive"
2025-07-02 17:27:24.197 +05:30 [INF] Start processing HTTP request GET https://graph.facebook.com/v22.0/999432368375320/message_templates
2025-07-02 17:27:24.199 +05:30 [INF] Sending HTTP request GET https://graph.facebook.com/v22.0/999432368375320/message_templates
2025-07-02 17:27:24.819 +05:30 [INF] Received HTTP response headers after 618.2135ms - 401
2025-07-02 17:27:24.821 +05:30 [INF] End processing HTTP request after 623.864ms - 401
2025-07-02 17:27:24.823 +05:30 [INF] 📦 Meta Template API Raw JSON for "c13be597-6ae2-42bb-9d43-925815f24ff8":
{"error":{"message":"Error validating access token: Session has expired on Monday, 30-Jun-25 11:00:00 PDT. The current time is Wednesday, 02-Jul-25 04:57:29 PDT.","type":"OAuthException","code":190,"error_subcode":463,"fbtrace_id":"AJpe4I7qluy1lN-xKUKR5Ul"}}
2025-07-02 17:27:24.825 +05:30 [ERR] ❌ Failed to fetch templates for BusinessId "c13be597-6ae2-42bb-9d43-925815f24ff8": {"error":{"message":"Error validating access token: Session has expired on Monday, 30-Jun-25 11:00:00 PDT. The current time is Wednesday, 02-Jul-25 04:57:29 PDT.","type":"OAuthException","code":190,"error_subcode":463,"fbtrace_id":"AJpe4I7qluy1lN-xKUKR5Ul"}}
2025-07-02 17:27:24.827 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType64`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[TemplateForUIResponseDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 17:27:24.828 +05:30 [INF] Executed action xbytechat_api.WhatsAppSettings.Controllers.WhatsAppTemplateFetcherController.GetAllTemplatesAsync (xbytechat.api) in 646.567ms
2025-07-02 17:27:24.831 +05:30 [INF] Executed endpoint 'xbytechat_api.WhatsAppSettings.Controllers.WhatsAppTemplateFetcherController.GetAllTemplatesAsync (xbytechat.api)'
2025-07-02 17:27:24.832 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/WhatsAppTemplateFetcher/get-template-all - 200 null application/json; charset=utf-8 659.7578ms
2025-07-02 17:27:26.670 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/campaign/get-image-campaign - null null
2025-07-02 17:27:26.684 +05:30 [INF] CORS policy execution successful.
2025-07-02 17:27:26.687 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetAll (xbytechat.api)'
2025-07-02 17:27:26.689 +05:30 [INF] Route matched with {action = "GetAll", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAll(System.String) on controller xbytechat.api.Features.CampaignModule.Controllers.CampaignController (xbytechat.api).
2025-07-02 17:27:26.700 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Name", c."Status", c."ScheduledAt", c."CreatedAt", c."ImageUrl", c."ImageCaption", c0."Title" AS "CtaTitle", (
    SELECT count(*)::int
    FROM "CampaignRecipients" AS c1
    WHERE c."Id" = c1."CampaignId") AS "RecipientCount"
FROM "Campaigns" AS c
LEFT JOIN "CTADefinitions" AS c0 ON c."CtaId" = c0."Id"
WHERE c."BusinessId" = @__businessId_0
ORDER BY c."CreatedAt" DESC
2025-07-02 17:27:26.704 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.CampaignModule.DTOs.CampaignSummaryDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 17:27:26.705 +05:30 [INF] Executed action xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetAll (xbytechat.api) in 11.7221ms
2025-07-02 17:27:26.707 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetAll (xbytechat.api)'
2025-07-02 17:27:26.709 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/campaign/get-image-campaign - 200 null application/json; charset=utf-8 38.4952ms
2025-07-02 17:27:33.061 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/campaign/assign-contacts - null null
2025-07-02 17:27:33.065 +05:30 [INF] CORS policy execution successful.
2025-07-02 17:27:33.067 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetCampaignById (xbytechat.api)'
2025-07-02 17:27:33.072 +05:30 [INF] Route matched with {action = "GetCampaignById", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[xbytechat.api.Features.CampaignModule.DTOs.CampaignDto]] GetCampaignById(System.Guid) on controller xbytechat.api.Features.CampaignModule.Controllers.CampaignController (xbytechat.api).
2025-07-02 17:27:33.084 +05:30 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-07-02 17:27:33.090 +05:30 [INF] Executed action xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetCampaignById (xbytechat.api) in 7.5141ms
2025-07-02 17:27:33.092 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetCampaignById (xbytechat.api)'
2025-07-02 17:27:33.094 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/campaign/assign-contacts - 400 null application/problem+json; charset=utf-8 32.2991ms
2025-07-02 17:28:02.857 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/campaign/get-image-campaign - null null
2025-07-02 17:28:02.861 +05:30 [INF] CORS policy execution successful.
2025-07-02 17:28:02.865 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetAll (xbytechat.api)'
2025-07-02 17:28:02.878 +05:30 [INF] Route matched with {action = "GetAll", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAll(System.String) on controller xbytechat.api.Features.CampaignModule.Controllers.CampaignController (xbytechat.api).
2025-07-02 17:28:02.890 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Name", c."Status", c."ScheduledAt", c."CreatedAt", c."ImageUrl", c."ImageCaption", c0."Title" AS "CtaTitle", (
    SELECT count(*)::int
    FROM "CampaignRecipients" AS c1
    WHERE c."Id" = c1."CampaignId") AS "RecipientCount"
FROM "Campaigns" AS c
LEFT JOIN "CTADefinitions" AS c0 ON c."CtaId" = c0."Id"
WHERE c."BusinessId" = @__businessId_0
ORDER BY c."CreatedAt" DESC
2025-07-02 17:28:02.901 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.CampaignModule.DTOs.CampaignSummaryDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 17:28:02.903 +05:30 [INF] Executed action xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetAll (xbytechat.api) in 18.4702ms
2025-07-02 17:28:02.906 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetAll (xbytechat.api)'
2025-07-02 17:28:02.907 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/campaign/get-image-campaign - 200 null application/json; charset=utf-8 50.6325ms
2025-07-02 17:28:05.763 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/campaign/assign-contacts - null null
2025-07-02 17:28:05.767 +05:30 [INF] CORS policy execution successful.
2025-07-02 17:28:05.768 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetCampaignById (xbytechat.api)'
2025-07-02 17:28:05.770 +05:30 [INF] Route matched with {action = "GetCampaignById", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[xbytechat.api.Features.CampaignModule.DTOs.CampaignDto]] GetCampaignById(System.Guid) on controller xbytechat.api.Features.CampaignModule.Controllers.CampaignController (xbytechat.api).
2025-07-02 17:28:05.775 +05:30 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-07-02 17:28:05.776 +05:30 [INF] Executed action xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetCampaignById (xbytechat.api) in 3.7712ms
2025-07-02 17:28:05.777 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetCampaignById (xbytechat.api)'
2025-07-02 17:28:05.778 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/campaign/assign-contacts - 400 null application/problem+json; charset=utf-8 15.0345ms
2025-07-02 17:28:09.421 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/campaign/get-image-campaign - null null
2025-07-02 17:28:09.425 +05:30 [INF] CORS policy execution successful.
2025-07-02 17:28:09.426 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetAll (xbytechat.api)'
2025-07-02 17:28:09.428 +05:30 [INF] Route matched with {action = "GetAll", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAll(System.String) on controller xbytechat.api.Features.CampaignModule.Controllers.CampaignController (xbytechat.api).
2025-07-02 17:28:09.436 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Name", c."Status", c."ScheduledAt", c."CreatedAt", c."ImageUrl", c."ImageCaption", c0."Title" AS "CtaTitle", (
    SELECT count(*)::int
    FROM "CampaignRecipients" AS c1
    WHERE c."Id" = c1."CampaignId") AS "RecipientCount"
FROM "Campaigns" AS c
LEFT JOIN "CTADefinitions" AS c0 ON c."CtaId" = c0."Id"
WHERE c."BusinessId" = @__businessId_0
ORDER BY c."CreatedAt" DESC
2025-07-02 17:28:09.441 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.CampaignModule.DTOs.CampaignSummaryDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 17:28:09.443 +05:30 [INF] Executed action xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetAll (xbytechat.api) in 12.9118ms
2025-07-02 17:28:09.445 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetAll (xbytechat.api)'
2025-07-02 17:28:09.447 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/campaign/get-image-campaign - 200 null application/json; charset=utf-8 25.7979ms
2025-07-02 17:28:12.669 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/tags - null null
2025-07-02 17:28:12.670 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/contacts?tab=all&page=1&pageSize=1000 - null null
2025-07-02 17:28:12.676 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/campaign/97c88929-da44-4b3b-811e-550a41e77640 - null null
2025-07-02 17:28:12.681 +05:30 [INF] CORS policy execution successful.
2025-07-02 17:28:12.684 +05:30 [INF] CORS policy execution successful.
2025-07-02 17:28:12.687 +05:30 [INF] CORS policy execution successful.
2025-07-02 17:28:12.688 +05:30 [INF] Executing endpoint 'xbytechat.api.CRM.Controllers.TagsController.GetAllTags (xbytechat.api)'
2025-07-02 17:28:12.689 +05:30 [INF] Executing endpoint 'xbytechat.api.CRM.Controllers.ContactsController.GetAllContacts (xbytechat.api)'
2025-07-02 17:28:12.690 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetCampaignById (xbytechat.api)'
2025-07-02 17:28:12.691 +05:30 [INF] Route matched with {action = "GetAllTags", controller = "Tags"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllTags() on controller xbytechat.api.CRM.Controllers.TagsController (xbytechat.api).
2025-07-02 17:28:12.692 +05:30 [INF] Route matched with {action = "GetAllContacts", controller = "Contacts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllContacts(System.String, Int32, Int32) on controller xbytechat.api.CRM.Controllers.ContactsController (xbytechat.api).
2025-07-02 17:28:12.693 +05:30 [INF] Route matched with {action = "GetCampaignById", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[xbytechat.api.Features.CampaignModule.DTOs.CampaignDto]] GetCampaignById(System.Guid) on controller xbytechat.api.Features.CampaignModule.Controllers.CampaignController (xbytechat.api).
2025-07-02 17:28:12.701 +05:30 [INF] GetPagedContactsAsync: businessId="c13be597-6ae2-42bb-9d43-925815f24ff8", tab=all, page=1, pageSize=1000
2025-07-02 17:28:12.703 +05:30 [INF] Executed DbCommand (6ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."Name", t."ColorHex", t."Category", t."Notes", t."IsSystemTag", t."IsActive", t."CreatedAt", t."LastUsedAt"
FROM "Tags" AS t
WHERE t."BusinessId" = @__businessId_0 AND t."IsActive"
ORDER BY t."CreatedAt" DESC
2025-07-02 17:28:12.722 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Helpers.ResponseResult'.
2025-07-02 17:28:12.724 +05:30 [INF] Executed action xbytechat.api.CRM.Controllers.TagsController.GetAllTags (xbytechat.api) in 28.7097ms
2025-07-02 17:28:12.727 +05:30 [INF] Executed endpoint 'xbytechat.api.CRM.Controllers.TagsController.GetAllTags (xbytechat.api)'
2025-07-02 17:28:12.727 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/tags - null null
2025-07-02 17:28:12.731 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/tags - 200 null application/json; charset=utf-8 61.9916ms
2025-07-02 17:28:12.735 +05:30 [INF] CORS policy execution successful.
2025-07-02 17:28:12.742 +05:30 [INF] Executing endpoint 'xbytechat.api.CRM.Controllers.TagsController.GetAllTags (xbytechat.api)'
2025-07-02 17:28:12.744 +05:30 [INF] Route matched with {action = "GetAllTags", controller = "Tags"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllTags() on controller xbytechat.api.CRM.Controllers.TagsController (xbytechat.api).
2025-07-02 17:28:12.749 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."Name", t."ColorHex", t."Category", t."Notes", t."IsSystemTag", t."IsActive", t."CreatedAt", t."LastUsedAt"
FROM "Tags" AS t
WHERE t."BusinessId" = @__businessId_0 AND t."IsActive"
ORDER BY t."CreatedAt" DESC
2025-07-02 17:28:12.760 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Helpers.ResponseResult'.
2025-07-02 17:28:12.763 +05:30 [INF] Executed action xbytechat.api.CRM.Controllers.TagsController.GetAllTags (xbytechat.api) in 17.2452ms
2025-07-02 17:28:12.765 +05:30 [INF] Executed endpoint 'xbytechat.api.CRM.Controllers.TagsController.GetAllTags (xbytechat.api)'
2025-07-02 17:28:12.766 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/tags - 200 null application/json; charset=utf-8 39.0758ms
2025-07-02 17:28:12.895 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Contacts" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."IsActive"
2025-07-02 17:28:12.901 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__p_2='100', @__p_1='0'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."AssignedAgentId", t."BusinessId", t."CreatedAt", t."Email", t."Group", t."IsActive", t."IsArchived", t."IsAutomationPaused", t."IsFavorite", t."LastCTAInteraction", t."LastCTAType", t."LastClickedProductId", t."LastContactedAt", t."LeadSource", t."Name", t."NextFollowUpAt", t."Notes", t."PhoneNumber", t."Tags", t0."Id", t0."AssignedAt", t0."AssignedBy", t0."BusinessId", t0."ContactId", t0."TagId", t0."Id0", t0."BusinessId0", t0."Category", t0."ColorHex", t0."CreatedAt", t0."IsActive", t0."IsSystemTag", t0."LastUsedAt", t0."Name", t0."Notes"
FROM (
    SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."Tags"
    FROM "Contacts" AS c
    WHERE c."BusinessId" = @__businessId_0 AND c."IsActive"
    ORDER BY c."Name"
    LIMIT @__p_2 OFFSET @__p_1
) AS t
LEFT JOIN (
    SELECT c0."Id", c0."AssignedAt", c0."AssignedBy", c0."BusinessId", c0."ContactId", c0."TagId", t1."Id" AS "Id0", t1."BusinessId" AS "BusinessId0", t1."Category", t1."ColorHex", t1."CreatedAt", t1."IsActive", t1."IsSystemTag", t1."LastUsedAt", t1."Name", t1."Notes"
    FROM "ContactTags" AS c0
    INNER JOIN "Tags" AS t1 ON c0."TagId" = t1."Id"
) AS t0 ON t."Id" = t0."ContactId"
ORDER BY t."Name", t."Id", t0."Id"
2025-07-02 17:28:12.904 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Helpers.ResponseResult'.
2025-07-02 17:28:12.906 +05:30 [INF] Executed action xbytechat.api.CRM.Controllers.ContactsController.GetAllContacts (xbytechat.api) in 206.8922ms
2025-07-02 17:28:12.907 +05:30 [INF] Executed endpoint 'xbytechat.api.CRM.Controllers.ContactsController.GetAllContacts (xbytechat.api)'
2025-07-02 17:28:12.909 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/contacts?tab=all&page=1&pageSize=1000 - 200 null application/json; charset=utf-8 238.5327ms
2025-07-02 17:28:13.001 +05:30 [INF] Executed DbCommand (6ms) [Parameters=[@__campaignId_0='97c88929-da44-4b3b-811e-550a41e77640', @__businessId_1='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."BusinessId", t."CampaignId", t."CampaignType", t."CreatedAt", t."CreatedBy", t."CtaId", t."DeletedAt", t."DeletedBy", t."FollowUpTemplateId", t."ImageCaption", t."ImageUrl", t."IsDeleted", t."MessageBody", t."MessageTemplate", t."Name", t."ScheduledAt", t."SourceCampaignId", t."Status", t."TemplateId", t."TemplateParameters", t."UpdatedAt", t."Id0", t."BusinessId0", t."ButtonText", t."ButtonType", t."CreatedAt0", t."Description", t."IsActive", t."TargetUrl", t."Title", t."UpdatedAt0", c1."Id", c1."CampaignId", c1."IsFromTemplate", c1."Position", c1."Title", c1."Type", c1."Value"
FROM (
    SELECT c."Id", c."BusinessId", c."CampaignId", c."CampaignType", c."CreatedAt", c."CreatedBy", c."CtaId", c."DeletedAt", c."DeletedBy", c."FollowUpTemplateId", c."ImageCaption", c."ImageUrl", c."IsDeleted", c."MessageBody", c."MessageTemplate", c."Name", c."ScheduledAt", c."SourceCampaignId", c."Status", c."TemplateId", c."TemplateParameters", c."UpdatedAt", c0."Id" AS "Id0", c0."BusinessId" AS "BusinessId0", c0."ButtonText", c0."ButtonType", c0."CreatedAt" AS "CreatedAt0", c0."Description", c0."IsActive", c0."TargetUrl", c0."Title", c0."UpdatedAt" AS "UpdatedAt0"
    FROM "Campaigns" AS c
    LEFT JOIN "CTADefinitions" AS c0 ON c."CtaId" = c0."Id"
    WHERE c."Id" = @__campaignId_0 AND c."BusinessId" = @__businessId_1
    LIMIT 1
) AS t
LEFT JOIN "CampaignButtons" AS c1 ON t."Id" = c1."CampaignId"
ORDER BY t."Id", t."Id0"
2025-07-02 17:28:13.058 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Features.CampaignModule.DTOs.CampaignDto'.
2025-07-02 17:28:13.064 +05:30 [INF] Executed action xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetCampaignById (xbytechat.api) in 353.1669ms
2025-07-02 17:28:13.066 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetCampaignById (xbytechat.api)'
2025-07-02 17:28:13.068 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/campaign/97c88929-da44-4b3b-811e-550a41e77640 - 200 null application/json; charset=utf-8 391.3224ms
2025-07-02 17:28:15.123 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/campaign/get-image-campaign - null null
2025-07-02 17:28:15.126 +05:30 [INF] CORS policy execution successful.
2025-07-02 17:28:15.127 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetAll (xbytechat.api)'
2025-07-02 17:28:15.128 +05:30 [INF] Route matched with {action = "GetAll", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAll(System.String) on controller xbytechat.api.Features.CampaignModule.Controllers.CampaignController (xbytechat.api).
2025-07-02 17:28:15.142 +05:30 [INF] Executed DbCommand (10ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Name", c."Status", c."ScheduledAt", c."CreatedAt", c."ImageUrl", c."ImageCaption", c0."Title" AS "CtaTitle", (
    SELECT count(*)::int
    FROM "CampaignRecipients" AS c1
    WHERE c."Id" = c1."CampaignId") AS "RecipientCount"
FROM "Campaigns" AS c
LEFT JOIN "CTADefinitions" AS c0 ON c."CtaId" = c0."Id"
WHERE c."BusinessId" = @__businessId_0
ORDER BY c."CreatedAt" DESC
2025-07-02 17:28:15.145 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.CampaignModule.DTOs.CampaignSummaryDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 17:28:15.146 +05:30 [INF] Executed action xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetAll (xbytechat.api) in 16.2352ms
2025-07-02 17:28:15.148 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetAll (xbytechat.api)'
2025-07-02 17:28:15.149 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/campaign/get-image-campaign - 200 null application/json; charset=utf-8 26.666ms
2025-07-02 17:33:30.296 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/campaigns/analytics/:campaignId/summary - null null
2025-07-02 17:33:30.303 +05:30 [INF] CORS policy execution successful.
2025-07-02 17:33:30.305 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CampaignTracking.Controllers.CampaignAnalyticsController.GetSummary (xbytechat.api)'
2025-07-02 17:33:30.314 +05:30 [INF] Route matched with {action = "GetSummary", controller = "CampaignAnalytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[xbytechat.api.Features.CampaignTracking.DTOs.CampaignStatusDashboardDto]] GetSummary(System.Guid) on controller xbytechat.api.Features.CampaignTracking.Controllers.CampaignAnalyticsController (xbytechat.api).
2025-07-02 17:33:30.319 +05:30 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-07-02 17:33:30.322 +05:30 [INF] Executed action xbytechat.api.Features.CampaignTracking.Controllers.CampaignAnalyticsController.GetSummary (xbytechat.api) in 4.4063ms
2025-07-02 17:33:30.324 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CampaignTracking.Controllers.CampaignAnalyticsController.GetSummary (xbytechat.api)'
2025-07-02 17:33:30.326 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/campaigns/analytics/:campaignId/summary - 400 null application/problem+json; charset=utf-8 29.9372ms
2025-07-02 17:33:44.184 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/Campaign/paginated?page=1&pageSize=10&status= - null null
2025-07-02 17:33:44.196 +05:30 [INF] CORS policy execution successful.
2025-07-02 17:33:44.199 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetPaginatedCampaigns (xbytechat.api)'
2025-07-02 17:33:44.201 +05:30 [INF] Route matched with {action = "GetPaginatedCampaigns", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPaginatedCampaigns(xbytechat.api.Shared.PaginatedRequest) on controller xbytechat.api.Features.CampaignModule.Controllers.CampaignController (xbytechat.api).
2025-07-02 17:33:44.388 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Campaigns" AS c
WHERE c."BusinessId" = @__businessId_0
2025-07-02 17:33:44.394 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__p_2='10', @__p_1='0'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Name", c."Status", c."ScheduledAt", c."CreatedAt"
FROM "Campaigns" AS c
WHERE c."BusinessId" = @__businessId_0
ORDER BY c."CreatedAt" DESC
LIMIT @__p_2 OFFSET @__p_1
2025-07-02 17:33:44.397 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Shared.PaginatedResponse`1[[xbytechat.api.Features.CampaignModule.DTOs.CampaignSummaryDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 17:33:44.400 +05:30 [INF] Executed action xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetPaginatedCampaigns (xbytechat.api) in 195.7514ms
2025-07-02 17:33:44.402 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetPaginatedCampaigns (xbytechat.api)'
2025-07-02 17:33:44.404 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/Campaign/paginated?page=1&pageSize=10&status= - 200 null application/json; charset=utf-8 219.9237ms
2025-07-02 17:33:46.316 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/campaigns/analytics/5b762111-ca31-42e3-aead-a65f67b4ff48/summary - null null
2025-07-02 17:33:46.327 +05:30 [INF] CORS policy execution successful.
2025-07-02 17:33:46.334 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CampaignTracking.Controllers.CampaignAnalyticsController.GetSummary (xbytechat.api)'
2025-07-02 17:33:46.337 +05:30 [INF] Route matched with {action = "GetSummary", controller = "CampaignAnalytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[xbytechat.api.Features.CampaignTracking.DTOs.CampaignStatusDashboardDto]] GetSummary(System.Guid) on controller xbytechat.api.Features.CampaignTracking.Controllers.CampaignAnalyticsController (xbytechat.api).
2025-07-02 17:33:49.446 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__campaignId_0='5b762111-ca31-42e3-aead-a65f67b4ff48'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."CampaignId" = @__campaignId_0
2025-07-02 17:33:49.456 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType30`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[xbytechat.api.Features.CampaignTracking.DTOs.CampaignStatusDashboardDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 17:33:49.466 +05:30 [INF] Executed action xbytechat.api.Features.CampaignTracking.Controllers.CampaignAnalyticsController.GetSummary (xbytechat.api) in 3124.752ms
2025-07-02 17:33:49.468 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CampaignTracking.Controllers.CampaignAnalyticsController.GetSummary (xbytechat.api)'
2025-07-02 17:33:49.470 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/campaigns/analytics/5b762111-ca31-42e3-aead-a65f67b4ff48/summary - 200 null application/json; charset=utf-8 3154.5404ms
2025-07-02 17:33:59.944 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/Campaign/paginated?page=1&pageSize=10&status= - null null
2025-07-02 17:33:59.946 +05:30 [INF] CORS policy execution successful.
2025-07-02 17:33:59.947 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetPaginatedCampaigns (xbytechat.api)'
2025-07-02 17:33:59.948 +05:30 [INF] Route matched with {action = "GetPaginatedCampaigns", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPaginatedCampaigns(xbytechat.api.Shared.PaginatedRequest) on controller xbytechat.api.Features.CampaignModule.Controllers.CampaignController (xbytechat.api).
2025-07-02 17:33:59.956 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Campaigns" AS c
WHERE c."BusinessId" = @__businessId_0
2025-07-02 17:33:59.963 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__p_2='10', @__p_1='0'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Name", c."Status", c."ScheduledAt", c."CreatedAt"
FROM "Campaigns" AS c
WHERE c."BusinessId" = @__businessId_0
ORDER BY c."CreatedAt" DESC
LIMIT @__p_2 OFFSET @__p_1
2025-07-02 17:33:59.966 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Shared.PaginatedResponse`1[[xbytechat.api.Features.CampaignModule.DTOs.CampaignSummaryDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 17:33:59.968 +05:30 [INF] Executed action xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetPaginatedCampaigns (xbytechat.api) in 17.9618ms
2025-07-02 17:33:59.969 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetPaginatedCampaigns (xbytechat.api)'
2025-07-02 17:33:59.971 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/Campaign/paginated?page=1&pageSize=10&status= - 200 null application/json; charset=utf-8 26.956ms
2025-07-02 17:34:02.819 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/campaigns/analytics/5b762111-ca31-42e3-aead-a65f67b4ff48/summary - null null
2025-07-02 17:34:02.823 +05:30 [INF] CORS policy execution successful.
2025-07-02 17:34:02.825 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CampaignTracking.Controllers.CampaignAnalyticsController.GetSummary (xbytechat.api)'
2025-07-02 17:34:02.827 +05:30 [INF] Route matched with {action = "GetSummary", controller = "CampaignAnalytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[xbytechat.api.Features.CampaignTracking.DTOs.CampaignStatusDashboardDto]] GetSummary(System.Guid) on controller xbytechat.api.Features.CampaignTracking.Controllers.CampaignAnalyticsController (xbytechat.api).
2025-07-02 17:34:03.767 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__campaignId_0='5b762111-ca31-42e3-aead-a65f67b4ff48'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."CampaignId" = @__campaignId_0
2025-07-02 17:34:03.773 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType30`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[xbytechat.api.Features.CampaignTracking.DTOs.CampaignStatusDashboardDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 17:34:03.775 +05:30 [INF] Executed action xbytechat.api.Features.CampaignTracking.Controllers.CampaignAnalyticsController.GetSummary (xbytechat.api) in 945.3882ms
2025-07-02 17:34:03.776 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CampaignTracking.Controllers.CampaignAnalyticsController.GetSummary (xbytechat.api)'
2025-07-02 17:34:03.777 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/campaigns/analytics/5b762111-ca31-42e3-aead-a65f67b4ff48/summary - 200 null application/json; charset=utf-8 958.9761ms
2025-07-02 17:34:08.637 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/Campaign/paginated?page=1&pageSize=10&status= - null null
2025-07-02 17:34:08.647 +05:30 [INF] CORS policy execution successful.
2025-07-02 17:34:08.651 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetPaginatedCampaigns (xbytechat.api)'
2025-07-02 17:34:08.652 +05:30 [INF] Route matched with {action = "GetPaginatedCampaigns", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPaginatedCampaigns(xbytechat.api.Shared.PaginatedRequest) on controller xbytechat.api.Features.CampaignModule.Controllers.CampaignController (xbytechat.api).
2025-07-02 17:34:08.662 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Campaigns" AS c
WHERE c."BusinessId" = @__businessId_0
2025-07-02 17:34:08.669 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__p_2='10', @__p_1='0'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Name", c."Status", c."ScheduledAt", c."CreatedAt"
FROM "Campaigns" AS c
WHERE c."BusinessId" = @__businessId_0
ORDER BY c."CreatedAt" DESC
LIMIT @__p_2 OFFSET @__p_1
2025-07-02 17:34:08.674 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Shared.PaginatedResponse`1[[xbytechat.api.Features.CampaignModule.DTOs.CampaignSummaryDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 17:34:08.676 +05:30 [INF] Executed action xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetPaginatedCampaigns (xbytechat.api) in 18.7587ms
2025-07-02 17:34:08.680 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetPaginatedCampaigns (xbytechat.api)'
2025-07-02 17:34:08.682 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/Campaign/paginated?page=1&pageSize=10&status= - 200 null application/json; charset=utf-8 44.3548ms
2025-07-02 17:35:59.838 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/Campaign/paginated?page=1&pageSize=10&status= - null null
2025-07-02 17:35:59.849 +05:30 [INF] CORS policy execution successful.
2025-07-02 17:35:59.851 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetPaginatedCampaigns (xbytechat.api)'
2025-07-02 17:35:59.854 +05:30 [INF] Route matched with {action = "GetPaginatedCampaigns", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPaginatedCampaigns(xbytechat.api.Shared.PaginatedRequest) on controller xbytechat.api.Features.CampaignModule.Controllers.CampaignController (xbytechat.api).
2025-07-02 17:35:59.863 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Campaigns" AS c
WHERE c."BusinessId" = @__businessId_0
2025-07-02 17:35:59.869 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__p_2='10', @__p_1='0'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Name", c."Status", c."ScheduledAt", c."CreatedAt"
FROM "Campaigns" AS c
WHERE c."BusinessId" = @__businessId_0
ORDER BY c."CreatedAt" DESC
LIMIT @__p_2 OFFSET @__p_1
2025-07-02 17:35:59.881 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Shared.PaginatedResponse`1[[xbytechat.api.Features.CampaignModule.DTOs.CampaignSummaryDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 17:35:59.883 +05:30 [INF] Executed action xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetPaginatedCampaigns (xbytechat.api) in 24.7233ms
2025-07-02 17:35:59.884 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetPaginatedCampaigns (xbytechat.api)'
2025-07-02 17:35:59.886 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/Campaign/paginated?page=1&pageSize=10&status= - 200 null application/json; charset=utf-8 51.0971ms
2025-07-02 17:36:01.217 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/campaigns/analytics/5b762111-ca31-42e3-aead-a65f67b4ff48/summary - null null
2025-07-02 17:36:01.220 +05:30 [INF] CORS policy execution successful.
2025-07-02 17:36:01.221 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CampaignTracking.Controllers.CampaignAnalyticsController.GetSummary (xbytechat.api)'
2025-07-02 17:36:01.223 +05:30 [INF] Route matched with {action = "GetSummary", controller = "CampaignAnalytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[xbytechat.api.Features.CampaignTracking.DTOs.CampaignStatusDashboardDto]] GetSummary(System.Guid) on controller xbytechat.api.Features.CampaignTracking.Controllers.CampaignAnalyticsController (xbytechat.api).
2025-07-02 17:36:02.839 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__campaignId_0='5b762111-ca31-42e3-aead-a65f67b4ff48'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."CampaignId" = @__campaignId_0
2025-07-02 17:36:02.849 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType30`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[xbytechat.api.Features.CampaignTracking.DTOs.CampaignStatusDashboardDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 17:36:02.851 +05:30 [INF] Executed action xbytechat.api.Features.CampaignTracking.Controllers.CampaignAnalyticsController.GetSummary (xbytechat.api) in 1625.7982ms
2025-07-02 17:36:02.853 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CampaignTracking.Controllers.CampaignAnalyticsController.GetSummary (xbytechat.api)'
2025-07-02 17:36:02.854 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/campaigns/analytics/5b762111-ca31-42e3-aead-a65f67b4ff48/summary - 200 null application/json; charset=utf-8 1636.7588ms
2025-07-02 17:36:06.085 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/Campaign/paginated?page=1&pageSize=10&status= - null null
2025-07-02 17:36:06.091 +05:30 [INF] CORS policy execution successful.
2025-07-02 17:36:06.092 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetPaginatedCampaigns (xbytechat.api)'
2025-07-02 17:36:06.093 +05:30 [INF] Route matched with {action = "GetPaginatedCampaigns", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPaginatedCampaigns(xbytechat.api.Shared.PaginatedRequest) on controller xbytechat.api.Features.CampaignModule.Controllers.CampaignController (xbytechat.api).
2025-07-02 17:36:06.125 +05:30 [INF] Executed DbCommand (24ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Campaigns" AS c
WHERE c."BusinessId" = @__businessId_0
2025-07-02 17:36:06.133 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__p_2='10', @__p_1='0'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Name", c."Status", c."ScheduledAt", c."CreatedAt"
FROM "Campaigns" AS c
WHERE c."BusinessId" = @__businessId_0
ORDER BY c."CreatedAt" DESC
LIMIT @__p_2 OFFSET @__p_1
2025-07-02 17:36:06.136 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Shared.PaginatedResponse`1[[xbytechat.api.Features.CampaignModule.DTOs.CampaignSummaryDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 17:36:06.138 +05:30 [INF] Executed action xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetPaginatedCampaigns (xbytechat.api) in 42.8294ms
2025-07-02 17:36:06.140 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetPaginatedCampaigns (xbytechat.api)'
2025-07-02 17:36:06.141 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/Campaign/paginated?page=1&pageSize=10&status= - 200 null application/json; charset=utf-8 56.1658ms
2025-07-02 17:39:56.420 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/cta-flow/all-draft - null null
2025-07-02 17:39:56.436 +05:30 [INF] CORS policy execution successful.
2025-07-02 17:39:56.438 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController.GetAllDraftFlows (xbytechat.api)'
2025-07-02 17:39:56.440 +05:30 [INF] Route matched with {action = "GetAllDraftFlows", controller = "CTAFlow"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllDraftFlows() on controller xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController (xbytechat.api).
2025-07-02 17:39:56.620 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."FlowName", c."CreatedAt", c."IsPublished"
FROM "CTAFlowConfigs" AS c
WHERE c."BusinessId" = @__businessId_0 AND NOT (c."IsPublished") AND c."IsActive"
ORDER BY c."CreatedAt" DESC
2025-07-02 17:39:56.624 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.CTAFlowBuilder.DTOs.VisualFlowSummaryDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 17:39:56.625 +05:30 [INF] Executed action xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController.GetAllDraftFlows (xbytechat.api) in 182.6137ms
2025-07-02 17:39:56.627 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController.GetAllDraftFlows (xbytechat.api)'
2025-07-02 17:39:56.629 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/cta-flow/all-draft - 200 null application/json; charset=utf-8 209.6044ms
2025-07-02 17:39:58.597 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/cta-flow/all-published - null null
2025-07-02 17:39:58.603 +05:30 [INF] CORS policy execution successful.
2025-07-02 17:39:58.607 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController.GetPublishedFlows (xbytechat.api)'
2025-07-02 17:39:58.608 +05:30 [INF] Route matched with {action = "GetPublishedFlows", controller = "CTAFlow"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPublishedFlows() on controller xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController (xbytechat.api).
2025-07-02 17:39:58.616 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."FlowName", c."IsPublished", c."CreatedAt"
FROM "CTAFlowConfigs" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."IsPublished"
ORDER BY c."CreatedAt" DESC
2025-07-02 17:39:58.627 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.CTAFlowBuilder.DTOs.VisualFlowSummaryDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 17:39:58.629 +05:30 [INF] Executed action xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController.GetPublishedFlows (xbytechat.api) in 17.093ms
2025-07-02 17:39:58.631 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController.GetPublishedFlows (xbytechat.api)'
2025-07-02 17:39:58.633 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/cta-flow/all-published - 200 null application/json; charset=utf-8 36.5997ms
2025-07-02 17:39:59.495 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/cta-flow/all-draft - null null
2025-07-02 17:39:59.499 +05:30 [INF] CORS policy execution successful.
2025-07-02 17:39:59.501 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController.GetAllDraftFlows (xbytechat.api)'
2025-07-02 17:39:59.502 +05:30 [INF] Route matched with {action = "GetAllDraftFlows", controller = "CTAFlow"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllDraftFlows() on controller xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController (xbytechat.api).
2025-07-02 17:39:59.507 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."FlowName", c."CreatedAt", c."IsPublished"
FROM "CTAFlowConfigs" AS c
WHERE c."BusinessId" = @__businessId_0 AND NOT (c."IsPublished") AND c."IsActive"
ORDER BY c."CreatedAt" DESC
2025-07-02 17:39:59.512 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.CTAFlowBuilder.DTOs.VisualFlowSummaryDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 17:39:59.515 +05:30 [INF] Executed action xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController.GetAllDraftFlows (xbytechat.api) in 10.8211ms
2025-07-02 17:39:59.517 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController.GetAllDraftFlows (xbytechat.api)'
2025-07-02 17:39:59.518 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/cta-flow/all-draft - 200 null application/json; charset=utf-8 23.1151ms
2025-07-02 17:48:37.741 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/auth/session - null null
2025-07-02 17:48:37.758 +05:30 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '02-07-2025 12:18:22 PM', Current time (UTC): '02-07-2025 12:18:37 PM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-07-02 17:48:37.828 +05:30 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '02-07-2025 12:18:22 PM', Current time (UTC): '02-07-2025 12:18:37 PM'.
2025-07-02 17:48:37.831 +05:30 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-07-02 17:48:37.884 +05:30 [ERR] ❌ An unhandled exception occurred
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ThrowResponseAlreadyStartedException(String value)
   at Microsoft.AspNetCore.Http.DefaultHttpResponse.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Authentication.JwtBearer.JwtBearerHandler.HandleChallengeAsync(AuthenticationProperties properties)
   at Microsoft.AspNetCore.Authentication.AuthenticationHandler`1.ChallengeAsync(AuthenticationProperties properties)
   at Microsoft.AspNetCore.Authentication.AuthenticationService.ChallengeAsync(HttpContext context, String scheme, AuthenticationProperties properties)
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.<>c__DisplayClass0_0.<<HandleAsync>g__Handle|0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at GlobalExceptionMiddleware.Invoke(HttpContext context) in D:\xbytechat\xbytechat-api\xbytechat-api\Middlewares\GlobalExceptionMiddleware.cs:line 32
2025-07-02 17:48:37.904 +05:30 [ERR] Response has already started, unable to write error response for path: /api/auth/session
2025-07-02 17:48:37.906 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/auth/session - 401 null application/json 164.6699ms
2025-07-02 17:51:14.626 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/api/auth/login - null null
2025-07-02 17:51:14.638 +05:30 [INF] CORS policy execution successful.
2025-07-02 17:51:14.641 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/api/auth/login - 204 null null 17.7499ms
2025-07-02 17:51:14.646 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/api/auth/login - application/json 47
2025-07-02 17:51:14.662 +05:30 [INF] CORS policy execution successful.
2025-07-02 17:51:14.665 +05:30 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '02-07-2025 12:18:22 PM', Current time (UTC): '02-07-2025 12:21:14 PM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-07-02 17:51:14.669 +05:30 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '02-07-2025 12:18:22 PM', Current time (UTC): '02-07-2025 12:21:14 PM'.
2025-07-02 17:51:14.671 +05:30 [INF] Executing endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.Login (xbytechat.api)'
2025-07-02 17:51:14.673 +05:30 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(xbytechat.api.AuthModule.DTOs.UserLoginDto) on controller xbytechat.api.AuthModule.Controllers.AuthController (xbytechat.api).
2025-07-02 17:51:14.682 +05:30 [INF] 🔑 Login attempt for email: ratan@tcs.com
2025-07-02 17:51:14.916 +05:30 [INF] Executed DbCommand (5ms) [Parameters=[@__dto_Email_0='ratan@tcs.com', @__hashedPassword_1='JAvlGPq9JyTdtvBO6x2llnRI1+gxwIyPqCKAn3THIKk='], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."BusinessId", u."CreatedAt", u."DeletedAt", u."Email", u."IsDeleted", u."Name", u."PasswordHash", u."RefreshToken", u."RefreshTokenExpiry", u."RoleId", u."Status", r."Id", r."CreatedAt", r."Description", r."IsActive", r."IsSystemDefined", r."Name"
FROM "Users" AS u
LEFT JOIN "Roles" AS r ON u."RoleId" = r."Id"
WHERE u."Email" = @__dto_Email_0 AND u."PasswordHash" = @__hashedPassword_1 AND NOT (u."IsDeleted")
LIMIT 1
2025-07-02 17:51:14.926 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__user_BusinessId_Value_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT b."Id", b."Address", b."ApprovedAt", b."ApprovedBy", b."BusinessEmail", b."BusinessName", b."CompanyName", b."CompanyPhone", b."CreatedAt", b."CreatedBy", b."CreatedByPartnerId", b."DeletedAt", b."DeletedBy", b."Industry", b."IsApproved", b."IsDeleted", b."LastLoginAt", b."LogoUrl", b."Notes", b."Phone", b."RepresentativeName", b."Source", b."Status", b."Tags", b."Website", b0."Id", b0."BusinessId", b0."CreatedAt", b0."Plan", b0."QuotaResetDate", b0."RemainingMessages", b0."TotalMonthlyQuota", b0."UpdatedAt", b0."WalletBalance"
FROM "Businesses" AS b
LEFT JOIN "BusinessPlanInfos" AS b0 ON b."Id" = b0."BusinessId"
WHERE b."Id" = @__user_BusinessId_Value_0
LIMIT 1
2025-07-02 17:51:14.933 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__user_RoleId_0='00000000-0000-0000-0000-000000000004' (Nullable = true)], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."AssignedAt", r."AssignedBy", r."IsActive", r."IsRevoked", r."PermissionId", r."RoleId"
FROM "RolePermissions" AS r
WHERE r."RoleId" = @__user_RoleId_0 AND NOT (r."IsRevoked")
2025-07-02 17:51:14.941 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='2870e1d8-0e80-4b12-88bd-70a8113307d6'], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."AssignedAt", u."AssignedBy", u."IsGranted", u."IsRevoked", u."PermissionId", u."UserId"
FROM "UserPermissions" AS u
WHERE u."UserId" = @__userId_0 AND NOT (u."IsRevoked")
2025-07-02 17:51:14.948 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__permissionIds_0={ '30000000-0000-0000-0000-000000000000', '30000000-0000-0000-0000-000000000004', '30000000-0000-0000-0000-000000000001', '30000000-0000-0000-0000-000000000007' } (DbType = Object)], CommandType='"Text"', CommandTimeout='30']
SELECT p."Id", p."Code", p."CreatedAt", p."Description", p."Group", p."IsActive", p."Name"
FROM "Permissions" AS p
WHERE p."Id" = ANY (@__permissionIds_0)
2025-07-02 17:51:14.954 +05:30 [INF] ✅ Token generated for: ratan@tcs.com
2025-07-02 17:51:15.080 +05:30 [INF] Executed action xbytechat.api.AuthModule.Controllers.AuthController.Login (xbytechat.api) in 400.6049ms
2025-07-02 17:51:15.083 +05:30 [INF] Executed endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.Login (xbytechat.api)'
2025-07-02 17:51:15.162 +05:30 [ERR] ❌ An unhandled exception occurred
System.InvalidOperationException: Headers are read-only, response has already started.
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpHeaders.ThrowHeadersReadOnlyException()
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpResponseHeaders.Microsoft.AspNetCore.Http.IHeaderDictionary.set_SetCookie(StringValues value)
   at Microsoft.AspNetCore.Http.ResponseCookies.Append(String key, String value, CookieOptions options)
   at xbytechat.api.AuthModule.Services.AuthService.LoginAsync(UserLoginDto dto) in D:\xbytechat\xbytechat-api\xbytechat-api\AuthModule\Services\AuthService.cs:line 462
   at xbytechat.api.AuthModule.Controllers.AuthController.Login(UserLoginDto dto) in D:\xbytechat\xbytechat-api\xbytechat-api\AuthModule\Controllers\AuthController.cs:line 29
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at GlobalExceptionMiddleware.Invoke(HttpContext context) in D:\xbytechat\xbytechat-api\xbytechat-api\Middlewares\GlobalExceptionMiddleware.cs:line 32
2025-07-02 17:51:15.175 +05:30 [ERR] Response has already started, unable to write error response for path: /api/auth/login
2025-07-02 17:51:15.177 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/api/auth/login - 401 null application/json 531.4354ms
2025-07-02 17:51:15.182 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/api/auth/refresh - null null
2025-07-02 17:51:15.187 +05:30 [INF] CORS policy execution successful.
2025-07-02 17:51:15.189 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/api/auth/refresh - 204 null null 7.7367ms
2025-07-02 17:51:15.191 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/api/auth/refresh - application/json 2
2025-07-02 17:51:15.199 +05:30 [INF] CORS policy execution successful.
2025-07-02 17:51:15.201 +05:30 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '02-07-2025 12:18:22 PM', Current time (UTC): '02-07-2025 12:21:15 PM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-07-02 17:51:15.205 +05:30 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '02-07-2025 12:18:22 PM', Current time (UTC): '02-07-2025 12:21:15 PM'.
2025-07-02 17:51:15.207 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/api/auth/refresh - 401 null application/json 16.0359ms
2025-07-02 17:51:15.213 +05:30 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: POST http://localhost:7113/api/auth/refresh, Response status code: 401
2025-07-02 17:51:16.683 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/auth/session - null null
2025-07-02 17:51:16.691 +05:30 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '02-07-2025 12:18:22 PM', Current time (UTC): '02-07-2025 12:21:16 PM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-07-02 17:51:16.697 +05:30 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '02-07-2025 12:18:22 PM', Current time (UTC): '02-07-2025 12:21:16 PM'.
2025-07-02 17:51:16.703 +05:30 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-07-02 17:51:16.741 +05:30 [ERR] ❌ An unhandled exception occurred
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ThrowResponseAlreadyStartedException(String value)
   at Microsoft.AspNetCore.Http.DefaultHttpResponse.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Authentication.JwtBearer.JwtBearerHandler.HandleChallengeAsync(AuthenticationProperties properties)
   at Microsoft.AspNetCore.Authentication.AuthenticationHandler`1.ChallengeAsync(AuthenticationProperties properties)
   at Microsoft.AspNetCore.Authentication.AuthenticationService.ChallengeAsync(HttpContext context, String scheme, AuthenticationProperties properties)
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.<>c__DisplayClass0_0.<<HandleAsync>g__Handle|0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at GlobalExceptionMiddleware.Invoke(HttpContext context) in D:\xbytechat\xbytechat-api\xbytechat-api\Middlewares\GlobalExceptionMiddleware.cs:line 32
2025-07-02 17:51:16.751 +05:30 [ERR] Response has already started, unable to write error response for path: /api/auth/session
2025-07-02 17:51:16.753 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/auth/session - 401 null application/json 70.1834ms
2025-07-02 17:51:31.160 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/api/auth/login - null null
2025-07-02 17:51:31.165 +05:30 [INF] CORS policy execution successful.
2025-07-02 17:51:31.167 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/api/auth/login - 204 null null 6.5061ms
2025-07-02 17:51:31.168 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/api/auth/login - application/json 47
2025-07-02 17:51:31.176 +05:30 [INF] CORS policy execution successful.
2025-07-02 17:51:31.178 +05:30 [INF] Executing endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.Login (xbytechat.api)'
2025-07-02 17:51:31.180 +05:30 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(xbytechat.api.AuthModule.DTOs.UserLoginDto) on controller xbytechat.api.AuthModule.Controllers.AuthController (xbytechat.api).
2025-07-02 17:51:31.185 +05:30 [INF] 🔑 Login attempt for email: ratan@tcs.com
2025-07-02 17:51:31.189 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__dto_Email_0='ratan@tcs.com', @__hashedPassword_1='JAvlGPq9JyTdtvBO6x2llnRI1+gxwIyPqCKAn3THIKk='], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."BusinessId", u."CreatedAt", u."DeletedAt", u."Email", u."IsDeleted", u."Name", u."PasswordHash", u."RefreshToken", u."RefreshTokenExpiry", u."RoleId", u."Status", r."Id", r."CreatedAt", r."Description", r."IsActive", r."IsSystemDefined", r."Name"
FROM "Users" AS u
LEFT JOIN "Roles" AS r ON u."RoleId" = r."Id"
WHERE u."Email" = @__dto_Email_0 AND u."PasswordHash" = @__hashedPassword_1 AND NOT (u."IsDeleted")
LIMIT 1
2025-07-02 17:51:31.199 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__user_BusinessId_Value_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT b."Id", b."Address", b."ApprovedAt", b."ApprovedBy", b."BusinessEmail", b."BusinessName", b."CompanyName", b."CompanyPhone", b."CreatedAt", b."CreatedBy", b."CreatedByPartnerId", b."DeletedAt", b."DeletedBy", b."Industry", b."IsApproved", b."IsDeleted", b."LastLoginAt", b."LogoUrl", b."Notes", b."Phone", b."RepresentativeName", b."Source", b."Status", b."Tags", b."Website", b0."Id", b0."BusinessId", b0."CreatedAt", b0."Plan", b0."QuotaResetDate", b0."RemainingMessages", b0."TotalMonthlyQuota", b0."UpdatedAt", b0."WalletBalance"
FROM "Businesses" AS b
LEFT JOIN "BusinessPlanInfos" AS b0 ON b."Id" = b0."BusinessId"
WHERE b."Id" = @__user_BusinessId_Value_0
LIMIT 1
2025-07-02 17:51:31.206 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__user_RoleId_0='00000000-0000-0000-0000-000000000004' (Nullable = true)], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."AssignedAt", r."AssignedBy", r."IsActive", r."IsRevoked", r."PermissionId", r."RoleId"
FROM "RolePermissions" AS r
WHERE r."RoleId" = @__user_RoleId_0 AND NOT (r."IsRevoked")
2025-07-02 17:51:31.213 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='2870e1d8-0e80-4b12-88bd-70a8113307d6'], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."AssignedAt", u."AssignedBy", u."IsGranted", u."IsRevoked", u."PermissionId", u."UserId"
FROM "UserPermissions" AS u
WHERE u."UserId" = @__userId_0 AND NOT (u."IsRevoked")
2025-07-02 17:51:31.220 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__permissionIds_0={ '30000000-0000-0000-0000-000000000000', '30000000-0000-0000-0000-000000000004', '30000000-0000-0000-0000-000000000001', '30000000-0000-0000-0000-000000000007' } (DbType = Object)], CommandType='"Text"', CommandTimeout='30']
SELECT p."Id", p."Code", p."CreatedAt", p."Description", p."Group", p."IsActive", p."Name"
FROM "Permissions" AS p
WHERE p."Id" = ANY (@__permissionIds_0)
2025-07-02 17:51:31.226 +05:30 [INF] ✅ Token generated for: ratan@tcs.com
2025-07-02 17:51:31.230 +05:30 [INF] ✅ Login successful for ratan@tcs.com, Role: business, Plan: Smart
2025-07-02 17:51:31.234 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`3[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 17:51:31.238 +05:30 [INF] Executed action xbytechat.api.AuthModule.Controllers.AuthController.Login (xbytechat.api) in 54.5866ms
2025-07-02 17:51:31.240 +05:30 [INF] Executed endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.Login (xbytechat.api)'
2025-07-02 17:51:31.243 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/api/auth/login - 200 null application/json; charset=utf-8 74.4959ms
2025-07-02 17:51:31.564 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/auth/session - null null
2025-07-02 17:51:31.571 +05:30 [INF] Executing endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 17:51:31.573 +05:30 [INF] Route matched with {action = "GetSession", controller = "Auth"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetSession() on controller xbytechat.api.AuthModule.Controllers.AuthController (xbytechat.api).
2025-07-02 17:51:31.580 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`4[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 17:51:31.582 +05:30 [INF] Executed action xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api) in 3.7138ms
2025-07-02 17:51:31.585 +05:30 [INF] Executed endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 17:51:31.587 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/auth/session - 200 null application/json; charset=utf-8 23.0699ms
2025-07-02 17:51:31.825 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/feature-access/me - null null
2025-07-02 17:51:31.829 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 17:51:31.831 +05:30 [INF] Route matched with {action = "GetMyFeatures", controller = "FeatureAccess"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto]]] GetMyFeatures() on controller xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController (xbytechat.api).
2025-07-02 17:51:31.838 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT b."Id", b."Address", b."ApprovedAt", b."ApprovedBy", b."BusinessEmail", b."BusinessName", b."CompanyName", b."CompanyPhone", b."CreatedAt", b."CreatedBy", b."CreatedByPartnerId", b."DeletedAt", b."DeletedBy", b."Industry", b."IsApproved", b."IsDeleted", b."LastLoginAt", b."LogoUrl", b."Notes", b."Phone", b."RepresentativeName", b."Source", b."Status", b."Tags", b."Website", b0."Id", b0."BusinessId", b0."CreatedAt", b0."Plan", b0."QuotaResetDate", b0."RemainingMessages", b0."TotalMonthlyQuota", b0."UpdatedAt", b0."WalletBalance"
FROM "Businesses" AS b
LEFT JOIN "BusinessPlanInfos" AS b0 ON b."Id" = b0."BusinessId"
WHERE b."Id" = @__businessId_0
LIMIT 1
2025-07-02 17:51:31.845 +05:30 [INF] 📦 Resolved plan for Business "c13be597-6ae2-42bb-9d43-925815f24ff8": Smart
2025-07-02 17:51:31.851 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."BusinessId", f."CreatedAt", f."Description", f."FeatureName", f."Group", f."IsEnabled", f."Notes", f."Plan"
FROM "FeatureAccess" AS f
WHERE f."BusinessId" = @__businessId_0
2025-07-02 17:51:31.855 +05:30 [INF] 🔧 Feature override: AddProduct = False
2025-07-02 17:51:31.856 +05:30 [INF] 🔧 Feature override: Campaigns = True
2025-07-02 17:51:31.857 +05:30 [INF] 🔧 Feature override: Catalog = True
2025-07-02 17:51:31.859 +05:30 [INF] 🔧 Feature override: CRM = True
2025-07-02 17:51:31.860 +05:30 [INF] 🔧 Feature override: CRMInsights = True
2025-07-02 17:51:31.861 +05:30 [INF] 🔧 Feature override: CTAFlow = True
2025-07-02 17:51:31.863 +05:30 [INF] 🔧 Feature override: FlowInsights = True
2025-07-02 17:51:31.864 +05:30 [INF] 🔧 Feature override: Messaging = True
2025-07-02 17:51:31.865 +05:30 [INF] 🔧 Feature override: ProfileCompletion = True
2025-07-02 17:51:31.867 +05:30 [INF] 🔧 Feature override: UpgradePlan = True
2025-07-02 17:51:31.868 +05:30 [INF] 🔧 Feature override: WhatsAppSettings = True
2025-07-02 17:51:31.871 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 17:51:31.873 +05:30 [INF] Executed action xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api) in 38.7795ms
2025-07-02 17:51:31.876 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 17:51:31.878 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/feature-access/me - 200 null application/json; charset=utf-8 53.7067ms
2025-07-02 17:51:34.416 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/api/auth/login - application/json 47
2025-07-02 17:51:34.421 +05:30 [INF] CORS policy execution successful.
2025-07-02 17:51:34.423 +05:30 [INF] Executing endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.Login (xbytechat.api)'
2025-07-02 17:51:34.428 +05:30 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(xbytechat.api.AuthModule.DTOs.UserLoginDto) on controller xbytechat.api.AuthModule.Controllers.AuthController (xbytechat.api).
2025-07-02 17:51:34.432 +05:30 [INF] 🔑 Login attempt for email: ratan@tcs.com
2025-07-02 17:51:34.437 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__dto_Email_0='ratan@tcs.com', @__hashedPassword_1='JAvlGPq9JyTdtvBO6x2llnRI1+gxwIyPqCKAn3THIKk='], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."BusinessId", u."CreatedAt", u."DeletedAt", u."Email", u."IsDeleted", u."Name", u."PasswordHash", u."RefreshToken", u."RefreshTokenExpiry", u."RoleId", u."Status", r."Id", r."CreatedAt", r."Description", r."IsActive", r."IsSystemDefined", r."Name"
FROM "Users" AS u
LEFT JOIN "Roles" AS r ON u."RoleId" = r."Id"
WHERE u."Email" = @__dto_Email_0 AND u."PasswordHash" = @__hashedPassword_1 AND NOT (u."IsDeleted")
LIMIT 1
2025-07-02 17:51:34.449 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__user_BusinessId_Value_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT b."Id", b."Address", b."ApprovedAt", b."ApprovedBy", b."BusinessEmail", b."BusinessName", b."CompanyName", b."CompanyPhone", b."CreatedAt", b."CreatedBy", b."CreatedByPartnerId", b."DeletedAt", b."DeletedBy", b."Industry", b."IsApproved", b."IsDeleted", b."LastLoginAt", b."LogoUrl", b."Notes", b."Phone", b."RepresentativeName", b."Source", b."Status", b."Tags", b."Website", b0."Id", b0."BusinessId", b0."CreatedAt", b0."Plan", b0."QuotaResetDate", b0."RemainingMessages", b0."TotalMonthlyQuota", b0."UpdatedAt", b0."WalletBalance"
FROM "Businesses" AS b
LEFT JOIN "BusinessPlanInfos" AS b0 ON b."Id" = b0."BusinessId"
WHERE b."Id" = @__user_BusinessId_Value_0
LIMIT 1
2025-07-02 17:51:34.457 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__user_RoleId_0='00000000-0000-0000-0000-000000000004' (Nullable = true)], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."AssignedAt", r."AssignedBy", r."IsActive", r."IsRevoked", r."PermissionId", r."RoleId"
FROM "RolePermissions" AS r
WHERE r."RoleId" = @__user_RoleId_0 AND NOT (r."IsRevoked")
2025-07-02 17:51:34.464 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='2870e1d8-0e80-4b12-88bd-70a8113307d6'], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."AssignedAt", u."AssignedBy", u."IsGranted", u."IsRevoked", u."PermissionId", u."UserId"
FROM "UserPermissions" AS u
WHERE u."UserId" = @__userId_0 AND NOT (u."IsRevoked")
2025-07-02 17:51:34.471 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__permissionIds_0={ '30000000-0000-0000-0000-000000000000', '30000000-0000-0000-0000-000000000004', '30000000-0000-0000-0000-000000000001', '30000000-0000-0000-0000-000000000007' } (DbType = Object)], CommandType='"Text"', CommandTimeout='30']
SELECT p."Id", p."Code", p."CreatedAt", p."Description", p."Group", p."IsActive", p."Name"
FROM "Permissions" AS p
WHERE p."Id" = ANY (@__permissionIds_0)
2025-07-02 17:51:34.479 +05:30 [INF] ✅ Token generated for: ratan@tcs.com
2025-07-02 17:51:34.481 +05:30 [INF] ✅ Login successful for ratan@tcs.com, Role: business, Plan: Smart
2025-07-02 17:51:34.483 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`3[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 17:51:34.486 +05:30 [INF] Executed action xbytechat.api.AuthModule.Controllers.AuthController.Login (xbytechat.api) in 54.5441ms
2025-07-02 17:51:34.489 +05:30 [INF] Executed endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.Login (xbytechat.api)'
2025-07-02 17:51:34.492 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/api/auth/login - 200 null application/json; charset=utf-8 75.5637ms
2025-07-02 17:51:34.504 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/auth/session - null null
2025-07-02 17:51:34.509 +05:30 [INF] Executing endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 17:51:34.512 +05:30 [INF] Route matched with {action = "GetSession", controller = "Auth"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetSession() on controller xbytechat.api.AuthModule.Controllers.AuthController (xbytechat.api).
2025-07-02 17:51:34.516 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`4[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 17:51:34.518 +05:30 [INF] Executed action xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api) in 2.961ms
2025-07-02 17:51:34.520 +05:30 [INF] Executed endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 17:51:34.522 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/auth/session - 200 null application/json; charset=utf-8 18.3117ms
2025-07-02 17:51:34.855 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/feature-access/me - null null
2025-07-02 17:51:34.861 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 17:51:34.863 +05:30 [INF] Route matched with {action = "GetMyFeatures", controller = "FeatureAccess"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto]]] GetMyFeatures() on controller xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController (xbytechat.api).
2025-07-02 17:51:34.869 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT b."Id", b."Address", b."ApprovedAt", b."ApprovedBy", b."BusinessEmail", b."BusinessName", b."CompanyName", b."CompanyPhone", b."CreatedAt", b."CreatedBy", b."CreatedByPartnerId", b."DeletedAt", b."DeletedBy", b."Industry", b."IsApproved", b."IsDeleted", b."LastLoginAt", b."LogoUrl", b."Notes", b."Phone", b."RepresentativeName", b."Source", b."Status", b."Tags", b."Website", b0."Id", b0."BusinessId", b0."CreatedAt", b0."Plan", b0."QuotaResetDate", b0."RemainingMessages", b0."TotalMonthlyQuota", b0."UpdatedAt", b0."WalletBalance"
FROM "Businesses" AS b
LEFT JOIN "BusinessPlanInfos" AS b0 ON b."Id" = b0."BusinessId"
WHERE b."Id" = @__businessId_0
LIMIT 1
2025-07-02 17:51:34.875 +05:30 [INF] 📦 Resolved plan for Business "c13be597-6ae2-42bb-9d43-925815f24ff8": Smart
2025-07-02 17:51:34.880 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."BusinessId", f."CreatedAt", f."Description", f."FeatureName", f."Group", f."IsEnabled", f."Notes", f."Plan"
FROM "FeatureAccess" AS f
WHERE f."BusinessId" = @__businessId_0
2025-07-02 17:51:34.884 +05:30 [INF] 🔧 Feature override: AddProduct = False
2025-07-02 17:51:34.886 +05:30 [INF] 🔧 Feature override: Campaigns = True
2025-07-02 17:51:34.887 +05:30 [INF] 🔧 Feature override: Catalog = True
2025-07-02 17:51:34.889 +05:30 [INF] 🔧 Feature override: CRM = True
2025-07-02 17:51:34.890 +05:30 [INF] 🔧 Feature override: CRMInsights = True
2025-07-02 17:51:34.894 +05:30 [INF] 🔧 Feature override: CTAFlow = True
2025-07-02 17:51:34.896 +05:30 [INF] 🔧 Feature override: FlowInsights = True
2025-07-02 17:51:34.898 +05:30 [INF] 🔧 Feature override: Messaging = True
2025-07-02 17:51:34.901 +05:30 [INF] 🔧 Feature override: ProfileCompletion = True
2025-07-02 17:51:34.903 +05:30 [INF] 🔧 Feature override: UpgradePlan = True
2025-07-02 17:51:34.905 +05:30 [INF] 🔧 Feature override: WhatsAppSettings = True
2025-07-02 17:51:34.908 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 17:51:34.910 +05:30 [INF] Executed action xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api) in 44.3444ms
2025-07-02 17:51:34.913 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 17:51:34.916 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/feature-access/me - 200 null application/json; charset=utf-8 60.3362ms
2025-07-02 17:55:10.614 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/auth/session - null null
2025-07-02 17:55:10.626 +05:30 [INF] Executing endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 17:55:10.628 +05:30 [INF] Route matched with {action = "GetSession", controller = "Auth"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetSession() on controller xbytechat.api.AuthModule.Controllers.AuthController (xbytechat.api).
2025-07-02 17:55:10.631 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`4[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 17:55:10.634 +05:30 [INF] Executed action xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api) in 3.294ms
2025-07-02 17:55:10.637 +05:30 [INF] Executed endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 17:55:10.639 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/auth/session - 200 null application/json; charset=utf-8 25.4296ms
2025-07-02 17:55:10.738 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/feature-access/me - null null
2025-07-02 17:55:10.745 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 17:55:10.747 +05:30 [INF] Route matched with {action = "GetMyFeatures", controller = "FeatureAccess"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto]]] GetMyFeatures() on controller xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController (xbytechat.api).
2025-07-02 17:55:10.756 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT b."Id", b."Address", b."ApprovedAt", b."ApprovedBy", b."BusinessEmail", b."BusinessName", b."CompanyName", b."CompanyPhone", b."CreatedAt", b."CreatedBy", b."CreatedByPartnerId", b."DeletedAt", b."DeletedBy", b."Industry", b."IsApproved", b."IsDeleted", b."LastLoginAt", b."LogoUrl", b."Notes", b."Phone", b."RepresentativeName", b."Source", b."Status", b."Tags", b."Website", b0."Id", b0."BusinessId", b0."CreatedAt", b0."Plan", b0."QuotaResetDate", b0."RemainingMessages", b0."TotalMonthlyQuota", b0."UpdatedAt", b0."WalletBalance"
FROM "Businesses" AS b
LEFT JOIN "BusinessPlanInfos" AS b0 ON b."Id" = b0."BusinessId"
WHERE b."Id" = @__businessId_0
LIMIT 1
2025-07-02 17:55:10.763 +05:30 [INF] 📦 Resolved plan for Business "c13be597-6ae2-42bb-9d43-925815f24ff8": Smart
2025-07-02 17:55:10.768 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."BusinessId", f."CreatedAt", f."Description", f."FeatureName", f."Group", f."IsEnabled", f."Notes", f."Plan"
FROM "FeatureAccess" AS f
WHERE f."BusinessId" = @__businessId_0
2025-07-02 17:55:10.772 +05:30 [INF] 🔧 Feature override: AddProduct = False
2025-07-02 17:55:10.774 +05:30 [INF] 🔧 Feature override: Campaigns = True
2025-07-02 17:55:10.775 +05:30 [INF] 🔧 Feature override: Catalog = True
2025-07-02 17:55:10.776 +05:30 [INF] 🔧 Feature override: CRM = True
2025-07-02 17:55:10.778 +05:30 [INF] 🔧 Feature override: CRMInsights = True
2025-07-02 17:55:10.780 +05:30 [INF] 🔧 Feature override: CTAFlow = True
2025-07-02 17:55:10.781 +05:30 [INF] 🔧 Feature override: FlowInsights = True
2025-07-02 17:55:10.783 +05:30 [INF] 🔧 Feature override: Messaging = True
2025-07-02 17:55:10.784 +05:30 [INF] 🔧 Feature override: ProfileCompletion = True
2025-07-02 17:55:10.786 +05:30 [INF] 🔧 Feature override: UpgradePlan = True
2025-07-02 17:55:10.788 +05:30 [INF] 🔧 Feature override: WhatsAppSettings = True
2025-07-02 17:55:10.792 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 17:55:10.794 +05:30 [INF] Executed action xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api) in 41.4831ms
2025-07-02 17:55:10.796 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 17:55:10.798 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/feature-access/me - 200 null application/json; charset=utf-8 59.428ms
2025-07-02 17:55:40.989 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/auth/session - null null
2025-07-02 17:55:41.002 +05:30 [INF] Executing endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 17:55:41.004 +05:30 [INF] Route matched with {action = "GetSession", controller = "Auth"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetSession() on controller xbytechat.api.AuthModule.Controllers.AuthController (xbytechat.api).
2025-07-02 17:55:41.008 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`4[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 17:55:41.012 +05:30 [INF] Executed action xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api) in 3.8029ms
2025-07-02 17:55:41.014 +05:30 [INF] Executed endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 17:55:41.016 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/auth/session - 200 null application/json; charset=utf-8 27.2232ms
2025-07-02 17:55:41.052 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/feature-access/me - null null
2025-07-02 17:55:41.059 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 17:55:41.063 +05:30 [INF] Route matched with {action = "GetMyFeatures", controller = "FeatureAccess"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto]]] GetMyFeatures() on controller xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController (xbytechat.api).
2025-07-02 17:55:41.072 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT b."Id", b."Address", b."ApprovedAt", b."ApprovedBy", b."BusinessEmail", b."BusinessName", b."CompanyName", b."CompanyPhone", b."CreatedAt", b."CreatedBy", b."CreatedByPartnerId", b."DeletedAt", b."DeletedBy", b."Industry", b."IsApproved", b."IsDeleted", b."LastLoginAt", b."LogoUrl", b."Notes", b."Phone", b."RepresentativeName", b."Source", b."Status", b."Tags", b."Website", b0."Id", b0."BusinessId", b0."CreatedAt", b0."Plan", b0."QuotaResetDate", b0."RemainingMessages", b0."TotalMonthlyQuota", b0."UpdatedAt", b0."WalletBalance"
FROM "Businesses" AS b
LEFT JOIN "BusinessPlanInfos" AS b0 ON b."Id" = b0."BusinessId"
WHERE b."Id" = @__businessId_0
LIMIT 1
2025-07-02 17:55:41.080 +05:30 [INF] 📦 Resolved plan for Business "c13be597-6ae2-42bb-9d43-925815f24ff8": Smart
2025-07-02 17:55:41.085 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."BusinessId", f."CreatedAt", f."Description", f."FeatureName", f."Group", f."IsEnabled", f."Notes", f."Plan"
FROM "FeatureAccess" AS f
WHERE f."BusinessId" = @__businessId_0
2025-07-02 17:55:41.090 +05:30 [INF] 🔧 Feature override: AddProduct = False
2025-07-02 17:55:41.091 +05:30 [INF] 🔧 Feature override: Campaigns = True
2025-07-02 17:55:41.092 +05:30 [INF] 🔧 Feature override: Catalog = True
2025-07-02 17:55:41.094 +05:30 [INF] 🔧 Feature override: CRM = True
2025-07-02 17:55:41.096 +05:30 [INF] 🔧 Feature override: CRMInsights = True
2025-07-02 17:55:41.097 +05:30 [INF] 🔧 Feature override: CTAFlow = True
2025-07-02 17:55:41.099 +05:30 [INF] 🔧 Feature override: FlowInsights = True
2025-07-02 17:55:41.101 +05:30 [INF] 🔧 Feature override: Messaging = True
2025-07-02 17:55:41.102 +05:30 [INF] 🔧 Feature override: ProfileCompletion = True
2025-07-02 17:55:41.103 +05:30 [INF] 🔧 Feature override: UpgradePlan = True
2025-07-02 17:55:41.105 +05:30 [INF] 🔧 Feature override: WhatsAppSettings = True
2025-07-02 17:55:41.107 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 17:55:41.110 +05:30 [INF] Executed action xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api) in 41.1862ms
2025-07-02 17:55:41.112 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 17:55:41.115 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/feature-access/me - 200 null application/json; charset=utf-8 62.371ms
2025-07-02 18:02:43.634 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/auth/session - null null
2025-07-02 18:02:43.646 +05:30 [INF] Executing endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 18:02:43.648 +05:30 [INF] Route matched with {action = "GetSession", controller = "Auth"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetSession() on controller xbytechat.api.AuthModule.Controllers.AuthController (xbytechat.api).
2025-07-02 18:02:43.652 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`4[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 18:02:43.654 +05:30 [INF] Executed action xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api) in 3.1041ms
2025-07-02 18:02:43.656 +05:30 [INF] Executed endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 18:02:43.659 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/auth/session - 200 null application/json; charset=utf-8 26.117ms
2025-07-02 18:02:43.764 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/feature-access/me - null null
2025-07-02 18:02:43.770 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 18:02:43.772 +05:30 [INF] Route matched with {action = "GetMyFeatures", controller = "FeatureAccess"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto]]] GetMyFeatures() on controller xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController (xbytechat.api).
2025-07-02 18:02:44.025 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT b."Id", b."Address", b."ApprovedAt", b."ApprovedBy", b."BusinessEmail", b."BusinessName", b."CompanyName", b."CompanyPhone", b."CreatedAt", b."CreatedBy", b."CreatedByPartnerId", b."DeletedAt", b."DeletedBy", b."Industry", b."IsApproved", b."IsDeleted", b."LastLoginAt", b."LogoUrl", b."Notes", b."Phone", b."RepresentativeName", b."Source", b."Status", b."Tags", b."Website", b0."Id", b0."BusinessId", b0."CreatedAt", b0."Plan", b0."QuotaResetDate", b0."RemainingMessages", b0."TotalMonthlyQuota", b0."UpdatedAt", b0."WalletBalance"
FROM "Businesses" AS b
LEFT JOIN "BusinessPlanInfos" AS b0 ON b."Id" = b0."BusinessId"
WHERE b."Id" = @__businessId_0
LIMIT 1
2025-07-02 18:02:44.031 +05:30 [INF] 📦 Resolved plan for Business "c13be597-6ae2-42bb-9d43-925815f24ff8": Smart
2025-07-02 18:02:44.035 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."BusinessId", f."CreatedAt", f."Description", f."FeatureName", f."Group", f."IsEnabled", f."Notes", f."Plan"
FROM "FeatureAccess" AS f
WHERE f."BusinessId" = @__businessId_0
2025-07-02 18:02:44.039 +05:30 [INF] 🔧 Feature override: AddProduct = False
2025-07-02 18:02:44.041 +05:30 [INF] 🔧 Feature override: Campaigns = True
2025-07-02 18:02:44.044 +05:30 [INF] 🔧 Feature override: Catalog = True
2025-07-02 18:02:44.045 +05:30 [INF] 🔧 Feature override: CRM = True
2025-07-02 18:02:44.046 +05:30 [INF] 🔧 Feature override: CRMInsights = True
2025-07-02 18:02:44.047 +05:30 [INF] 🔧 Feature override: CTAFlow = True
2025-07-02 18:02:44.048 +05:30 [INF] 🔧 Feature override: FlowInsights = True
2025-07-02 18:02:44.050 +05:30 [INF] 🔧 Feature override: Messaging = True
2025-07-02 18:02:44.051 +05:30 [INF] 🔧 Feature override: ProfileCompletion = True
2025-07-02 18:02:44.052 +05:30 [INF] 🔧 Feature override: UpgradePlan = True
2025-07-02 18:02:44.053 +05:30 [INF] 🔧 Feature override: WhatsAppSettings = True
2025-07-02 18:02:44.056 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 18:02:44.058 +05:30 [INF] Executed action xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api) in 282.32ms
2025-07-02 18:02:44.061 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 18:02:44.063 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/feature-access/me - 200 null application/json; charset=utf-8 299.4988ms
2025-07-02 18:03:30.406 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/auth/session - null null
2025-07-02 18:03:30.416 +05:30 [INF] Executing endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 18:03:30.418 +05:30 [INF] Route matched with {action = "GetSession", controller = "Auth"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetSession() on controller xbytechat.api.AuthModule.Controllers.AuthController (xbytechat.api).
2025-07-02 18:03:30.423 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`4[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 18:03:30.425 +05:30 [INF] Executed action xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api) in 3.6556ms
2025-07-02 18:03:30.428 +05:30 [INF] Executed endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 18:03:30.430 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/auth/session - 200 null application/json; charset=utf-8 24.1267ms
2025-07-02 18:03:30.457 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/feature-access/me - null null
2025-07-02 18:03:30.465 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 18:03:30.470 +05:30 [INF] Route matched with {action = "GetMyFeatures", controller = "FeatureAccess"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto]]] GetMyFeatures() on controller xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController (xbytechat.api).
2025-07-02 18:03:30.481 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT b."Id", b."Address", b."ApprovedAt", b."ApprovedBy", b."BusinessEmail", b."BusinessName", b."CompanyName", b."CompanyPhone", b."CreatedAt", b."CreatedBy", b."CreatedByPartnerId", b."DeletedAt", b."DeletedBy", b."Industry", b."IsApproved", b."IsDeleted", b."LastLoginAt", b."LogoUrl", b."Notes", b."Phone", b."RepresentativeName", b."Source", b."Status", b."Tags", b."Website", b0."Id", b0."BusinessId", b0."CreatedAt", b0."Plan", b0."QuotaResetDate", b0."RemainingMessages", b0."TotalMonthlyQuota", b0."UpdatedAt", b0."WalletBalance"
FROM "Businesses" AS b
LEFT JOIN "BusinessPlanInfos" AS b0 ON b."Id" = b0."BusinessId"
WHERE b."Id" = @__businessId_0
LIMIT 1
2025-07-02 18:03:30.494 +05:30 [INF] 📦 Resolved plan for Business "c13be597-6ae2-42bb-9d43-925815f24ff8": Smart
2025-07-02 18:03:30.499 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."BusinessId", f."CreatedAt", f."Description", f."FeatureName", f."Group", f."IsEnabled", f."Notes", f."Plan"
FROM "FeatureAccess" AS f
WHERE f."BusinessId" = @__businessId_0
2025-07-02 18:03:30.503 +05:30 [INF] 🔧 Feature override: AddProduct = False
2025-07-02 18:03:30.505 +05:30 [INF] 🔧 Feature override: Campaigns = True
2025-07-02 18:03:30.506 +05:30 [INF] 🔧 Feature override: Catalog = True
2025-07-02 18:03:30.508 +05:30 [INF] 🔧 Feature override: CRM = True
2025-07-02 18:03:30.510 +05:30 [INF] 🔧 Feature override: CRMInsights = True
2025-07-02 18:03:30.511 +05:30 [INF] 🔧 Feature override: CTAFlow = True
2025-07-02 18:03:30.513 +05:30 [INF] 🔧 Feature override: FlowInsights = True
2025-07-02 18:03:30.515 +05:30 [INF] 🔧 Feature override: Messaging = True
2025-07-02 18:03:30.516 +05:30 [INF] 🔧 Feature override: ProfileCompletion = True
2025-07-02 18:03:30.517 +05:30 [INF] 🔧 Feature override: UpgradePlan = True
2025-07-02 18:03:30.519 +05:30 [INF] 🔧 Feature override: WhatsAppSettings = True
2025-07-02 18:03:30.523 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 18:03:30.525 +05:30 [INF] Executed action xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api) in 50.5165ms
2025-07-02 18:03:30.527 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 18:03:30.529 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/feature-access/me - 200 null application/json; charset=utf-8 71.7283ms
2025-07-02 18:04:02.409 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/auth/session - null null
2025-07-02 18:04:02.423 +05:30 [INF] Executing endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 18:04:02.425 +05:30 [INF] Route matched with {action = "GetSession", controller = "Auth"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetSession() on controller xbytechat.api.AuthModule.Controllers.AuthController (xbytechat.api).
2025-07-02 18:04:02.432 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`4[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 18:04:02.440 +05:30 [INF] Executed action xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api) in 9.0865ms
2025-07-02 18:04:02.442 +05:30 [INF] Executed endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 18:04:02.446 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/auth/session - 200 null application/json; charset=utf-8 36.919ms
2025-07-02 18:04:02.468 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/feature-access/me - null null
2025-07-02 18:04:02.499 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 18:04:02.500 +05:30 [INF] Route matched with {action = "GetMyFeatures", controller = "FeatureAccess"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto]]] GetMyFeatures() on controller xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController (xbytechat.api).
2025-07-02 18:04:02.507 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT b."Id", b."Address", b."ApprovedAt", b."ApprovedBy", b."BusinessEmail", b."BusinessName", b."CompanyName", b."CompanyPhone", b."CreatedAt", b."CreatedBy", b."CreatedByPartnerId", b."DeletedAt", b."DeletedBy", b."Industry", b."IsApproved", b."IsDeleted", b."LastLoginAt", b."LogoUrl", b."Notes", b."Phone", b."RepresentativeName", b."Source", b."Status", b."Tags", b."Website", b0."Id", b0."BusinessId", b0."CreatedAt", b0."Plan", b0."QuotaResetDate", b0."RemainingMessages", b0."TotalMonthlyQuota", b0."UpdatedAt", b0."WalletBalance"
FROM "Businesses" AS b
LEFT JOIN "BusinessPlanInfos" AS b0 ON b."Id" = b0."BusinessId"
WHERE b."Id" = @__businessId_0
LIMIT 1
2025-07-02 18:04:02.519 +05:30 [INF] 📦 Resolved plan for Business "c13be597-6ae2-42bb-9d43-925815f24ff8": Smart
2025-07-02 18:04:02.523 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."BusinessId", f."CreatedAt", f."Description", f."FeatureName", f."Group", f."IsEnabled", f."Notes", f."Plan"
FROM "FeatureAccess" AS f
WHERE f."BusinessId" = @__businessId_0
2025-07-02 18:04:02.527 +05:30 [INF] 🔧 Feature override: AddProduct = False
2025-07-02 18:04:02.529 +05:30 [INF] 🔧 Feature override: Campaigns = True
2025-07-02 18:04:02.530 +05:30 [INF] 🔧 Feature override: Catalog = True
2025-07-02 18:04:02.531 +05:30 [INF] 🔧 Feature override: CRM = True
2025-07-02 18:04:02.532 +05:30 [INF] 🔧 Feature override: CRMInsights = True
2025-07-02 18:04:02.534 +05:30 [INF] 🔧 Feature override: CTAFlow = True
2025-07-02 18:04:02.535 +05:30 [INF] 🔧 Feature override: FlowInsights = True
2025-07-02 18:04:02.536 +05:30 [INF] 🔧 Feature override: Messaging = True
2025-07-02 18:04:02.537 +05:30 [INF] 🔧 Feature override: ProfileCompletion = True
2025-07-02 18:04:02.539 +05:30 [INF] 🔧 Feature override: UpgradePlan = True
2025-07-02 18:04:02.540 +05:30 [INF] 🔧 Feature override: WhatsAppSettings = True
2025-07-02 18:04:02.543 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 18:04:02.545 +05:30 [INF] Executed action xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api) in 42.1223ms
2025-07-02 18:04:02.548 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 18:04:02.550 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/feature-access/me - 200 null application/json; charset=utf-8 81.4178ms
2025-07-02 18:05:00.385 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/auth/session - null null
2025-07-02 18:05:00.391 +05:30 [INF] Executing endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 18:05:00.393 +05:30 [INF] Route matched with {action = "GetSession", controller = "Auth"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetSession() on controller xbytechat.api.AuthModule.Controllers.AuthController (xbytechat.api).
2025-07-02 18:05:00.398 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`4[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 18:05:00.402 +05:30 [INF] Executed action xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api) in 4.5941ms
2025-07-02 18:05:00.405 +05:30 [INF] Executed endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 18:05:00.407 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/auth/session - 200 null application/json; charset=utf-8 21.8262ms
2025-07-02 18:05:00.452 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/feature-access/me - null null
2025-07-02 18:05:00.460 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 18:05:00.464 +05:30 [INF] Route matched with {action = "GetMyFeatures", controller = "FeatureAccess"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto]]] GetMyFeatures() on controller xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController (xbytechat.api).
2025-07-02 18:05:00.474 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT b."Id", b."Address", b."ApprovedAt", b."ApprovedBy", b."BusinessEmail", b."BusinessName", b."CompanyName", b."CompanyPhone", b."CreatedAt", b."CreatedBy", b."CreatedByPartnerId", b."DeletedAt", b."DeletedBy", b."Industry", b."IsApproved", b."IsDeleted", b."LastLoginAt", b."LogoUrl", b."Notes", b."Phone", b."RepresentativeName", b."Source", b."Status", b."Tags", b."Website", b0."Id", b0."BusinessId", b0."CreatedAt", b0."Plan", b0."QuotaResetDate", b0."RemainingMessages", b0."TotalMonthlyQuota", b0."UpdatedAt", b0."WalletBalance"
FROM "Businesses" AS b
LEFT JOIN "BusinessPlanInfos" AS b0 ON b."Id" = b0."BusinessId"
WHERE b."Id" = @__businessId_0
LIMIT 1
2025-07-02 18:05:00.481 +05:30 [INF] 📦 Resolved plan for Business "c13be597-6ae2-42bb-9d43-925815f24ff8": Smart
2025-07-02 18:05:00.486 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."BusinessId", f."CreatedAt", f."Description", f."FeatureName", f."Group", f."IsEnabled", f."Notes", f."Plan"
FROM "FeatureAccess" AS f
WHERE f."BusinessId" = @__businessId_0
2025-07-02 18:05:00.490 +05:30 [INF] 🔧 Feature override: AddProduct = False
2025-07-02 18:05:00.491 +05:30 [INF] 🔧 Feature override: Campaigns = True
2025-07-02 18:05:00.493 +05:30 [INF] 🔧 Feature override: Catalog = True
2025-07-02 18:05:00.494 +05:30 [INF] 🔧 Feature override: CRM = True
2025-07-02 18:05:00.496 +05:30 [INF] 🔧 Feature override: CRMInsights = True
2025-07-02 18:05:00.497 +05:30 [INF] 🔧 Feature override: CTAFlow = True
2025-07-02 18:05:00.499 +05:30 [INF] 🔧 Feature override: FlowInsights = True
2025-07-02 18:05:00.501 +05:30 [INF] 🔧 Feature override: Messaging = True
2025-07-02 18:05:00.502 +05:30 [INF] 🔧 Feature override: ProfileCompletion = True
2025-07-02 18:05:00.503 +05:30 [INF] 🔧 Feature override: UpgradePlan = True
2025-07-02 18:05:00.505 +05:30 [INF] 🔧 Feature override: WhatsAppSettings = True
2025-07-02 18:05:00.507 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 18:05:00.510 +05:30 [INF] Executed action xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api) in 41.2967ms
2025-07-02 18:05:00.512 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 18:05:00.514 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/feature-access/me - 200 null application/json; charset=utf-8 62.037ms
2025-07-02 18:05:08.612 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/auth/session - null null
2025-07-02 18:05:08.618 +05:30 [INF] Executing endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 18:05:08.621 +05:30 [INF] Route matched with {action = "GetSession", controller = "Auth"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetSession() on controller xbytechat.api.AuthModule.Controllers.AuthController (xbytechat.api).
2025-07-02 18:05:08.626 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`4[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 18:05:08.629 +05:30 [INF] Executed action xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api) in 4.1574ms
2025-07-02 18:05:08.632 +05:30 [INF] Executed endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 18:05:08.634 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/auth/session - 200 null application/json; charset=utf-8 22.7863ms
2025-07-02 18:05:08.691 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/feature-access/me - null null
2025-07-02 18:05:08.697 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 18:05:08.700 +05:30 [INF] Route matched with {action = "GetMyFeatures", controller = "FeatureAccess"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto]]] GetMyFeatures() on controller xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController (xbytechat.api).
2025-07-02 18:05:08.709 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT b."Id", b."Address", b."ApprovedAt", b."ApprovedBy", b."BusinessEmail", b."BusinessName", b."CompanyName", b."CompanyPhone", b."CreatedAt", b."CreatedBy", b."CreatedByPartnerId", b."DeletedAt", b."DeletedBy", b."Industry", b."IsApproved", b."IsDeleted", b."LastLoginAt", b."LogoUrl", b."Notes", b."Phone", b."RepresentativeName", b."Source", b."Status", b."Tags", b."Website", b0."Id", b0."BusinessId", b0."CreatedAt", b0."Plan", b0."QuotaResetDate", b0."RemainingMessages", b0."TotalMonthlyQuota", b0."UpdatedAt", b0."WalletBalance"
FROM "Businesses" AS b
LEFT JOIN "BusinessPlanInfos" AS b0 ON b."Id" = b0."BusinessId"
WHERE b."Id" = @__businessId_0
LIMIT 1
2025-07-02 18:05:08.716 +05:30 [INF] 📦 Resolved plan for Business "c13be597-6ae2-42bb-9d43-925815f24ff8": Smart
2025-07-02 18:05:08.722 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."BusinessId", f."CreatedAt", f."Description", f."FeatureName", f."Group", f."IsEnabled", f."Notes", f."Plan"
FROM "FeatureAccess" AS f
WHERE f."BusinessId" = @__businessId_0
2025-07-02 18:05:08.728 +05:30 [INF] 🔧 Feature override: AddProduct = False
2025-07-02 18:05:08.730 +05:30 [INF] 🔧 Feature override: Campaigns = True
2025-07-02 18:05:08.732 +05:30 [INF] 🔧 Feature override: Catalog = True
2025-07-02 18:05:08.734 +05:30 [INF] 🔧 Feature override: CRM = True
2025-07-02 18:05:08.736 +05:30 [INF] 🔧 Feature override: CRMInsights = True
2025-07-02 18:05:08.738 +05:30 [INF] 🔧 Feature override: CTAFlow = True
2025-07-02 18:05:08.740 +05:30 [INF] 🔧 Feature override: FlowInsights = True
2025-07-02 18:05:08.741 +05:30 [INF] 🔧 Feature override: Messaging = True
2025-07-02 18:05:08.743 +05:30 [INF] 🔧 Feature override: ProfileCompletion = True
2025-07-02 18:05:08.745 +05:30 [INF] 🔧 Feature override: UpgradePlan = True
2025-07-02 18:05:08.747 +05:30 [INF] 🔧 Feature override: WhatsAppSettings = True
2025-07-02 18:05:08.750 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 18:05:08.752 +05:30 [INF] Executed action xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api) in 47.9716ms
2025-07-02 18:05:08.755 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 18:05:08.758 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/feature-access/me - 200 null application/json; charset=utf-8 66.6643ms
2025-07-02 18:05:14.888 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/auth/session - null null
2025-07-02 18:05:14.894 +05:30 [INF] Executing endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 18:05:14.896 +05:30 [INF] Route matched with {action = "GetSession", controller = "Auth"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetSession() on controller xbytechat.api.AuthModule.Controllers.AuthController (xbytechat.api).
2025-07-02 18:05:14.900 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`4[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 18:05:14.903 +05:30 [INF] Executed action xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api) in 4.0546ms
2025-07-02 18:05:14.906 +05:30 [INF] Executed endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 18:05:14.909 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/auth/session - 200 null application/json; charset=utf-8 21.1969ms
2025-07-02 18:05:14.984 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/feature-access/me - null null
2025-07-02 18:05:14.990 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 18:05:14.992 +05:30 [INF] Route matched with {action = "GetMyFeatures", controller = "FeatureAccess"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto]]] GetMyFeatures() on controller xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController (xbytechat.api).
2025-07-02 18:05:15.001 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT b."Id", b."Address", b."ApprovedAt", b."ApprovedBy", b."BusinessEmail", b."BusinessName", b."CompanyName", b."CompanyPhone", b."CreatedAt", b."CreatedBy", b."CreatedByPartnerId", b."DeletedAt", b."DeletedBy", b."Industry", b."IsApproved", b."IsDeleted", b."LastLoginAt", b."LogoUrl", b."Notes", b."Phone", b."RepresentativeName", b."Source", b."Status", b."Tags", b."Website", b0."Id", b0."BusinessId", b0."CreatedAt", b0."Plan", b0."QuotaResetDate", b0."RemainingMessages", b0."TotalMonthlyQuota", b0."UpdatedAt", b0."WalletBalance"
FROM "Businesses" AS b
LEFT JOIN "BusinessPlanInfos" AS b0 ON b."Id" = b0."BusinessId"
WHERE b."Id" = @__businessId_0
LIMIT 1
2025-07-02 18:05:15.008 +05:30 [INF] 📦 Resolved plan for Business "c13be597-6ae2-42bb-9d43-925815f24ff8": Smart
2025-07-02 18:05:15.012 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."BusinessId", f."CreatedAt", f."Description", f."FeatureName", f."Group", f."IsEnabled", f."Notes", f."Plan"
FROM "FeatureAccess" AS f
WHERE f."BusinessId" = @__businessId_0
2025-07-02 18:05:15.016 +05:30 [INF] 🔧 Feature override: AddProduct = False
2025-07-02 18:05:15.018 +05:30 [INF] 🔧 Feature override: Campaigns = True
2025-07-02 18:05:15.020 +05:30 [INF] 🔧 Feature override: Catalog = True
2025-07-02 18:05:15.022 +05:30 [INF] 🔧 Feature override: CRM = True
2025-07-02 18:05:15.024 +05:30 [INF] 🔧 Feature override: CRMInsights = True
2025-07-02 18:05:15.025 +05:30 [INF] 🔧 Feature override: CTAFlow = True
2025-07-02 18:05:15.027 +05:30 [INF] 🔧 Feature override: FlowInsights = True
2025-07-02 18:05:15.028 +05:30 [INF] 🔧 Feature override: Messaging = True
2025-07-02 18:05:15.029 +05:30 [INF] 🔧 Feature override: ProfileCompletion = True
2025-07-02 18:05:15.030 +05:30 [INF] 🔧 Feature override: UpgradePlan = True
2025-07-02 18:05:15.032 +05:30 [INF] 🔧 Feature override: WhatsAppSettings = True
2025-07-02 18:05:15.035 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 18:05:15.038 +05:30 [INF] Executed action xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api) in 41.2962ms
2025-07-02 18:05:15.041 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 18:05:15.043 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/feature-access/me - 200 null application/json; charset=utf-8 58.5971ms
2025-07-02 18:21:46.015 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/auth/session - null null
2025-07-02 18:21:46.029 +05:30 [INF] Executing endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 18:21:46.031 +05:30 [INF] Route matched with {action = "GetSession", controller = "Auth"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetSession() on controller xbytechat.api.AuthModule.Controllers.AuthController (xbytechat.api).
2025-07-02 18:21:46.035 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`4[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 18:21:46.038 +05:30 [INF] Executed action xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api) in 3.6687ms
2025-07-02 18:21:46.040 +05:30 [INF] Executed endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 18:21:46.043 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/auth/session - 200 null application/json; charset=utf-8 27.5803ms
2025-07-02 18:21:46.153 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/feature-access/me - null null
2025-07-02 18:21:46.168 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 18:21:46.171 +05:30 [INF] Route matched with {action = "GetMyFeatures", controller = "FeatureAccess"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto]]] GetMyFeatures() on controller xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController (xbytechat.api).
2025-07-02 18:21:46.431 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT b."Id", b."Address", b."ApprovedAt", b."ApprovedBy", b."BusinessEmail", b."BusinessName", b."CompanyName", b."CompanyPhone", b."CreatedAt", b."CreatedBy", b."CreatedByPartnerId", b."DeletedAt", b."DeletedBy", b."Industry", b."IsApproved", b."IsDeleted", b."LastLoginAt", b."LogoUrl", b."Notes", b."Phone", b."RepresentativeName", b."Source", b."Status", b."Tags", b."Website", b0."Id", b0."BusinessId", b0."CreatedAt", b0."Plan", b0."QuotaResetDate", b0."RemainingMessages", b0."TotalMonthlyQuota", b0."UpdatedAt", b0."WalletBalance"
FROM "Businesses" AS b
LEFT JOIN "BusinessPlanInfos" AS b0 ON b."Id" = b0."BusinessId"
WHERE b."Id" = @__businessId_0
LIMIT 1
2025-07-02 18:21:46.435 +05:30 [INF] 📦 Resolved plan for Business "c13be597-6ae2-42bb-9d43-925815f24ff8": Smart
2025-07-02 18:21:46.440 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."BusinessId", f."CreatedAt", f."Description", f."FeatureName", f."Group", f."IsEnabled", f."Notes", f."Plan"
FROM "FeatureAccess" AS f
WHERE f."BusinessId" = @__businessId_0
2025-07-02 18:21:46.445 +05:30 [INF] 🔧 Feature override: AddProduct = False
2025-07-02 18:21:46.447 +05:30 [INF] 🔧 Feature override: Automation = True
2025-07-02 18:21:46.448 +05:30 [INF] 🔧 Feature override: Campaigns = True
2025-07-02 18:21:46.450 +05:30 [INF] 🔧 Feature override: Catalog = True
2025-07-02 18:21:46.451 +05:30 [INF] 🔧 Feature override: CRM = True
2025-07-02 18:21:46.452 +05:30 [INF] 🔧 Feature override: CRMInsights = True
2025-07-02 18:21:46.454 +05:30 [INF] 🔧 Feature override: CTAFlow = True
2025-07-02 18:21:46.455 +05:30 [INF] 🔧 Feature override: FlowInsights = True
2025-07-02 18:21:46.456 +05:30 [INF] 🔧 Feature override: Messaging = True
2025-07-02 18:21:46.458 +05:30 [INF] 🔧 Feature override: ProfileCompletion = True
2025-07-02 18:21:46.459 +05:30 [INF] 🔧 Feature override: UpgradePlan = True
2025-07-02 18:21:46.461 +05:30 [INF] 🔧 Feature override: WhatsAppSettings = True
2025-07-02 18:21:46.464 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 18:21:46.466 +05:30 [INF] Executed action xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api) in 290.7374ms
2025-07-02 18:21:46.469 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 18:21:46.471 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/feature-access/me - 200 null application/json; charset=utf-8 317.4443ms
2025-07-02 18:41:06.104 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/auth/session - null null
2025-07-02 18:41:06.113 +05:30 [INF] Executing endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 18:41:06.114 +05:30 [INF] Route matched with {action = "GetSession", controller = "Auth"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetSession() on controller xbytechat.api.AuthModule.Controllers.AuthController (xbytechat.api).
2025-07-02 18:41:06.116 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`4[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 18:41:06.117 +05:30 [INF] Executed action xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api) in 1.7168ms
2025-07-02 18:41:06.118 +05:30 [INF] Executed endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 18:41:06.120 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/auth/session - 200 null application/json; charset=utf-8 16.0593ms
2025-07-02 18:41:06.181 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/feature-access/me - null null
2025-07-02 18:41:06.184 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 18:41:06.184 +05:30 [INF] Route matched with {action = "GetMyFeatures", controller = "FeatureAccess"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto]]] GetMyFeatures() on controller xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController (xbytechat.api).
2025-07-02 18:41:06.397 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT b."Id", b."Address", b."ApprovedAt", b."ApprovedBy", b."BusinessEmail", b."BusinessName", b."CompanyName", b."CompanyPhone", b."CreatedAt", b."CreatedBy", b."CreatedByPartnerId", b."DeletedAt", b."DeletedBy", b."Industry", b."IsApproved", b."IsDeleted", b."LastLoginAt", b."LogoUrl", b."Notes", b."Phone", b."RepresentativeName", b."Source", b."Status", b."Tags", b."Website", b0."Id", b0."BusinessId", b0."CreatedAt", b0."Plan", b0."QuotaResetDate", b0."RemainingMessages", b0."TotalMonthlyQuota", b0."UpdatedAt", b0."WalletBalance"
FROM "Businesses" AS b
LEFT JOIN "BusinessPlanInfos" AS b0 ON b."Id" = b0."BusinessId"
WHERE b."Id" = @__businessId_0
LIMIT 1
2025-07-02 18:41:06.400 +05:30 [INF] 📦 Resolved plan for Business "c13be597-6ae2-42bb-9d43-925815f24ff8": Smart
2025-07-02 18:41:06.402 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."BusinessId", f."CreatedAt", f."Description", f."FeatureName", f."Group", f."IsEnabled", f."Notes", f."Plan"
FROM "FeatureAccess" AS f
WHERE f."BusinessId" = @__businessId_0
2025-07-02 18:41:06.404 +05:30 [INF] 🔧 Feature override: AddProduct = False
2025-07-02 18:41:06.404 +05:30 [INF] 🔧 Feature override: Automation = True
2025-07-02 18:41:06.405 +05:30 [INF] 🔧 Feature override: Campaigns = True
2025-07-02 18:41:06.406 +05:30 [INF] 🔧 Feature override: Catalog = True
2025-07-02 18:41:06.406 +05:30 [INF] 🔧 Feature override: CRM = True
2025-07-02 18:41:06.407 +05:30 [INF] 🔧 Feature override: CRMInsights = True
2025-07-02 18:41:06.407 +05:30 [INF] 🔧 Feature override: CTAFlow = True
2025-07-02 18:41:06.408 +05:30 [INF] 🔧 Feature override: FlowInsights = True
2025-07-02 18:41:06.408 +05:30 [INF] 🔧 Feature override: Messaging = True
2025-07-02 18:41:06.409 +05:30 [INF] 🔧 Feature override: ProfileCompletion = True
2025-07-02 18:41:06.410 +05:30 [INF] 🔧 Feature override: UpgradePlan = True
2025-07-02 18:41:06.410 +05:30 [INF] 🔧 Feature override: WhatsAppSettings = True
2025-07-02 18:41:06.411 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 18:41:06.412 +05:30 [INF] Executed action xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api) in 225.9829ms
2025-07-02 18:41:06.413 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 18:41:06.414 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/feature-access/me - 200 null application/json; charset=utf-8 233.133ms
2025-07-02 18:44:11.056 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/auth/session - null null
2025-07-02 18:44:11.063 +05:30 [INF] Executing endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 18:44:11.064 +05:30 [INF] Route matched with {action = "GetSession", controller = "Auth"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetSession() on controller xbytechat.api.AuthModule.Controllers.AuthController (xbytechat.api).
2025-07-02 18:44:11.066 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`4[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 18:44:11.067 +05:30 [INF] Executed action xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api) in 1.489ms
2025-07-02 18:44:11.068 +05:30 [INF] Executed endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 18:44:11.069 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/auth/session - 200 null application/json; charset=utf-8 12.7831ms
2025-07-02 18:44:11.082 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/feature-access/me - null null
2025-07-02 18:44:11.089 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 18:44:11.091 +05:30 [INF] Route matched with {action = "GetMyFeatures", controller = "FeatureAccess"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto]]] GetMyFeatures() on controller xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController (xbytechat.api).
2025-07-02 18:44:11.096 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT b."Id", b."Address", b."ApprovedAt", b."ApprovedBy", b."BusinessEmail", b."BusinessName", b."CompanyName", b."CompanyPhone", b."CreatedAt", b."CreatedBy", b."CreatedByPartnerId", b."DeletedAt", b."DeletedBy", b."Industry", b."IsApproved", b."IsDeleted", b."LastLoginAt", b."LogoUrl", b."Notes", b."Phone", b."RepresentativeName", b."Source", b."Status", b."Tags", b."Website", b0."Id", b0."BusinessId", b0."CreatedAt", b0."Plan", b0."QuotaResetDate", b0."RemainingMessages", b0."TotalMonthlyQuota", b0."UpdatedAt", b0."WalletBalance"
FROM "Businesses" AS b
LEFT JOIN "BusinessPlanInfos" AS b0 ON b."Id" = b0."BusinessId"
WHERE b."Id" = @__businessId_0
LIMIT 1
2025-07-02 18:44:11.100 +05:30 [INF] 📦 Resolved plan for Business "c13be597-6ae2-42bb-9d43-925815f24ff8": Smart
2025-07-02 18:44:11.102 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."BusinessId", f."CreatedAt", f."Description", f."FeatureName", f."Group", f."IsEnabled", f."Notes", f."Plan"
FROM "FeatureAccess" AS f
WHERE f."BusinessId" = @__businessId_0
2025-07-02 18:44:11.104 +05:30 [INF] 🔧 Feature override: AddProduct = False
2025-07-02 18:44:11.105 +05:30 [INF] 🔧 Feature override: Automation = True
2025-07-02 18:44:11.105 +05:30 [INF] 🔧 Feature override: Campaigns = True
2025-07-02 18:44:11.106 +05:30 [INF] 🔧 Feature override: Catalog = True
2025-07-02 18:44:11.107 +05:30 [INF] 🔧 Feature override: CRM = True
2025-07-02 18:44:11.107 +05:30 [INF] 🔧 Feature override: CRMInsights = True
2025-07-02 18:44:11.108 +05:30 [INF] 🔧 Feature override: CTAFlow = True
2025-07-02 18:44:11.108 +05:30 [INF] 🔧 Feature override: FlowInsights = True
2025-07-02 18:44:11.109 +05:30 [INF] 🔧 Feature override: Messaging = True
2025-07-02 18:44:11.110 +05:30 [INF] 🔧 Feature override: ProfileCompletion = True
2025-07-02 18:44:11.110 +05:30 [INF] 🔧 Feature override: UpgradePlan = True
2025-07-02 18:44:11.111 +05:30 [INF] 🔧 Feature override: WhatsAppSettings = True
2025-07-02 18:44:11.112 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 18:44:11.113 +05:30 [INF] Executed action xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api) in 19.9907ms
2025-07-02 18:44:11.114 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 18:44:11.115 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/feature-access/me - 200 null application/json; charset=utf-8 32.7192ms
2025-07-02 18:44:58.994 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/auth/session - null null
2025-07-02 18:44:58.999 +05:30 [INF] Executing endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 18:44:59.000 +05:30 [INF] Route matched with {action = "GetSession", controller = "Auth"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetSession() on controller xbytechat.api.AuthModule.Controllers.AuthController (xbytechat.api).
2025-07-02 18:44:59.002 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`4[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 18:44:59.003 +05:30 [INF] Executed action xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api) in 1.3027ms
2025-07-02 18:44:59.003 +05:30 [INF] Executed endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 18:44:59.004 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/auth/session - 200 null application/json; charset=utf-8 10.6624ms
2025-07-02 18:44:59.082 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/feature-access/me - null null
2025-07-02 18:44:59.085 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 18:44:59.086 +05:30 [INF] Route matched with {action = "GetMyFeatures", controller = "FeatureAccess"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto]]] GetMyFeatures() on controller xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController (xbytechat.api).
2025-07-02 18:44:59.089 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT b."Id", b."Address", b."ApprovedAt", b."ApprovedBy", b."BusinessEmail", b."BusinessName", b."CompanyName", b."CompanyPhone", b."CreatedAt", b."CreatedBy", b."CreatedByPartnerId", b."DeletedAt", b."DeletedBy", b."Industry", b."IsApproved", b."IsDeleted", b."LastLoginAt", b."LogoUrl", b."Notes", b."Phone", b."RepresentativeName", b."Source", b."Status", b."Tags", b."Website", b0."Id", b0."BusinessId", b0."CreatedAt", b0."Plan", b0."QuotaResetDate", b0."RemainingMessages", b0."TotalMonthlyQuota", b0."UpdatedAt", b0."WalletBalance"
FROM "Businesses" AS b
LEFT JOIN "BusinessPlanInfos" AS b0 ON b."Id" = b0."BusinessId"
WHERE b."Id" = @__businessId_0
LIMIT 1
2025-07-02 18:44:59.092 +05:30 [INF] 📦 Resolved plan for Business "c13be597-6ae2-42bb-9d43-925815f24ff8": Smart
2025-07-02 18:44:59.094 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."BusinessId", f."CreatedAt", f."Description", f."FeatureName", f."Group", f."IsEnabled", f."Notes", f."Plan"
FROM "FeatureAccess" AS f
WHERE f."BusinessId" = @__businessId_0
2025-07-02 18:44:59.096 +05:30 [INF] 🔧 Feature override: AddProduct = False
2025-07-02 18:44:59.097 +05:30 [INF] 🔧 Feature override: Automation = True
2025-07-02 18:44:59.098 +05:30 [INF] 🔧 Feature override: Campaigns = True
2025-07-02 18:44:59.098 +05:30 [INF] 🔧 Feature override: Catalog = True
2025-07-02 18:44:59.099 +05:30 [INF] 🔧 Feature override: CRM = True
2025-07-02 18:44:59.099 +05:30 [INF] 🔧 Feature override: CRMInsights = True
2025-07-02 18:44:59.100 +05:30 [INF] 🔧 Feature override: CTAFlow = True
2025-07-02 18:44:59.101 +05:30 [INF] 🔧 Feature override: FlowInsights = True
2025-07-02 18:44:59.101 +05:30 [INF] 🔧 Feature override: Messaging = True
2025-07-02 18:44:59.102 +05:30 [INF] 🔧 Feature override: ProfileCompletion = True
2025-07-02 18:44:59.102 +05:30 [INF] 🔧 Feature override: UpgradePlan = True
2025-07-02 18:44:59.103 +05:30 [INF] 🔧 Feature override: WhatsAppSettings = True
2025-07-02 18:44:59.104 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 18:44:59.105 +05:30 [INF] Executed action xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api) in 17.7146ms
2025-07-02 18:44:59.106 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 18:44:59.107 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/feature-access/me - 200 null application/json; charset=utf-8 24.6789ms
2025-07-02 18:45:26.214 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/auth/session - null null
2025-07-02 18:45:26.220 +05:30 [INF] Executing endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 18:45:26.220 +05:30 [INF] Route matched with {action = "GetSession", controller = "Auth"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetSession() on controller xbytechat.api.AuthModule.Controllers.AuthController (xbytechat.api).
2025-07-02 18:45:26.222 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`4[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 18:45:26.223 +05:30 [INF] Executed action xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api) in 1.5325ms
2025-07-02 18:45:26.224 +05:30 [INF] Executed endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 18:45:26.225 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/auth/session - 200 null application/json; charset=utf-8 10.8616ms
2025-07-02 18:45:26.313 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/feature-access/me - null null
2025-07-02 18:45:26.316 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 18:45:26.316 +05:30 [INF] Route matched with {action = "GetMyFeatures", controller = "FeatureAccess"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto]]] GetMyFeatures() on controller xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController (xbytechat.api).
2025-07-02 18:45:26.320 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT b."Id", b."Address", b."ApprovedAt", b."ApprovedBy", b."BusinessEmail", b."BusinessName", b."CompanyName", b."CompanyPhone", b."CreatedAt", b."CreatedBy", b."CreatedByPartnerId", b."DeletedAt", b."DeletedBy", b."Industry", b."IsApproved", b."IsDeleted", b."LastLoginAt", b."LogoUrl", b."Notes", b."Phone", b."RepresentativeName", b."Source", b."Status", b."Tags", b."Website", b0."Id", b0."BusinessId", b0."CreatedAt", b0."Plan", b0."QuotaResetDate", b0."RemainingMessages", b0."TotalMonthlyQuota", b0."UpdatedAt", b0."WalletBalance"
FROM "Businesses" AS b
LEFT JOIN "BusinessPlanInfos" AS b0 ON b."Id" = b0."BusinessId"
WHERE b."Id" = @__businessId_0
LIMIT 1
2025-07-02 18:45:26.324 +05:30 [INF] 📦 Resolved plan for Business "c13be597-6ae2-42bb-9d43-925815f24ff8": Smart
2025-07-02 18:45:26.326 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."BusinessId", f."CreatedAt", f."Description", f."FeatureName", f."Group", f."IsEnabled", f."Notes", f."Plan"
FROM "FeatureAccess" AS f
WHERE f."BusinessId" = @__businessId_0
2025-07-02 18:45:26.332 +05:30 [INF] 🔧 Feature override: AddProduct = False
2025-07-02 18:45:26.332 +05:30 [INF] 🔧 Feature override: Automation = True
2025-07-02 18:45:26.333 +05:30 [INF] 🔧 Feature override: Campaigns = True
2025-07-02 18:45:26.333 +05:30 [INF] 🔧 Feature override: Catalog = True
2025-07-02 18:45:26.334 +05:30 [INF] 🔧 Feature override: CRM = True
2025-07-02 18:45:26.334 +05:30 [INF] 🔧 Feature override: CRMInsights = True
2025-07-02 18:45:26.335 +05:30 [INF] 🔧 Feature override: CTAFlow = True
2025-07-02 18:45:26.335 +05:30 [INF] 🔧 Feature override: FlowInsights = True
2025-07-02 18:45:26.336 +05:30 [INF] 🔧 Feature override: Messaging = True
2025-07-02 18:45:26.336 +05:30 [INF] 🔧 Feature override: ProfileCompletion = True
2025-07-02 18:45:26.337 +05:30 [INF] 🔧 Feature override: UpgradePlan = True
2025-07-02 18:45:26.338 +05:30 [INF] 🔧 Feature override: WhatsAppSettings = True
2025-07-02 18:45:26.339 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 18:45:26.340 +05:30 [INF] Executed action xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api) in 21.9334ms
2025-07-02 18:45:26.341 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 18:45:26.342 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/feature-access/me - 200 null application/json; charset=utf-8 29.0809ms
2025-07-02 18:46:29.533 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/auth/session - null null
2025-07-02 18:46:29.539 +05:30 [INF] Executing endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 18:46:29.540 +05:30 [INF] Route matched with {action = "GetSession", controller = "Auth"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetSession() on controller xbytechat.api.AuthModule.Controllers.AuthController (xbytechat.api).
2025-07-02 18:46:29.542 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`4[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 18:46:29.544 +05:30 [INF] Executed action xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api) in 2.2696ms
2025-07-02 18:46:29.545 +05:30 [INF] Executed endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 18:46:29.547 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/auth/session - 200 null application/json; charset=utf-8 13.5033ms
2025-07-02 18:46:29.570 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/feature-access/me - null null
2025-07-02 18:46:29.574 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 18:46:29.575 +05:30 [INF] Route matched with {action = "GetMyFeatures", controller = "FeatureAccess"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto]]] GetMyFeatures() on controller xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController (xbytechat.api).
2025-07-02 18:46:29.789 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT b."Id", b."Address", b."ApprovedAt", b."ApprovedBy", b."BusinessEmail", b."BusinessName", b."CompanyName", b."CompanyPhone", b."CreatedAt", b."CreatedBy", b."CreatedByPartnerId", b."DeletedAt", b."DeletedBy", b."Industry", b."IsApproved", b."IsDeleted", b."LastLoginAt", b."LogoUrl", b."Notes", b."Phone", b."RepresentativeName", b."Source", b."Status", b."Tags", b."Website", b0."Id", b0."BusinessId", b0."CreatedAt", b0."Plan", b0."QuotaResetDate", b0."RemainingMessages", b0."TotalMonthlyQuota", b0."UpdatedAt", b0."WalletBalance"
FROM "Businesses" AS b
LEFT JOIN "BusinessPlanInfos" AS b0 ON b."Id" = b0."BusinessId"
WHERE b."Id" = @__businessId_0
LIMIT 1
2025-07-02 18:46:29.791 +05:30 [INF] 📦 Resolved plan for Business "c13be597-6ae2-42bb-9d43-925815f24ff8": Smart
2025-07-02 18:46:29.793 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."BusinessId", f."CreatedAt", f."Description", f."FeatureName", f."Group", f."IsEnabled", f."Notes", f."Plan"
FROM "FeatureAccess" AS f
WHERE f."BusinessId" = @__businessId_0
2025-07-02 18:46:29.795 +05:30 [INF] 🔧 Feature override: AddProduct = False
2025-07-02 18:46:29.796 +05:30 [INF] 🔧 Feature override: Automation = True
2025-07-02 18:46:29.796 +05:30 [INF] 🔧 Feature override: Campaigns = True
2025-07-02 18:46:29.797 +05:30 [INF] 🔧 Feature override: Catalog = True
2025-07-02 18:46:29.798 +05:30 [INF] 🔧 Feature override: CRM = True
2025-07-02 18:46:29.798 +05:30 [INF] 🔧 Feature override: CRMInsights = True
2025-07-02 18:46:29.799 +05:30 [INF] 🔧 Feature override: CTAFlow = True
2025-07-02 18:46:29.800 +05:30 [INF] 🔧 Feature override: FlowInsights = True
2025-07-02 18:46:29.800 +05:30 [INF] 🔧 Feature override: Messaging = True
2025-07-02 18:46:29.801 +05:30 [INF] 🔧 Feature override: ProfileCompletion = True
2025-07-02 18:46:29.802 +05:30 [INF] 🔧 Feature override: UpgradePlan = True
2025-07-02 18:46:29.802 +05:30 [INF] 🔧 Feature override: WhatsAppSettings = True
2025-07-02 18:46:29.804 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 18:46:29.805 +05:30 [INF] Executed action xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api) in 228.585ms
2025-07-02 18:46:29.806 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 18:46:29.807 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/feature-access/me - 200 null application/json; charset=utf-8 236.9219ms
2025-07-02 18:46:58.795 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/auth/session - null null
2025-07-02 18:46:58.802 +05:30 [INF] Executing endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 18:46:58.802 +05:30 [INF] Route matched with {action = "GetSession", controller = "Auth"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetSession() on controller xbytechat.api.AuthModule.Controllers.AuthController (xbytechat.api).
2025-07-02 18:46:58.805 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`4[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 18:46:58.806 +05:30 [INF] Executed action xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api) in 2.1165ms
2025-07-02 18:46:58.807 +05:30 [INF] Executed endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 18:46:58.808 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/auth/session - 200 null application/json; charset=utf-8 12.9249ms
2025-07-02 18:46:58.829 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/feature-access/me - null null
2025-07-02 18:46:58.832 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 18:46:58.833 +05:30 [INF] Route matched with {action = "GetMyFeatures", controller = "FeatureAccess"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto]]] GetMyFeatures() on controller xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController (xbytechat.api).
2025-07-02 18:46:58.837 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT b."Id", b."Address", b."ApprovedAt", b."ApprovedBy", b."BusinessEmail", b."BusinessName", b."CompanyName", b."CompanyPhone", b."CreatedAt", b."CreatedBy", b."CreatedByPartnerId", b."DeletedAt", b."DeletedBy", b."Industry", b."IsApproved", b."IsDeleted", b."LastLoginAt", b."LogoUrl", b."Notes", b."Phone", b."RepresentativeName", b."Source", b."Status", b."Tags", b."Website", b0."Id", b0."BusinessId", b0."CreatedAt", b0."Plan", b0."QuotaResetDate", b0."RemainingMessages", b0."TotalMonthlyQuota", b0."UpdatedAt", b0."WalletBalance"
FROM "Businesses" AS b
LEFT JOIN "BusinessPlanInfos" AS b0 ON b."Id" = b0."BusinessId"
WHERE b."Id" = @__businessId_0
LIMIT 1
2025-07-02 18:46:58.840 +05:30 [INF] 📦 Resolved plan for Business "c13be597-6ae2-42bb-9d43-925815f24ff8": Smart
2025-07-02 18:46:58.842 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."BusinessId", f."CreatedAt", f."Description", f."FeatureName", f."Group", f."IsEnabled", f."Notes", f."Plan"
FROM "FeatureAccess" AS f
WHERE f."BusinessId" = @__businessId_0
2025-07-02 18:46:58.847 +05:30 [INF] 🔧 Feature override: AddProduct = False
2025-07-02 18:46:58.847 +05:30 [INF] 🔧 Feature override: Automation = True
2025-07-02 18:46:58.848 +05:30 [INF] 🔧 Feature override: Campaigns = True
2025-07-02 18:46:58.849 +05:30 [INF] 🔧 Feature override: Catalog = True
2025-07-02 18:46:58.849 +05:30 [INF] 🔧 Feature override: CRM = True
2025-07-02 18:46:58.850 +05:30 [INF] 🔧 Feature override: CRMInsights = True
2025-07-02 18:46:58.851 +05:30 [INF] 🔧 Feature override: CTAFlow = True
2025-07-02 18:46:58.851 +05:30 [INF] 🔧 Feature override: FlowInsights = True
2025-07-02 18:46:58.852 +05:30 [INF] 🔧 Feature override: Messaging = True
2025-07-02 18:46:58.853 +05:30 [INF] 🔧 Feature override: ProfileCompletion = True
2025-07-02 18:46:58.853 +05:30 [INF] 🔧 Feature override: UpgradePlan = True
2025-07-02 18:46:58.854 +05:30 [INF] 🔧 Feature override: WhatsAppSettings = True
2025-07-02 18:46:58.855 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 18:46:58.856 +05:30 [INF] Executed action xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api) in 21.2414ms
2025-07-02 18:46:58.857 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 18:46:58.858 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/feature-access/me - 200 null application/json; charset=utf-8 28.996ms
2025-07-02 18:47:11.605 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/auth/session - null null
2025-07-02 18:47:11.607 +05:30 [INF] Executing endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 18:47:11.608 +05:30 [INF] Route matched with {action = "GetSession", controller = "Auth"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetSession() on controller xbytechat.api.AuthModule.Controllers.AuthController (xbytechat.api).
2025-07-02 18:47:11.610 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`4[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 18:47:11.611 +05:30 [INF] Executed action xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api) in 1.3437ms
2025-07-02 18:47:11.612 +05:30 [INF] Executed endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 18:47:11.612 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/auth/session - 200 null application/json; charset=utf-8 7.6587ms
2025-07-02 18:47:11.627 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/feature-access/me - null null
2025-07-02 18:47:11.630 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 18:47:11.631 +05:30 [INF] Route matched with {action = "GetMyFeatures", controller = "FeatureAccess"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto]]] GetMyFeatures() on controller xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController (xbytechat.api).
2025-07-02 18:47:11.635 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT b."Id", b."Address", b."ApprovedAt", b."ApprovedBy", b."BusinessEmail", b."BusinessName", b."CompanyName", b."CompanyPhone", b."CreatedAt", b."CreatedBy", b."CreatedByPartnerId", b."DeletedAt", b."DeletedBy", b."Industry", b."IsApproved", b."IsDeleted", b."LastLoginAt", b."LogoUrl", b."Notes", b."Phone", b."RepresentativeName", b."Source", b."Status", b."Tags", b."Website", b0."Id", b0."BusinessId", b0."CreatedAt", b0."Plan", b0."QuotaResetDate", b0."RemainingMessages", b0."TotalMonthlyQuota", b0."UpdatedAt", b0."WalletBalance"
FROM "Businesses" AS b
LEFT JOIN "BusinessPlanInfos" AS b0 ON b."Id" = b0."BusinessId"
WHERE b."Id" = @__businessId_0
LIMIT 1
2025-07-02 18:47:11.639 +05:30 [INF] 📦 Resolved plan for Business "c13be597-6ae2-42bb-9d43-925815f24ff8": Smart
2025-07-02 18:47:11.642 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."BusinessId", f."CreatedAt", f."Description", f."FeatureName", f."Group", f."IsEnabled", f."Notes", f."Plan"
FROM "FeatureAccess" AS f
WHERE f."BusinessId" = @__businessId_0
2025-07-02 18:47:11.644 +05:30 [INF] 🔧 Feature override: AddProduct = False
2025-07-02 18:47:11.645 +05:30 [INF] 🔧 Feature override: Automation = True
2025-07-02 18:47:11.646 +05:30 [INF] 🔧 Feature override: Campaigns = True
2025-07-02 18:47:11.647 +05:30 [INF] 🔧 Feature override: Catalog = True
2025-07-02 18:47:11.647 +05:30 [INF] 🔧 Feature override: CRM = True
2025-07-02 18:47:11.648 +05:30 [INF] 🔧 Feature override: CRMInsights = True
2025-07-02 18:47:11.648 +05:30 [INF] 🔧 Feature override: CTAFlow = True
2025-07-02 18:47:11.649 +05:30 [INF] 🔧 Feature override: FlowInsights = True
2025-07-02 18:47:11.650 +05:30 [INF] 🔧 Feature override: Messaging = True
2025-07-02 18:47:11.650 +05:30 [INF] 🔧 Feature override: ProfileCompletion = True
2025-07-02 18:47:11.651 +05:30 [INF] 🔧 Feature override: UpgradePlan = True
2025-07-02 18:47:11.652 +05:30 [INF] 🔧 Feature override: WhatsAppSettings = True
2025-07-02 18:47:11.653 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 18:47:11.654 +05:30 [INF] Executed action xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api) in 20.8037ms
2025-07-02 18:47:11.655 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 18:47:11.656 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/feature-access/me - 200 null application/json; charset=utf-8 28.8379ms
2025-07-02 18:57:29.863 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/auth/session - null null
2025-07-02 18:57:29.869 +05:30 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '02-07-2025 01:21:34 PM', Current time (UTC): '02-07-2025 01:27:29 PM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-07-02 18:57:29.873 +05:30 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '02-07-2025 01:21:34 PM', Current time (UTC): '02-07-2025 01:27:29 PM'.
2025-07-02 18:57:29.874 +05:30 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-07-02 18:57:29.895 +05:30 [ERR] ❌ An unhandled exception occurred
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ThrowResponseAlreadyStartedException(String value)
   at Microsoft.AspNetCore.Http.DefaultHttpResponse.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Authentication.JwtBearer.JwtBearerHandler.HandleChallengeAsync(AuthenticationProperties properties)
   at Microsoft.AspNetCore.Authentication.AuthenticationHandler`1.ChallengeAsync(AuthenticationProperties properties)
   at Microsoft.AspNetCore.Authentication.AuthenticationService.ChallengeAsync(HttpContext context, String scheme, AuthenticationProperties properties)
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.<>c__DisplayClass0_0.<<HandleAsync>g__Handle|0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at GlobalExceptionMiddleware.Invoke(HttpContext context) in D:\xbytechat\xbytechat-api\xbytechat-api\Middlewares\GlobalExceptionMiddleware.cs:line 32
2025-07-02 18:57:29.901 +05:30 [ERR] Response has already started, unable to write error response for path: /api/auth/session
2025-07-02 18:57:29.902 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/auth/session - 401 null application/json 38.7331ms
2025-07-02 18:57:47.364 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/api/auth/login - null null
2025-07-02 18:57:47.369 +05:30 [INF] CORS policy execution successful.
2025-07-02 18:57:47.370 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/api/auth/login - 204 null null 6.5705ms
2025-07-02 18:57:47.372 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/api/auth/login - application/json 47
2025-07-02 18:57:47.375 +05:30 [INF] CORS policy execution successful.
2025-07-02 18:57:47.375 +05:30 [INF] Executing endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.Login (xbytechat.api)'
2025-07-02 18:57:47.376 +05:30 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(xbytechat.api.AuthModule.DTOs.UserLoginDto) on controller xbytechat.api.AuthModule.Controllers.AuthController (xbytechat.api).
2025-07-02 18:57:47.378 +05:30 [INF] 🔑 Login attempt for email: ratan@tcs.com
2025-07-02 18:57:47.594 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__dto_Email_0='ratan@tcs.com', @__hashedPassword_1='JAvlGPq9JyTdtvBO6x2llnRI1+gxwIyPqCKAn3THIKk='], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."BusinessId", u."CreatedAt", u."DeletedAt", u."Email", u."IsDeleted", u."Name", u."PasswordHash", u."RefreshToken", u."RefreshTokenExpiry", u."RoleId", u."Status", r."Id", r."CreatedAt", r."Description", r."IsActive", r."IsSystemDefined", r."Name"
FROM "Users" AS u
LEFT JOIN "Roles" AS r ON u."RoleId" = r."Id"
WHERE u."Email" = @__dto_Email_0 AND u."PasswordHash" = @__hashedPassword_1 AND NOT (u."IsDeleted")
LIMIT 1
2025-07-02 18:57:47.598 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__user_BusinessId_Value_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT b."Id", b."Address", b."ApprovedAt", b."ApprovedBy", b."BusinessEmail", b."BusinessName", b."CompanyName", b."CompanyPhone", b."CreatedAt", b."CreatedBy", b."CreatedByPartnerId", b."DeletedAt", b."DeletedBy", b."Industry", b."IsApproved", b."IsDeleted", b."LastLoginAt", b."LogoUrl", b."Notes", b."Phone", b."RepresentativeName", b."Source", b."Status", b."Tags", b."Website", b0."Id", b0."BusinessId", b0."CreatedAt", b0."Plan", b0."QuotaResetDate", b0."RemainingMessages", b0."TotalMonthlyQuota", b0."UpdatedAt", b0."WalletBalance"
FROM "Businesses" AS b
LEFT JOIN "BusinessPlanInfos" AS b0 ON b."Id" = b0."BusinessId"
WHERE b."Id" = @__user_BusinessId_Value_0
LIMIT 1
2025-07-02 18:57:47.601 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__user_RoleId_0='00000000-0000-0000-0000-000000000004' (Nullable = true)], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."AssignedAt", r."AssignedBy", r."IsActive", r."IsRevoked", r."PermissionId", r."RoleId"
FROM "RolePermissions" AS r
WHERE r."RoleId" = @__user_RoleId_0 AND NOT (r."IsRevoked")
2025-07-02 18:57:47.603 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='2870e1d8-0e80-4b12-88bd-70a8113307d6'], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."AssignedAt", u."AssignedBy", u."IsGranted", u."IsRevoked", u."PermissionId", u."UserId"
FROM "UserPermissions" AS u
WHERE u."UserId" = @__userId_0 AND NOT (u."IsRevoked")
2025-07-02 18:57:47.606 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__permissionIds_0={ '30000000-0000-0000-0000-000000000000', '30000000-0000-0000-0000-000000000004', '30000000-0000-0000-0000-000000000001', '30000000-0000-0000-0000-000000000007' } (DbType = Object)], CommandType='"Text"', CommandTimeout='30']
SELECT p."Id", p."Code", p."CreatedAt", p."Description", p."Group", p."IsActive", p."Name"
FROM "Permissions" AS p
WHERE p."Id" = ANY (@__permissionIds_0)
2025-07-02 18:57:47.608 +05:30 [INF] ✅ Token generated for: ratan@tcs.com
2025-07-02 18:57:47.609 +05:30 [INF] ✅ Login successful for ratan@tcs.com, Role: business, Plan: Smart
2025-07-02 18:57:47.610 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`3[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 18:57:47.612 +05:30 [INF] Executed action xbytechat.api.AuthModule.Controllers.AuthController.Login (xbytechat.api) in 234.2886ms
2025-07-02 18:57:47.613 +05:30 [INF] Executed endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.Login (xbytechat.api)'
2025-07-02 18:57:47.614 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/api/auth/login - 200 null application/json; charset=utf-8 241.9266ms
2025-07-02 18:57:47.619 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/auth/session - null null
2025-07-02 18:57:47.623 +05:30 [INF] Executing endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 18:57:47.623 +05:30 [INF] Route matched with {action = "GetSession", controller = "Auth"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetSession() on controller xbytechat.api.AuthModule.Controllers.AuthController (xbytechat.api).
2025-07-02 18:57:47.625 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`4[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 18:57:47.626 +05:30 [INF] Executed action xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api) in 1.4033ms
2025-07-02 18:57:47.627 +05:30 [INF] Executed endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 18:57:47.628 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/auth/session - 200 null application/json; charset=utf-8 8.9435ms
2025-07-02 18:57:47.953 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/feature-access/me - null null
2025-07-02 18:57:47.956 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 18:57:47.957 +05:30 [INF] Route matched with {action = "GetMyFeatures", controller = "FeatureAccess"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto]]] GetMyFeatures() on controller xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController (xbytechat.api).
2025-07-02 18:57:47.960 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT b."Id", b."Address", b."ApprovedAt", b."ApprovedBy", b."BusinessEmail", b."BusinessName", b."CompanyName", b."CompanyPhone", b."CreatedAt", b."CreatedBy", b."CreatedByPartnerId", b."DeletedAt", b."DeletedBy", b."Industry", b."IsApproved", b."IsDeleted", b."LastLoginAt", b."LogoUrl", b."Notes", b."Phone", b."RepresentativeName", b."Source", b."Status", b."Tags", b."Website", b0."Id", b0."BusinessId", b0."CreatedAt", b0."Plan", b0."QuotaResetDate", b0."RemainingMessages", b0."TotalMonthlyQuota", b0."UpdatedAt", b0."WalletBalance"
FROM "Businesses" AS b
LEFT JOIN "BusinessPlanInfos" AS b0 ON b."Id" = b0."BusinessId"
WHERE b."Id" = @__businessId_0
LIMIT 1
2025-07-02 18:57:47.963 +05:30 [INF] 📦 Resolved plan for Business "c13be597-6ae2-42bb-9d43-925815f24ff8": Smart
2025-07-02 18:57:47.965 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."BusinessId", f."CreatedAt", f."Description", f."FeatureName", f."Group", f."IsEnabled", f."Notes", f."Plan"
FROM "FeatureAccess" AS f
WHERE f."BusinessId" = @__businessId_0
2025-07-02 18:57:47.967 +05:30 [INF] 🔧 Feature override: AddProduct = False
2025-07-02 18:57:47.968 +05:30 [INF] 🔧 Feature override: Automation = True
2025-07-02 18:57:47.968 +05:30 [INF] 🔧 Feature override: Campaigns = True
2025-07-02 18:57:47.969 +05:30 [INF] 🔧 Feature override: Catalog = True
2025-07-02 18:57:47.969 +05:30 [INF] 🔧 Feature override: CRM = True
2025-07-02 18:57:47.970 +05:30 [INF] 🔧 Feature override: CRMInsights = True
2025-07-02 18:57:47.971 +05:30 [INF] 🔧 Feature override: CTAFlow = True
2025-07-02 18:57:47.971 +05:30 [INF] 🔧 Feature override: FlowInsights = True
2025-07-02 18:57:47.972 +05:30 [INF] 🔧 Feature override: Messaging = True
2025-07-02 18:57:47.972 +05:30 [INF] 🔧 Feature override: ProfileCompletion = True
2025-07-02 18:57:47.973 +05:30 [INF] 🔧 Feature override: UpgradePlan = True
2025-07-02 18:57:47.973 +05:30 [INF] 🔧 Feature override: WhatsAppSettings = True
2025-07-02 18:57:47.974 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 18:57:47.975 +05:30 [INF] Executed action xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api) in 17.2982ms
2025-07-02 18:57:47.976 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 18:57:47.977 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/feature-access/me - 200 null application/json; charset=utf-8 24.0268ms
2025-07-02 19:12:36.139 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/auth/session - null null
2025-07-02 19:12:36.151 +05:30 [INF] Executing endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 19:12:36.152 +05:30 [INF] Route matched with {action = "GetSession", controller = "Auth"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetSession() on controller xbytechat.api.AuthModule.Controllers.AuthController (xbytechat.api).
2025-07-02 19:12:36.154 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`4[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 19:12:36.155 +05:30 [INF] Executed action xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api) in 1.7844ms
2025-07-02 19:12:36.156 +05:30 [INF] Executed endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 19:12:36.157 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/auth/session - 200 null application/json; charset=utf-8 17.3356ms
2025-07-02 19:12:36.233 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/feature-access/me - null null
2025-07-02 19:12:36.239 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 19:12:36.240 +05:30 [INF] Route matched with {action = "GetMyFeatures", controller = "FeatureAccess"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto]]] GetMyFeatures() on controller xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController (xbytechat.api).
2025-07-02 19:12:36.380 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT b."Id", b."Address", b."ApprovedAt", b."ApprovedBy", b."BusinessEmail", b."BusinessName", b."CompanyName", b."CompanyPhone", b."CreatedAt", b."CreatedBy", b."CreatedByPartnerId", b."DeletedAt", b."DeletedBy", b."Industry", b."IsApproved", b."IsDeleted", b."LastLoginAt", b."LogoUrl", b."Notes", b."Phone", b."RepresentativeName", b."Source", b."Status", b."Tags", b."Website", b0."Id", b0."BusinessId", b0."CreatedAt", b0."Plan", b0."QuotaResetDate", b0."RemainingMessages", b0."TotalMonthlyQuota", b0."UpdatedAt", b0."WalletBalance"
FROM "Businesses" AS b
LEFT JOIN "BusinessPlanInfos" AS b0 ON b."Id" = b0."BusinessId"
WHERE b."Id" = @__businessId_0
LIMIT 1
2025-07-02 19:12:36.383 +05:30 [INF] 📦 Resolved plan for Business "c13be597-6ae2-42bb-9d43-925815f24ff8": Smart
2025-07-02 19:12:36.385 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."BusinessId", f."CreatedAt", f."Description", f."FeatureName", f."Group", f."IsEnabled", f."Notes", f."Plan"
FROM "FeatureAccess" AS f
WHERE f."BusinessId" = @__businessId_0
2025-07-02 19:12:36.387 +05:30 [INF] 🔧 Feature override: AddProduct = False
2025-07-02 19:12:36.388 +05:30 [INF] 🔧 Feature override: Automation = True
2025-07-02 19:12:36.389 +05:30 [INF] 🔧 Feature override: Campaigns = True
2025-07-02 19:12:36.389 +05:30 [INF] 🔧 Feature override: Catalog = True
2025-07-02 19:12:36.390 +05:30 [INF] 🔧 Feature override: CRM = True
2025-07-02 19:12:36.391 +05:30 [INF] 🔧 Feature override: CRMInsights = True
2025-07-02 19:12:36.391 +05:30 [INF] 🔧 Feature override: CTAFlow = True
2025-07-02 19:12:36.392 +05:30 [INF] 🔧 Feature override: FlowInsights = True
2025-07-02 19:12:36.393 +05:30 [INF] 🔧 Feature override: Messaging = True
2025-07-02 19:12:36.394 +05:30 [INF] 🔧 Feature override: ProfileCompletion = True
2025-07-02 19:12:36.394 +05:30 [INF] 🔧 Feature override: UpgradePlan = True
2025-07-02 19:12:36.395 +05:30 [INF] 🔧 Feature override: WhatsAppSettings = True
2025-07-02 19:12:36.396 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 19:12:36.397 +05:30 [INF] Executed action xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api) in 154.7812ms
2025-07-02 19:12:36.398 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 19:12:36.400 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/feature-access/me - 200 null application/json; charset=utf-8 166.5664ms
2025-07-02 19:21:29.180 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/auth/session - null null
2025-07-02 19:21:29.188 +05:30 [INF] Executing endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 19:21:29.189 +05:30 [INF] Route matched with {action = "GetSession", controller = "Auth"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetSession() on controller xbytechat.api.AuthModule.Controllers.AuthController (xbytechat.api).
2025-07-02 19:21:29.191 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`4[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 19:21:29.192 +05:30 [INF] Executed action xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api) in 1.9869ms
2025-07-02 19:21:29.193 +05:30 [INF] Executed endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 19:21:29.194 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/auth/session - 200 null application/json; charset=utf-8 14.4881ms
2025-07-02 19:21:29.271 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/feature-access/me - null null
2025-07-02 19:21:29.277 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 19:21:29.296 +05:30 [INF] Route matched with {action = "GetMyFeatures", controller = "FeatureAccess"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto]]] GetMyFeatures() on controller xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController (xbytechat.api).
2025-07-02 19:21:29.543 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT b."Id", b."Address", b."ApprovedAt", b."ApprovedBy", b."BusinessEmail", b."BusinessName", b."CompanyName", b."CompanyPhone", b."CreatedAt", b."CreatedBy", b."CreatedByPartnerId", b."DeletedAt", b."DeletedBy", b."Industry", b."IsApproved", b."IsDeleted", b."LastLoginAt", b."LogoUrl", b."Notes", b."Phone", b."RepresentativeName", b."Source", b."Status", b."Tags", b."Website", b0."Id", b0."BusinessId", b0."CreatedAt", b0."Plan", b0."QuotaResetDate", b0."RemainingMessages", b0."TotalMonthlyQuota", b0."UpdatedAt", b0."WalletBalance"
FROM "Businesses" AS b
LEFT JOIN "BusinessPlanInfos" AS b0 ON b."Id" = b0."BusinessId"
WHERE b."Id" = @__businessId_0
LIMIT 1
2025-07-02 19:21:29.545 +05:30 [INF] 📦 Resolved plan for Business "c13be597-6ae2-42bb-9d43-925815f24ff8": Smart
2025-07-02 19:21:29.547 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."BusinessId", f."CreatedAt", f."Description", f."FeatureName", f."Group", f."IsEnabled", f."Notes", f."Plan"
FROM "FeatureAccess" AS f
WHERE f."BusinessId" = @__businessId_0
2025-07-02 19:21:29.549 +05:30 [INF] 🔧 Feature override: AddProduct = False
2025-07-02 19:21:29.550 +05:30 [INF] 🔧 Feature override: Automation = True
2025-07-02 19:21:29.550 +05:30 [INF] 🔧 Feature override: Campaigns = True
2025-07-02 19:21:29.551 +05:30 [INF] 🔧 Feature override: Catalog = True
2025-07-02 19:21:29.552 +05:30 [INF] 🔧 Feature override: CRM = True
2025-07-02 19:21:29.553 +05:30 [INF] 🔧 Feature override: CRMInsights = True
2025-07-02 19:21:29.553 +05:30 [INF] 🔧 Feature override: CTAFlow = True
2025-07-02 19:21:29.554 +05:30 [INF] 🔧 Feature override: FlowInsights = True
2025-07-02 19:21:29.555 +05:30 [INF] 🔧 Feature override: Messaging = True
2025-07-02 19:21:29.555 +05:30 [INF] 🔧 Feature override: ProfileCompletion = True
2025-07-02 19:21:29.556 +05:30 [INF] 🔧 Feature override: UpgradePlan = True
2025-07-02 19:21:29.556 +05:30 [INF] 🔧 Feature override: WhatsAppSettings = True
2025-07-02 19:21:29.558 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 19:21:29.559 +05:30 [INF] Executed action xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api) in 260.1774ms
2025-07-02 19:21:29.560 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 19:21:29.561 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/feature-access/me - 200 null application/json; charset=utf-8 289.8826ms
2025-07-02 19:24:44.298 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/auth/session - null null
2025-07-02 19:24:44.322 +05:30 [INF] Executing endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 19:24:44.324 +05:30 [INF] Route matched with {action = "GetSession", controller = "Auth"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetSession() on controller xbytechat.api.AuthModule.Controllers.AuthController (xbytechat.api).
2025-07-02 19:24:44.326 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`4[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 19:24:44.328 +05:30 [INF] Executed action xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api) in 2.266ms
2025-07-02 19:24:44.329 +05:30 [INF] Executed endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 19:24:44.330 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/auth/session - 200 null application/json; charset=utf-8 31.9226ms
2025-07-02 19:24:44.392 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/feature-access/me - null null
2025-07-02 19:24:44.395 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 19:24:44.396 +05:30 [INF] Route matched with {action = "GetMyFeatures", controller = "FeatureAccess"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto]]] GetMyFeatures() on controller xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController (xbytechat.api).
2025-07-02 19:24:44.401 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT b."Id", b."Address", b."ApprovedAt", b."ApprovedBy", b."BusinessEmail", b."BusinessName", b."CompanyName", b."CompanyPhone", b."CreatedAt", b."CreatedBy", b."CreatedByPartnerId", b."DeletedAt", b."DeletedBy", b."Industry", b."IsApproved", b."IsDeleted", b."LastLoginAt", b."LogoUrl", b."Notes", b."Phone", b."RepresentativeName", b."Source", b."Status", b."Tags", b."Website", b0."Id", b0."BusinessId", b0."CreatedAt", b0."Plan", b0."QuotaResetDate", b0."RemainingMessages", b0."TotalMonthlyQuota", b0."UpdatedAt", b0."WalletBalance"
FROM "Businesses" AS b
LEFT JOIN "BusinessPlanInfos" AS b0 ON b."Id" = b0."BusinessId"
WHERE b."Id" = @__businessId_0
LIMIT 1
2025-07-02 19:24:44.412 +05:30 [INF] 📦 Resolved plan for Business "c13be597-6ae2-42bb-9d43-925815f24ff8": Smart
2025-07-02 19:24:44.415 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."BusinessId", f."CreatedAt", f."Description", f."FeatureName", f."Group", f."IsEnabled", f."Notes", f."Plan"
FROM "FeatureAccess" AS f
WHERE f."BusinessId" = @__businessId_0
2025-07-02 19:24:44.418 +05:30 [INF] 🔧 Feature override: AddProduct = False
2025-07-02 19:24:44.419 +05:30 [INF] 🔧 Feature override: Automation = True
2025-07-02 19:24:44.420 +05:30 [INF] 🔧 Feature override: Campaigns = True
2025-07-02 19:24:44.421 +05:30 [INF] 🔧 Feature override: Catalog = True
2025-07-02 19:24:44.421 +05:30 [INF] 🔧 Feature override: CRM = True
2025-07-02 19:24:44.422 +05:30 [INF] 🔧 Feature override: CRMInsights = True
2025-07-02 19:24:44.423 +05:30 [INF] 🔧 Feature override: CTAFlow = True
2025-07-02 19:24:44.424 +05:30 [INF] 🔧 Feature override: FlowInsights = True
2025-07-02 19:24:44.425 +05:30 [INF] 🔧 Feature override: Messaging = True
2025-07-02 19:24:44.426 +05:30 [INF] 🔧 Feature override: ProfileCompletion = True
2025-07-02 19:24:44.427 +05:30 [INF] 🔧 Feature override: UpgradePlan = True
2025-07-02 19:24:44.427 +05:30 [INF] 🔧 Feature override: WhatsAppSettings = True
2025-07-02 19:24:44.429 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 19:24:44.430 +05:30 [INF] Executed action xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api) in 32.4593ms
2025-07-02 19:24:44.432 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 19:24:44.433 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/feature-access/me - 200 null application/json; charset=utf-8 40.5189ms
2025-07-02 19:24:49.554 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/auth/session - null null
2025-07-02 19:24:49.556 +05:30 [INF] Executing endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 19:24:49.557 +05:30 [INF] Route matched with {action = "GetSession", controller = "Auth"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetSession() on controller xbytechat.api.AuthModule.Controllers.AuthController (xbytechat.api).
2025-07-02 19:24:49.559 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`4[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 19:24:49.560 +05:30 [INF] Executed action xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api) in 1.4825ms
2025-07-02 19:24:49.561 +05:30 [INF] Executed endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 19:24:49.562 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/auth/session - 200 null application/json; charset=utf-8 8.0998ms
2025-07-02 19:24:49.571 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/feature-access/me - null null
2025-07-02 19:24:49.573 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 19:24:49.574 +05:30 [INF] Route matched with {action = "GetMyFeatures", controller = "FeatureAccess"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto]]] GetMyFeatures() on controller xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController (xbytechat.api).
2025-07-02 19:24:49.577 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT b."Id", b."Address", b."ApprovedAt", b."ApprovedBy", b."BusinessEmail", b."BusinessName", b."CompanyName", b."CompanyPhone", b."CreatedAt", b."CreatedBy", b."CreatedByPartnerId", b."DeletedAt", b."DeletedBy", b."Industry", b."IsApproved", b."IsDeleted", b."LastLoginAt", b."LogoUrl", b."Notes", b."Phone", b."RepresentativeName", b."Source", b."Status", b."Tags", b."Website", b0."Id", b0."BusinessId", b0."CreatedAt", b0."Plan", b0."QuotaResetDate", b0."RemainingMessages", b0."TotalMonthlyQuota", b0."UpdatedAt", b0."WalletBalance"
FROM "Businesses" AS b
LEFT JOIN "BusinessPlanInfos" AS b0 ON b."Id" = b0."BusinessId"
WHERE b."Id" = @__businessId_0
LIMIT 1
2025-07-02 19:24:49.579 +05:30 [INF] 📦 Resolved plan for Business "c13be597-6ae2-42bb-9d43-925815f24ff8": Smart
2025-07-02 19:24:49.581 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."BusinessId", f."CreatedAt", f."Description", f."FeatureName", f."Group", f."IsEnabled", f."Notes", f."Plan"
FROM "FeatureAccess" AS f
WHERE f."BusinessId" = @__businessId_0
2025-07-02 19:24:49.583 +05:30 [INF] 🔧 Feature override: AddProduct = False
2025-07-02 19:24:49.583 +05:30 [INF] 🔧 Feature override: Automation = True
2025-07-02 19:24:49.584 +05:30 [INF] 🔧 Feature override: Campaigns = True
2025-07-02 19:24:49.585 +05:30 [INF] 🔧 Feature override: Catalog = True
2025-07-02 19:24:49.585 +05:30 [INF] 🔧 Feature override: CRM = True
2025-07-02 19:24:49.586 +05:30 [INF] 🔧 Feature override: CRMInsights = True
2025-07-02 19:24:49.587 +05:30 [INF] 🔧 Feature override: CTAFlow = True
2025-07-02 19:24:49.587 +05:30 [INF] 🔧 Feature override: FlowInsights = True
2025-07-02 19:24:49.588 +05:30 [INF] 🔧 Feature override: Messaging = True
2025-07-02 19:24:49.588 +05:30 [INF] 🔧 Feature override: ProfileCompletion = True
2025-07-02 19:24:49.589 +05:30 [INF] 🔧 Feature override: UpgradePlan = True
2025-07-02 19:24:49.589 +05:30 [INF] 🔧 Feature override: WhatsAppSettings = True
2025-07-02 19:24:49.590 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 19:24:49.591 +05:30 [INF] Executed action xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api) in 16.1644ms
2025-07-02 19:24:49.593 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 19:24:49.593 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/feature-access/me - 200 null application/json; charset=utf-8 22.2918ms
2025-07-02 19:24:54.590 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/auth/session - null null
2025-07-02 19:24:54.593 +05:30 [INF] Executing endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 19:24:54.594 +05:30 [INF] Route matched with {action = "GetSession", controller = "Auth"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetSession() on controller xbytechat.api.AuthModule.Controllers.AuthController (xbytechat.api).
2025-07-02 19:24:54.597 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`4[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 19:24:54.598 +05:30 [INF] Executed action xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api) in 1.9406ms
2025-07-02 19:24:54.599 +05:30 [INF] Executed endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 19:24:54.599 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/auth/session - 200 null application/json; charset=utf-8 8.8127ms
2025-07-02 19:24:54.610 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/feature-access/me - null null
2025-07-02 19:24:54.613 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 19:24:54.614 +05:30 [INF] Route matched with {action = "GetMyFeatures", controller = "FeatureAccess"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto]]] GetMyFeatures() on controller xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController (xbytechat.api).
2025-07-02 19:24:54.619 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT b."Id", b."Address", b."ApprovedAt", b."ApprovedBy", b."BusinessEmail", b."BusinessName", b."CompanyName", b."CompanyPhone", b."CreatedAt", b."CreatedBy", b."CreatedByPartnerId", b."DeletedAt", b."DeletedBy", b."Industry", b."IsApproved", b."IsDeleted", b."LastLoginAt", b."LogoUrl", b."Notes", b."Phone", b."RepresentativeName", b."Source", b."Status", b."Tags", b."Website", b0."Id", b0."BusinessId", b0."CreatedAt", b0."Plan", b0."QuotaResetDate", b0."RemainingMessages", b0."TotalMonthlyQuota", b0."UpdatedAt", b0."WalletBalance"
FROM "Businesses" AS b
LEFT JOIN "BusinessPlanInfos" AS b0 ON b."Id" = b0."BusinessId"
WHERE b."Id" = @__businessId_0
LIMIT 1
2025-07-02 19:24:54.622 +05:30 [INF] 📦 Resolved plan for Business "c13be597-6ae2-42bb-9d43-925815f24ff8": Smart
2025-07-02 19:24:54.624 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."BusinessId", f."CreatedAt", f."Description", f."FeatureName", f."Group", f."IsEnabled", f."Notes", f."Plan"
FROM "FeatureAccess" AS f
WHERE f."BusinessId" = @__businessId_0
2025-07-02 19:24:54.626 +05:30 [INF] 🔧 Feature override: AddProduct = False
2025-07-02 19:24:54.627 +05:30 [INF] 🔧 Feature override: Automation = True
2025-07-02 19:24:54.627 +05:30 [INF] 🔧 Feature override: Campaigns = True
2025-07-02 19:24:54.628 +05:30 [INF] 🔧 Feature override: Catalog = True
2025-07-02 19:24:54.629 +05:30 [INF] 🔧 Feature override: CRM = True
2025-07-02 19:24:54.629 +05:30 [INF] 🔧 Feature override: CRMInsights = True
2025-07-02 19:24:54.630 +05:30 [INF] 🔧 Feature override: CTAFlow = True
2025-07-02 19:24:54.630 +05:30 [INF] 🔧 Feature override: FlowInsights = True
2025-07-02 19:24:54.631 +05:30 [INF] 🔧 Feature override: Messaging = True
2025-07-02 19:24:54.632 +05:30 [INF] 🔧 Feature override: ProfileCompletion = True
2025-07-02 19:24:54.632 +05:30 [INF] 🔧 Feature override: UpgradePlan = True
2025-07-02 19:24:54.633 +05:30 [INF] 🔧 Feature override: WhatsAppSettings = True
2025-07-02 19:24:54.634 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 19:24:54.635 +05:30 [INF] Executed action xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api) in 18.749ms
2025-07-02 19:24:54.636 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 19:24:54.637 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/feature-access/me - 200 null application/json; charset=utf-8 26.8992ms
2025-07-02 19:31:10.462 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/auth/session - null null
2025-07-02 19:31:10.468 +05:30 [INF] Executing endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 19:31:10.469 +05:30 [INF] Route matched with {action = "GetSession", controller = "Auth"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetSession() on controller xbytechat.api.AuthModule.Controllers.AuthController (xbytechat.api).
2025-07-02 19:31:10.470 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`4[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 19:31:10.471 +05:30 [INF] Executed action xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api) in 1.5199ms
2025-07-02 19:31:10.472 +05:30 [INF] Executed endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 19:31:10.473 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/auth/session - 200 null application/json; charset=utf-8 10.7812ms
2025-07-02 19:31:10.517 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/feature-access/me - null null
2025-07-02 19:31:10.520 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 19:31:10.521 +05:30 [INF] Route matched with {action = "GetMyFeatures", controller = "FeatureAccess"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto]]] GetMyFeatures() on controller xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController (xbytechat.api).
2025-07-02 19:31:10.632 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT b."Id", b."Address", b."ApprovedAt", b."ApprovedBy", b."BusinessEmail", b."BusinessName", b."CompanyName", b."CompanyPhone", b."CreatedAt", b."CreatedBy", b."CreatedByPartnerId", b."DeletedAt", b."DeletedBy", b."Industry", b."IsApproved", b."IsDeleted", b."LastLoginAt", b."LogoUrl", b."Notes", b."Phone", b."RepresentativeName", b."Source", b."Status", b."Tags", b."Website", b0."Id", b0."BusinessId", b0."CreatedAt", b0."Plan", b0."QuotaResetDate", b0."RemainingMessages", b0."TotalMonthlyQuota", b0."UpdatedAt", b0."WalletBalance"
FROM "Businesses" AS b
LEFT JOIN "BusinessPlanInfos" AS b0 ON b."Id" = b0."BusinessId"
WHERE b."Id" = @__businessId_0
LIMIT 1
2025-07-02 19:31:10.634 +05:30 [INF] 📦 Resolved plan for Business "c13be597-6ae2-42bb-9d43-925815f24ff8": Smart
2025-07-02 19:31:10.636 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."BusinessId", f."CreatedAt", f."Description", f."FeatureName", f."Group", f."IsEnabled", f."Notes", f."Plan"
FROM "FeatureAccess" AS f
WHERE f."BusinessId" = @__businessId_0
2025-07-02 19:31:10.638 +05:30 [INF] 🔧 Feature override: AddProduct = False
2025-07-02 19:31:10.639 +05:30 [INF] 🔧 Feature override: Automation = True
2025-07-02 19:31:10.640 +05:30 [INF] 🔧 Feature override: Campaigns = True
2025-07-02 19:31:10.640 +05:30 [INF] 🔧 Feature override: Catalog = True
2025-07-02 19:31:10.641 +05:30 [INF] 🔧 Feature override: CRM = True
2025-07-02 19:31:10.641 +05:30 [INF] 🔧 Feature override: CRMInsights = True
2025-07-02 19:31:10.642 +05:30 [INF] 🔧 Feature override: CTAFlow = True
2025-07-02 19:31:10.643 +05:30 [INF] 🔧 Feature override: FlowInsights = True
2025-07-02 19:31:10.643 +05:30 [INF] 🔧 Feature override: Messaging = True
2025-07-02 19:31:10.644 +05:30 [INF] 🔧 Feature override: ProfileCompletion = True
2025-07-02 19:31:10.645 +05:30 [INF] 🔧 Feature override: UpgradePlan = True
2025-07-02 19:31:10.645 +05:30 [INF] 🔧 Feature override: WhatsAppSettings = True
2025-07-02 19:31:10.646 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 19:31:10.647 +05:30 [INF] Executed action xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api) in 124.7064ms
2025-07-02 19:31:10.649 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 19:31:10.650 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/feature-access/me - 200 null application/json; charset=utf-8 132.117ms
2025-07-02 19:31:14.265 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/auth/session - null null
2025-07-02 19:31:14.268 +05:30 [INF] Executing endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 19:31:14.268 +05:30 [INF] Route matched with {action = "GetSession", controller = "Auth"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetSession() on controller xbytechat.api.AuthModule.Controllers.AuthController (xbytechat.api).
2025-07-02 19:31:14.270 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`4[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 19:31:14.271 +05:30 [INF] Executed action xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api) in 1.572ms
2025-07-02 19:31:14.273 +05:30 [INF] Executed endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 19:31:14.274 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/auth/session - 200 null application/json; charset=utf-8 8.4768ms
2025-07-02 19:31:14.454 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/feature-access/me - null null
2025-07-02 19:31:14.456 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 19:31:14.457 +05:30 [INF] Route matched with {action = "GetMyFeatures", controller = "FeatureAccess"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto]]] GetMyFeatures() on controller xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController (xbytechat.api).
2025-07-02 19:31:14.460 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT b."Id", b."Address", b."ApprovedAt", b."ApprovedBy", b."BusinessEmail", b."BusinessName", b."CompanyName", b."CompanyPhone", b."CreatedAt", b."CreatedBy", b."CreatedByPartnerId", b."DeletedAt", b."DeletedBy", b."Industry", b."IsApproved", b."IsDeleted", b."LastLoginAt", b."LogoUrl", b."Notes", b."Phone", b."RepresentativeName", b."Source", b."Status", b."Tags", b."Website", b0."Id", b0."BusinessId", b0."CreatedAt", b0."Plan", b0."QuotaResetDate", b0."RemainingMessages", b0."TotalMonthlyQuota", b0."UpdatedAt", b0."WalletBalance"
FROM "Businesses" AS b
LEFT JOIN "BusinessPlanInfos" AS b0 ON b."Id" = b0."BusinessId"
WHERE b."Id" = @__businessId_0
LIMIT 1
2025-07-02 19:31:14.464 +05:30 [INF] 📦 Resolved plan for Business "c13be597-6ae2-42bb-9d43-925815f24ff8": Smart
2025-07-02 19:31:14.465 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."BusinessId", f."CreatedAt", f."Description", f."FeatureName", f."Group", f."IsEnabled", f."Notes", f."Plan"
FROM "FeatureAccess" AS f
WHERE f."BusinessId" = @__businessId_0
2025-07-02 19:31:14.467 +05:30 [INF] 🔧 Feature override: AddProduct = False
2025-07-02 19:31:14.468 +05:30 [INF] 🔧 Feature override: Automation = True
2025-07-02 19:31:14.469 +05:30 [INF] 🔧 Feature override: Campaigns = True
2025-07-02 19:31:14.469 +05:30 [INF] 🔧 Feature override: Catalog = True
2025-07-02 19:31:14.470 +05:30 [INF] 🔧 Feature override: CRM = True
2025-07-02 19:31:14.471 +05:30 [INF] 🔧 Feature override: CRMInsights = True
2025-07-02 19:31:14.471 +05:30 [INF] 🔧 Feature override: CTAFlow = True
2025-07-02 19:31:14.472 +05:30 [INF] 🔧 Feature override: FlowInsights = True
2025-07-02 19:31:14.473 +05:30 [INF] 🔧 Feature override: Messaging = True
2025-07-02 19:31:14.473 +05:30 [INF] 🔧 Feature override: ProfileCompletion = True
2025-07-02 19:31:14.474 +05:30 [INF] 🔧 Feature override: UpgradePlan = True
2025-07-02 19:31:14.474 +05:30 [INF] 🔧 Feature override: WhatsAppSettings = True
2025-07-02 19:31:14.475 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 19:31:14.476 +05:30 [INF] Executed action xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api) in 17.8701ms
2025-07-02 19:31:14.477 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 19:31:14.478 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/feature-access/me - 200 null application/json; charset=utf-8 24.5174ms
2025-07-02 19:33:32.137 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/auth/session - null null
2025-07-02 19:33:32.143 +05:30 [INF] Executing endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 19:33:32.144 +05:30 [INF] Route matched with {action = "GetSession", controller = "Auth"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetSession() on controller xbytechat.api.AuthModule.Controllers.AuthController (xbytechat.api).
2025-07-02 19:33:32.146 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`4[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 19:33:32.147 +05:30 [INF] Executed action xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api) in 1.5964ms
2025-07-02 19:33:32.148 +05:30 [INF] Executed endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 19:33:32.149 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/auth/session - 200 null application/json; charset=utf-8 12.5801ms
2025-07-02 19:33:32.163 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/feature-access/me - null null
2025-07-02 19:33:32.166 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 19:33:32.167 +05:30 [INF] Route matched with {action = "GetMyFeatures", controller = "FeatureAccess"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto]]] GetMyFeatures() on controller xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController (xbytechat.api).
2025-07-02 19:33:32.172 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT b."Id", b."Address", b."ApprovedAt", b."ApprovedBy", b."BusinessEmail", b."BusinessName", b."CompanyName", b."CompanyPhone", b."CreatedAt", b."CreatedBy", b."CreatedByPartnerId", b."DeletedAt", b."DeletedBy", b."Industry", b."IsApproved", b."IsDeleted", b."LastLoginAt", b."LogoUrl", b."Notes", b."Phone", b."RepresentativeName", b."Source", b."Status", b."Tags", b."Website", b0."Id", b0."BusinessId", b0."CreatedAt", b0."Plan", b0."QuotaResetDate", b0."RemainingMessages", b0."TotalMonthlyQuota", b0."UpdatedAt", b0."WalletBalance"
FROM "Businesses" AS b
LEFT JOIN "BusinessPlanInfos" AS b0 ON b."Id" = b0."BusinessId"
WHERE b."Id" = @__businessId_0
LIMIT 1
2025-07-02 19:33:32.174 +05:30 [INF] 📦 Resolved plan for Business "c13be597-6ae2-42bb-9d43-925815f24ff8": Smart
2025-07-02 19:33:32.176 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."BusinessId", f."CreatedAt", f."Description", f."FeatureName", f."Group", f."IsEnabled", f."Notes", f."Plan"
FROM "FeatureAccess" AS f
WHERE f."BusinessId" = @__businessId_0
2025-07-02 19:33:32.178 +05:30 [INF] 🔧 Feature override: AddProduct = False
2025-07-02 19:33:32.179 +05:30 [INF] 🔧 Feature override: Automation = True
2025-07-02 19:33:32.179 +05:30 [INF] 🔧 Feature override: Campaigns = True
2025-07-02 19:33:32.180 +05:30 [INF] 🔧 Feature override: Catalog = True
2025-07-02 19:33:32.180 +05:30 [INF] 🔧 Feature override: CRM = True
2025-07-02 19:33:32.181 +05:30 [INF] 🔧 Feature override: CRMInsights = True
2025-07-02 19:33:32.181 +05:30 [INF] 🔧 Feature override: CTAFlow = True
2025-07-02 19:33:32.182 +05:30 [INF] 🔧 Feature override: FlowInsights = True
2025-07-02 19:33:32.182 +05:30 [INF] 🔧 Feature override: Messaging = True
2025-07-02 19:33:32.183 +05:30 [INF] 🔧 Feature override: ProfileCompletion = True
2025-07-02 19:33:32.183 +05:30 [INF] 🔧 Feature override: UpgradePlan = True
2025-07-02 19:33:32.184 +05:30 [INF] 🔧 Feature override: WhatsAppSettings = True
2025-07-02 19:33:32.185 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 19:33:32.186 +05:30 [INF] Executed action xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api) in 17.1475ms
2025-07-02 19:33:32.187 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 19:33:32.188 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/feature-access/me - 200 null application/json; charset=utf-8 25.0218ms
2025-07-02 19:49:02.373 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/contacts?tab=all&search= - null null
2025-07-02 19:49:02.381 +05:30 [INF] CORS policy execution successful.
2025-07-02 19:49:02.382 +05:30 [INF] Executing endpoint 'xbytechat.api.CRM.Controllers.ContactsController.GetAllContacts (xbytechat.api)'
2025-07-02 19:49:02.383 +05:30 [INF] Route matched with {action = "GetAllContacts", controller = "Contacts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllContacts(System.String, Int32, Int32) on controller xbytechat.api.CRM.Controllers.ContactsController (xbytechat.api).
2025-07-02 19:49:02.386 +05:30 [INF] GetPagedContactsAsync: businessId="c13be597-6ae2-42bb-9d43-925815f24ff8", tab=all, page=1, pageSize=25
2025-07-02 19:49:02.501 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Contacts" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."IsActive"
2025-07-02 19:49:02.506 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__p_2='25', @__p_1='0'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."AssignedAgentId", t."BusinessId", t."CreatedAt", t."Email", t."Group", t."IsActive", t."IsArchived", t."IsAutomationPaused", t."IsFavorite", t."LastCTAInteraction", t."LastCTAType", t."LastClickedProductId", t."LastContactedAt", t."LeadSource", t."Name", t."NextFollowUpAt", t."Notes", t."PhoneNumber", t."Tags", t0."Id", t0."AssignedAt", t0."AssignedBy", t0."BusinessId", t0."ContactId", t0."TagId", t0."Id0", t0."BusinessId0", t0."Category", t0."ColorHex", t0."CreatedAt", t0."IsActive", t0."IsSystemTag", t0."LastUsedAt", t0."Name", t0."Notes"
FROM (
    SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."Tags"
    FROM "Contacts" AS c
    WHERE c."BusinessId" = @__businessId_0 AND c."IsActive"
    ORDER BY c."Name"
    LIMIT @__p_2 OFFSET @__p_1
) AS t
LEFT JOIN (
    SELECT c0."Id", c0."AssignedAt", c0."AssignedBy", c0."BusinessId", c0."ContactId", c0."TagId", t1."Id" AS "Id0", t1."BusinessId" AS "BusinessId0", t1."Category", t1."ColorHex", t1."CreatedAt", t1."IsActive", t1."IsSystemTag", t1."LastUsedAt", t1."Name", t1."Notes"
    FROM "ContactTags" AS c0
    INNER JOIN "Tags" AS t1 ON c0."TagId" = t1."Id"
) AS t0 ON t."Id" = t0."ContactId"
ORDER BY t."Name", t."Id", t0."Id"
2025-07-02 19:49:02.508 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Helpers.ResponseResult'.
2025-07-02 19:49:02.509 +05:30 [INF] Executed action xbytechat.api.CRM.Controllers.ContactsController.GetAllContacts (xbytechat.api) in 124.4661ms
2025-07-02 19:49:02.510 +05:30 [INF] Executed endpoint 'xbytechat.api.CRM.Controllers.ContactsController.GetAllContacts (xbytechat.api)'
2025-07-02 19:49:02.511 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/contacts?tab=all&search= - 200 null application/json; charset=utf-8 138.4215ms
2025-07-02 19:49:02.686 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/tags - null null
2025-07-02 19:49:02.689 +05:30 [INF] Executing endpoint 'xbytechat.api.CRM.Controllers.TagsController.GetAllTags (xbytechat.api)'
2025-07-02 19:49:02.690 +05:30 [INF] Route matched with {action = "GetAllTags", controller = "Tags"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllTags() on controller xbytechat.api.CRM.Controllers.TagsController (xbytechat.api).
2025-07-02 19:49:02.694 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."Name", t."ColorHex", t."Category", t."Notes", t."IsSystemTag", t."IsActive", t."CreatedAt", t."LastUsedAt"
FROM "Tags" AS t
WHERE t."BusinessId" = @__businessId_0 AND t."IsActive"
ORDER BY t."CreatedAt" DESC
2025-07-02 19:49:02.697 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Helpers.ResponseResult'.
2025-07-02 19:49:02.698 +05:30 [INF] Executed action xbytechat.api.CRM.Controllers.TagsController.GetAllTags (xbytechat.api) in 6.4801ms
2025-07-02 19:49:02.699 +05:30 [INF] Executed endpoint 'xbytechat.api.CRM.Controllers.TagsController.GetAllTags (xbytechat.api)'
2025-07-02 19:49:02.699 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/tags - 200 null application/json; charset=utf-8 13.375ms
2025-07-02 19:57:34.435 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/Campaign/paginated?page=1&pageSize=10&status= - null null
2025-07-02 19:57:34.444 +05:30 [INF] CORS policy execution successful.
2025-07-02 19:57:34.445 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetPaginatedCampaigns (xbytechat.api)'
2025-07-02 19:57:34.446 +05:30 [INF] Route matched with {action = "GetPaginatedCampaigns", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPaginatedCampaigns(xbytechat.api.Shared.PaginatedRequest) on controller xbytechat.api.Features.CampaignModule.Controllers.CampaignController (xbytechat.api).
2025-07-02 19:57:34.668 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Campaigns" AS c
WHERE c."BusinessId" = @__businessId_0
2025-07-02 19:57:34.672 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__p_2='10', @__p_1='0'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Name", c."Status", c."ScheduledAt", c."CreatedAt"
FROM "Campaigns" AS c
WHERE c."BusinessId" = @__businessId_0
ORDER BY c."CreatedAt" DESC
LIMIT @__p_2 OFFSET @__p_1
2025-07-02 19:57:34.674 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Shared.PaginatedResponse`1[[xbytechat.api.Features.CampaignModule.DTOs.CampaignSummaryDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 19:57:34.675 +05:30 [INF] Executed action xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetPaginatedCampaigns (xbytechat.api) in 227.9204ms
2025-07-02 19:57:34.676 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetPaginatedCampaigns (xbytechat.api)'
2025-07-02 19:57:34.677 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/Campaign/paginated?page=1&pageSize=10&status= - 200 null application/json; charset=utf-8 241.9762ms
2025-07-02 19:57:39.069 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/Campaign/paginated?page=1&pageSize=10&status= - null null
2025-07-02 19:57:39.071 +05:30 [INF] CORS policy execution successful.
2025-07-02 19:57:39.072 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetPaginatedCampaigns (xbytechat.api)'
2025-07-02 19:57:39.073 +05:30 [INF] Route matched with {action = "GetPaginatedCampaigns", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPaginatedCampaigns(xbytechat.api.Shared.PaginatedRequest) on controller xbytechat.api.Features.CampaignModule.Controllers.CampaignController (xbytechat.api).
2025-07-02 19:57:39.077 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Campaigns" AS c
WHERE c."BusinessId" = @__businessId_0
2025-07-02 19:57:39.082 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__p_2='10', @__p_1='0'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Name", c."Status", c."ScheduledAt", c."CreatedAt"
FROM "Campaigns" AS c
WHERE c."BusinessId" = @__businessId_0
ORDER BY c."CreatedAt" DESC
LIMIT @__p_2 OFFSET @__p_1
2025-07-02 19:57:39.084 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Shared.PaginatedResponse`1[[xbytechat.api.Features.CampaignModule.DTOs.CampaignSummaryDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 19:57:39.085 +05:30 [INF] Executed action xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetPaginatedCampaigns (xbytechat.api) in 10.7666ms
2025-07-02 19:57:39.086 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetPaginatedCampaigns (xbytechat.api)'
2025-07-02 19:57:39.087 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/Campaign/paginated?page=1&pageSize=10&status= - 200 null application/json; charset=utf-8 18.7246ms
2025-07-02 19:59:20.941 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null null
2025-07-02 19:59:20.951 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/inbox/unread-counts - null null
2025-07-02 19:59:20.961 +05:30 [INF] CORS policy execution successful.
2025-07-02 19:59:20.951 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/contacts - null null
2025-07-02 19:59:20.971 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 204 null null 29.67ms
2025-07-02 19:59:20.971 +05:30 [INF] CORS policy execution successful.
2025-07-02 19:59:20.969 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null null
2025-07-02 19:59:20.978 +05:30 [INF] CORS policy execution successful.
2025-07-02 19:59:20.978 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null 0
2025-07-02 19:59:20.982 +05:30 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '02-07-2025 02:27:47 PM', Current time (UTC): '02-07-2025 02:29:20 PM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-07-02 19:59:20.983 +05:30 [INF] CORS policy execution successful.
2025-07-02 19:59:20.984 +05:30 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '02-07-2025 02:27:47 PM', Current time (UTC): '02-07-2025 02:29:20 PM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-07-02 19:59:20.991 +05:30 [INF] CORS policy execution successful.
2025-07-02 19:59:20.997 +05:30 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '02-07-2025 02:27:47 PM', Current time (UTC): '02-07-2025 02:29:20 PM'.
2025-07-02 19:59:20.999 +05:30 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '02-07-2025 02:27:47 PM', Current time (UTC): '02-07-2025 02:29:20 PM'.
2025-07-02 19:59:20.997 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 204 null null 28.1108ms
2025-07-02 19:59:21.000 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null 0
2025-07-02 19:59:21.039 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Inbox.Controllers.InboxController.GetUnreadCounts (xbytechat.api)'
2025-07-02 19:59:21.040 +05:30 [INF] Executing endpoint 'xbytechat.api.CRM.Controllers.ContactsController.GetAllContacts (xbytechat.api)'
2025-07-02 19:59:21.003 +05:30 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '02-07-2025 02:27:47 PM', Current time (UTC): '02-07-2025 02:29:20 PM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-07-02 19:59:21.044 +05:30 [INF] CORS policy execution successful.
2025-07-02 19:59:21.045 +05:30 [INF] Route matched with {action = "GetUnreadCounts", controller = "Inbox"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUnreadCounts() on controller xbytechat.api.Features.Inbox.Controllers.InboxController (xbytechat.api).
2025-07-02 19:59:21.046 +05:30 [INF] Route matched with {action = "GetAllContacts", controller = "Contacts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllContacts(System.String, Int32, Int32) on controller xbytechat.api.CRM.Controllers.ContactsController (xbytechat.api).
2025-07-02 19:59:21.047 +05:30 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '02-07-2025 02:27:47 PM', Current time (UTC): '02-07-2025 02:29:20 PM'.
2025-07-02 19:59:21.048 +05:30 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '02-07-2025 02:27:47 PM', Current time (UTC): '02-07-2025 02:29:21 PM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-07-02 19:59:21.066 +05:30 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-07-02 19:59:21.084 +05:30 [INF] Executed action xbytechat.api.Features.Inbox.Controllers.InboxController.GetUnreadCounts (xbytechat.api) in 35.7605ms
2025-07-02 19:59:21.084 +05:30 [INF] Executed action xbytechat.api.CRM.Controllers.ContactsController.GetAllContacts (xbytechat.api) in 34.6482ms
2025-07-02 19:59:21.085 +05:30 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '02-07-2025 02:27:47 PM', Current time (UTC): '02-07-2025 02:29:21 PM'.
2025-07-02 19:59:21.098 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Inbox.Controllers.InboxController.GetUnreadCounts (xbytechat.api)'
2025-07-02 19:59:21.099 +05:30 [INF] Executed endpoint 'xbytechat.api.CRM.Controllers.ContactsController.GetAllContacts (xbytechat.api)'
2025-07-02 19:59:21.098 +05:30 [ERR] ❌ An unhandled exception occurred
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ThrowResponseAlreadyStartedException(String value)
   at Microsoft.AspNetCore.Http.DefaultHttpResponse.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Authentication.JwtBearer.JwtBearerHandler.HandleChallengeAsync(AuthenticationProperties properties)
   at Microsoft.AspNetCore.Authentication.AuthenticationHandler`1.ChallengeAsync(AuthenticationProperties properties)
   at Microsoft.AspNetCore.Authentication.AuthenticationService.ChallengeAsync(HttpContext context, String scheme, AuthenticationProperties properties)
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.<>c__DisplayClass0_0.<<HandleAsync>g__Handle|0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at GlobalExceptionMiddleware.Invoke(HttpContext context) in D:\xbytechat\xbytechat-api\xbytechat-api\Middlewares\GlobalExceptionMiddleware.cs:line 32
2025-07-02 19:59:21.100 +05:30 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-07-02 19:59:21.113 +05:30 [ERR] ❌ An unhandled exception occurred
System.UnauthorizedAccessException: Invalid or missing userId in token.
   at xbytechat.api.Shared.ClaimsBusinessDetails.GetUserId(ClaimsPrincipal user) in D:\xbytechat\xbytechat-api\xbytechat-api\Shared\ClaimsBusinessDetails.cs:line 20
   at xbytechat.api.Features.Inbox.Controllers.InboxController.GetUnreadCounts() in D:\xbytechat\xbytechat-api\xbytechat-api\Features\Inbox\Controllers\InboxController.cs:line 100
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at GlobalExceptionMiddleware.Invoke(HttpContext context) in D:\xbytechat\xbytechat-api\xbytechat-api\Middlewares\GlobalExceptionMiddleware.cs:line 32
2025-07-02 19:59:21.124 +05:30 [ERR] ❌ An unhandled exception occurred
System.UnauthorizedAccessException: Invalid or missing businessId in token.
   at xbytechat.api.Shared.ClaimsBusinessDetails.GetBusinessId(ClaimsPrincipal user) in D:\xbytechat\xbytechat-api\xbytechat-api\Shared\ClaimsBusinessDetails.cs:line 12
   at xbytechat.api.CRM.Controllers.ContactsController.GetAllContacts(String tab, Int32 page, Int32 pageSize) in D:\xbytechat\xbytechat-api\xbytechat-api\CRM\Controllers\ContactsController.cs:line 135
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at GlobalExceptionMiddleware.Invoke(HttpContext context) in D:\xbytechat\xbytechat-api\xbytechat-api\Middlewares\GlobalExceptionMiddleware.cs:line 32
2025-07-02 19:59:21.126 +05:30 [ERR] Response has already started, unable to write error response for path: /hubs/inbox/negotiate
2025-07-02 19:59:21.139 +05:30 [ERR] ❌ An unhandled exception occurred
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ThrowResponseAlreadyStartedException(String value)
   at Microsoft.AspNetCore.Http.DefaultHttpResponse.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Authentication.JwtBearer.JwtBearerHandler.HandleChallengeAsync(AuthenticationProperties properties)
   at Microsoft.AspNetCore.Authentication.AuthenticationHandler`1.ChallengeAsync(AuthenticationProperties properties)
   at Microsoft.AspNetCore.Authentication.AuthenticationService.ChallengeAsync(HttpContext context, String scheme, AuthenticationProperties properties)
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.<>c__DisplayClass0_0.<<HandleAsync>g__Handle|0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at GlobalExceptionMiddleware.Invoke(HttpContext context) in D:\xbytechat\xbytechat-api\xbytechat-api\Middlewares\GlobalExceptionMiddleware.cs:line 32
2025-07-02 19:59:21.142 +05:30 [ERR] Response has already started, unable to write error response for path: /api/inbox/unread-counts
2025-07-02 19:59:21.145 +05:30 [ERR] Response has already started, unable to write error response for path: /api/contacts
2025-07-02 19:59:21.145 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 401 null application/json 167.2034ms
2025-07-02 19:59:21.147 +05:30 [ERR] Response has already started, unable to write error response for path: /hubs/inbox/negotiate
2025-07-02 19:59:21.148 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/inbox/unread-counts - 401 null application/json 196.7978ms
2025-07-02 19:59:21.148 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/contacts - 401 null application/json 197.3419ms
2025-07-02 19:59:21.152 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 401 null application/json 152.1153ms
2025-07-02 19:59:21.153 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/api/auth/refresh - null null
2025-07-02 19:59:21.161 +05:30 [INF] CORS policy execution successful.
2025-07-02 19:59:21.162 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/api/auth/refresh - 204 null null 8.516ms
2025-07-02 19:59:21.163 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/api/auth/refresh - application/json 2
2025-07-02 19:59:21.165 +05:30 [INF] CORS policy execution successful.
2025-07-02 19:59:21.166 +05:30 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '02-07-2025 02:27:47 PM', Current time (UTC): '02-07-2025 02:29:21 PM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-07-02 19:59:21.168 +05:30 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '02-07-2025 02:27:47 PM', Current time (UTC): '02-07-2025 02:29:21 PM'.
2025-07-02 19:59:21.169 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/api/auth/refresh - 401 null application/json 5.8077ms
2025-07-02 19:59:21.171 +05:30 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: POST http://localhost:7113/api/auth/refresh, Response status code: 401
2025-07-02 19:59:22.141 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/auth/session - null null
2025-07-02 19:59:22.144 +05:30 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '02-07-2025 02:27:47 PM', Current time (UTC): '02-07-2025 02:29:22 PM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-07-02 19:59:22.146 +05:30 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '02-07-2025 02:27:47 PM', Current time (UTC): '02-07-2025 02:29:22 PM'.
2025-07-02 19:59:22.147 +05:30 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-07-02 19:59:22.163 +05:30 [ERR] ❌ An unhandled exception occurred
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ThrowResponseAlreadyStartedException(String value)
   at Microsoft.AspNetCore.Http.DefaultHttpResponse.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Authentication.JwtBearer.JwtBearerHandler.HandleChallengeAsync(AuthenticationProperties properties)
   at Microsoft.AspNetCore.Authentication.AuthenticationHandler`1.ChallengeAsync(AuthenticationProperties properties)
   at Microsoft.AspNetCore.Authentication.AuthenticationService.ChallengeAsync(HttpContext context, String scheme, AuthenticationProperties properties)
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.<>c__DisplayClass0_0.<<HandleAsync>g__Handle|0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at GlobalExceptionMiddleware.Invoke(HttpContext context) in D:\xbytechat\xbytechat-api\xbytechat-api\Middlewares\GlobalExceptionMiddleware.cs:line 32
2025-07-02 19:59:22.166 +05:30 [ERR] Response has already started, unable to write error response for path: /api/auth/session
2025-07-02 19:59:22.167 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/auth/session - 401 null application/json 25.8844ms
2025-07-02 19:59:23.139 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/auth/session - null null
2025-07-02 19:59:23.141 +05:30 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '02-07-2025 02:27:47 PM', Current time (UTC): '02-07-2025 02:29:23 PM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-07-02 19:59:23.143 +05:30 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '02-07-2025 02:27:47 PM', Current time (UTC): '02-07-2025 02:29:23 PM'.
2025-07-02 19:59:23.144 +05:30 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-07-02 19:59:23.158 +05:30 [ERR] ❌ An unhandled exception occurred
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ThrowResponseAlreadyStartedException(String value)
   at Microsoft.AspNetCore.Http.DefaultHttpResponse.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Authentication.JwtBearer.JwtBearerHandler.HandleChallengeAsync(AuthenticationProperties properties)
   at Microsoft.AspNetCore.Authentication.AuthenticationHandler`1.ChallengeAsync(AuthenticationProperties properties)
   at Microsoft.AspNetCore.Authentication.AuthenticationService.ChallengeAsync(HttpContext context, String scheme, AuthenticationProperties properties)
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.<>c__DisplayClass0_0.<<HandleAsync>g__Handle|0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at GlobalExceptionMiddleware.Invoke(HttpContext context) in D:\xbytechat\xbytechat-api\xbytechat-api\Middlewares\GlobalExceptionMiddleware.cs:line 32
2025-07-02 19:59:23.162 +05:30 [ERR] Response has already started, unable to write error response for path: /api/auth/session
2025-07-02 19:59:23.163 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/auth/session - 401 null application/json 24.0204ms
2025-07-02 19:59:42.780 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/api/auth/login - null null
2025-07-02 19:59:42.782 +05:30 [INF] CORS policy execution successful.
2025-07-02 19:59:42.783 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/api/auth/login - 204 null null 3.1602ms
2025-07-02 19:59:42.785 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/api/auth/login - application/json 47
2025-07-02 19:59:42.788 +05:30 [INF] CORS policy execution successful.
2025-07-02 19:59:42.789 +05:30 [INF] Executing endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.Login (xbytechat.api)'
2025-07-02 19:59:42.789 +05:30 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(xbytechat.api.AuthModule.DTOs.UserLoginDto) on controller xbytechat.api.AuthModule.Controllers.AuthController (xbytechat.api).
2025-07-02 19:59:42.791 +05:30 [INF] 🔑 Login attempt for email: ratan@tcs.com
2025-07-02 19:59:42.795 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__dto_Email_0='ratan@tcs.com', @__hashedPassword_1='JAvlGPq9JyTdtvBO6x2llnRI1+gxwIyPqCKAn3THIKk='], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."BusinessId", u."CreatedAt", u."DeletedAt", u."Email", u."IsDeleted", u."Name", u."PasswordHash", u."RefreshToken", u."RefreshTokenExpiry", u."RoleId", u."Status", r."Id", r."CreatedAt", r."Description", r."IsActive", r."IsSystemDefined", r."Name"
FROM "Users" AS u
LEFT JOIN "Roles" AS r ON u."RoleId" = r."Id"
WHERE u."Email" = @__dto_Email_0 AND u."PasswordHash" = @__hashedPassword_1 AND NOT (u."IsDeleted")
LIMIT 1
2025-07-02 19:59:42.798 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__user_BusinessId_Value_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT b."Id", b."Address", b."ApprovedAt", b."ApprovedBy", b."BusinessEmail", b."BusinessName", b."CompanyName", b."CompanyPhone", b."CreatedAt", b."CreatedBy", b."CreatedByPartnerId", b."DeletedAt", b."DeletedBy", b."Industry", b."IsApproved", b."IsDeleted", b."LastLoginAt", b."LogoUrl", b."Notes", b."Phone", b."RepresentativeName", b."Source", b."Status", b."Tags", b."Website", b0."Id", b0."BusinessId", b0."CreatedAt", b0."Plan", b0."QuotaResetDate", b0."RemainingMessages", b0."TotalMonthlyQuota", b0."UpdatedAt", b0."WalletBalance"
FROM "Businesses" AS b
LEFT JOIN "BusinessPlanInfos" AS b0 ON b."Id" = b0."BusinessId"
WHERE b."Id" = @__user_BusinessId_Value_0
LIMIT 1
2025-07-02 19:59:42.801 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__user_RoleId_0='00000000-0000-0000-0000-000000000004' (Nullable = true)], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."AssignedAt", r."AssignedBy", r."IsActive", r."IsRevoked", r."PermissionId", r."RoleId"
FROM "RolePermissions" AS r
WHERE r."RoleId" = @__user_RoleId_0 AND NOT (r."IsRevoked")
2025-07-02 19:59:42.804 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='2870e1d8-0e80-4b12-88bd-70a8113307d6'], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."AssignedAt", u."AssignedBy", u."IsGranted", u."IsRevoked", u."PermissionId", u."UserId"
FROM "UserPermissions" AS u
WHERE u."UserId" = @__userId_0 AND NOT (u."IsRevoked")
2025-07-02 19:59:42.807 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__permissionIds_0={ '30000000-0000-0000-0000-000000000000', '30000000-0000-0000-0000-000000000004', '30000000-0000-0000-0000-000000000001', '30000000-0000-0000-0000-000000000007' } (DbType = Object)], CommandType='"Text"', CommandTimeout='30']
SELECT p."Id", p."Code", p."CreatedAt", p."Description", p."Group", p."IsActive", p."Name"
FROM "Permissions" AS p
WHERE p."Id" = ANY (@__permissionIds_0)
2025-07-02 19:59:42.808 +05:30 [INF] ✅ Token generated for: ratan@tcs.com
2025-07-02 19:59:42.809 +05:30 [INF] ✅ Login successful for ratan@tcs.com, Role: business, Plan: Smart
2025-07-02 19:59:42.810 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`3[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 19:59:42.811 +05:30 [INF] Executed action xbytechat.api.AuthModule.Controllers.AuthController.Login (xbytechat.api) in 20.6564ms
2025-07-02 19:59:42.812 +05:30 [INF] Executed endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.Login (xbytechat.api)'
2025-07-02 19:59:42.813 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/api/auth/login - 200 null application/json; charset=utf-8 28.5537ms
2025-07-02 19:59:42.819 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/auth/session - null null
2025-07-02 19:59:42.821 +05:30 [INF] Executing endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 19:59:42.822 +05:30 [INF] Route matched with {action = "GetSession", controller = "Auth"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetSession() on controller xbytechat.api.AuthModule.Controllers.AuthController (xbytechat.api).
2025-07-02 19:59:42.824 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`4[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 19:59:42.825 +05:30 [INF] Executed action xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api) in 1.2738ms
2025-07-02 19:59:42.826 +05:30 [INF] Executed endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 19:59:42.826 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/auth/session - 200 null application/json; charset=utf-8 7.5847ms
2025-07-02 19:59:43.148 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/feature-access/me - null null
2025-07-02 19:59:43.150 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 19:59:43.151 +05:30 [INF] Route matched with {action = "GetMyFeatures", controller = "FeatureAccess"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto]]] GetMyFeatures() on controller xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController (xbytechat.api).
2025-07-02 19:59:43.173 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT b."Id", b."Address", b."ApprovedAt", b."ApprovedBy", b."BusinessEmail", b."BusinessName", b."CompanyName", b."CompanyPhone", b."CreatedAt", b."CreatedBy", b."CreatedByPartnerId", b."DeletedAt", b."DeletedBy", b."Industry", b."IsApproved", b."IsDeleted", b."LastLoginAt", b."LogoUrl", b."Notes", b."Phone", b."RepresentativeName", b."Source", b."Status", b."Tags", b."Website", b0."Id", b0."BusinessId", b0."CreatedAt", b0."Plan", b0."QuotaResetDate", b0."RemainingMessages", b0."TotalMonthlyQuota", b0."UpdatedAt", b0."WalletBalance"
FROM "Businesses" AS b
LEFT JOIN "BusinessPlanInfos" AS b0 ON b."Id" = b0."BusinessId"
WHERE b."Id" = @__businessId_0
LIMIT 1
2025-07-02 19:59:43.175 +05:30 [INF] 📦 Resolved plan for Business "c13be597-6ae2-42bb-9d43-925815f24ff8": Smart
2025-07-02 19:59:43.177 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."BusinessId", f."CreatedAt", f."Description", f."FeatureName", f."Group", f."IsEnabled", f."Notes", f."Plan"
FROM "FeatureAccess" AS f
WHERE f."BusinessId" = @__businessId_0
2025-07-02 19:59:43.179 +05:30 [INF] 🔧 Feature override: AddProduct = False
2025-07-02 19:59:43.179 +05:30 [INF] 🔧 Feature override: Automation = True
2025-07-02 19:59:43.180 +05:30 [INF] 🔧 Feature override: Campaigns = True
2025-07-02 19:59:43.180 +05:30 [INF] 🔧 Feature override: Catalog = True
2025-07-02 19:59:43.181 +05:30 [INF] 🔧 Feature override: CRM = True
2025-07-02 19:59:43.181 +05:30 [INF] 🔧 Feature override: CRMInsights = True
2025-07-02 19:59:43.182 +05:30 [INF] 🔧 Feature override: CTAFlow = True
2025-07-02 19:59:43.182 +05:30 [INF] 🔧 Feature override: FlowInsights = True
2025-07-02 19:59:43.183 +05:30 [INF] 🔧 Feature override: Messaging = True
2025-07-02 19:59:43.183 +05:30 [INF] 🔧 Feature override: ProfileCompletion = True
2025-07-02 19:59:43.184 +05:30 [INF] 🔧 Feature override: UpgradePlan = True
2025-07-02 19:59:43.184 +05:30 [INF] 🔧 Feature override: WhatsAppSettings = True
2025-07-02 19:59:43.185 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 19:59:43.186 +05:30 [INF] Executed action xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api) in 33.4642ms
2025-07-02 19:59:43.187 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 19:59:43.188 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/feature-access/me - 200 null application/json; charset=utf-8 39.6197ms
2025-07-02 20:02:14.778 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/auth/session - null null
2025-07-02 20:02:14.785 +05:30 [INF] Executing endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 20:02:14.786 +05:30 [INF] Route matched with {action = "GetSession", controller = "Auth"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetSession() on controller xbytechat.api.AuthModule.Controllers.AuthController (xbytechat.api).
2025-07-02 20:02:14.788 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`4[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 20:02:14.789 +05:30 [INF] Executed action xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api) in 1.5559ms
2025-07-02 20:02:14.790 +05:30 [INF] Executed endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 20:02:14.791 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/auth/session - 200 null application/json; charset=utf-8 12.888ms
2025-07-02 20:02:14.842 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/feature-access/me - null null
2025-07-02 20:02:14.844 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 20:02:14.845 +05:30 [INF] Route matched with {action = "GetMyFeatures", controller = "FeatureAccess"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto]]] GetMyFeatures() on controller xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController (xbytechat.api).
2025-07-02 20:02:14.850 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT b."Id", b."Address", b."ApprovedAt", b."ApprovedBy", b."BusinessEmail", b."BusinessName", b."CompanyName", b."CompanyPhone", b."CreatedAt", b."CreatedBy", b."CreatedByPartnerId", b."DeletedAt", b."DeletedBy", b."Industry", b."IsApproved", b."IsDeleted", b."LastLoginAt", b."LogoUrl", b."Notes", b."Phone", b."RepresentativeName", b."Source", b."Status", b."Tags", b."Website", b0."Id", b0."BusinessId", b0."CreatedAt", b0."Plan", b0."QuotaResetDate", b0."RemainingMessages", b0."TotalMonthlyQuota", b0."UpdatedAt", b0."WalletBalance"
FROM "Businesses" AS b
LEFT JOIN "BusinessPlanInfos" AS b0 ON b."Id" = b0."BusinessId"
WHERE b."Id" = @__businessId_0
LIMIT 1
2025-07-02 20:02:14.854 +05:30 [INF] 📦 Resolved plan for Business "c13be597-6ae2-42bb-9d43-925815f24ff8": Smart
2025-07-02 20:02:14.856 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."BusinessId", f."CreatedAt", f."Description", f."FeatureName", f."Group", f."IsEnabled", f."Notes", f."Plan"
FROM "FeatureAccess" AS f
WHERE f."BusinessId" = @__businessId_0
2025-07-02 20:02:14.864 +05:30 [INF] 🔧 Feature override: AddProduct = False
2025-07-02 20:02:14.865 +05:30 [INF] 🔧 Feature override: Automation = True
2025-07-02 20:02:14.866 +05:30 [INF] 🔧 Feature override: Campaigns = True
2025-07-02 20:02:14.867 +05:30 [INF] 🔧 Feature override: Catalog = True
2025-07-02 20:02:14.867 +05:30 [INF] 🔧 Feature override: CRM = True
2025-07-02 20:02:14.868 +05:30 [INF] 🔧 Feature override: CRMInsights = True
2025-07-02 20:02:14.869 +05:30 [INF] 🔧 Feature override: CTAFlow = True
2025-07-02 20:02:14.869 +05:30 [INF] 🔧 Feature override: FlowInsights = True
2025-07-02 20:02:14.870 +05:30 [INF] 🔧 Feature override: Messaging = True
2025-07-02 20:02:14.871 +05:30 [INF] 🔧 Feature override: ProfileCompletion = True
2025-07-02 20:02:14.871 +05:30 [INF] 🔧 Feature override: UpgradePlan = True
2025-07-02 20:02:14.872 +05:30 [INF] 🔧 Feature override: WhatsAppSettings = True
2025-07-02 20:02:14.873 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 20:02:14.874 +05:30 [INF] Executed action xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api) in 27.0162ms
2025-07-02 20:02:14.875 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 20:02:14.876 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/feature-access/me - 200 null application/json; charset=utf-8 34.8285ms
2025-07-02 20:02:21.483 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null null
2025-07-02 20:02:21.486 +05:30 [INF] CORS policy execution successful.
2025-07-02 20:02:21.486 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/contacts - null null
2025-07-02 20:02:21.486 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/inbox/unread-counts - null null
2025-07-02 20:02:21.489 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null 0
2025-07-02 20:02:21.489 +05:30 [INF] CORS policy execution successful.
2025-07-02 20:02:21.497 +05:30 [INF] CORS policy execution successful.
2025-07-02 20:02:21.487 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 204 null null 4.1855ms
2025-07-02 20:02:21.500 +05:30 [INF] CORS policy execution successful.
2025-07-02 20:02:21.501 +05:30 [INF] Executing endpoint 'xbytechat.api.CRM.Controllers.ContactsController.GetAllContacts (xbytechat.api)'
2025-07-02 20:02:21.502 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Inbox.Controllers.InboxController.GetUnreadCounts (xbytechat.api)'
2025-07-02 20:02:21.504 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null null
2025-07-02 20:02:21.505 +05:30 [INF] Executing endpoint '/hubs/inbox/negotiate'
2025-07-02 20:02:21.506 +05:30 [INF] Route matched with {action = "GetAllContacts", controller = "Contacts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllContacts(System.String, Int32, Int32) on controller xbytechat.api.CRM.Controllers.ContactsController (xbytechat.api).
2025-07-02 20:02:21.506 +05:30 [INF] Route matched with {action = "GetUnreadCounts", controller = "Inbox"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUnreadCounts() on controller xbytechat.api.Features.Inbox.Controllers.InboxController (xbytechat.api).
2025-07-02 20:02:21.508 +05:30 [INF] CORS policy execution successful.
2025-07-02 20:02:21.510 +05:30 [INF] Executed endpoint '/hubs/inbox/negotiate'
2025-07-02 20:02:21.510 +05:30 [INF] GetPagedContactsAsync: businessId="c13be597-6ae2-42bb-9d43-925815f24ff8", tab=all, page=1, pageSize=25
2025-07-02 20:02:21.513 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 200 316 application/json 23.7912ms
2025-07-02 20:02:21.512 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 204 null null 8.0293ms
2025-07-02 20:02:21.531 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null 0
2025-07-02 20:02:21.518 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__userId_0='2870e1d8-0e80-4b12-88bd-70a8113307d6'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."BusinessId", c."ContactId", c."LastReadAt", c."UserId"
FROM "ContactReads" AS c
WHERE c."UserId" = @__userId_0
2025-07-02 20:02:21.529 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/hubs/inbox?id=T2aErP_Fkwcba7Ma6IP6cA - null null
2025-07-02 20:02:21.537 +05:30 [INF] CORS policy execution successful.
2025-07-02 20:02:21.540 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."CreatedAt", m."ErrorMessage", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."IsIncoming" AND m."ContactId" IS NOT NULL
2025-07-02 20:02:21.541 +05:30 [INF] CORS policy execution successful.
2025-07-02 20:02:21.541 +05:30 [INF] Executing endpoint '/hubs/inbox/negotiate'
2025-07-02 20:02:21.543 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.Dictionary`2[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 20:02:21.543 +05:30 [INF] Executing endpoint '/hubs/inbox'
2025-07-02 20:02:21.544 +05:30 [INF] Executed endpoint '/hubs/inbox/negotiate'
2025-07-02 20:02:21.545 +05:30 [INF] Executed action xbytechat.api.Features.Inbox.Controllers.InboxController.GetUnreadCounts (xbytechat.api) in 33.2159ms
2025-07-02 20:02:21.547 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 200 316 application/json 15.6481ms
2025-07-02 20:02:21.549 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Inbox.Controllers.InboxController.GetUnreadCounts (xbytechat.api)'
2025-07-02 20:02:21.552 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/inbox/unread-counts - 200 null application/json; charset=utf-8 65.5665ms
2025-07-02 20:02:21.569 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/hubs/inbox?id=Ae8G3yh29vbvnZVP2m29Ww - null null
2025-07-02 20:02:21.571 +05:30 [INF] CORS policy execution successful.
2025-07-02 20:02:21.571 +05:30 [INF] Executing endpoint '/hubs/inbox'
2025-07-02 20:02:21.629 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Contacts" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."IsActive"
2025-07-02 20:02:21.632 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__p_2='25', @__p_1='0'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."AssignedAgentId", t."BusinessId", t."CreatedAt", t."Email", t."Group", t."IsActive", t."IsArchived", t."IsAutomationPaused", t."IsFavorite", t."LastCTAInteraction", t."LastCTAType", t."LastClickedProductId", t."LastContactedAt", t."LeadSource", t."Name", t."NextFollowUpAt", t."Notes", t."PhoneNumber", t."Tags", t0."Id", t0."AssignedAt", t0."AssignedBy", t0."BusinessId", t0."ContactId", t0."TagId", t0."Id0", t0."BusinessId0", t0."Category", t0."ColorHex", t0."CreatedAt", t0."IsActive", t0."IsSystemTag", t0."LastUsedAt", t0."Name", t0."Notes"
FROM (
    SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."Tags"
    FROM "Contacts" AS c
    WHERE c."BusinessId" = @__businessId_0 AND c."IsActive"
    ORDER BY c."Name"
    LIMIT @__p_2 OFFSET @__p_1
) AS t
LEFT JOIN (
    SELECT c0."Id", c0."AssignedAt", c0."AssignedBy", c0."BusinessId", c0."ContactId", c0."TagId", t1."Id" AS "Id0", t1."BusinessId" AS "BusinessId0", t1."Category", t1."ColorHex", t1."CreatedAt", t1."IsActive", t1."IsSystemTag", t1."LastUsedAt", t1."Name", t1."Notes"
    FROM "ContactTags" AS c0
    INNER JOIN "Tags" AS t1 ON c0."TagId" = t1."Id"
) AS t0 ON t."Id" = t0."ContactId"
ORDER BY t."Name", t."Id", t0."Id"
2025-07-02 20:02:21.634 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Helpers.ResponseResult'.
2025-07-02 20:02:21.635 +05:30 [INF] Executed action xbytechat.api.CRM.Controllers.ContactsController.GetAllContacts (xbytechat.api) in 125.2925ms
2025-07-02 20:02:21.636 +05:30 [INF] Executed endpoint 'xbytechat.api.CRM.Controllers.ContactsController.GetAllContacts (xbytechat.api)'
2025-07-02 20:02:21.637 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/contacts - 200 null application/json; charset=utf-8 150.9431ms
2025-07-02 20:26:32.161 +05:30 [INF] Executed endpoint '/hubs/inbox'
2025-07-02 20:26:32.161 +05:30 [INF] Executed endpoint '/hubs/inbox'
2025-07-02 20:26:32.163 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/hubs/inbox?id=Ae8G3yh29vbvnZVP2m29Ww - 101 null null 1450593.7646ms
2025-07-02 20:26:32.164 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/hubs/inbox?id=T2aErP_Fkwcba7Ma6IP6cA - 101 null null 1450635.3131ms
2025-07-02 20:40:09.679 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null null
2025-07-02 20:40:09.680 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null null
2025-07-02 20:40:09.683 +05:30 [INF] CORS policy execution successful.
2025-07-02 20:40:09.685 +05:30 [INF] CORS policy execution successful.
2025-07-02 20:40:09.686 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 204 null null 7.3114ms
2025-07-02 20:40:09.689 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null 0
2025-07-02 20:40:09.696 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null 0
2025-07-02 20:40:09.687 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 204 null null 7.6004ms
2025-07-02 20:40:09.703 +05:30 [INF] CORS policy execution successful.
2025-07-02 20:40:09.706 +05:30 [INF] CORS policy execution successful.
2025-07-02 20:40:09.711 +05:30 [INF] Executing endpoint '/hubs/inbox/negotiate'
2025-07-02 20:40:09.712 +05:30 [INF] Executing endpoint '/hubs/inbox/negotiate'
2025-07-02 20:40:09.713 +05:30 [INF] Executed endpoint '/hubs/inbox/negotiate'
2025-07-02 20:40:09.714 +05:30 [INF] Executed endpoint '/hubs/inbox/negotiate'
2025-07-02 20:40:09.716 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 200 316 application/json 26.7866ms
2025-07-02 20:40:09.717 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/hubs/inbox?id=6GTXnO3vNCa48c6tQASPmQ - null null
2025-07-02 20:40:09.718 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 200 316 application/json 21.2242ms
2025-07-02 20:40:09.725 +05:30 [INF] CORS policy execution successful.
2025-07-02 20:40:09.730 +05:30 [INF] Executing endpoint '/hubs/inbox'
2025-07-02 20:40:09.756 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/hubs/inbox?id=1hqWHH3m_KydJgytHZuncA - null null
2025-07-02 20:40:09.759 +05:30 [INF] CORS policy execution successful.
2025-07-02 20:40:09.761 +05:30 [INF] Executing endpoint '/hubs/inbox'
2025-07-02 20:40:39.444 +05:30 [INF] Executed endpoint '/hubs/inbox'
2025-07-02 20:40:39.444 +05:30 [INF] Executed endpoint '/hubs/inbox'
2025-07-02 20:40:39.446 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/hubs/inbox?id=6GTXnO3vNCa48c6tQASPmQ - 101 null null 29728.87ms
2025-07-02 20:40:39.448 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/hubs/inbox?id=1hqWHH3m_KydJgytHZuncA - 101 null null 29692.4ms
2025-07-02 20:43:33.283 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null null
2025-07-02 20:43:33.283 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null null
2025-07-02 20:43:33.286 +05:30 [INF] CORS policy execution successful.
2025-07-02 20:43:33.288 +05:30 [INF] CORS policy execution successful.
2025-07-02 20:43:33.289 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 204 null null 6.4621ms
2025-07-02 20:43:33.290 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 204 null null 7.0129ms
2025-07-02 20:43:33.293 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null 0
2025-07-02 20:43:33.292 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null 0
2025-07-02 20:43:33.304 +05:30 [INF] CORS policy execution successful.
2025-07-02 20:43:33.306 +05:30 [INF] CORS policy execution successful.
2025-07-02 20:43:33.307 +05:30 [INF] Executing endpoint '/hubs/inbox/negotiate'
2025-07-02 20:43:33.308 +05:30 [INF] Executing endpoint '/hubs/inbox/negotiate'
2025-07-02 20:43:33.309 +05:30 [INF] Executed endpoint '/hubs/inbox/negotiate'
2025-07-02 20:43:33.310 +05:30 [INF] Executed endpoint '/hubs/inbox/negotiate'
2025-07-02 20:43:33.311 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 200 316 application/json 17.9574ms
2025-07-02 20:43:33.313 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/hubs/inbox?id=56-ro-RJcTfsa3VuMG_Ipw - null null
2025-07-02 20:43:33.313 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 200 316 application/json 20.3493ms
2025-07-02 20:43:33.319 +05:30 [INF] CORS policy execution successful.
2025-07-02 20:43:33.322 +05:30 [INF] Executing endpoint '/hubs/inbox'
2025-07-02 20:43:33.341 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/hubs/inbox?id=oGX281mR7Km1QPWydpcTvw - null null
2025-07-02 20:43:33.344 +05:30 [INF] CORS policy execution successful.
2025-07-02 20:43:33.344 +05:30 [INF] Executing endpoint '/hubs/inbox'
2025-07-02 20:44:02.174 +05:30 [INF] Executed endpoint '/hubs/inbox'
2025-07-02 20:44:02.174 +05:30 [INF] Executed endpoint '/hubs/inbox'
2025-07-02 20:44:02.179 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/hubs/inbox?id=oGX281mR7Km1QPWydpcTvw - 101 null null 28837.6469ms
2025-07-02 20:44:02.180 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/hubs/inbox?id=56-ro-RJcTfsa3VuMG_Ipw - 101 null null 28867.4187ms
2025-07-02 20:50:09.233 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null null
2025-07-02 20:50:09.234 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null null
2025-07-02 20:50:09.241 +05:30 [INF] CORS policy execution successful.
2025-07-02 20:50:09.238 +05:30 [INF] CORS policy execution successful.
2025-07-02 20:50:09.244 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 204 null null 9.7682ms
2025-07-02 20:50:09.247 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 204 null null 13.0894ms
2025-07-02 20:50:09.352 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null 0
2025-07-02 20:50:09.470 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null 0
2025-07-02 20:50:09.721 +05:30 [INF] CORS policy execution successful.
2025-07-02 20:50:09.735 +05:30 [INF] CORS policy execution successful.
2025-07-02 20:50:09.737 +05:30 [INF] Executing endpoint '/hubs/inbox/negotiate'
2025-07-02 20:50:09.738 +05:30 [INF] Executing endpoint '/hubs/inbox/negotiate'
2025-07-02 20:50:09.740 +05:30 [INF] Executed endpoint '/hubs/inbox/negotiate'
2025-07-02 20:50:09.743 +05:30 [INF] Executed endpoint '/hubs/inbox/negotiate'
2025-07-02 20:50:09.749 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 200 316 application/json 279.1194ms
2025-07-02 20:50:09.748 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 200 316 application/json 395.2318ms
2025-07-02 20:50:12.667 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null null
2025-07-02 20:50:12.667 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null null
2025-07-02 20:50:12.669 +05:30 [INF] CORS policy execution successful.
2025-07-02 20:50:12.672 +05:30 [INF] CORS policy execution successful.
2025-07-02 20:50:12.672 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 204 null null 5.2232ms
2025-07-02 20:50:12.673 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 204 null null 5.8097ms
2025-07-02 20:50:12.673 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null 0
2025-07-02 20:50:12.674 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null 0
2025-07-02 20:50:12.680 +05:30 [INF] CORS policy execution successful.
2025-07-02 20:50:12.682 +05:30 [INF] CORS policy execution successful.
2025-07-02 20:50:12.683 +05:30 [INF] Executing endpoint '/hubs/inbox/negotiate'
2025-07-02 20:50:12.684 +05:30 [INF] Executing endpoint '/hubs/inbox/negotiate'
2025-07-02 20:50:12.685 +05:30 [INF] Executed endpoint '/hubs/inbox/negotiate'
2025-07-02 20:50:12.686 +05:30 [INF] Executed endpoint '/hubs/inbox/negotiate'
2025-07-02 20:50:12.689 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/hubs/inbox?id=XBUHf_vA8bYvbnaLlAQ0lA - null null
2025-07-02 20:50:12.690 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 200 316 application/json 15.0602ms
2025-07-02 20:50:12.687 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 200 316 application/json 13.7093ms
2025-07-02 20:50:12.696 +05:30 [INF] CORS policy execution successful.
2025-07-02 20:50:12.703 +05:30 [INF] Executing endpoint '/hubs/inbox'
2025-07-02 20:50:12.730 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/hubs/inbox?id=ANUMqW2gwAVmyOwsB9BVEg - null null
2025-07-02 20:50:12.732 +05:30 [INF] CORS policy execution successful.
2025-07-02 20:50:12.733 +05:30 [INF] Executing endpoint '/hubs/inbox'
2025-07-02 20:50:40.339 +05:30 [INF] Executed endpoint '/hubs/inbox'
2025-07-02 20:50:40.349 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/hubs/inbox?id=XBUHf_vA8bYvbnaLlAQ0lA - 101 null null 27659.9927ms
2025-07-02 20:50:40.349 +05:30 [INF] Executed endpoint '/hubs/inbox'
2025-07-02 20:50:40.353 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/hubs/inbox?id=ANUMqW2gwAVmyOwsB9BVEg - 101 null null 27623.1693ms
2025-07-02 20:52:40.000 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null null
2025-07-02 20:52:40.443 +05:30 [INF] CORS policy execution successful.
2025-07-02 20:52:40.476 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 204 null null 476.954ms
2025-07-02 20:52:40.508 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null 0
2025-07-02 20:52:40.571 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null null
2025-07-02 20:52:40.602 +05:30 [INF] CORS policy execution successful.
2025-07-02 20:52:40.653 +05:30 [INF] CORS policy execution successful.
2025-07-02 20:52:40.659 +05:30 [INF] Executing endpoint '/hubs/inbox/negotiate'
2025-07-02 20:52:40.665 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 204 null null 94.148ms
2025-07-02 20:52:40.674 +05:30 [INF] Executed endpoint '/hubs/inbox/negotiate'
2025-07-02 20:52:40.696 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 200 316 application/json 187.9765ms
2025-07-02 20:52:42.679 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null null
2025-07-02 20:52:42.680 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null null
2025-07-02 20:52:42.682 +05:30 [INF] CORS policy execution successful.
2025-07-02 20:52:42.684 +05:30 [INF] CORS policy execution successful.
2025-07-02 20:52:42.685 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 204 null null 6.3748ms
2025-07-02 20:52:42.687 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null 0
2025-07-02 20:52:42.686 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 204 null null 6.2244ms
2025-07-02 20:52:42.688 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null 0
2025-07-02 20:52:42.693 +05:30 [INF] CORS policy execution successful.
2025-07-02 20:52:42.699 +05:30 [INF] CORS policy execution successful.
2025-07-02 20:52:42.700 +05:30 [INF] Executing endpoint '/hubs/inbox/negotiate'
2025-07-02 20:52:42.701 +05:30 [INF] Executing endpoint '/hubs/inbox/negotiate'
2025-07-02 20:52:42.702 +05:30 [INF] Executed endpoint '/hubs/inbox/negotiate'
2025-07-02 20:52:42.703 +05:30 [INF] Executed endpoint '/hubs/inbox/negotiate'
2025-07-02 20:52:42.706 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/hubs/inbox?id=RGdg2FrsAfkpcp36HWPU1Q - null null
2025-07-02 20:52:42.704 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 200 316 application/json 17.0613ms
2025-07-02 20:52:42.706 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 200 316 application/json 17.5136ms
2025-07-02 20:52:42.709 +05:30 [INF] CORS policy execution successful.
2025-07-02 20:52:42.717 +05:30 [INF] Executing endpoint '/hubs/inbox'
2025-07-02 20:52:42.740 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/hubs/inbox?id=l9r7EJcD8RpV9H4t5z-oww - null null
2025-07-02 20:52:42.743 +05:30 [INF] CORS policy execution successful.
2025-07-02 20:52:42.744 +05:30 [INF] Executing endpoint '/hubs/inbox'
2025-07-02 20:52:44.673 +05:30 [INF] Executed endpoint '/hubs/inbox'
2025-07-02 20:52:44.673 +05:30 [INF] Executed endpoint '/hubs/inbox'
2025-07-02 20:52:44.675 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/hubs/inbox?id=RGdg2FrsAfkpcp36HWPU1Q - 101 null null 1969.6455ms
2025-07-02 20:52:44.677 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/hubs/inbox?id=l9r7EJcD8RpV9H4t5z-oww - 101 null null 1936.6314ms
2025-07-02 20:55:06.814 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null null
2025-07-02 20:55:06.839 +05:30 [INF] CORS policy execution successful.
2025-07-02 20:55:06.839 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null null
2025-07-02 20:55:06.841 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 204 null null 26.8614ms
2025-07-02 20:55:06.848 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null 0
2025-07-02 20:55:06.862 +05:30 [INF] CORS policy execution successful.
2025-07-02 20:55:06.888 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 204 null null 49.4016ms
2025-07-02 20:55:06.884 +05:30 [INF] CORS policy execution successful.
2025-07-02 20:55:06.896 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null 0
2025-07-02 20:55:06.906 +05:30 [INF] Executing endpoint '/hubs/inbox/negotiate'
2025-07-02 20:55:06.910 +05:30 [INF] CORS policy execution successful.
2025-07-02 20:55:06.912 +05:30 [INF] Executed endpoint '/hubs/inbox/negotiate'
2025-07-02 20:55:06.919 +05:30 [INF] Executing endpoint '/hubs/inbox/negotiate'
2025-07-02 20:55:06.922 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 200 316 application/json 74.0192ms
2025-07-02 20:55:06.926 +05:30 [INF] Executed endpoint '/hubs/inbox/negotiate'
2025-07-02 20:55:06.929 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/hubs/inbox?id=GV4QMXU8re3H6QjHZWlhiw - null null
2025-07-02 20:55:06.942 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 200 316 application/json 46.0908ms
2025-07-02 20:55:06.947 +05:30 [INF] CORS policy execution successful.
2025-07-02 20:55:06.958 +05:30 [INF] Executing endpoint '/hubs/inbox'
2025-07-02 20:55:06.983 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/hubs/inbox?id=C0tvjZX_TVf2hs5T_qWZOQ - null null
2025-07-02 20:55:07.032 +05:30 [INF] CORS policy execution successful.
2025-07-02 20:55:07.035 +05:30 [INF] Executing endpoint '/hubs/inbox'
2025-07-02 20:55:37.544 +05:30 [INF] Executed endpoint '/hubs/inbox'
2025-07-02 20:55:37.544 +05:30 [INF] Executed endpoint '/hubs/inbox'
2025-07-02 20:55:37.546 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/hubs/inbox?id=C0tvjZX_TVf2hs5T_qWZOQ - 101 null null 30563.182ms
2025-07-02 20:55:37.547 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/hubs/inbox?id=GV4QMXU8re3H6QjHZWlhiw - 101 null null 30618.2202ms
2025-07-02 21:10:36.015 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null null
2025-07-02 21:10:36.022 +05:30 [INF] CORS policy execution successful.
2025-07-02 21:10:36.024 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 204 null null 9.295ms
2025-07-02 21:10:36.040 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null 0
2025-07-02 21:10:36.054 +05:30 [INF] CORS policy execution successful.
2025-07-02 21:10:36.056 +05:30 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '02-07-2025 03:29:42 PM', Current time (UTC): '02-07-2025 03:40:36 PM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-07-02 21:10:36.060 +05:30 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '02-07-2025 03:29:42 PM', Current time (UTC): '02-07-2025 03:40:36 PM'.
2025-07-02 21:10:36.061 +05:30 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-07-02 21:10:36.097 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null null
2025-07-02 21:10:36.097 +05:30 [ERR] ❌ An unhandled exception occurred
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ThrowResponseAlreadyStartedException(String value)
   at Microsoft.AspNetCore.Http.DefaultHttpResponse.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Authentication.JwtBearer.JwtBearerHandler.HandleChallengeAsync(AuthenticationProperties properties)
   at Microsoft.AspNetCore.Authentication.AuthenticationHandler`1.ChallengeAsync(AuthenticationProperties properties)
   at Microsoft.AspNetCore.Authentication.AuthenticationService.ChallengeAsync(HttpContext context, String scheme, AuthenticationProperties properties)
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.<>c__DisplayClass0_0.<<HandleAsync>g__Handle|0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at GlobalExceptionMiddleware.Invoke(HttpContext context) in D:\xbytechat\xbytechat-api\xbytechat-api\Middlewares\GlobalExceptionMiddleware.cs:line 32
2025-07-02 21:10:36.102 +05:30 [INF] CORS policy execution successful.
2025-07-02 21:10:36.107 +05:30 [ERR] Response has already started, unable to write error response for path: /hubs/inbox/negotiate
2025-07-02 21:10:36.108 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 204 null null 10.6014ms
2025-07-02 21:10:36.109 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 401 null application/json 69.3543ms
2025-07-02 21:10:36.119 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null 0
2025-07-02 21:10:36.124 +05:30 [INF] CORS policy execution successful.
2025-07-02 21:10:36.126 +05:30 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '02-07-2025 03:29:42 PM', Current time (UTC): '02-07-2025 03:40:36 PM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-07-02 21:10:36.130 +05:30 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '02-07-2025 03:29:42 PM', Current time (UTC): '02-07-2025 03:40:36 PM'.
2025-07-02 21:10:36.134 +05:30 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-07-02 21:10:36.172 +05:30 [ERR] ❌ An unhandled exception occurred
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ThrowResponseAlreadyStartedException(String value)
   at Microsoft.AspNetCore.Http.DefaultHttpResponse.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Authentication.JwtBearer.JwtBearerHandler.HandleChallengeAsync(AuthenticationProperties properties)
   at Microsoft.AspNetCore.Authentication.AuthenticationHandler`1.ChallengeAsync(AuthenticationProperties properties)
   at Microsoft.AspNetCore.Authentication.AuthenticationService.ChallengeAsync(HttpContext context, String scheme, AuthenticationProperties properties)
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.<>c__DisplayClass0_0.<<HandleAsync>g__Handle|0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at GlobalExceptionMiddleware.Invoke(HttpContext context) in D:\xbytechat\xbytechat-api\xbytechat-api\Middlewares\GlobalExceptionMiddleware.cs:line 32
2025-07-02 21:10:36.180 +05:30 [ERR] Response has already started, unable to write error response for path: /hubs/inbox/negotiate
2025-07-02 21:10:36.184 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 401 null application/json 64.7372ms
2025-07-02 21:10:46.682 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null null
2025-07-02 21:10:46.686 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null null
2025-07-02 21:10:46.693 +05:30 [INF] CORS policy execution successful.
2025-07-02 21:10:46.697 +05:30 [INF] CORS policy execution successful.
2025-07-02 21:10:46.699 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 204 null null 16.349ms
2025-07-02 21:10:46.700 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 204 null null 14.3614ms
2025-07-02 21:10:46.700 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null 0
2025-07-02 21:10:46.701 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null 0
2025-07-02 21:10:46.712 +05:30 [INF] CORS policy execution successful.
2025-07-02 21:10:46.716 +05:30 [INF] CORS policy execution successful.
2025-07-02 21:10:46.718 +05:30 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '02-07-2025 03:29:42 PM', Current time (UTC): '02-07-2025 03:40:46 PM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-07-02 21:10:46.719 +05:30 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '02-07-2025 03:29:42 PM', Current time (UTC): '02-07-2025 03:40:46 PM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-07-02 21:10:46.722 +05:30 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '02-07-2025 03:29:42 PM', Current time (UTC): '02-07-2025 03:40:46 PM'.
2025-07-02 21:10:46.724 +05:30 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '02-07-2025 03:29:42 PM', Current time (UTC): '02-07-2025 03:40:46 PM'.
2025-07-02 21:10:46.726 +05:30 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-07-02 21:10:46.727 +05:30 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-07-02 21:10:46.749 +05:30 [ERR] ❌ An unhandled exception occurred
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ThrowResponseAlreadyStartedException(String value)
   at Microsoft.AspNetCore.Http.DefaultHttpResponse.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Authentication.JwtBearer.JwtBearerHandler.HandleChallengeAsync(AuthenticationProperties properties)
   at Microsoft.AspNetCore.Authentication.AuthenticationHandler`1.ChallengeAsync(AuthenticationProperties properties)
   at Microsoft.AspNetCore.Authentication.AuthenticationService.ChallengeAsync(HttpContext context, String scheme, AuthenticationProperties properties)
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.<>c__DisplayClass0_0.<<HandleAsync>g__Handle|0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at GlobalExceptionMiddleware.Invoke(HttpContext context) in D:\xbytechat\xbytechat-api\xbytechat-api\Middlewares\GlobalExceptionMiddleware.cs:line 32
2025-07-02 21:10:46.768 +05:30 [ERR] ❌ An unhandled exception occurred
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ThrowResponseAlreadyStartedException(String value)
   at Microsoft.AspNetCore.Http.DefaultHttpResponse.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Authentication.JwtBearer.JwtBearerHandler.HandleChallengeAsync(AuthenticationProperties properties)
   at Microsoft.AspNetCore.Authentication.AuthenticationHandler`1.ChallengeAsync(AuthenticationProperties properties)
   at Microsoft.AspNetCore.Authentication.AuthenticationService.ChallengeAsync(HttpContext context, String scheme, AuthenticationProperties properties)
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.<>c__DisplayClass0_0.<<HandleAsync>g__Handle|0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at GlobalExceptionMiddleware.Invoke(HttpContext context) in D:\xbytechat\xbytechat-api\xbytechat-api\Middlewares\GlobalExceptionMiddleware.cs:line 32
2025-07-02 21:10:46.773 +05:30 [ERR] Response has already started, unable to write error response for path: /hubs/inbox/negotiate
2025-07-02 21:10:46.777 +05:30 [ERR] Response has already started, unable to write error response for path: /hubs/inbox/negotiate
2025-07-02 21:10:46.778 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 401 null application/json 77.6894ms
2025-07-02 21:10:46.780 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 401 null application/json 78.5354ms
2025-07-02 21:11:17.682 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null null
2025-07-02 21:11:17.683 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null null
2025-07-02 21:11:17.685 +05:30 [INF] CORS policy execution successful.
2025-07-02 21:11:17.687 +05:30 [INF] CORS policy execution successful.
2025-07-02 21:11:17.688 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 204 null null 6.4551ms
2025-07-02 21:11:17.691 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null 0
2025-07-02 21:11:17.691 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null 0
2025-07-02 21:11:17.689 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 204 null null 5.9769ms
2025-07-02 21:11:17.707 +05:30 [INF] CORS policy execution successful.
2025-07-02 21:11:17.709 +05:30 [INF] CORS policy execution successful.
2025-07-02 21:11:17.712 +05:30 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '02-07-2025 03:29:42 PM', Current time (UTC): '02-07-2025 03:41:17 PM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-07-02 21:11:17.713 +05:30 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '02-07-2025 03:29:42 PM', Current time (UTC): '02-07-2025 03:41:17 PM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-07-02 21:11:17.715 +05:30 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '02-07-2025 03:29:42 PM', Current time (UTC): '02-07-2025 03:41:17 PM'.
2025-07-02 21:11:17.716 +05:30 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '02-07-2025 03:29:42 PM', Current time (UTC): '02-07-2025 03:41:17 PM'.
2025-07-02 21:11:17.717 +05:30 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-07-02 21:11:17.717 +05:30 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-07-02 21:11:17.729 +05:30 [ERR] ❌ An unhandled exception occurred
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ThrowResponseAlreadyStartedException(String value)
   at Microsoft.AspNetCore.Http.DefaultHttpResponse.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Authentication.JwtBearer.JwtBearerHandler.HandleChallengeAsync(AuthenticationProperties properties)
   at Microsoft.AspNetCore.Authentication.AuthenticationHandler`1.ChallengeAsync(AuthenticationProperties properties)
   at Microsoft.AspNetCore.Authentication.AuthenticationService.ChallengeAsync(HttpContext context, String scheme, AuthenticationProperties properties)
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.<>c__DisplayClass0_0.<<HandleAsync>g__Handle|0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at GlobalExceptionMiddleware.Invoke(HttpContext context) in D:\xbytechat\xbytechat-api\xbytechat-api\Middlewares\GlobalExceptionMiddleware.cs:line 32
2025-07-02 21:11:17.738 +05:30 [ERR] ❌ An unhandled exception occurred
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ThrowResponseAlreadyStartedException(String value)
   at Microsoft.AspNetCore.Http.DefaultHttpResponse.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Authentication.JwtBearer.JwtBearerHandler.HandleChallengeAsync(AuthenticationProperties properties)
   at Microsoft.AspNetCore.Authentication.AuthenticationHandler`1.ChallengeAsync(AuthenticationProperties properties)
   at Microsoft.AspNetCore.Authentication.AuthenticationService.ChallengeAsync(HttpContext context, String scheme, AuthenticationProperties properties)
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.<>c__DisplayClass0_0.<<HandleAsync>g__Handle|0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at GlobalExceptionMiddleware.Invoke(HttpContext context) in D:\xbytechat\xbytechat-api\xbytechat-api\Middlewares\GlobalExceptionMiddleware.cs:line 32
2025-07-02 21:11:17.740 +05:30 [ERR] Response has already started, unable to write error response for path: /hubs/inbox/negotiate
2025-07-02 21:11:17.743 +05:30 [ERR] Response has already started, unable to write error response for path: /hubs/inbox/negotiate
2025-07-02 21:11:17.743 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 401 null application/json 52.8089ms
2025-07-02 21:11:17.744 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 401 null application/json 53.8199ms
2025-07-02 21:56:42.432 +05:30 [INF] User profile is available. Using 'C:\Users\sunde\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-07-02 21:56:42.487 +05:30 [INF] 🚀 Webhook Queue Worker started.
2025-07-02 21:56:42.505 +05:30 [INF] 🧹 FailedWebhookLogCleanupService started.
2025-07-02 21:56:43.557 +05:30 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2025-07-02 21:56:44.263 +05:30 [WRN] The query uses the 'First'/'FirstOrDefault' operator without 'OrderBy' and filter operators. This may lead to unpredictable results.
2025-07-02 21:56:44.593 +05:30 [INF] Now listening on: http://localhost:7113
2025-07-02 21:56:44.595 +05:30 [INF] Now listening on: http://localhost:5295
2025-07-02 21:56:44.596 +05:30 [INF] Application started. Press Ctrl+C to shut down.
2025-07-02 21:56:44.598 +05:30 [INF] Hosting environment: Development
2025-07-02 21:56:44.599 +05:30 [INF] Content root path: D:\xbytechat\xbytechat-api\xbytechat-api
2025-07-02 21:56:44.605 +05:30 [INF] Executed DbCommand (43ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."AutoCleanupEnabled", w."LastCleanupAt"
FROM "WebhookSettings" AS w
LIMIT 1
2025-07-02 21:56:44.636 +05:30 [INF] Executed DbCommand (67ms) [Parameters=[@__cutoff_0='2025-06-25T16:26:42.6643879Z' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."CreatedAt", f."ErrorMessage", f."FailureType", f."RawJson", f."SourceModule"
FROM "FailedWebhookLogs" AS f
WHERE f."CreatedAt" < @__cutoff_0
2025-07-02 21:56:45.799 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/swagger - null null
2025-07-02 21:56:46.848 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/swagger - 301 0 null 1063.4472ms
2025-07-02 21:56:46.897 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/swagger/index.html - null null
2025-07-02 21:56:47.118 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/swagger/index.html - 200 null text/html;charset=utf-8 221.3033ms
2025-07-02 21:56:47.215 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/swagger/swagger-ui-bundle.js - null null
2025-07-02 21:56:47.215 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/swagger/swagger-ui.css - null null
2025-07-02 21:56:47.217 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/swagger/swagger-ui-standalone-preset.js - null null
2025-07-02 21:56:47.309 +05:30 [INF] Sending file. Request path: '/swagger-ui.css'. Physical path: 'N/A'
2025-07-02 21:56:47.309 +05:30 [INF] Sending file. Request path: '/swagger-ui-standalone-preset.js'. Physical path: 'N/A'
2025-07-02 21:56:47.329 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/swagger/swagger-ui-standalone-preset.js - 200 230280 text/javascript 111.8309ms
2025-07-02 21:56:47.329 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/swagger/swagger-ui.css - 200 152034 text/css 113.5283ms
2025-07-02 21:56:47.358 +05:30 [INF] Sending file. Request path: '/swagger-ui-bundle.js'. Physical path: 'N/A'
2025-07-02 21:56:47.362 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/swagger/swagger-ui-bundle.js - 200 1456926 text/javascript 146.6538ms
2025-07-02 21:56:47.648 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/_framework/aspnetcore-browser-refresh.js - null null
2025-07-02 21:56:47.659 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/_vs/browserLink - null null
2025-07-02 21:56:47.679 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/_framework/aspnetcore-browser-refresh.js - 200 13762 application/javascript; charset=utf-8 31.1824ms
2025-07-02 21:56:47.781 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/_vs/browserLink - 200 null text/javascript; charset=UTF-8 120.5869ms
2025-07-02 21:56:48.596 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/swagger/v1/swagger.json - null null
2025-07-02 21:56:48.863 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 266.9178ms
2025-07-02 22:00:27.664 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/auth/session - null null
2025-07-02 22:00:27.672 +05:30 [WRN] Failed to determine the https port for redirect.
2025-07-02 22:00:27.826 +05:30 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '02-07-2025 03:29:42 PM', Current time (UTC): '02-07-2025 04:30:27 PM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-07-02 22:00:27.882 +05:30 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '02-07-2025 03:29:42 PM', Current time (UTC): '02-07-2025 04:30:27 PM'.
2025-07-02 22:00:27.899 +05:30 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-07-02 22:00:27.952 +05:30 [ERR] ❌ An unhandled exception occurred
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ThrowResponseAlreadyStartedException(String value)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Authentication.JwtBearer.JwtBearerHandler.HandleChallengeAsync(AuthenticationProperties properties)
   at Microsoft.AspNetCore.Authentication.AuthenticationHandler`1.ChallengeAsync(AuthenticationProperties properties)
   at Microsoft.AspNetCore.Authentication.AuthenticationService.ChallengeAsync(HttpContext context, String scheme, AuthenticationProperties properties)
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.<>c__DisplayClass0_0.<<HandleAsync>g__Handle|0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at GlobalExceptionMiddleware.Invoke(HttpContext context) in D:\xbytechat\xbytechat-api\xbytechat-api\Middlewares\GlobalExceptionMiddleware.cs:line 32
2025-07-02 22:00:27.970 +05:30 [ERR] Response has already started, unable to write error response for path: /api/auth/session
2025-07-02 22:00:27.972 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/auth/session - 401 null application/json 307.8386ms
2025-07-02 22:00:36.018 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/api/auth/login - null null
2025-07-02 22:00:36.033 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:00:36.038 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/api/auth/login - 204 null null 20.0348ms
2025-07-02 22:00:36.041 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/api/auth/login - application/json 47
2025-07-02 22:00:36.047 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:00:36.053 +05:30 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '02-07-2025 03:29:42 PM', Current time (UTC): '02-07-2025 04:30:36 PM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-07-02 22:00:36.058 +05:30 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '02-07-2025 03:29:42 PM', Current time (UTC): '02-07-2025 04:30:36 PM'.
2025-07-02 22:00:36.080 +05:30 [INF] Executing endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.Login (xbytechat.api)'
2025-07-02 22:00:36.115 +05:30 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(xbytechat.api.AuthModule.DTOs.UserLoginDto) on controller xbytechat.api.AuthModule.Controllers.AuthController (xbytechat.api).
2025-07-02 22:00:36.258 +05:30 [INF] 🔑 Login attempt for email: ratan@tcs.com
2025-07-02 22:00:36.405 +05:30 [INF] Executed DbCommand (28ms) [Parameters=[@__dto_Email_0='ratan@tcs.com', @__hashedPassword_1='JAvlGPq9JyTdtvBO6x2llnRI1+gxwIyPqCKAn3THIKk='], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."BusinessId", u."CreatedAt", u."DeletedAt", u."Email", u."IsDeleted", u."Name", u."PasswordHash", u."RefreshToken", u."RefreshTokenExpiry", u."RoleId", u."Status", r."Id", r."CreatedAt", r."Description", r."IsActive", r."IsSystemDefined", r."Name"
FROM "Users" AS u
LEFT JOIN "Roles" AS r ON u."RoleId" = r."Id"
WHERE u."Email" = @__dto_Email_0 AND u."PasswordHash" = @__hashedPassword_1 AND NOT (u."IsDeleted")
LIMIT 1
2025-07-02 22:00:36.568 +05:30 [INF] Executed DbCommand (16ms) [Parameters=[@__user_BusinessId_Value_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT b."Id", b."Address", b."ApprovedAt", b."ApprovedBy", b."BusinessEmail", b."BusinessName", b."CompanyName", b."CompanyPhone", b."CreatedAt", b."CreatedBy", b."CreatedByPartnerId", b."DeletedAt", b."DeletedBy", b."Industry", b."IsApproved", b."IsDeleted", b."LastLoginAt", b."LogoUrl", b."Notes", b."Phone", b."RepresentativeName", b."Source", b."Status", b."Tags", b."Website", b0."Id", b0."BusinessId", b0."CreatedAt", b0."Plan", b0."QuotaResetDate", b0."RemainingMessages", b0."TotalMonthlyQuota", b0."UpdatedAt", b0."WalletBalance"
FROM "Businesses" AS b
LEFT JOIN "BusinessPlanInfos" AS b0 ON b."Id" = b0."BusinessId"
WHERE b."Id" = @__user_BusinessId_Value_0
LIMIT 1
2025-07-02 22:00:36.704 +05:30 [INF] Executed DbCommand (5ms) [Parameters=[@__user_RoleId_0='00000000-0000-0000-0000-000000000004' (Nullable = true)], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."AssignedAt", r."AssignedBy", r."IsActive", r."IsRevoked", r."PermissionId", r."RoleId"
FROM "RolePermissions" AS r
WHERE r."RoleId" = @__user_RoleId_0 AND NOT (r."IsRevoked")
2025-07-02 22:00:36.734 +05:30 [INF] Executed DbCommand (6ms) [Parameters=[@__userId_0='2870e1d8-0e80-4b12-88bd-70a8113307d6'], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."AssignedAt", u."AssignedBy", u."IsGranted", u."IsRevoked", u."PermissionId", u."UserId"
FROM "UserPermissions" AS u
WHERE u."UserId" = @__userId_0 AND NOT (u."IsRevoked")
2025-07-02 22:00:36.861 +05:30 [INF] Executed DbCommand (76ms) [Parameters=[@__permissionIds_0={ '30000000-0000-0000-0000-000000000000', '30000000-0000-0000-0000-000000000004', '30000000-0000-0000-0000-000000000001', '30000000-0000-0000-0000-000000000007' } (DbType = Object)], CommandType='"Text"', CommandTimeout='30']
SELECT p."Id", p."Code", p."CreatedAt", p."Description", p."Group", p."IsActive", p."Name"
FROM "Permissions" AS p
WHERE p."Id" = ANY (@__permissionIds_0)
2025-07-02 22:00:36.893 +05:30 [INF] ✅ Token generated for: ratan@tcs.com
2025-07-02 22:00:37.024 +05:30 [INF] Executed action xbytechat.api.AuthModule.Controllers.AuthController.Login (xbytechat.api) in 902.0022ms
2025-07-02 22:00:37.030 +05:30 [INF] Executed endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.Login (xbytechat.api)'
2025-07-02 22:00:37.121 +05:30 [ERR] ❌ An unhandled exception occurred
System.InvalidOperationException: Headers are read-only, response has already started.
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpHeaders.ThrowHeadersReadOnlyException()
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpResponseHeaders.Microsoft.AspNetCore.Http.IHeaderDictionary.set_SetCookie(StringValues value)
   at Microsoft.AspNetCore.Http.ResponseCookies.Append(String key, String value, CookieOptions options)
   at xbytechat.api.AuthModule.Services.AuthService.LoginAsync(UserLoginDto dto) in D:\xbytechat\xbytechat-api\xbytechat-api\AuthModule\Services\AuthService.cs:line 462
   at xbytechat.api.AuthModule.Controllers.AuthController.Login(UserLoginDto dto) in D:\xbytechat\xbytechat-api\xbytechat-api\AuthModule\Controllers\AuthController.cs:line 29
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at GlobalExceptionMiddleware.Invoke(HttpContext context) in D:\xbytechat\xbytechat-api\xbytechat-api\Middlewares\GlobalExceptionMiddleware.cs:line 32
2025-07-02 22:00:37.133 +05:30 [ERR] Response has already started, unable to write error response for path: /api/auth/login
2025-07-02 22:00:37.140 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/api/auth/refresh - null null
2025-07-02 22:00:37.140 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/api/auth/login - 401 null application/json 1099.4526ms
2025-07-02 22:00:37.143 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:00:37.147 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/api/auth/refresh - 204 null null 7.973ms
2025-07-02 22:00:37.150 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/api/auth/refresh - application/json 2
2025-07-02 22:00:37.161 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:00:37.164 +05:30 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '02-07-2025 03:29:42 PM', Current time (UTC): '02-07-2025 04:30:37 PM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-07-02 22:00:37.166 +05:30 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '02-07-2025 03:29:42 PM', Current time (UTC): '02-07-2025 04:30:37 PM'.
2025-07-02 22:00:37.170 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/api/auth/refresh - 401 null application/json 19.6707ms
2025-07-02 22:00:37.175 +05:30 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: POST http://localhost:7113/api/auth/refresh, Response status code: 401
2025-07-02 22:00:37.799 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/auth/session - null null
2025-07-02 22:00:37.810 +05:30 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '02-07-2025 03:29:42 PM', Current time (UTC): '02-07-2025 04:30:37 PM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-07-02 22:00:37.814 +05:30 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '02-07-2025 03:29:42 PM', Current time (UTC): '02-07-2025 04:30:37 PM'.
2025-07-02 22:00:37.819 +05:30 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-07-02 22:00:37.859 +05:30 [ERR] ❌ An unhandled exception occurred
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ThrowResponseAlreadyStartedException(String value)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.set_StatusCode(Int32 value)
   at Microsoft.AspNetCore.Authentication.JwtBearer.JwtBearerHandler.HandleChallengeAsync(AuthenticationProperties properties)
   at Microsoft.AspNetCore.Authentication.AuthenticationHandler`1.ChallengeAsync(AuthenticationProperties properties)
   at Microsoft.AspNetCore.Authentication.AuthenticationService.ChallengeAsync(HttpContext context, String scheme, AuthenticationProperties properties)
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.<>c__DisplayClass0_0.<<HandleAsync>g__Handle|0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at GlobalExceptionMiddleware.Invoke(HttpContext context) in D:\xbytechat\xbytechat-api\xbytechat-api\Middlewares\GlobalExceptionMiddleware.cs:line 32
2025-07-02 22:00:37.875 +05:30 [ERR] Response has already started, unable to write error response for path: /api/auth/session
2025-07-02 22:00:37.878 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/auth/session - 401 null application/json 78.872ms
2025-07-02 22:00:49.928 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/api/auth/login - null null
2025-07-02 22:00:49.932 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:00:49.934 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/api/auth/login - 204 null null 6.6897ms
2025-07-02 22:00:49.937 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/api/auth/login - application/json 47
2025-07-02 22:00:49.943 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:00:49.945 +05:30 [INF] Executing endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.Login (xbytechat.api)'
2025-07-02 22:00:49.947 +05:30 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(xbytechat.api.AuthModule.DTOs.UserLoginDto) on controller xbytechat.api.AuthModule.Controllers.AuthController (xbytechat.api).
2025-07-02 22:00:49.956 +05:30 [INF] 🔑 Login attempt for email: ratan@tcs.com
2025-07-02 22:00:49.970 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[@__dto_Email_0='ratan@tcs.com', @__hashedPassword_1='JAvlGPq9JyTdtvBO6x2llnRI1+gxwIyPqCKAn3THIKk='], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."BusinessId", u."CreatedAt", u."DeletedAt", u."Email", u."IsDeleted", u."Name", u."PasswordHash", u."RefreshToken", u."RefreshTokenExpiry", u."RoleId", u."Status", r."Id", r."CreatedAt", r."Description", r."IsActive", r."IsSystemDefined", r."Name"
FROM "Users" AS u
LEFT JOIN "Roles" AS r ON u."RoleId" = r."Id"
WHERE u."Email" = @__dto_Email_0 AND u."PasswordHash" = @__hashedPassword_1 AND NOT (u."IsDeleted")
LIMIT 1
2025-07-02 22:00:49.981 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__user_BusinessId_Value_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT b."Id", b."Address", b."ApprovedAt", b."ApprovedBy", b."BusinessEmail", b."BusinessName", b."CompanyName", b."CompanyPhone", b."CreatedAt", b."CreatedBy", b."CreatedByPartnerId", b."DeletedAt", b."DeletedBy", b."Industry", b."IsApproved", b."IsDeleted", b."LastLoginAt", b."LogoUrl", b."Notes", b."Phone", b."RepresentativeName", b."Source", b."Status", b."Tags", b."Website", b0."Id", b0."BusinessId", b0."CreatedAt", b0."Plan", b0."QuotaResetDate", b0."RemainingMessages", b0."TotalMonthlyQuota", b0."UpdatedAt", b0."WalletBalance"
FROM "Businesses" AS b
LEFT JOIN "BusinessPlanInfos" AS b0 ON b."Id" = b0."BusinessId"
WHERE b."Id" = @__user_BusinessId_Value_0
LIMIT 1
2025-07-02 22:00:49.988 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__user_RoleId_0='00000000-0000-0000-0000-000000000004' (Nullable = true)], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."AssignedAt", r."AssignedBy", r."IsActive", r."IsRevoked", r."PermissionId", r."RoleId"
FROM "RolePermissions" AS r
WHERE r."RoleId" = @__user_RoleId_0 AND NOT (r."IsRevoked")
2025-07-02 22:00:49.997 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='2870e1d8-0e80-4b12-88bd-70a8113307d6'], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."AssignedAt", u."AssignedBy", u."IsGranted", u."IsRevoked", u."PermissionId", u."UserId"
FROM "UserPermissions" AS u
WHERE u."UserId" = @__userId_0 AND NOT (u."IsRevoked")
2025-07-02 22:00:50.004 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__permissionIds_0={ '30000000-0000-0000-0000-000000000000', '30000000-0000-0000-0000-000000000004', '30000000-0000-0000-0000-000000000001', '30000000-0000-0000-0000-000000000007' } (DbType = Object)], CommandType='"Text"', CommandTimeout='30']
SELECT p."Id", p."Code", p."CreatedAt", p."Description", p."Group", p."IsActive", p."Name"
FROM "Permissions" AS p
WHERE p."Id" = ANY (@__permissionIds_0)
2025-07-02 22:00:50.009 +05:30 [INF] ✅ Token generated for: ratan@tcs.com
2025-07-02 22:00:50.012 +05:30 [INF] ✅ Login successful for ratan@tcs.com, Role: business, Plan: Smart
2025-07-02 22:00:50.023 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`3[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:00:50.060 +05:30 [INF] Executed action xbytechat.api.AuthModule.Controllers.AuthController.Login (xbytechat.api) in 109.8537ms
2025-07-02 22:00:50.062 +05:30 [INF] Executed endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.Login (xbytechat.api)'
2025-07-02 22:00:50.065 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/api/auth/login - 200 null application/json; charset=utf-8 128.0058ms
2025-07-02 22:00:50.385 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/auth/session - null null
2025-07-02 22:00:50.409 +05:30 [INF] Executing endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 22:00:50.412 +05:30 [INF] Route matched with {action = "GetSession", controller = "Auth"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetSession() on controller xbytechat.api.AuthModule.Controllers.AuthController (xbytechat.api).
2025-07-02 22:00:50.434 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`4[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:00:50.439 +05:30 [INF] Executed action xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api) in 22.5851ms
2025-07-02 22:00:50.443 +05:30 [INF] Executed endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 22:00:50.445 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/auth/session - 200 null application/json; charset=utf-8 59.4967ms
2025-07-02 22:00:50.645 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/feature-access/me - null null
2025-07-02 22:00:50.650 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 22:00:50.657 +05:30 [INF] Route matched with {action = "GetMyFeatures", controller = "FeatureAccess"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto]]] GetMyFeatures() on controller xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController (xbytechat.api).
2025-07-02 22:00:50.687 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT b."Id", b."Address", b."ApprovedAt", b."ApprovedBy", b."BusinessEmail", b."BusinessName", b."CompanyName", b."CompanyPhone", b."CreatedAt", b."CreatedBy", b."CreatedByPartnerId", b."DeletedAt", b."DeletedBy", b."Industry", b."IsApproved", b."IsDeleted", b."LastLoginAt", b."LogoUrl", b."Notes", b."Phone", b."RepresentativeName", b."Source", b."Status", b."Tags", b."Website", b0."Id", b0."BusinessId", b0."CreatedAt", b0."Plan", b0."QuotaResetDate", b0."RemainingMessages", b0."TotalMonthlyQuota", b0."UpdatedAt", b0."WalletBalance"
FROM "Businesses" AS b
LEFT JOIN "BusinessPlanInfos" AS b0 ON b."Id" = b0."BusinessId"
WHERE b."Id" = @__businessId_0
LIMIT 1
2025-07-02 22:00:50.693 +05:30 [INF] 📦 Resolved plan for Business "c13be597-6ae2-42bb-9d43-925815f24ff8": Smart
2025-07-02 22:00:50.714 +05:30 [INF] Executed DbCommand (9ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."BusinessId", f."CreatedAt", f."Description", f."FeatureName", f."Group", f."IsEnabled", f."Notes", f."Plan"
FROM "FeatureAccess" AS f
WHERE f."BusinessId" = @__businessId_0
2025-07-02 22:00:50.740 +05:30 [INF] 🔧 Feature override: AddProduct = False
2025-07-02 22:00:50.742 +05:30 [INF] 🔧 Feature override: Automation = True
2025-07-02 22:00:50.743 +05:30 [INF] 🔧 Feature override: Campaigns = True
2025-07-02 22:00:50.744 +05:30 [INF] 🔧 Feature override: Catalog = True
2025-07-02 22:00:50.745 +05:30 [INF] 🔧 Feature override: CRM = True
2025-07-02 22:00:50.746 +05:30 [INF] 🔧 Feature override: CRMInsights = True
2025-07-02 22:00:50.747 +05:30 [INF] 🔧 Feature override: CTAFlow = True
2025-07-02 22:00:50.749 +05:30 [INF] 🔧 Feature override: FlowInsights = True
2025-07-02 22:00:50.750 +05:30 [INF] 🔧 Feature override: Messaging = True
2025-07-02 22:00:50.751 +05:30 [INF] 🔧 Feature override: ProfileCompletion = True
2025-07-02 22:00:50.752 +05:30 [INF] 🔧 Feature override: UpgradePlan = True
2025-07-02 22:00:50.752 +05:30 [INF] 🔧 Feature override: WhatsAppSettings = True
2025-07-02 22:00:50.761 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 22:00:50.771 +05:30 [INF] Executed action xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api) in 109.6074ms
2025-07-02 22:00:50.775 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 22:00:50.777 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/feature-access/me - 200 null application/json; charset=utf-8 132.2613ms
2025-07-02 22:00:53.940 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/api/auth/login - application/json 47
2025-07-02 22:00:53.946 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:00:53.949 +05:30 [INF] Executing endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.Login (xbytechat.api)'
2025-07-02 22:00:53.950 +05:30 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(xbytechat.api.AuthModule.DTOs.UserLoginDto) on controller xbytechat.api.AuthModule.Controllers.AuthController (xbytechat.api).
2025-07-02 22:00:53.955 +05:30 [INF] 🔑 Login attempt for email: ratan@tcs.com
2025-07-02 22:00:53.961 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__dto_Email_0='ratan@tcs.com', @__hashedPassword_1='JAvlGPq9JyTdtvBO6x2llnRI1+gxwIyPqCKAn3THIKk='], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."BusinessId", u."CreatedAt", u."DeletedAt", u."Email", u."IsDeleted", u."Name", u."PasswordHash", u."RefreshToken", u."RefreshTokenExpiry", u."RoleId", u."Status", r."Id", r."CreatedAt", r."Description", r."IsActive", r."IsSystemDefined", r."Name"
FROM "Users" AS u
LEFT JOIN "Roles" AS r ON u."RoleId" = r."Id"
WHERE u."Email" = @__dto_Email_0 AND u."PasswordHash" = @__hashedPassword_1 AND NOT (u."IsDeleted")
LIMIT 1
2025-07-02 22:00:53.968 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__user_BusinessId_Value_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT b."Id", b."Address", b."ApprovedAt", b."ApprovedBy", b."BusinessEmail", b."BusinessName", b."CompanyName", b."CompanyPhone", b."CreatedAt", b."CreatedBy", b."CreatedByPartnerId", b."DeletedAt", b."DeletedBy", b."Industry", b."IsApproved", b."IsDeleted", b."LastLoginAt", b."LogoUrl", b."Notes", b."Phone", b."RepresentativeName", b."Source", b."Status", b."Tags", b."Website", b0."Id", b0."BusinessId", b0."CreatedAt", b0."Plan", b0."QuotaResetDate", b0."RemainingMessages", b0."TotalMonthlyQuota", b0."UpdatedAt", b0."WalletBalance"
FROM "Businesses" AS b
LEFT JOIN "BusinessPlanInfos" AS b0 ON b."Id" = b0."BusinessId"
WHERE b."Id" = @__user_BusinessId_Value_0
LIMIT 1
2025-07-02 22:00:53.977 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__user_RoleId_0='00000000-0000-0000-0000-000000000004' (Nullable = true)], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."AssignedAt", r."AssignedBy", r."IsActive", r."IsRevoked", r."PermissionId", r."RoleId"
FROM "RolePermissions" AS r
WHERE r."RoleId" = @__user_RoleId_0 AND NOT (r."IsRevoked")
2025-07-02 22:00:53.982 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='2870e1d8-0e80-4b12-88bd-70a8113307d6'], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."AssignedAt", u."AssignedBy", u."IsGranted", u."IsRevoked", u."PermissionId", u."UserId"
FROM "UserPermissions" AS u
WHERE u."UserId" = @__userId_0 AND NOT (u."IsRevoked")
2025-07-02 22:00:53.989 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__permissionIds_0={ '30000000-0000-0000-0000-000000000000', '30000000-0000-0000-0000-000000000004', '30000000-0000-0000-0000-000000000001', '30000000-0000-0000-0000-000000000007' } (DbType = Object)], CommandType='"Text"', CommandTimeout='30']
SELECT p."Id", p."Code", p."CreatedAt", p."Description", p."Group", p."IsActive", p."Name"
FROM "Permissions" AS p
WHERE p."Id" = ANY (@__permissionIds_0)
2025-07-02 22:00:53.993 +05:30 [INF] ✅ Token generated for: ratan@tcs.com
2025-07-02 22:00:53.995 +05:30 [INF] ✅ Login successful for ratan@tcs.com, Role: business, Plan: Smart
2025-07-02 22:00:53.997 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`3[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:00:53.999 +05:30 [INF] Executed action xbytechat.api.AuthModule.Controllers.AuthController.Login (xbytechat.api) in 46.4354ms
2025-07-02 22:00:54.001 +05:30 [INF] Executed endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.Login (xbytechat.api)'
2025-07-02 22:00:54.006 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/api/auth/login - 200 null application/json; charset=utf-8 65.6069ms
2025-07-02 22:00:54.019 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/auth/session - null null
2025-07-02 22:00:54.024 +05:30 [INF] Executing endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 22:00:54.026 +05:30 [INF] Route matched with {action = "GetSession", controller = "Auth"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetSession() on controller xbytechat.api.AuthModule.Controllers.AuthController (xbytechat.api).
2025-07-02 22:00:54.029 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`4[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:00:54.031 +05:30 [INF] Executed action xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api) in 3.352ms
2025-07-02 22:00:54.033 +05:30 [INF] Executed endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 22:00:54.034 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/auth/session - 200 null application/json; charset=utf-8 15.4862ms
2025-07-02 22:00:54.355 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/feature-access/me - null null
2025-07-02 22:00:54.361 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 22:00:54.362 +05:30 [INF] Route matched with {action = "GetMyFeatures", controller = "FeatureAccess"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto]]] GetMyFeatures() on controller xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController (xbytechat.api).
2025-07-02 22:00:54.369 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT b."Id", b."Address", b."ApprovedAt", b."ApprovedBy", b."BusinessEmail", b."BusinessName", b."CompanyName", b."CompanyPhone", b."CreatedAt", b."CreatedBy", b."CreatedByPartnerId", b."DeletedAt", b."DeletedBy", b."Industry", b."IsApproved", b."IsDeleted", b."LastLoginAt", b."LogoUrl", b."Notes", b."Phone", b."RepresentativeName", b."Source", b."Status", b."Tags", b."Website", b0."Id", b0."BusinessId", b0."CreatedAt", b0."Plan", b0."QuotaResetDate", b0."RemainingMessages", b0."TotalMonthlyQuota", b0."UpdatedAt", b0."WalletBalance"
FROM "Businesses" AS b
LEFT JOIN "BusinessPlanInfos" AS b0 ON b."Id" = b0."BusinessId"
WHERE b."Id" = @__businessId_0
LIMIT 1
2025-07-02 22:00:54.375 +05:30 [INF] 📦 Resolved plan for Business "c13be597-6ae2-42bb-9d43-925815f24ff8": Smart
2025-07-02 22:00:54.379 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."BusinessId", f."CreatedAt", f."Description", f."FeatureName", f."Group", f."IsEnabled", f."Notes", f."Plan"
FROM "FeatureAccess" AS f
WHERE f."BusinessId" = @__businessId_0
2025-07-02 22:00:54.382 +05:30 [INF] 🔧 Feature override: AddProduct = False
2025-07-02 22:00:54.383 +05:30 [INF] 🔧 Feature override: Automation = True
2025-07-02 22:00:54.384 +05:30 [INF] 🔧 Feature override: Campaigns = True
2025-07-02 22:00:54.385 +05:30 [INF] 🔧 Feature override: Catalog = True
2025-07-02 22:00:54.388 +05:30 [INF] 🔧 Feature override: CRM = True
2025-07-02 22:00:54.389 +05:30 [INF] 🔧 Feature override: CRMInsights = True
2025-07-02 22:00:54.390 +05:30 [INF] 🔧 Feature override: CTAFlow = True
2025-07-02 22:00:54.391 +05:30 [INF] 🔧 Feature override: FlowInsights = True
2025-07-02 22:00:54.392 +05:30 [INF] 🔧 Feature override: Messaging = True
2025-07-02 22:00:54.393 +05:30 [INF] 🔧 Feature override: ProfileCompletion = True
2025-07-02 22:00:54.394 +05:30 [INF] 🔧 Feature override: UpgradePlan = True
2025-07-02 22:00:54.395 +05:30 [INF] 🔧 Feature override: WhatsAppSettings = True
2025-07-02 22:00:54.397 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 22:00:54.399 +05:30 [INF] Executed action xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api) in 34.4053ms
2025-07-02 22:00:54.401 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 22:00:54.402 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/feature-access/me - 200 null application/json; charset=utf-8 47.154ms
2025-07-02 22:00:59.083 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/contacts - null null
2025-07-02 22:00:59.086 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null null
2025-07-02 22:00:59.087 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:00:59.090 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null null
2025-07-02 22:00:59.087 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/inbox/unread-counts - null null
2025-07-02 22:00:59.097 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:00:59.099 +05:30 [INF] Executing endpoint 'xbytechat.api.CRM.Controllers.ContactsController.GetAllContacts (xbytechat.api)'
2025-07-02 22:00:59.105 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:00:59.108 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:00:59.112 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 204 null null 22.4226ms
2025-07-02 22:00:59.121 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Inbox.Controllers.InboxController.GetUnreadCounts (xbytechat.api)'
2025-07-02 22:00:59.120 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null 0
2025-07-02 22:00:59.109 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 204 null null 27.5532ms
2025-07-02 22:00:59.112 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null 0
2025-07-02 22:00:59.149 +05:30 [INF] Route matched with {action = "GetAllContacts", controller = "Contacts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllContacts(System.String, Int32, Int32) on controller xbytechat.api.CRM.Controllers.ContactsController (xbytechat.api).
2025-07-02 22:00:59.154 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:00:59.154 +05:30 [INF] Route matched with {action = "GetUnreadCounts", controller = "Inbox"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUnreadCounts() on controller xbytechat.api.Features.Inbox.Controllers.InboxController (xbytechat.api).
2025-07-02 22:00:59.161 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:00:59.165 +05:30 [INF] Executing endpoint '/hubs/inbox/negotiate'
2025-07-02 22:00:59.170 +05:30 [INF] Executing endpoint '/hubs/inbox/negotiate'
2025-07-02 22:00:59.174 +05:30 [INF] GetPagedContactsAsync: businessId="c13be597-6ae2-42bb-9d43-925815f24ff8", tab=all, page=1, pageSize=25
2025-07-02 22:00:59.189 +05:30 [INF] Executed DbCommand (5ms) [Parameters=[@__userId_0='2870e1d8-0e80-4b12-88bd-70a8113307d6'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."BusinessId", c."ContactId", c."LastReadAt", c."UserId"
FROM "ContactReads" AS c
WHERE c."UserId" = @__userId_0
2025-07-02 22:00:59.190 +05:30 [INF] Executed endpoint '/hubs/inbox/negotiate'
2025-07-02 22:00:59.190 +05:30 [INF] Executed endpoint '/hubs/inbox/negotiate'
2025-07-02 22:00:59.203 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/hubs/inbox?id=_axYsoODimk20hnVxfBYKg - null null
2025-07-02 22:00:59.203 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 200 316 application/json 83.0167ms
2025-07-02 22:00:59.205 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 200 316 application/json 92.7075ms
2025-07-02 22:00:59.208 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:00:59.222 +05:30 [INF] Executing endpoint '/hubs/inbox'
2025-07-02 22:00:59.225 +05:30 [INF] Executed DbCommand (8ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."CreatedAt", m."ErrorMessage", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."IsIncoming" AND m."ContactId" IS NOT NULL
2025-07-02 22:00:59.235 +05:30 [INF] Executed DbCommand (11ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Contacts" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."IsActive"
2025-07-02 22:00:59.236 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.Dictionary`2[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:00:59.245 +05:30 [INF] Executed action xbytechat.api.Features.Inbox.Controllers.InboxController.GetUnreadCounts (xbytechat.api) in 76.877ms
2025-07-02 22:00:59.247 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Inbox.Controllers.InboxController.GetUnreadCounts (xbytechat.api)'
2025-07-02 22:00:59.250 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/inbox/unread-counts - 200 null application/json; charset=utf-8 163.5986ms
2025-07-02 22:00:59.264 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/hubs/inbox?id=5uyuJ0ejX3T8eUm_VyQt5w - null null
2025-07-02 22:00:59.269 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:00:59.271 +05:30 [INF] Executing endpoint '/hubs/inbox'
2025-07-02 22:00:59.331 +05:30 [INF] Executed DbCommand (11ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__p_2='25', @__p_1='0'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."AssignedAgentId", t."BusinessId", t."CreatedAt", t."Email", t."Group", t."IsActive", t."IsArchived", t."IsAutomationPaused", t."IsFavorite", t."LastCTAInteraction", t."LastCTAType", t."LastClickedProductId", t."LastContactedAt", t."LeadSource", t."Name", t."NextFollowUpAt", t."Notes", t."PhoneNumber", t."Tags", t0."Id", t0."AssignedAt", t0."AssignedBy", t0."BusinessId", t0."ContactId", t0."TagId", t0."Id0", t0."BusinessId0", t0."Category", t0."ColorHex", t0."CreatedAt", t0."IsActive", t0."IsSystemTag", t0."LastUsedAt", t0."Name", t0."Notes"
FROM (
    SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."Tags"
    FROM "Contacts" AS c
    WHERE c."BusinessId" = @__businessId_0 AND c."IsActive"
    ORDER BY c."Name"
    LIMIT @__p_2 OFFSET @__p_1
) AS t
LEFT JOIN (
    SELECT c0."Id", c0."AssignedAt", c0."AssignedBy", c0."BusinessId", c0."ContactId", c0."TagId", t1."Id" AS "Id0", t1."BusinessId" AS "BusinessId0", t1."Category", t1."ColorHex", t1."CreatedAt", t1."IsActive", t1."IsSystemTag", t1."LastUsedAt", t1."Name", t1."Notes"
    FROM "ContactTags" AS c0
    INNER JOIN "Tags" AS t1 ON c0."TagId" = t1."Id"
) AS t0 ON t."Id" = t0."ContactId"
ORDER BY t."Name", t."Id", t0."Id"
2025-07-02 22:00:59.427 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Helpers.ResponseResult'.
2025-07-02 22:00:59.450 +05:30 [INF] Executed action xbytechat.api.CRM.Controllers.ContactsController.GetAllContacts (xbytechat.api) in 286.4884ms
2025-07-02 22:00:59.452 +05:30 [INF] Executed endpoint 'xbytechat.api.CRM.Controllers.ContactsController.GetAllContacts (xbytechat.api)'
2025-07-02 22:00:59.454 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/contacts - 200 null application/json; charset=utf-8 370.9253ms
2025-07-02 22:03:26.808 +05:30 [INF] Executed endpoint '/hubs/inbox'
2025-07-02 22:03:26.808 +05:30 [INF] Executed endpoint '/hubs/inbox'
2025-07-02 22:03:26.811 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/hubs/inbox?id=_axYsoODimk20hnVxfBYKg - 101 null null 147607.8595ms
2025-07-02 22:03:26.812 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/hubs/inbox?id=5uyuJ0ejX3T8eUm_VyQt5w - 101 null null 147548.5622ms
2025-07-02 22:03:27.477 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/auth/session - null null
2025-07-02 22:03:27.484 +05:30 [INF] Executing endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 22:03:27.485 +05:30 [INF] Route matched with {action = "GetSession", controller = "Auth"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetSession() on controller xbytechat.api.AuthModule.Controllers.AuthController (xbytechat.api).
2025-07-02 22:03:27.490 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`4[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:03:27.493 +05:30 [INF] Executed action xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api) in 4.0516ms
2025-07-02 22:03:27.495 +05:30 [INF] Executed endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 22:03:27.496 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/auth/session - 200 null application/json; charset=utf-8 19.2069ms
2025-07-02 22:03:27.618 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/feature-access/me - null null
2025-07-02 22:03:27.623 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 22:03:27.625 +05:30 [INF] Route matched with {action = "GetMyFeatures", controller = "FeatureAccess"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto]]] GetMyFeatures() on controller xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController (xbytechat.api).
2025-07-02 22:03:27.752 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT b."Id", b."Address", b."ApprovedAt", b."ApprovedBy", b."BusinessEmail", b."BusinessName", b."CompanyName", b."CompanyPhone", b."CreatedAt", b."CreatedBy", b."CreatedByPartnerId", b."DeletedAt", b."DeletedBy", b."Industry", b."IsApproved", b."IsDeleted", b."LastLoginAt", b."LogoUrl", b."Notes", b."Phone", b."RepresentativeName", b."Source", b."Status", b."Tags", b."Website", b0."Id", b0."BusinessId", b0."CreatedAt", b0."Plan", b0."QuotaResetDate", b0."RemainingMessages", b0."TotalMonthlyQuota", b0."UpdatedAt", b0."WalletBalance"
FROM "Businesses" AS b
LEFT JOIN "BusinessPlanInfos" AS b0 ON b."Id" = b0."BusinessId"
WHERE b."Id" = @__businessId_0
LIMIT 1
2025-07-02 22:03:27.756 +05:30 [INF] 📦 Resolved plan for Business "c13be597-6ae2-42bb-9d43-925815f24ff8": Smart
2025-07-02 22:03:27.761 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."BusinessId", f."CreatedAt", f."Description", f."FeatureName", f."Group", f."IsEnabled", f."Notes", f."Plan"
FROM "FeatureAccess" AS f
WHERE f."BusinessId" = @__businessId_0
2025-07-02 22:03:27.765 +05:30 [INF] 🔧 Feature override: AddProduct = False
2025-07-02 22:03:27.766 +05:30 [INF] 🔧 Feature override: Automation = True
2025-07-02 22:03:27.767 +05:30 [INF] 🔧 Feature override: Campaigns = True
2025-07-02 22:03:27.768 +05:30 [INF] 🔧 Feature override: Catalog = True
2025-07-02 22:03:27.769 +05:30 [INF] 🔧 Feature override: CRM = True
2025-07-02 22:03:27.770 +05:30 [INF] 🔧 Feature override: CRMInsights = True
2025-07-02 22:03:27.771 +05:30 [INF] 🔧 Feature override: CTAFlow = True
2025-07-02 22:03:27.772 +05:30 [INF] 🔧 Feature override: FlowInsights = True
2025-07-02 22:03:27.773 +05:30 [INF] 🔧 Feature override: Messaging = True
2025-07-02 22:03:27.774 +05:30 [INF] 🔧 Feature override: ProfileCompletion = True
2025-07-02 22:03:27.776 +05:30 [INF] 🔧 Feature override: UpgradePlan = True
2025-07-02 22:03:27.777 +05:30 [INF] 🔧 Feature override: WhatsAppSettings = True
2025-07-02 22:03:27.779 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 22:03:27.782 +05:30 [INF] Executed action xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api) in 153.6785ms
2025-07-02 22:03:27.784 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 22:03:27.786 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/feature-access/me - 200 null application/json; charset=utf-8 168.1297ms
2025-07-02 22:03:27.852 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null null
2025-07-02 22:03:27.854 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/contacts - null null
2025-07-02 22:03:27.855 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/inbox/unread-counts - null null
2025-07-02 22:03:27.856 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:03:27.860 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:03:27.864 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null null
2025-07-02 22:03:27.865 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 204 null null 13.1895ms
2025-07-02 22:03:27.866 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:03:27.867 +05:30 [INF] Executing endpoint 'xbytechat.api.CRM.Controllers.ContactsController.GetAllContacts (xbytechat.api)'
2025-07-02 22:03:27.868 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null 0
2025-07-02 22:03:27.870 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:03:27.877 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Inbox.Controllers.InboxController.GetUnreadCounts (xbytechat.api)'
2025-07-02 22:03:27.878 +05:30 [INF] Route matched with {action = "GetAllContacts", controller = "Contacts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllContacts(System.String, Int32, Int32) on controller xbytechat.api.CRM.Controllers.ContactsController (xbytechat.api).
2025-07-02 22:03:27.882 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:03:27.883 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 204 null null 18.726ms
2025-07-02 22:03:27.885 +05:30 [INF] Route matched with {action = "GetUnreadCounts", controller = "Inbox"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUnreadCounts() on controller xbytechat.api.Features.Inbox.Controllers.InboxController (xbytechat.api).
2025-07-02 22:03:27.887 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null 0
2025-07-02 22:03:27.889 +05:30 [INF] Executing endpoint '/hubs/inbox/negotiate'
2025-07-02 22:03:27.914 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[@__userId_0='2870e1d8-0e80-4b12-88bd-70a8113307d6'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."BusinessId", c."ContactId", c."LastReadAt", c."UserId"
FROM "ContactReads" AS c
WHERE c."UserId" = @__userId_0
2025-07-02 22:03:27.912 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:03:27.920 +05:30 [INF] Executed endpoint '/hubs/inbox/negotiate'
2025-07-02 22:03:27.888 +05:30 [INF] GetPagedContactsAsync: businessId="c13be597-6ae2-42bb-9d43-925815f24ff8", tab=all, page=1, pageSize=25
2025-07-02 22:03:27.927 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."CreatedAt", m."ErrorMessage", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."IsIncoming" AND m."ContactId" IS NOT NULL
2025-07-02 22:03:27.927 +05:30 [INF] Executing endpoint '/hubs/inbox/negotiate'
2025-07-02 22:03:27.935 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.Dictionary`2[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:03:27.938 +05:30 [INF] Executed endpoint '/hubs/inbox/negotiate'
2025-07-02 22:03:27.928 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 200 316 application/json 60.1591ms
2025-07-02 22:03:27.945 +05:30 [INF] Executed action xbytechat.api.Features.Inbox.Controllers.InboxController.GetUnreadCounts (xbytechat.api) in 38.1919ms
2025-07-02 22:03:27.946 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 200 316 application/json 59.2801ms
2025-07-02 22:03:27.954 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Inbox.Controllers.InboxController.GetUnreadCounts (xbytechat.api)'
2025-07-02 22:03:27.963 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/inbox/unread-counts - 200 null application/json; charset=utf-8 107.7562ms
2025-07-02 22:03:27.966 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/hubs/inbox?id=79eMoxTGHBOiSuVZ2sDZKQ - null null
2025-07-02 22:03:27.973 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:03:27.975 +05:30 [INF] Executing endpoint '/hubs/inbox'
2025-07-02 22:03:27.999 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/hubs/inbox?id=NhzGOuA8gYfiONUwtm4mrw - null null
2025-07-02 22:03:28.003 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:03:28.005 +05:30 [INF] Executing endpoint '/hubs/inbox'
2025-07-02 22:03:28.052 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Contacts" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."IsActive"
2025-07-02 22:03:28.060 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__p_2='25', @__p_1='0'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."AssignedAgentId", t."BusinessId", t."CreatedAt", t."Email", t."Group", t."IsActive", t."IsArchived", t."IsAutomationPaused", t."IsFavorite", t."LastCTAInteraction", t."LastCTAType", t."LastClickedProductId", t."LastContactedAt", t."LeadSource", t."Name", t."NextFollowUpAt", t."Notes", t."PhoneNumber", t."Tags", t0."Id", t0."AssignedAt", t0."AssignedBy", t0."BusinessId", t0."ContactId", t0."TagId", t0."Id0", t0."BusinessId0", t0."Category", t0."ColorHex", t0."CreatedAt", t0."IsActive", t0."IsSystemTag", t0."LastUsedAt", t0."Name", t0."Notes"
FROM (
    SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."Tags"
    FROM "Contacts" AS c
    WHERE c."BusinessId" = @__businessId_0 AND c."IsActive"
    ORDER BY c."Name"
    LIMIT @__p_2 OFFSET @__p_1
) AS t
LEFT JOIN (
    SELECT c0."Id", c0."AssignedAt", c0."AssignedBy", c0."BusinessId", c0."ContactId", c0."TagId", t1."Id" AS "Id0", t1."BusinessId" AS "BusinessId0", t1."Category", t1."ColorHex", t1."CreatedAt", t1."IsActive", t1."IsSystemTag", t1."LastUsedAt", t1."Name", t1."Notes"
    FROM "ContactTags" AS c0
    INNER JOIN "Tags" AS t1 ON c0."TagId" = t1."Id"
) AS t0 ON t."Id" = t0."ContactId"
ORDER BY t."Name", t."Id", t0."Id"
2025-07-02 22:03:28.078 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Helpers.ResponseResult'.
2025-07-02 22:03:28.082 +05:30 [INF] Executed action xbytechat.api.CRM.Controllers.ContactsController.GetAllContacts (xbytechat.api) in 194.8613ms
2025-07-02 22:03:28.085 +05:30 [INF] Executed endpoint 'xbytechat.api.CRM.Controllers.ContactsController.GetAllContacts (xbytechat.api)'
2025-07-02 22:03:28.087 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/contacts - 200 null application/json; charset=utf-8 233.0059ms
2025-07-02 22:04:11.164 +05:30 [INF] Executed endpoint '/hubs/inbox'
2025-07-02 22:04:11.164 +05:30 [INF] Executed endpoint '/hubs/inbox'
2025-07-02 22:04:11.166 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/hubs/inbox?id=NhzGOuA8gYfiONUwtm4mrw - 101 null null 43167.3401ms
2025-07-02 22:04:11.168 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/hubs/inbox?id=79eMoxTGHBOiSuVZ2sDZKQ - 101 null null 43201.6924ms
2025-07-02 22:04:11.617 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/whatsappsettings/me - null null
2025-07-02 22:04:11.623 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:04:11.625 +05:30 [INF] Executing endpoint 'xbytechat_api.WhatsAppSettings.Controllers.WhatsAppSettingsController.GetMySettings (xbytechat.api)'
2025-07-02 22:04:11.632 +05:30 [INF] Route matched with {action = "GetMySettings", controller = "WhatsAppSettings"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMySettings() on controller xbytechat_api.WhatsAppSettings.Controllers.WhatsAppSettingsController (xbytechat.api).
2025-07-02 22:04:11.657 +05:30 [INF] Executed DbCommand (6ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiToken", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."BusinessId" = @__businessId_0 AND w."IsActive"
LIMIT 1
2025-07-02 22:04:11.687 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat_api.WhatsAppSettings.Models.WhatsAppSettingEntity'.
2025-07-02 22:04:11.693 +05:30 [INF] Executed action xbytechat_api.WhatsAppSettings.Controllers.WhatsAppSettingsController.GetMySettings (xbytechat.api) in 57.8197ms
2025-07-02 22:04:11.696 +05:30 [INF] Executed endpoint 'xbytechat_api.WhatsAppSettings.Controllers.WhatsAppSettingsController.GetMySettings (xbytechat.api)'
2025-07-02 22:04:11.698 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/whatsappsettings/me - 200 null application/json; charset=utf-8 80.8788ms
2025-07-02 22:05:11.304 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/api/whatsappsettings/update - null null
2025-07-02 22:05:11.310 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:05:11.311 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/api/whatsappsettings/update - 204 null null 7.5109ms
2025-07-02 22:05:11.316 +05:30 [INF] Request starting HTTP/1.1 PUT http://localhost:7113/api/whatsappsettings/update - application/json 477
2025-07-02 22:05:11.321 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:05:11.323 +05:30 [INF] Executing endpoint 'xbytechat_api.WhatsAppSettings.Controllers.WhatsAppSettingsController.UpdateSetting (xbytechat.api)'
2025-07-02 22:05:11.328 +05:30 [INF] Route matched with {action = "UpdateSetting", controller = "WhatsAppSettings"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] UpdateSetting(xbytechat_api.WhatsAppSettings.DTOs.SaveWhatsAppSettingDto) on controller xbytechat_api.WhatsAppSettings.Controllers.WhatsAppSettingsController (xbytechat.api).
2025-07-02 22:05:11.342 +05:30 [INF] 🔧 [UpdateSetting] Request received for WhatsApp settings update.
2025-07-02 22:05:11.345 +05:30 [INF] 💾 [UpdateSetting] Saving/updating WhatsApp settings for businessId="c13be597-6ae2-42bb-9d43-925815f24ff8".
2025-07-02 22:05:11.355 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__dto_BusinessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiToken", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."BusinessId" = @__dto_BusinessId_0
LIMIT 1
2025-07-02 22:05:11.481 +05:30 [INF] Executed DbCommand (15ms) [Parameters=[@p2='36de2595-f729-4b07-9958-11c8a56db12f', @p0='EAAIo1fBYKV8BOzcfmFlHx7HZBItcTZCngKIqvbARZAcxgykMSLH7d2nwlM1a3nkZCSbx67CCIZAZBx6nAZCkuW0YBi4zkZAYBOt13jTGs3qRVV2AfiZBuqU0pmR1OUvGck4z8Vhqy51pNXaoL6lkMd48LfoYX5yqxojdbIwWrOdxgsSSkmlZC4ZA7zHYGQrb2QRunn3Yo7Sl4jZCq9rE3jsElbSFE9oZCJ12OI9hRUSeA7ZAIhlJZAf7hEOkuqbulqG0fhezj0ZD' (Nullable = false), @p1='2025-07-02T16:35:11.3680733Z' (Nullable = true) (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE "WhatsAppSettings" SET "ApiToken" = @p0, "UpdatedAt" = @p1
WHERE "Id" = @p2;
2025-07-02 22:05:11.497 +05:30 [INF] ✅ [UpdateSetting] WhatsApp settings updated successfully.
2025-07-02 22:05:11.499 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType16`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:05:11.503 +05:30 [INF] Executed action xbytechat_api.WhatsAppSettings.Controllers.WhatsAppSettingsController.UpdateSetting (xbytechat.api) in 170.2898ms
2025-07-02 22:05:11.506 +05:30 [INF] Executed endpoint 'xbytechat_api.WhatsAppSettings.Controllers.WhatsAppSettingsController.UpdateSetting (xbytechat.api)'
2025-07-02 22:05:11.508 +05:30 [INF] Request finished HTTP/1.1 PUT http://localhost:7113/api/whatsappsettings/update - 200 null application/json; charset=utf-8 191.1242ms
2025-07-02 22:05:12.368 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/api/whatsappsettings/test-connection - null null
2025-07-02 22:05:12.372 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:05:12.374 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/api/whatsappsettings/test-connection - 204 null null 5.6262ms
2025-07-02 22:05:12.377 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/api/whatsappsettings/test-connection - application/json 477
2025-07-02 22:05:12.382 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:05:12.384 +05:30 [INF] Executing endpoint 'xbytechat_api.WhatsAppSettings.Controllers.WhatsAppSettingsController.TestConnection (xbytechat.api)'
2025-07-02 22:05:12.389 +05:30 [INF] Route matched with {action = "TestConnection", controller = "WhatsAppSettings"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] TestConnection(xbytechat_api.WhatsAppSettings.DTOs.SaveWhatsAppSettingDto) on controller xbytechat_api.WhatsAppSettings.Controllers.WhatsAppSettingsController (xbytechat.api).
2025-07-02 22:05:14.847 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType16`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:05:14.850 +05:30 [INF] Executed action xbytechat_api.WhatsAppSettings.Controllers.WhatsAppSettingsController.TestConnection (xbytechat.api) in 2457.1582ms
2025-07-02 22:05:14.852 +05:30 [INF] Executed endpoint 'xbytechat_api.WhatsAppSettings.Controllers.WhatsAppSettingsController.TestConnection (xbytechat.api)'
2025-07-02 22:05:14.853 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/api/whatsappsettings/test-connection - 200 null application/json; charset=utf-8 2476.5257ms
2025-07-02 22:06:39.466 +05:30 [INF] Request starting HTTP/1.1 GET http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp?hub.mode=subscribe&hub.challenge=1852561055&hub.verify_token=xbytechat-secret-token - null null
2025-07-02 22:06:39.471 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.VerifyWebhook (xbytechat.api)'
2025-07-02 22:06:39.474 +05:30 [INF] Route matched with {action = "VerifyWebhook", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult VerifyWebhook(System.String, System.String, System.String) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-07-02 22:06:39.484 +05:30 [INF] ✅ WhatsApp webhook verified successfully.
2025-07-02 22:06:39.485 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.String'.
2025-07-02 22:06:39.488 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.VerifyWebhook (xbytechat.api) in 8.0137ms
2025-07-02 22:06:39.490 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.VerifyWebhook (xbytechat.api)'
2025-07-02 22:06:39.491 +05:30 [INF] Request finished HTTP/1.1 GET http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp?hub.mode=subscribe&hub.challenge=1852561055&hub.verify_token=xbytechat-secret-token - 200 null text/plain; charset=utf-8 25.0737ms
2025-07-02 22:06:43.655 +05:30 [INF] Request starting HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - application/json 550
2025-07-02 22:06:43.661 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:06:43.665 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-07-02 22:06:43.679 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSODFCMTZBNDlFODkxMzYyNTQ0AA==","status":"delivered","timestamp":"1751182852","recipient_id":"917082156227","conversation":{"id":"90b38ee00c6455dcc79733c1fd93f79a","origin":{"type":"service"}},"pricing":{"billable":true,"pricing_model":"CBP","category":"service"}}]},"field":"messages"}]}]}
2025-07-02 22:06:43.684 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-07-02 22:06:43.687 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType73`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:06:43.691 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 22.7992ms
2025-07-02 22:06:43.699 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:06:43.701 +05:30 [INF] Request finished HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 46.4011ms
2025-07-02 22:06:43.886 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSODFCMTZBNDlFODkxMzYyNTQ0AA==","status":"delivered","timestamp":"1751182852","recipient_id":"917082156227","conversation":{"id":"90b38ee00c6455dcc79733c1fd93f79a","origin":{"type":"service"}},"pricing":{"billable":true,"pricing_model":"CBP","category":"service"}}]},"field":"messages"}]}]}
2025-07-02 22:06:43.889 +05:30 [INF] 📦 Routing to Status Processor
2025-07-02 22:06:43.892 +05:30 [WRN] 🔍 Incoming timestamp raw value: {"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSODFCMTZBNDlFODkxMzYyNTQ0AA==","status":"delivered","timestamp":"1751182852","recipient_id":"917082156227","conversation":{"id":"90b38ee00c6455dcc79733c1fd93f79a","origin":{"type":"service"}},"pricing":{"billable":true,"pricing_model":"CBP","category":"service"}}]},"field":"messages"}]}]}
2025-07-02 22:06:43.923 +05:30 [INF] Executed DbCommand (9ms) [Parameters=[@__messageId_0='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSODFCMTZBNDlFODkxMzYyNTQ0AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."MessageId" = @__messageId_0
LIMIT 1
2025-07-02 22:06:43.929 +05:30 [WRN] ⚠️ CampaignSendLog not found for MessageId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSODFCMTZBNDlFODkxMzYyNTQ0AA==
2025-07-02 22:06:43.932 +05:30 [WRN] ⚠️ No matching CampaignSendLog for MessageId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSODFCMTZBNDlFODkxMzYyNTQ0AA==
2025-07-02 22:06:53.601 +05:30 [INF] Request starting HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - application/json 554
2025-07-02 22:06:53.609 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:06:53.614 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-07-02 22:06:53.627 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMjdGRjU3OTVBNkQzMkM4RUQzAA==","status":"delivered","timestamp":"1751293969","recipient_id":"917082156227","conversation":{"id":"641e179b573fb1a0f165124f357270bb","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"CBP","category":"marketing"}}]},"field":"messages"}]}]}
2025-07-02 22:06:53.629 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-07-02 22:06:53.631 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType73`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:06:53.632 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMjdGRjU3OTVBNkQzMkM4RUQzAA==","status":"delivered","timestamp":"1751293969","recipient_id":"917082156227","conversation":{"id":"641e179b573fb1a0f165124f357270bb","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"CBP","category":"marketing"}}]},"field":"messages"}]}]}
2025-07-02 22:06:53.635 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 9.9959ms
2025-07-02 22:06:53.638 +05:30 [INF] 📦 Routing to Status Processor
2025-07-02 22:06:53.639 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:06:53.640 +05:30 [WRN] 🔍 Incoming timestamp raw value: {"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMjdGRjU3OTVBNkQzMkM4RUQzAA==","status":"delivered","timestamp":"1751293969","recipient_id":"917082156227","conversation":{"id":"641e179b573fb1a0f165124f357270bb","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"CBP","category":"marketing"}}]},"field":"messages"}]}]}
2025-07-02 22:06:53.642 +05:30 [INF] Request finished HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 40.8625ms
2025-07-02 22:06:53.661 +05:30 [INF] Executed DbCommand (9ms) [Parameters=[@__messageId_0='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMjdGRjU3OTVBNkQzMkM4RUQzAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."MessageId" = @__messageId_0
LIMIT 1
2025-07-02 22:06:53.768 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__logId_Value_0='c9ef0c77-eab2-40c3-8bb3-02a6118b1a4a'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."Id" = @__logId_Value_0
LIMIT 1
2025-07-02 22:06:53.810 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[@p2='c9ef0c77-eab2-40c3-8bb3-02a6118b1a4a', @p0='2025-06-30T14:32:49.0000000Z' (Nullable = true) (DbType = DateTime), @p1='Delivered'], CommandType='"Text"', CommandTimeout='30']
UPDATE "CampaignSendLogs" SET "DeliveredAt" = @p0, "SendStatus" = @p1
WHERE "Id" = @p2;
2025-07-02 22:06:53.818 +05:30 [INF] ✅ CampaignSendLog updated for MessageId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMjdGRjU3OTVBNkQzMkM4RUQzAA== → delivered
2025-07-02 22:06:59.333 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null null
2025-07-02 22:06:59.334 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/contacts - null null
2025-07-02 22:06:59.334 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null null
2025-07-02 22:06:59.334 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/inbox/unread-counts - null null
2025-07-02 22:06:59.340 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:06:59.343 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:06:59.347 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:06:59.350 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:06:59.354 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null 0
2025-07-02 22:06:59.361 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null 0
2025-07-02 22:06:59.356 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 204 null null 22.0426ms
2025-07-02 22:06:59.354 +05:30 [INF] Executing endpoint 'xbytechat.api.CRM.Controllers.ContactsController.GetAllContacts (xbytechat.api)'
2025-07-02 22:06:59.351 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 204 null null 18.3169ms
2025-07-02 22:06:59.372 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Inbox.Controllers.InboxController.GetUnreadCounts (xbytechat.api)'
2025-07-02 22:06:59.375 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:06:59.381 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:06:59.387 +05:30 [INF] Route matched with {action = "GetAllContacts", controller = "Contacts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllContacts(System.String, Int32, Int32) on controller xbytechat.api.CRM.Controllers.ContactsController (xbytechat.api).
2025-07-02 22:06:59.392 +05:30 [INF] Route matched with {action = "GetUnreadCounts", controller = "Inbox"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUnreadCounts() on controller xbytechat.api.Features.Inbox.Controllers.InboxController (xbytechat.api).
2025-07-02 22:06:59.394 +05:30 [INF] Executing endpoint '/hubs/inbox/negotiate'
2025-07-02 22:06:59.395 +05:30 [INF] Executing endpoint '/hubs/inbox/negotiate'
2025-07-02 22:06:59.398 +05:30 [INF] GetPagedContactsAsync: businessId="c13be597-6ae2-42bb-9d43-925815f24ff8", tab=all, page=1, pageSize=25
2025-07-02 22:06:59.402 +05:30 [INF] Executed endpoint '/hubs/inbox/negotiate'
2025-07-02 22:06:59.409 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/hubs/inbox?id=SB18QbqyIIDqTC8F7-aRPw - null null
2025-07-02 22:06:59.401 +05:30 [INF] Executed endpoint '/hubs/inbox/negotiate'
2025-07-02 22:06:59.405 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='2870e1d8-0e80-4b12-88bd-70a8113307d6'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."BusinessId", c."ContactId", c."LastReadAt", c."UserId"
FROM "ContactReads" AS c
WHERE c."UserId" = @__userId_0
2025-07-02 22:06:59.416 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Contacts" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."IsActive"
2025-07-02 22:06:59.416 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 200 316 application/json 54.8183ms
2025-07-02 22:06:59.419 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:06:59.420 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 200 316 application/json 65.997ms
2025-07-02 22:06:59.432 +05:30 [INF] Executed DbCommand (5ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__p_2='25', @__p_1='0'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."AssignedAgentId", t."BusinessId", t."CreatedAt", t."Email", t."Group", t."IsActive", t."IsArchived", t."IsAutomationPaused", t."IsFavorite", t."LastCTAInteraction", t."LastCTAType", t."LastClickedProductId", t."LastContactedAt", t."LeadSource", t."Name", t."NextFollowUpAt", t."Notes", t."PhoneNumber", t."Tags", t0."Id", t0."AssignedAt", t0."AssignedBy", t0."BusinessId", t0."ContactId", t0."TagId", t0."Id0", t0."BusinessId0", t0."Category", t0."ColorHex", t0."CreatedAt", t0."IsActive", t0."IsSystemTag", t0."LastUsedAt", t0."Name", t0."Notes"
FROM (
    SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."Tags"
    FROM "Contacts" AS c
    WHERE c."BusinessId" = @__businessId_0 AND c."IsActive"
    ORDER BY c."Name"
    LIMIT @__p_2 OFFSET @__p_1
) AS t
LEFT JOIN (
    SELECT c0."Id", c0."AssignedAt", c0."AssignedBy", c0."BusinessId", c0."ContactId", c0."TagId", t1."Id" AS "Id0", t1."BusinessId" AS "BusinessId0", t1."Category", t1."ColorHex", t1."CreatedAt", t1."IsActive", t1."IsSystemTag", t1."LastUsedAt", t1."Name", t1."Notes"
    FROM "ContactTags" AS c0
    INNER JOIN "Tags" AS t1 ON c0."TagId" = t1."Id"
) AS t0 ON t."Id" = t0."ContactId"
ORDER BY t."Name", t."Id", t0."Id"
2025-07-02 22:06:59.425 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."CreatedAt", m."ErrorMessage", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."IsIncoming" AND m."ContactId" IS NOT NULL
2025-07-02 22:06:59.437 +05:30 [INF] Executing endpoint '/hubs/inbox'
2025-07-02 22:06:59.443 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Helpers.ResponseResult'.
2025-07-02 22:06:59.446 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.Dictionary`2[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:06:59.453 +05:30 [INF] Executed action xbytechat.api.CRM.Controllers.ContactsController.GetAllContacts (xbytechat.api) in 56.2569ms
2025-07-02 22:06:59.455 +05:30 [INF] Executed action xbytechat.api.Features.Inbox.Controllers.InboxController.GetUnreadCounts (xbytechat.api) in 56.1153ms
2025-07-02 22:06:59.457 +05:30 [INF] Executed endpoint 'xbytechat.api.CRM.Controllers.ContactsController.GetAllContacts (xbytechat.api)'
2025-07-02 22:06:59.459 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Inbox.Controllers.InboxController.GetUnreadCounts (xbytechat.api)'
2025-07-02 22:06:59.461 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/contacts - 200 null application/json; charset=utf-8 126.7295ms
2025-07-02 22:06:59.462 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/inbox/unread-counts - 200 null application/json; charset=utf-8 127.3791ms
2025-07-02 22:06:59.463 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/hubs/inbox?id=FmnBG9T05KxqjgucjzWjUQ - null null
2025-07-02 22:06:59.475 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:06:59.476 +05:30 [INF] Executing endpoint '/hubs/inbox'
2025-07-02 22:07:44.879 +05:30 [INF] Request starting HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - application/json 491
2025-07-02 22:07:44.883 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:07:44.885 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-07-02 22:07:44.888 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"contacts":[{"profile":{"name":"\ua9c1S.K\ua9c2"},"wa_id":"917082156227"}],"messages":[{"from":"917082156227","id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAEhggNkUwQ0ZBMDdFMERGMUY5NTc3RDM2RTEwMzczQjQ4OTEA","timestamp":"1751182845","text":{"body":"Hi"},"type":"text"}]},"field":"messages"}]}]}
2025-07-02 22:07:44.890 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-07-02 22:07:44.893 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType73`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:07:44.895 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 7.7206ms
2025-07-02 22:07:44.898 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:07:44.899 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"contacts":[{"profile":{"name":"\ua9c1S.K\ua9c2"},"wa_id":"917082156227"}],"messages":[{"from":"917082156227","id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAEhggNkUwQ0ZBMDdFMERGMUY5NTc3RDM2RTEwMzczQjQ4OTEA","timestamp":"1751182845","text":{"body":"Hi"},"type":"text"}]},"field":"messages"}]}]}
2025-07-02 22:07:44.899 +05:30 [INF] Request finished HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 20.2798ms
2025-07-02 22:07:44.903 +05:30 [INF] 💬 Routing to InboundMessageProcessor (type: text)
2025-07-02 22:07:44.951 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__businessNumber_0='15556395845'], CommandType='"Text"', CommandTimeout='30']
SELECT b."Id", b."Address", b."ApprovedAt", b."ApprovedBy", b."BusinessEmail", b."BusinessName", b."CompanyName", b."CompanyPhone", b."CreatedAt", b."CreatedBy", b."CreatedByPartnerId", b."DeletedAt", b."DeletedBy", b."Industry", b."IsApproved", b."IsDeleted", b."LastLoginAt", b."LogoUrl", b."Notes", b."Phone", b."RepresentativeName", b."Source", b."Status", b."Tags", b."Website", w."Id", w."ApiToken", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WhatsAppBusinessNumber"
FROM "Businesses" AS b
LEFT JOIN "WhatsAppSettings" AS w ON b."Id" = w."BusinessId"
WHERE w."WhatsAppBusinessNumber" = @__businessNumber_0
LIMIT 1
2025-07-02 22:07:44.958 +05:30 [INF] FindOrCreateAsync: businessId="c13be597-6ae2-42bb-9d43-925815f24ff8", phoneNumber=917082156227
2025-07-02 22:07:44.969 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__phoneNumber_1='917082156227'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."Tags"
FROM "Contacts" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."PhoneNumber" = @__phoneNumber_1
LIMIT 1
2025-07-02 22:07:45.084 +05:30 [INF] Executed DbCommand (11ms) [Parameters=[@p0='0876f654-a362-420f-a912-6bce793436a5', @p1=NULL (DbType = Guid), @p2='c13be597-6ae2-42bb-9d43-925815f24ff8', @p3='2025-07-02T16:37:44.9776013Z' (DbType = DateTime), @p4=NULL, @p5=NULL, @p6='True', @p7='False', @p8='False', @p9='False', @p10=NULL (DbType = DateTime), @p11=NULL, @p12=NULL (DbType = Guid), @p13=NULL (DbType = DateTime), @p14=NULL, @p15='WhatsApp User' (Nullable = false), @p16=NULL (DbType = DateTime), @p17=NULL, @p18='917082156227' (Nullable = false), @p19=NULL], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Contacts" ("Id", "AssignedAgentId", "BusinessId", "CreatedAt", "Email", "Group", "IsActive", "IsArchived", "IsAutomationPaused", "IsFavorite", "LastCTAInteraction", "LastCTAType", "LastClickedProductId", "LastContactedAt", "LeadSource", "Name", "NextFollowUpAt", "Notes", "PhoneNumber", "Tags")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19);
2025-07-02 22:07:45.090 +05:30 [INF] Contact created: "0876f654-a362-420f-a912-6bce793436a5"
2025-07-02 22:07:45.106 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__contactId_1='0876f654-a362-420f-a912-6bce793436a5'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."BusinessId", c."ContactId", c."LastUpdatedAt", c."Mode", c."UpdatedBy"
FROM "ChatSessionStates" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."ContactId" = @__contactId_1
LIMIT 1
2025-07-02 22:07:45.181 +05:30 [INF] Executed DbCommand (5ms) [Parameters=[@p0='e07469e1-4aaf-4e03-b5c1-557c4f9bb3cf', @p1='c13be597-6ae2-42bb-9d43-925815f24ff8', @p2=NULL (DbType = Guid), @p3=NULL (DbType = Guid), @p4=NULL (DbType = Guid), @p5='0876f654-a362-420f-a912-6bce793436a5' (Nullable = true), @p6='2025-07-02T16:37:45.1124070Z' (DbType = DateTime), @p7=NULL, @p8='True', @p9=NULL, @p10='Hi' (Nullable = false), @p11=NULL, @p12=NULL, @p13='917082156227' (Nullable = false), @p14=NULL (DbType = Guid), @p15=NULL, @p16='2025-07-02T16:37:45.1124869Z' (Nullable = true) (DbType = DateTime), @p17=NULL, @p18='received' (Nullable = false)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "MessageLogs" ("Id", "BusinessId", "CTAFlowConfigId", "CTAFlowStepId", "CampaignId", "ContactId", "CreatedAt", "ErrorMessage", "IsIncoming", "MediaUrl", "MessageContent", "MessageId", "RawResponse", "RecipientNumber", "RefMessageId", "RenderedBody", "SentAt", "Source", "Status")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
2025-07-02 22:07:45.199 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."BusinessId", a."CreatedAt", a."FlowId", a."FlowName", a."IsActive", a."MediaUrl", a."Priority", a."ReplyMessage", a."TriggerKeyword", a."UpdatedAt"
FROM "AutoReplyRules" AS a
WHERE a."BusinessId" = @__businessId_0 AND a."IsActive"
2025-07-02 22:07:45.203 +05:30 [INF] 🔍 No flow match found or FlowId is null. Trying fallback auto-reply...
2025-07-02 22:07:45.223 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__incomingMessage_1='Hi'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."BusinessId", a."CreatedAt", a."FlowId", a."FlowName", a."IsActive", a."MediaUrl", a."Priority", a."ReplyMessage", a."TriggerKeyword", a."UpdatedAt"
FROM "AutoReplyRules" AS a
WHERE a."BusinessId" = @__businessId_0 AND a."IsActive" AND strpos(@__incomingMessage_1, a."TriggerKeyword") > 0
ORDER BY a."Priority"
LIMIT 1
2025-07-02 22:07:45.228 +05:30 [INF] ❌ No fallback rule matched for: Hi
2025-07-02 22:07:48.608 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[@p0='b45504f9-cc57-4644-80c1-bdf70bbc64eb', @p1='c13be597-6ae2-42bb-9d43-925815f24ff8', @p2=NULL (DbType = Guid), @p3=NULL (DbType = Guid), @p4=NULL (DbType = Guid), @p5='0876f654-a362-420f-a912-6bce793436a5' (Nullable = true), @p6='2025-07-02T16:37:48.5872764Z' (DbType = DateTime), @p7=NULL, @p8='True', @p9=NULL, @p10='Hi' (Nullable = false), @p11=NULL, @p12=NULL, @p13='917082156227' (Nullable = false), @p14=NULL (DbType = Guid), @p15=NULL, @p16=NULL (DbType = DateTime), @p17=NULL, @p18='Queued' (Nullable = false)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "MessageLogs" ("Id", "BusinessId", "CTAFlowConfigId", "CTAFlowStepId", "CampaignId", "ContactId", "CreatedAt", "ErrorMessage", "IsIncoming", "MediaUrl", "MessageContent", "MessageId", "RawResponse", "RecipientNumber", "RefMessageId", "RenderedBody", "SentAt", "Source", "Status")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
2025-07-02 22:07:50.602 +05:30 [INF] Request starting HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - application/json 491
2025-07-02 22:07:50.606 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:07:50.607 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-07-02 22:07:50.611 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"contacts":[{"profile":{"name":"\ua9c1S.K\ua9c2"},"wa_id":"917082156227"}],"messages":[{"from":"917082156227","id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAEhggQ0FBNTRCOUU2MDQ4NzZBNEY3NTc3NUY0QUU0MEYzNDUA","timestamp":"1751474272","text":{"body":"Hi"},"type":"text"}]},"field":"messages"}]}]}
2025-07-02 22:07:50.613 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-07-02 22:07:50.614 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"contacts":[{"profile":{"name":"\ua9c1S.K\ua9c2"},"wa_id":"917082156227"}],"messages":[{"from":"917082156227","id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAEhggQ0FBNTRCOUU2MDQ4NzZBNEY3NTc3NUY0QUU0MEYzNDUA","timestamp":"1751474272","text":{"body":"Hi"},"type":"text"}]},"field":"messages"}]}]}
2025-07-02 22:07:50.614 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType73`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:07:50.617 +05:30 [INF] 💬 Routing to InboundMessageProcessor (type: text)
2025-07-02 22:07:50.619 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 8.7927ms
2025-07-02 22:07:50.625 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:07:50.627 +05:30 [INF] Request finished HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 24.8218ms
2025-07-02 22:07:50.628 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessNumber_0='15556395845'], CommandType='"Text"', CommandTimeout='30']
SELECT b."Id", b."Address", b."ApprovedAt", b."ApprovedBy", b."BusinessEmail", b."BusinessName", b."CompanyName", b."CompanyPhone", b."CreatedAt", b."CreatedBy", b."CreatedByPartnerId", b."DeletedAt", b."DeletedBy", b."Industry", b."IsApproved", b."IsDeleted", b."LastLoginAt", b."LogoUrl", b."Notes", b."Phone", b."RepresentativeName", b."Source", b."Status", b."Tags", b."Website", w."Id", w."ApiToken", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WhatsAppBusinessNumber"
FROM "Businesses" AS b
LEFT JOIN "WhatsAppSettings" AS w ON b."Id" = w."BusinessId"
WHERE w."WhatsAppBusinessNumber" = @__businessNumber_0
LIMIT 1
2025-07-02 22:07:50.636 +05:30 [INF] FindOrCreateAsync: businessId="c13be597-6ae2-42bb-9d43-925815f24ff8", phoneNumber=917082156227
2025-07-02 22:07:50.640 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__phoneNumber_1='917082156227'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."Tags"
FROM "Contacts" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."PhoneNumber" = @__phoneNumber_1
LIMIT 1
2025-07-02 22:07:50.643 +05:30 [INF] Contact already exists: contactId="0876f654-a362-420f-a912-6bce793436a5"
2025-07-02 22:07:50.647 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__contactId_1='0876f654-a362-420f-a912-6bce793436a5'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."BusinessId", c."ContactId", c."LastUpdatedAt", c."Mode", c."UpdatedBy"
FROM "ChatSessionStates" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."ContactId" = @__contactId_1
LIMIT 1
2025-07-02 22:07:50.662 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@p0='2a629ad2-f777-4f7a-b689-9535125b2b65', @p1='c13be597-6ae2-42bb-9d43-925815f24ff8', @p2=NULL (DbType = Guid), @p3=NULL (DbType = Guid), @p4=NULL (DbType = Guid), @p5='0876f654-a362-420f-a912-6bce793436a5' (Nullable = true), @p6='2025-07-02T16:37:50.6581750Z' (DbType = DateTime), @p7=NULL, @p8='True', @p9=NULL, @p10='Hi' (Nullable = false), @p11=NULL, @p12=NULL, @p13='917082156227' (Nullable = false), @p14=NULL (DbType = Guid), @p15=NULL, @p16='2025-07-02T16:37:50.6581753Z' (Nullable = true) (DbType = DateTime), @p17=NULL, @p18='received' (Nullable = false)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "MessageLogs" ("Id", "BusinessId", "CTAFlowConfigId", "CTAFlowStepId", "CampaignId", "ContactId", "CreatedAt", "ErrorMessage", "IsIncoming", "MediaUrl", "MessageContent", "MessageId", "RawResponse", "RecipientNumber", "RefMessageId", "RenderedBody", "SentAt", "Source", "Status")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
2025-07-02 22:07:50.668 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."BusinessId", a."CreatedAt", a."FlowId", a."FlowName", a."IsActive", a."MediaUrl", a."Priority", a."ReplyMessage", a."TriggerKeyword", a."UpdatedAt"
FROM "AutoReplyRules" AS a
WHERE a."BusinessId" = @__businessId_0 AND a."IsActive"
2025-07-02 22:07:50.674 +05:30 [INF] 🔍 No flow match found or FlowId is null. Trying fallback auto-reply...
2025-07-02 22:07:50.678 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__incomingMessage_1='Hi'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."BusinessId", a."CreatedAt", a."FlowId", a."FlowName", a."IsActive", a."MediaUrl", a."Priority", a."ReplyMessage", a."TriggerKeyword", a."UpdatedAt"
FROM "AutoReplyRules" AS a
WHERE a."BusinessId" = @__businessId_0 AND a."IsActive" AND strpos(@__incomingMessage_1, a."TriggerKeyword") > 0
ORDER BY a."Priority"
LIMIT 1
2025-07-02 22:07:50.688 +05:30 [INF] ❌ No fallback rule matched for: Hi
2025-07-02 22:07:52.393 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@p0='81ecbb0f-eec2-43d6-b26a-4be2b3930a21', @p1='c13be597-6ae2-42bb-9d43-925815f24ff8', @p2=NULL (DbType = Guid), @p3=NULL (DbType = Guid), @p4=NULL (DbType = Guid), @p5='0876f654-a362-420f-a912-6bce793436a5' (Nullable = true), @p6='2025-07-02T16:37:52.3888664Z' (DbType = DateTime), @p7=NULL, @p8='True', @p9=NULL, @p10='Hi' (Nullable = false), @p11=NULL, @p12=NULL, @p13='917082156227' (Nullable = false), @p14=NULL (DbType = Guid), @p15=NULL, @p16=NULL (DbType = DateTime), @p17=NULL, @p18='Queued' (Nullable = false)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "MessageLogs" ("Id", "BusinessId", "CTAFlowConfigId", "CTAFlowStepId", "CampaignId", "ContactId", "CreatedAt", "ErrorMessage", "IsIncoming", "MediaUrl", "MessageContent", "MessageId", "RawResponse", "RecipientNumber", "RefMessageId", "RenderedBody", "SentAt", "Source", "Status")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
2025-07-02 22:07:52.790 +05:30 [INF] Request starting HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - application/json 550
2025-07-02 22:07:52.794 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:07:52.795 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-07-02 22:07:52.798 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSNkFDRUE4M0E1NzcyMTYxQzY5AA==","status":"delivered","timestamp":"1751189938","recipient_id":"917082156227","conversation":{"id":"90b38ee00c6455dcc79733c1fd93f79a","origin":{"type":"service"}},"pricing":{"billable":true,"pricing_model":"CBP","category":"service"}}]},"field":"messages"}]}]}
2025-07-02 22:07:52.800 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-07-02 22:07:52.801 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSNkFDRUE4M0E1NzcyMTYxQzY5AA==","status":"delivered","timestamp":"1751189938","recipient_id":"917082156227","conversation":{"id":"90b38ee00c6455dcc79733c1fd93f79a","origin":{"type":"service"}},"pricing":{"billable":true,"pricing_model":"CBP","category":"service"}}]},"field":"messages"}]}]}
2025-07-02 22:07:52.802 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType73`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:07:52.804 +05:30 [INF] 📦 Routing to Status Processor
2025-07-02 22:07:52.806 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 8.5352ms
2025-07-02 22:07:52.807 +05:30 [WRN] 🔍 Incoming timestamp raw value: {"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSNkFDRUE4M0E1NzcyMTYxQzY5AA==","status":"delivered","timestamp":"1751189938","recipient_id":"917082156227","conversation":{"id":"90b38ee00c6455dcc79733c1fd93f79a","origin":{"type":"service"}},"pricing":{"billable":true,"pricing_model":"CBP","category":"service"}}]},"field":"messages"}]}]}
2025-07-02 22:07:52.809 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:07:52.814 +05:30 [INF] Request finished HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 23.5593ms
2025-07-02 22:07:52.815 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__messageId_0='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSNkFDRUE4M0E1NzcyMTYxQzY5AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."MessageId" = @__messageId_0
LIMIT 1
2025-07-02 22:07:52.823 +05:30 [WRN] ⚠️ CampaignSendLog not found for MessageId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSNkFDRUE4M0E1NzcyMTYxQzY5AA==
2025-07-02 22:07:52.824 +05:30 [WRN] ⚠️ No matching CampaignSendLog for MessageId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSNkFDRUE4M0E1NzcyMTYxQzY5AA==
2025-07-02 22:08:36.947 +05:30 [INF] Executed endpoint '/hubs/inbox'
2025-07-02 22:08:36.947 +05:30 [INF] Executed endpoint '/hubs/inbox'
2025-07-02 22:08:36.953 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/hubs/inbox?id=SB18QbqyIIDqTC8F7-aRPw - 101 null null 97544.9094ms
2025-07-02 22:08:36.951 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/hubs/inbox?id=FmnBG9T05KxqjgucjzWjUQ - 101 null null 97487.7172ms
2025-07-02 22:08:37.536 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/auth/session - null null
2025-07-02 22:08:37.541 +05:30 [INF] Executing endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 22:08:37.542 +05:30 [INF] Route matched with {action = "GetSession", controller = "Auth"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetSession() on controller xbytechat.api.AuthModule.Controllers.AuthController (xbytechat.api).
2025-07-02 22:08:37.546 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`4[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:08:37.547 +05:30 [INF] Executed action xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api) in 2.3654ms
2025-07-02 22:08:37.549 +05:30 [INF] Executed endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 22:08:37.551 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/auth/session - 200 null application/json; charset=utf-8 15.3175ms
2025-07-02 22:08:37.667 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/feature-access/me - null null
2025-07-02 22:08:37.687 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 22:08:37.689 +05:30 [INF] Route matched with {action = "GetMyFeatures", controller = "FeatureAccess"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto]]] GetMyFeatures() on controller xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController (xbytechat.api).
2025-07-02 22:08:37.793 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT b."Id", b."Address", b."ApprovedAt", b."ApprovedBy", b."BusinessEmail", b."BusinessName", b."CompanyName", b."CompanyPhone", b."CreatedAt", b."CreatedBy", b."CreatedByPartnerId", b."DeletedAt", b."DeletedBy", b."Industry", b."IsApproved", b."IsDeleted", b."LastLoginAt", b."LogoUrl", b."Notes", b."Phone", b."RepresentativeName", b."Source", b."Status", b."Tags", b."Website", b0."Id", b0."BusinessId", b0."CreatedAt", b0."Plan", b0."QuotaResetDate", b0."RemainingMessages", b0."TotalMonthlyQuota", b0."UpdatedAt", b0."WalletBalance"
FROM "Businesses" AS b
LEFT JOIN "BusinessPlanInfos" AS b0 ON b."Id" = b0."BusinessId"
WHERE b."Id" = @__businessId_0
LIMIT 1
2025-07-02 22:08:37.797 +05:30 [INF] 📦 Resolved plan for Business "c13be597-6ae2-42bb-9d43-925815f24ff8": Smart
2025-07-02 22:08:37.801 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."BusinessId", f."CreatedAt", f."Description", f."FeatureName", f."Group", f."IsEnabled", f."Notes", f."Plan"
FROM "FeatureAccess" AS f
WHERE f."BusinessId" = @__businessId_0
2025-07-02 22:08:37.804 +05:30 [INF] 🔧 Feature override: AddProduct = False
2025-07-02 22:08:37.805 +05:30 [INF] 🔧 Feature override: Automation = True
2025-07-02 22:08:37.805 +05:30 [INF] 🔧 Feature override: Campaigns = True
2025-07-02 22:08:37.806 +05:30 [INF] 🔧 Feature override: Catalog = True
2025-07-02 22:08:37.807 +05:30 [INF] 🔧 Feature override: CRM = True
2025-07-02 22:08:37.808 +05:30 [INF] 🔧 Feature override: CRMInsights = True
2025-07-02 22:08:37.809 +05:30 [INF] 🔧 Feature override: CTAFlow = True
2025-07-02 22:08:37.809 +05:30 [INF] 🔧 Feature override: FlowInsights = True
2025-07-02 22:08:37.810 +05:30 [INF] 🔧 Feature override: Messaging = True
2025-07-02 22:08:37.811 +05:30 [INF] 🔧 Feature override: ProfileCompletion = True
2025-07-02 22:08:37.812 +05:30 [INF] 🔧 Feature override: UpgradePlan = True
2025-07-02 22:08:37.813 +05:30 [INF] 🔧 Feature override: WhatsAppSettings = True
2025-07-02 22:08:37.815 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 22:08:37.817 +05:30 [INF] Executed action xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api) in 123.5165ms
2025-07-02 22:08:37.819 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 22:08:37.820 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/feature-access/me - 200 null application/json; charset=utf-8 153.2058ms
2025-07-02 22:08:37.863 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null null
2025-07-02 22:08:37.864 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/contacts - null null
2025-07-02 22:08:37.864 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/inbox/unread-counts - null null
2025-07-02 22:08:37.874 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:08:37.869 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:08:37.876 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null null
2025-07-02 22:08:37.918 +05:30 [INF] Executing endpoint 'xbytechat.api.CRM.Controllers.ContactsController.GetAllContacts (xbytechat.api)'
2025-07-02 22:08:37.905 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:08:37.919 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 204 null null 56.1642ms
2025-07-02 22:08:37.928 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:08:37.928 +05:30 [INF] Route matched with {action = "GetAllContacts", controller = "Contacts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllContacts(System.String, Int32, Int32) on controller xbytechat.api.CRM.Controllers.ContactsController (xbytechat.api).
2025-07-02 22:08:37.931 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Inbox.Controllers.InboxController.GetUnreadCounts (xbytechat.api)'
2025-07-02 22:08:37.921 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null 0
2025-07-02 22:08:37.938 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 204 null null 62.4853ms
2025-07-02 22:08:37.940 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null 0
2025-07-02 22:08:37.944 +05:30 [INF] GetPagedContactsAsync: businessId="c13be597-6ae2-42bb-9d43-925815f24ff8", tab=all, page=1, pageSize=25
2025-07-02 22:08:37.945 +05:30 [INF] Route matched with {action = "GetUnreadCounts", controller = "Inbox"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUnreadCounts() on controller xbytechat.api.Features.Inbox.Controllers.InboxController (xbytechat.api).
2025-07-02 22:08:37.955 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:08:37.960 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Contacts" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."IsActive"
2025-07-02 22:08:37.964 +05:30 [INF] Executing endpoint '/hubs/inbox/negotiate'
2025-07-02 22:08:37.972 +05:30 [INF] Executed endpoint '/hubs/inbox/negotiate'
2025-07-02 22:08:37.947 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:08:37.975 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 200 316 application/json 34.5313ms
2025-07-02 22:08:37.976 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__p_2='25', @__p_1='0'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."AssignedAgentId", t."BusinessId", t."CreatedAt", t."Email", t."Group", t."IsActive", t."IsArchived", t."IsAutomationPaused", t."IsFavorite", t."LastCTAInteraction", t."LastCTAType", t."LastClickedProductId", t."LastContactedAt", t."LeadSource", t."Name", t."NextFollowUpAt", t."Notes", t."PhoneNumber", t."Tags", t0."Id", t0."AssignedAt", t0."AssignedBy", t0."BusinessId", t0."ContactId", t0."TagId", t0."Id0", t0."BusinessId0", t0."Category", t0."ColorHex", t0."CreatedAt", t0."IsActive", t0."IsSystemTag", t0."LastUsedAt", t0."Name", t0."Notes"
FROM (
    SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."Tags"
    FROM "Contacts" AS c
    WHERE c."BusinessId" = @__businessId_0 AND c."IsActive"
    ORDER BY c."Name"
    LIMIT @__p_2 OFFSET @__p_1
) AS t
LEFT JOIN (
    SELECT c0."Id", c0."AssignedAt", c0."AssignedBy", c0."BusinessId", c0."ContactId", c0."TagId", t1."Id" AS "Id0", t1."BusinessId" AS "BusinessId0", t1."Category", t1."ColorHex", t1."CreatedAt", t1."IsActive", t1."IsSystemTag", t1."LastUsedAt", t1."Name", t1."Notes"
    FROM "ContactTags" AS c0
    INNER JOIN "Tags" AS t1 ON c0."TagId" = t1."Id"
) AS t0 ON t."Id" = t0."ContactId"
ORDER BY t."Name", t."Id", t0."Id"
2025-07-02 22:08:37.977 +05:30 [INF] Executing endpoint '/hubs/inbox/negotiate'
2025-07-02 22:08:37.978 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/hubs/inbox?id=5h9y4Lz6TkIWTEusZunSmg - null null
2025-07-02 22:08:37.985 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Helpers.ResponseResult'.
2025-07-02 22:08:37.986 +05:30 [INF] Executed endpoint '/hubs/inbox/negotiate'
2025-07-02 22:08:37.989 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:08:37.991 +05:30 [INF] Executed action xbytechat.api.CRM.Controllers.ContactsController.GetAllContacts (xbytechat.api) in 47.5071ms
2025-07-02 22:08:37.992 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 200 316 application/json 70.934ms
2025-07-02 22:08:37.993 +05:30 [INF] Executing endpoint '/hubs/inbox'
2025-07-02 22:08:37.994 +05:30 [INF] Executed endpoint 'xbytechat.api.CRM.Controllers.ContactsController.GetAllContacts (xbytechat.api)'
2025-07-02 22:08:38.004 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/contacts - 200 null application/json; charset=utf-8 140.2091ms
2025-07-02 22:08:38.016 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/hubs/inbox?id=gK4q1_3fzX_RI3r7alnwjg - null null
2025-07-02 22:08:38.020 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:08:38.021 +05:30 [INF] Executing endpoint '/hubs/inbox'
2025-07-02 22:08:38.060 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='2870e1d8-0e80-4b12-88bd-70a8113307d6'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."BusinessId", c."ContactId", c."LastReadAt", c."UserId"
FROM "ContactReads" AS c
WHERE c."UserId" = @__userId_0
2025-07-02 22:08:38.066 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."CreatedAt", m."ErrorMessage", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."IsIncoming" AND m."ContactId" IS NOT NULL
2025-07-02 22:08:38.074 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.Dictionary`2[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:08:38.077 +05:30 [INF] Executed action xbytechat.api.Features.Inbox.Controllers.InboxController.GetUnreadCounts (xbytechat.api) in 115.2648ms
2025-07-02 22:08:38.080 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Inbox.Controllers.InboxController.GetUnreadCounts (xbytechat.api)'
2025-07-02 22:08:38.082 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/inbox/unread-counts - 200 null application/json; charset=utf-8 218.2187ms
2025-07-02 22:08:52.043 +05:30 [INF] Request starting HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - application/json 581
2025-07-02 22:08:52.046 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:08:52.048 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-07-02 22:08:52.050 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSM0M5MUJBNjhBREQ4QjVEODgzAA==","status":"sent","timestamp":"1751189903","recipient_id":"917082156227","conversation":{"id":"90b38ee00c6455dcc79733c1fd93f79a","expiration_timestamp":"1751269260","origin":{"type":"service"}},"pricing":{"billable":true,"pricing_model":"CBP","category":"service"}}]},"field":"messages"}]}]}
2025-07-02 22:08:52.052 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-07-02 22:08:52.052 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSM0M5MUJBNjhBREQ4QjVEODgzAA==","status":"sent","timestamp":"1751189903","recipient_id":"917082156227","conversation":{"id":"90b38ee00c6455dcc79733c1fd93f79a","expiration_timestamp":"1751269260","origin":{"type":"service"}},"pricing":{"billable":true,"pricing_model":"CBP","category":"service"}}]},"field":"messages"}]}]}
2025-07-02 22:08:52.053 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType73`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:08:52.055 +05:30 [INF] 📦 Routing to Status Processor
2025-07-02 22:08:52.058 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 8.7081ms
2025-07-02 22:08:52.059 +05:30 [WRN] 🔍 Incoming timestamp raw value: {"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSM0M5MUJBNjhBREQ4QjVEODgzAA==","status":"sent","timestamp":"1751189903","recipient_id":"917082156227","conversation":{"id":"90b38ee00c6455dcc79733c1fd93f79a","expiration_timestamp":"1751269260","origin":{"type":"service"}},"pricing":{"billable":true,"pricing_model":"CBP","category":"service"}}]},"field":"messages"}]}]}
2025-07-02 22:08:52.061 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:08:52.064 +05:30 [INF] Request finished HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 21.3067ms
2025-07-02 22:08:52.066 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__messageId_0='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSM0M5MUJBNjhBREQ4QjVEODgzAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."MessageId" = @__messageId_0
LIMIT 1
2025-07-02 22:08:52.072 +05:30 [WRN] ⚠️ CampaignSendLog not found for MessageId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSM0M5MUJBNjhBREQ4QjVEODgzAA==
2025-07-02 22:08:52.074 +05:30 [WRN] ⚠️ No matching CampaignSendLog for MessageId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSM0M5MUJBNjhBREQ4QjVEODgzAA==
2025-07-02 22:09:05.360 +05:30 [INF] Request starting HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - application/json 550
2025-07-02 22:09:05.364 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:09:05.366 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-07-02 22:09:05.370 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSM0RDNDM3M0Q3RjZBNjIyMTIzAA==","status":"delivered","timestamp":"1751182918","recipient_id":"917082156227","conversation":{"id":"90b38ee00c6455dcc79733c1fd93f79a","origin":{"type":"service"}},"pricing":{"billable":true,"pricing_model":"CBP","category":"service"}}]},"field":"messages"}]}]}
2025-07-02 22:09:05.372 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-07-02 22:09:05.372 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSM0RDNDM3M0Q3RjZBNjIyMTIzAA==","status":"delivered","timestamp":"1751182918","recipient_id":"917082156227","conversation":{"id":"90b38ee00c6455dcc79733c1fd93f79a","origin":{"type":"service"}},"pricing":{"billable":true,"pricing_model":"CBP","category":"service"}}]},"field":"messages"}]}]}
2025-07-02 22:09:05.373 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType73`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:09:05.375 +05:30 [INF] 📦 Routing to Status Processor
2025-07-02 22:09:05.377 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 7.425ms
2025-07-02 22:09:05.378 +05:30 [WRN] 🔍 Incoming timestamp raw value: {"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSM0RDNDM3M0Q3RjZBNjIyMTIzAA==","status":"delivered","timestamp":"1751182918","recipient_id":"917082156227","conversation":{"id":"90b38ee00c6455dcc79733c1fd93f79a","origin":{"type":"service"}},"pricing":{"billable":true,"pricing_model":"CBP","category":"service"}}]},"field":"messages"}]}]}
2025-07-02 22:09:05.381 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:09:05.385 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__messageId_0='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSM0RDNDM3M0Q3RjZBNjIyMTIzAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."MessageId" = @__messageId_0
LIMIT 1
2025-07-02 22:09:05.386 +05:30 [INF] Request finished HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 25.2051ms
2025-07-02 22:09:05.389 +05:30 [WRN] ⚠️ CampaignSendLog not found for MessageId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSM0RDNDM3M0Q3RjZBNjIyMTIzAA==
2025-07-02 22:09:05.395 +05:30 [WRN] ⚠️ No matching CampaignSendLog for MessageId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSM0RDNDM3M0Q3RjZBNjIyMTIzAA==
2025-07-02 22:09:23.549 +05:30 [INF] Request starting HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - application/json 550
2025-07-02 22:09:23.553 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:09:23.554 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-07-02 22:09:23.558 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMDEzRkFGOTcxMjgyNDZFOENFAA==","status":"delivered","timestamp":"1751202767","recipient_id":"917082156227","conversation":{"id":"b5bdfe9338c8b7c6740d9b579e228738","origin":{"type":"utility"}},"pricing":{"billable":true,"pricing_model":"CBP","category":"utility"}}]},"field":"messages"}]}]}
2025-07-02 22:09:23.559 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-07-02 22:09:23.560 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMDEzRkFGOTcxMjgyNDZFOENFAA==","status":"delivered","timestamp":"1751202767","recipient_id":"917082156227","conversation":{"id":"b5bdfe9338c8b7c6740d9b579e228738","origin":{"type":"utility"}},"pricing":{"billable":true,"pricing_model":"CBP","category":"utility"}}]},"field":"messages"}]}]}
2025-07-02 22:09:23.560 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType73`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:09:23.562 +05:30 [INF] 📦 Routing to Status Processor
2025-07-02 22:09:23.564 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 6.6326ms
2025-07-02 22:09:23.565 +05:30 [WRN] 🔍 Incoming timestamp raw value: {"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMDEzRkFGOTcxMjgyNDZFOENFAA==","status":"delivered","timestamp":"1751202767","recipient_id":"917082156227","conversation":{"id":"b5bdfe9338c8b7c6740d9b579e228738","origin":{"type":"utility"}},"pricing":{"billable":true,"pricing_model":"CBP","category":"utility"}}]},"field":"messages"}]}]}
2025-07-02 22:09:23.566 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:09:23.569 +05:30 [INF] Request finished HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 19.7114ms
2025-07-02 22:09:23.570 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__messageId_0='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMDEzRkFGOTcxMjgyNDZFOENFAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."MessageId" = @__messageId_0
LIMIT 1
2025-07-02 22:09:23.579 +05:30 [WRN] ⚠️ CampaignSendLog not found for MessageId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMDEzRkFGOTcxMjgyNDZFOENFAA==
2025-07-02 22:09:23.581 +05:30 [WRN] ⚠️ No matching CampaignSendLog for MessageId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMDEzRkFGOTcxMjgyNDZFOENFAA==
2025-07-02 22:11:09.371 +05:30 [INF] Executed endpoint '/hubs/inbox'
2025-07-02 22:11:09.378 +05:30 [INF] Executed endpoint '/hubs/inbox'
2025-07-02 22:11:09.382 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/hubs/inbox?id=gK4q1_3fzX_RI3r7alnwjg - 101 null null 151365.4588ms
2025-07-02 22:11:09.383 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/hubs/inbox?id=5h9y4Lz6TkIWTEusZunSmg - 101 null null 151404.866ms
2025-07-02 22:11:10.525 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/auth/session - null null
2025-07-02 22:11:10.530 +05:30 [INF] Executing endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 22:11:10.535 +05:30 [INF] Route matched with {action = "GetSession", controller = "Auth"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetSession() on controller xbytechat.api.AuthModule.Controllers.AuthController (xbytechat.api).
2025-07-02 22:11:10.538 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`4[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:11:10.541 +05:30 [INF] Executed action xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api) in 3.3779ms
2025-07-02 22:11:10.543 +05:30 [INF] Executed endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 22:11:10.546 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/auth/session - 200 null application/json; charset=utf-8 20.493ms
2025-07-02 22:11:10.568 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/feature-access/me - null null
2025-07-02 22:11:10.574 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 22:11:10.577 +05:30 [INF] Route matched with {action = "GetMyFeatures", controller = "FeatureAccess"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto]]] GetMyFeatures() on controller xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController (xbytechat.api).
2025-07-02 22:11:10.583 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT b."Id", b."Address", b."ApprovedAt", b."ApprovedBy", b."BusinessEmail", b."BusinessName", b."CompanyName", b."CompanyPhone", b."CreatedAt", b."CreatedBy", b."CreatedByPartnerId", b."DeletedAt", b."DeletedBy", b."Industry", b."IsApproved", b."IsDeleted", b."LastLoginAt", b."LogoUrl", b."Notes", b."Phone", b."RepresentativeName", b."Source", b."Status", b."Tags", b."Website", b0."Id", b0."BusinessId", b0."CreatedAt", b0."Plan", b0."QuotaResetDate", b0."RemainingMessages", b0."TotalMonthlyQuota", b0."UpdatedAt", b0."WalletBalance"
FROM "Businesses" AS b
LEFT JOIN "BusinessPlanInfos" AS b0 ON b."Id" = b0."BusinessId"
WHERE b."Id" = @__businessId_0
LIMIT 1
2025-07-02 22:11:10.589 +05:30 [INF] 📦 Resolved plan for Business "c13be597-6ae2-42bb-9d43-925815f24ff8": Smart
2025-07-02 22:11:10.594 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."BusinessId", f."CreatedAt", f."Description", f."FeatureName", f."Group", f."IsEnabled", f."Notes", f."Plan"
FROM "FeatureAccess" AS f
WHERE f."BusinessId" = @__businessId_0
2025-07-02 22:11:10.598 +05:30 [INF] 🔧 Feature override: AddProduct = False
2025-07-02 22:11:10.599 +05:30 [INF] 🔧 Feature override: Automation = True
2025-07-02 22:11:10.600 +05:30 [INF] 🔧 Feature override: Campaigns = True
2025-07-02 22:11:10.601 +05:30 [INF] 🔧 Feature override: Catalog = True
2025-07-02 22:11:10.602 +05:30 [INF] 🔧 Feature override: CRM = True
2025-07-02 22:11:10.603 +05:30 [INF] 🔧 Feature override: CRMInsights = True
2025-07-02 22:11:10.604 +05:30 [INF] 🔧 Feature override: CTAFlow = True
2025-07-02 22:11:10.605 +05:30 [INF] 🔧 Feature override: FlowInsights = True
2025-07-02 22:11:10.606 +05:30 [INF] 🔧 Feature override: Messaging = True
2025-07-02 22:11:10.607 +05:30 [INF] 🔧 Feature override: ProfileCompletion = True
2025-07-02 22:11:10.608 +05:30 [INF] 🔧 Feature override: UpgradePlan = True
2025-07-02 22:11:10.609 +05:30 [INF] 🔧 Feature override: WhatsAppSettings = True
2025-07-02 22:11:10.612 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 22:11:10.614 +05:30 [INF] Executed action xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api) in 34.6648ms
2025-07-02 22:11:10.616 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 22:11:10.617 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/feature-access/me - 200 null application/json; charset=utf-8 48.7873ms
2025-07-02 22:11:10.682 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null null
2025-07-02 22:11:10.684 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/contacts - null null
2025-07-02 22:11:10.685 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/inbox/unread-counts - null null
2025-07-02 22:11:10.686 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:11:10.689 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:11:10.693 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:11:10.697 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null 0
2025-07-02 22:11:10.708 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:11:10.695 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 204 null null 12.7696ms
2025-07-02 22:11:10.697 +05:30 [INF] Executing endpoint 'xbytechat.api.CRM.Controllers.ContactsController.GetAllContacts (xbytechat.api)'
2025-07-02 22:11:10.695 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null null
2025-07-02 22:11:10.698 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Inbox.Controllers.InboxController.GetUnreadCounts (xbytechat.api)'
2025-07-02 22:11:10.710 +05:30 [INF] Executing endpoint '/hubs/inbox/negotiate'
2025-07-02 22:11:10.716 +05:30 [INF] Route matched with {action = "GetAllContacts", controller = "Contacts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllContacts(System.String, Int32, Int32) on controller xbytechat.api.CRM.Controllers.ContactsController (xbytechat.api).
2025-07-02 22:11:10.720 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:11:10.722 +05:30 [INF] Route matched with {action = "GetUnreadCounts", controller = "Inbox"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUnreadCounts() on controller xbytechat.api.Features.Inbox.Controllers.InboxController (xbytechat.api).
2025-07-02 22:11:10.724 +05:30 [INF] Executed endpoint '/hubs/inbox/negotiate'
2025-07-02 22:11:10.727 +05:30 [INF] GetPagedContactsAsync: businessId="c13be597-6ae2-42bb-9d43-925815f24ff8", tab=all, page=1, pageSize=25
2025-07-02 22:11:10.730 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 200 316 application/json 33.1535ms
2025-07-02 22:11:10.749 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/hubs/inbox?id=dyj0k9bmK9cUd309CY5QWQ - null null
2025-07-02 22:11:10.749 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Contacts" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."IsActive"
2025-07-02 22:11:10.727 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 204 null null 31.8498ms
2025-07-02 22:11:10.756 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:11:10.752 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null 0
2025-07-02 22:11:10.733 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='2870e1d8-0e80-4b12-88bd-70a8113307d6'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."BusinessId", c."ContactId", c."LastReadAt", c."UserId"
FROM "ContactReads" AS c
WHERE c."UserId" = @__userId_0
2025-07-02 22:11:10.763 +05:30 [INF] Executed DbCommand (5ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__p_2='25', @__p_1='0'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."AssignedAgentId", t."BusinessId", t."CreatedAt", t."Email", t."Group", t."IsActive", t."IsArchived", t."IsAutomationPaused", t."IsFavorite", t."LastCTAInteraction", t."LastCTAType", t."LastClickedProductId", t."LastContactedAt", t."LeadSource", t."Name", t."NextFollowUpAt", t."Notes", t."PhoneNumber", t."Tags", t0."Id", t0."AssignedAt", t0."AssignedBy", t0."BusinessId", t0."ContactId", t0."TagId", t0."Id0", t0."BusinessId0", t0."Category", t0."ColorHex", t0."CreatedAt", t0."IsActive", t0."IsSystemTag", t0."LastUsedAt", t0."Name", t0."Notes"
FROM (
    SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."Tags"
    FROM "Contacts" AS c
    WHERE c."BusinessId" = @__businessId_0 AND c."IsActive"
    ORDER BY c."Name"
    LIMIT @__p_2 OFFSET @__p_1
) AS t
LEFT JOIN (
    SELECT c0."Id", c0."AssignedAt", c0."AssignedBy", c0."BusinessId", c0."ContactId", c0."TagId", t1."Id" AS "Id0", t1."BusinessId" AS "BusinessId0", t1."Category", t1."ColorHex", t1."CreatedAt", t1."IsActive", t1."IsSystemTag", t1."LastUsedAt", t1."Name", t1."Notes"
    FROM "ContactTags" AS c0
    INNER JOIN "Tags" AS t1 ON c0."TagId" = t1."Id"
) AS t0 ON t."Id" = t0."ContactId"
ORDER BY t."Name", t."Id", t0."Id"
2025-07-02 22:11:10.764 +05:30 [INF] Executing endpoint '/hubs/inbox'
2025-07-02 22:11:10.767 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:11:10.773 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."CreatedAt", m."ErrorMessage", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."IsIncoming" AND m."ContactId" IS NOT NULL
2025-07-02 22:11:10.775 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Helpers.ResponseResult'.
2025-07-02 22:11:10.779 +05:30 [INF] Executing endpoint '/hubs/inbox/negotiate'
2025-07-02 22:11:10.782 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.Dictionary`2[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:11:10.783 +05:30 [INF] Executed action xbytechat.api.CRM.Controllers.ContactsController.GetAllContacts (xbytechat.api) in 57.6684ms
2025-07-02 22:11:10.784 +05:30 [INF] Executed endpoint '/hubs/inbox/negotiate'
2025-07-02 22:11:10.786 +05:30 [INF] Executed action xbytechat.api.Features.Inbox.Controllers.InboxController.GetUnreadCounts (xbytechat.api) in 56.5983ms
2025-07-02 22:11:10.788 +05:30 [INF] Executed endpoint 'xbytechat.api.CRM.Controllers.ContactsController.GetAllContacts (xbytechat.api)'
2025-07-02 22:11:10.789 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 200 316 application/json 36.2501ms
2025-07-02 22:11:10.790 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Inbox.Controllers.InboxController.GetUnreadCounts (xbytechat.api)'
2025-07-02 22:11:10.791 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/contacts - 200 null application/json; charset=utf-8 106.975ms
2025-07-02 22:11:10.797 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/inbox/unread-counts - 200 null application/json; charset=utf-8 112.1523ms
2025-07-02 22:11:10.805 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/hubs/inbox?id=r1USUAAHNnSk8Q8GWef1aw - null null
2025-07-02 22:11:10.808 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:11:10.810 +05:30 [INF] Executing endpoint '/hubs/inbox'
2025-07-02 22:11:25.731 +05:30 [INF] Executed endpoint '/hubs/inbox'
2025-07-02 22:11:25.731 +05:30 [INF] Executed endpoint '/hubs/inbox'
2025-07-02 22:11:25.746 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/hubs/inbox?id=r1USUAAHNnSk8Q8GWef1aw - 101 null null 14940.6994ms
2025-07-02 22:11:25.752 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/hubs/inbox?id=dyj0k9bmK9cUd309CY5QWQ - 101 null null 15002.8449ms
2025-07-02 22:11:26.490 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/auth/session - null null
2025-07-02 22:11:26.498 +05:30 [INF] Executing endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 22:11:26.501 +05:30 [INF] Route matched with {action = "GetSession", controller = "Auth"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetSession() on controller xbytechat.api.AuthModule.Controllers.AuthController (xbytechat.api).
2025-07-02 22:11:26.504 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`4[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:11:26.506 +05:30 [INF] Executed action xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api) in 2.8566ms
2025-07-02 22:11:26.508 +05:30 [INF] Executed endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 22:11:26.509 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/auth/session - 200 null application/json; charset=utf-8 19.0425ms
2025-07-02 22:11:26.629 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/feature-access/me - null null
2025-07-02 22:11:26.635 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 22:11:26.636 +05:30 [INF] Route matched with {action = "GetMyFeatures", controller = "FeatureAccess"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto]]] GetMyFeatures() on controller xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController (xbytechat.api).
2025-07-02 22:11:26.645 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT b."Id", b."Address", b."ApprovedAt", b."ApprovedBy", b."BusinessEmail", b."BusinessName", b."CompanyName", b."CompanyPhone", b."CreatedAt", b."CreatedBy", b."CreatedByPartnerId", b."DeletedAt", b."DeletedBy", b."Industry", b."IsApproved", b."IsDeleted", b."LastLoginAt", b."LogoUrl", b."Notes", b."Phone", b."RepresentativeName", b."Source", b."Status", b."Tags", b."Website", b0."Id", b0."BusinessId", b0."CreatedAt", b0."Plan", b0."QuotaResetDate", b0."RemainingMessages", b0."TotalMonthlyQuota", b0."UpdatedAt", b0."WalletBalance"
FROM "Businesses" AS b
LEFT JOIN "BusinessPlanInfos" AS b0 ON b."Id" = b0."BusinessId"
WHERE b."Id" = @__businessId_0
LIMIT 1
2025-07-02 22:11:26.652 +05:30 [INF] 📦 Resolved plan for Business "c13be597-6ae2-42bb-9d43-925815f24ff8": Smart
2025-07-02 22:11:26.657 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."BusinessId", f."CreatedAt", f."Description", f."FeatureName", f."Group", f."IsEnabled", f."Notes", f."Plan"
FROM "FeatureAccess" AS f
WHERE f."BusinessId" = @__businessId_0
2025-07-02 22:11:26.670 +05:30 [INF] 🔧 Feature override: AddProduct = False
2025-07-02 22:11:26.672 +05:30 [INF] 🔧 Feature override: Automation = True
2025-07-02 22:11:26.673 +05:30 [INF] 🔧 Feature override: Campaigns = True
2025-07-02 22:11:26.675 +05:30 [INF] 🔧 Feature override: Catalog = True
2025-07-02 22:11:26.676 +05:30 [INF] 🔧 Feature override: CRM = True
2025-07-02 22:11:26.677 +05:30 [INF] 🔧 Feature override: CRMInsights = True
2025-07-02 22:11:26.679 +05:30 [INF] 🔧 Feature override: CTAFlow = True
2025-07-02 22:11:26.680 +05:30 [INF] 🔧 Feature override: FlowInsights = True
2025-07-02 22:11:26.681 +05:30 [INF] 🔧 Feature override: Messaging = True
2025-07-02 22:11:26.683 +05:30 [INF] 🔧 Feature override: ProfileCompletion = True
2025-07-02 22:11:26.684 +05:30 [INF] 🔧 Feature override: UpgradePlan = True
2025-07-02 22:11:26.685 +05:30 [INF] 🔧 Feature override: WhatsAppSettings = True
2025-07-02 22:11:26.688 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 22:11:26.691 +05:30 [INF] Executed action xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api) in 51.6995ms
2025-07-02 22:11:26.693 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 22:11:26.694 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/feature-access/me - 200 null application/json; charset=utf-8 65.1499ms
2025-07-02 22:11:26.754 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null null
2025-07-02 22:11:26.757 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/contacts - null null
2025-07-02 22:11:26.757 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/inbox/unread-counts - null null
2025-07-02 22:11:26.759 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:11:26.762 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:11:26.766 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:11:26.767 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 204 null null 12.8652ms
2025-07-02 22:11:26.768 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null null
2025-07-02 22:11:26.769 +05:30 [INF] Executing endpoint 'xbytechat.api.CRM.Controllers.ContactsController.GetAllContacts (xbytechat.api)'
2025-07-02 22:11:26.770 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Inbox.Controllers.InboxController.GetUnreadCounts (xbytechat.api)'
2025-07-02 22:11:26.770 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null 0
2025-07-02 22:11:26.776 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:11:26.777 +05:30 [INF] Route matched with {action = "GetAllContacts", controller = "Contacts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllContacts(System.String, Int32, Int32) on controller xbytechat.api.CRM.Controllers.ContactsController (xbytechat.api).
2025-07-02 22:11:26.779 +05:30 [INF] Route matched with {action = "GetUnreadCounts", controller = "Inbox"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUnreadCounts() on controller xbytechat.api.Features.Inbox.Controllers.InboxController (xbytechat.api).
2025-07-02 22:11:26.784 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:11:26.785 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 204 null null 17.3698ms
2025-07-02 22:11:26.789 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null 0
2025-07-02 22:11:26.795 +05:30 [INF] Executing endpoint '/hubs/inbox/negotiate'
2025-07-02 22:11:26.797 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='2870e1d8-0e80-4b12-88bd-70a8113307d6'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."BusinessId", c."ContactId", c."LastReadAt", c."UserId"
FROM "ContactReads" AS c
WHERE c."UserId" = @__userId_0
2025-07-02 22:11:26.788 +05:30 [INF] GetPagedContactsAsync: businessId="c13be597-6ae2-42bb-9d43-925815f24ff8", tab=all, page=1, pageSize=25
2025-07-02 22:11:26.805 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:11:26.806 +05:30 [INF] Executed endpoint '/hubs/inbox/negotiate'
2025-07-02 22:11:26.823 +05:30 [INF] Executing endpoint '/hubs/inbox/negotiate'
2025-07-02 22:11:26.816 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."CreatedAt", m."ErrorMessage", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."IsIncoming" AND m."ContactId" IS NOT NULL
2025-07-02 22:11:26.820 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Contacts" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."IsActive"
2025-07-02 22:11:26.824 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 200 316 application/json 53.7007ms
2025-07-02 22:11:26.827 +05:30 [INF] Executed endpoint '/hubs/inbox/negotiate'
2025-07-02 22:11:26.833 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.Dictionary`2[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:11:26.838 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__p_2='25', @__p_1='0'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."AssignedAgentId", t."BusinessId", t."CreatedAt", t."Email", t."Group", t."IsActive", t."IsArchived", t."IsAutomationPaused", t."IsFavorite", t."LastCTAInteraction", t."LastCTAType", t."LastClickedProductId", t."LastContactedAt", t."LeadSource", t."Name", t."NextFollowUpAt", t."Notes", t."PhoneNumber", t."Tags", t0."Id", t0."AssignedAt", t0."AssignedBy", t0."BusinessId", t0."ContactId", t0."TagId", t0."Id0", t0."BusinessId0", t0."Category", t0."ColorHex", t0."CreatedAt", t0."IsActive", t0."IsSystemTag", t0."LastUsedAt", t0."Name", t0."Notes"
FROM (
    SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."Tags"
    FROM "Contacts" AS c
    WHERE c."BusinessId" = @__businessId_0 AND c."IsActive"
    ORDER BY c."Name"
    LIMIT @__p_2 OFFSET @__p_1
) AS t
LEFT JOIN (
    SELECT c0."Id", c0."AssignedAt", c0."AssignedBy", c0."BusinessId", c0."ContactId", c0."TagId", t1."Id" AS "Id0", t1."BusinessId" AS "BusinessId0", t1."Category", t1."ColorHex", t1."CreatedAt", t1."IsActive", t1."IsSystemTag", t1."LastUsedAt", t1."Name", t1."Notes"
    FROM "ContactTags" AS c0
    INNER JOIN "Tags" AS t1 ON c0."TagId" = t1."Id"
) AS t0 ON t."Id" = t0."ContactId"
ORDER BY t."Name", t."Id", t0."Id"
2025-07-02 22:11:26.842 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 200 316 application/json 53.5486ms
2025-07-02 22:11:26.844 +05:30 [INF] Executed action xbytechat.api.Features.Inbox.Controllers.InboxController.GetUnreadCounts (xbytechat.api) in 50.7915ms
2025-07-02 22:11:26.849 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Helpers.ResponseResult'.
2025-07-02 22:11:26.854 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Inbox.Controllers.InboxController.GetUnreadCounts (xbytechat.api)'
2025-07-02 22:11:26.857 +05:30 [INF] Executed action xbytechat.api.CRM.Controllers.ContactsController.GetAllContacts (xbytechat.api) in 69.7278ms
2025-07-02 22:11:26.859 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/inbox/unread-counts - 200 null application/json; charset=utf-8 101.2098ms
2025-07-02 22:11:26.863 +05:30 [INF] Executed endpoint 'xbytechat.api.CRM.Controllers.ContactsController.GetAllContacts (xbytechat.api)'
2025-07-02 22:11:26.870 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/contacts - 200 null application/json; charset=utf-8 112.9619ms
2025-07-02 22:11:26.872 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/hubs/inbox?id=Uc7z0DwviA06vFSgw2UXnQ - null null
2025-07-02 22:11:26.879 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:11:26.882 +05:30 [INF] Executing endpoint '/hubs/inbox'
2025-07-02 22:11:26.900 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/hubs/inbox?id=YZ7vaWpf3WjacapF_I8qBQ - null null
2025-07-02 22:11:26.904 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:11:26.905 +05:30 [INF] Executing endpoint '/hubs/inbox'
2025-07-02 22:11:33.494 +05:30 [INF] Request starting HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - application/json 550
2025-07-02 22:11:33.498 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:11:33.499 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-07-02 22:11:33.502 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSNDBCRTEwODQ0RURGNEY4OTFCAA==","status":"delivered","timestamp":"1751191054","recipient_id":"917082156227","conversation":{"id":"90b38ee00c6455dcc79733c1fd93f79a","origin":{"type":"service"}},"pricing":{"billable":true,"pricing_model":"CBP","category":"service"}}]},"field":"messages"}]}]}
2025-07-02 22:11:33.503 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-07-02 22:11:33.504 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType73`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:11:33.504 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSNDBCRTEwODQ0RURGNEY4OTFCAA==","status":"delivered","timestamp":"1751191054","recipient_id":"917082156227","conversation":{"id":"90b38ee00c6455dcc79733c1fd93f79a","origin":{"type":"service"}},"pricing":{"billable":true,"pricing_model":"CBP","category":"service"}}]},"field":"messages"}]}]}
2025-07-02 22:11:33.506 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 5.1712ms
2025-07-02 22:11:33.509 +05:30 [INF] 📦 Routing to Status Processor
2025-07-02 22:11:33.510 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:11:33.511 +05:30 [WRN] 🔍 Incoming timestamp raw value: {"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSNDBCRTEwODQ0RURGNEY4OTFCAA==","status":"delivered","timestamp":"1751191054","recipient_id":"917082156227","conversation":{"id":"90b38ee00c6455dcc79733c1fd93f79a","origin":{"type":"service"}},"pricing":{"billable":true,"pricing_model":"CBP","category":"service"}}]},"field":"messages"}]}]}
2025-07-02 22:11:33.512 +05:30 [INF] Request finished HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 18.5843ms
2025-07-02 22:11:33.518 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__messageId_0='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSNDBCRTEwODQ0RURGNEY4OTFCAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."MessageId" = @__messageId_0
LIMIT 1
2025-07-02 22:11:33.524 +05:30 [WRN] ⚠️ CampaignSendLog not found for MessageId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSNDBCRTEwODQ0RURGNEY4OTFCAA==
2025-07-02 22:11:33.525 +05:30 [WRN] ⚠️ No matching CampaignSendLog for MessageId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSNDBCRTEwODQ0RURGNEY4OTFCAA==
2025-07-02 22:12:50.492 +05:30 [INF] Request starting HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - application/json 581
2025-07-02 22:12:50.496 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:12:50.498 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-07-02 22:12:50.501 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSRkNDMTAyODcwMTQyNTE3NEY4AA==","status":"sent","timestamp":"1751189154","recipient_id":"917082156227","conversation":{"id":"90b38ee00c6455dcc79733c1fd93f79a","expiration_timestamp":"1751269260","origin":{"type":"service"}},"pricing":{"billable":true,"pricing_model":"CBP","category":"service"}}]},"field":"messages"}]}]}
2025-07-02 22:12:50.503 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-07-02 22:12:50.503 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSRkNDMTAyODcwMTQyNTE3NEY4AA==","status":"sent","timestamp":"1751189154","recipient_id":"917082156227","conversation":{"id":"90b38ee00c6455dcc79733c1fd93f79a","expiration_timestamp":"1751269260","origin":{"type":"service"}},"pricing":{"billable":true,"pricing_model":"CBP","category":"service"}}]},"field":"messages"}]}]}
2025-07-02 22:12:50.504 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType73`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:12:50.505 +05:30 [INF] 📦 Routing to Status Processor
2025-07-02 22:12:50.507 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 6.3076ms
2025-07-02 22:12:50.508 +05:30 [WRN] 🔍 Incoming timestamp raw value: {"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSRkNDMTAyODcwMTQyNTE3NEY4AA==","status":"sent","timestamp":"1751189154","recipient_id":"917082156227","conversation":{"id":"90b38ee00c6455dcc79733c1fd93f79a","expiration_timestamp":"1751269260","origin":{"type":"service"}},"pricing":{"billable":true,"pricing_model":"CBP","category":"service"}}]},"field":"messages"}]}]}
2025-07-02 22:12:50.510 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:12:50.514 +05:30 [INF] Request finished HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 21.2621ms
2025-07-02 22:12:50.514 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__messageId_0='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSRkNDMTAyODcwMTQyNTE3NEY4AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."MessageId" = @__messageId_0
LIMIT 1
2025-07-02 22:12:50.531 +05:30 [WRN] ⚠️ CampaignSendLog not found for MessageId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSRkNDMTAyODcwMTQyNTE3NEY4AA==
2025-07-02 22:12:50.533 +05:30 [WRN] ⚠️ No matching CampaignSendLog for MessageId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSRkNDMTAyODcwMTQyNTE3NEY4AA==
2025-07-02 22:14:19.456 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/auth/session - null null
2025-07-02 22:14:19.462 +05:30 [INF] Executing endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 22:14:19.464 +05:30 [INF] Route matched with {action = "GetSession", controller = "Auth"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetSession() on controller xbytechat.api.AuthModule.Controllers.AuthController (xbytechat.api).
2025-07-02 22:14:19.468 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`4[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:14:19.470 +05:30 [INF] Executed action xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api) in 2.8314ms
2025-07-02 22:14:19.471 +05:30 [INF] Executed endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 22:14:19.473 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/auth/session - 200 null application/json; charset=utf-8 16.4604ms
2025-07-02 22:14:19.606 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/feature-access/me - null null
2025-07-02 22:14:19.610 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 22:14:19.611 +05:30 [INF] Route matched with {action = "GetMyFeatures", controller = "FeatureAccess"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto]]] GetMyFeatures() on controller xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController (xbytechat.api).
2025-07-02 22:14:19.724 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT b."Id", b."Address", b."ApprovedAt", b."ApprovedBy", b."BusinessEmail", b."BusinessName", b."CompanyName", b."CompanyPhone", b."CreatedAt", b."CreatedBy", b."CreatedByPartnerId", b."DeletedAt", b."DeletedBy", b."Industry", b."IsApproved", b."IsDeleted", b."LastLoginAt", b."LogoUrl", b."Notes", b."Phone", b."RepresentativeName", b."Source", b."Status", b."Tags", b."Website", b0."Id", b0."BusinessId", b0."CreatedAt", b0."Plan", b0."QuotaResetDate", b0."RemainingMessages", b0."TotalMonthlyQuota", b0."UpdatedAt", b0."WalletBalance"
FROM "Businesses" AS b
LEFT JOIN "BusinessPlanInfos" AS b0 ON b."Id" = b0."BusinessId"
WHERE b."Id" = @__businessId_0
LIMIT 1
2025-07-02 22:14:19.728 +05:30 [INF] 📦 Resolved plan for Business "c13be597-6ae2-42bb-9d43-925815f24ff8": Smart
2025-07-02 22:14:19.732 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."BusinessId", f."CreatedAt", f."Description", f."FeatureName", f."Group", f."IsEnabled", f."Notes", f."Plan"
FROM "FeatureAccess" AS f
WHERE f."BusinessId" = @__businessId_0
2025-07-02 22:14:19.735 +05:30 [INF] 🔧 Feature override: AddProduct = False
2025-07-02 22:14:19.736 +05:30 [INF] 🔧 Feature override: Automation = True
2025-07-02 22:14:19.737 +05:30 [INF] 🔧 Feature override: Campaigns = True
2025-07-02 22:14:19.738 +05:30 [INF] 🔧 Feature override: Catalog = True
2025-07-02 22:14:19.739 +05:30 [INF] 🔧 Feature override: CRM = True
2025-07-02 22:14:19.740 +05:30 [INF] 🔧 Feature override: CRMInsights = True
2025-07-02 22:14:19.741 +05:30 [INF] 🔧 Feature override: CTAFlow = True
2025-07-02 22:14:19.742 +05:30 [INF] 🔧 Feature override: FlowInsights = True
2025-07-02 22:14:19.743 +05:30 [INF] 🔧 Feature override: Messaging = True
2025-07-02 22:14:19.744 +05:30 [INF] 🔧 Feature override: ProfileCompletion = True
2025-07-02 22:14:19.745 +05:30 [INF] 🔧 Feature override: UpgradePlan = True
2025-07-02 22:14:19.746 +05:30 [INF] 🔧 Feature override: WhatsAppSettings = True
2025-07-02 22:14:19.748 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 22:14:19.750 +05:30 [INF] Executed action xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api) in 135.7483ms
2025-07-02 22:14:19.752 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 22:14:19.753 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/feature-access/me - 200 null application/json; charset=utf-8 147.7413ms
2025-07-02 22:14:19.807 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null null
2025-07-02 22:14:19.810 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/inbox/unread-counts - null null
2025-07-02 22:14:19.823 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null null
2025-07-02 22:14:19.819 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:14:19.823 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:14:19.810 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/contacts - null null
2025-07-02 22:14:19.834 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 204 null null 27.8476ms
2025-07-02 22:14:19.836 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Inbox.Controllers.InboxController.GetUnreadCounts (xbytechat.api)'
2025-07-02 22:14:19.833 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:14:19.838 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null 0
2025-07-02 22:14:19.839 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:14:19.853 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null 0
2025-07-02 22:14:19.846 +05:30 [INF] Route matched with {action = "GetUnreadCounts", controller = "Inbox"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUnreadCounts() on controller xbytechat.api.Features.Inbox.Controllers.InboxController (xbytechat.api).
2025-07-02 22:14:19.859 +05:30 [INF] Executing endpoint 'xbytechat.api.CRM.Controllers.ContactsController.GetAllContacts (xbytechat.api)'
2025-07-02 22:14:19.870 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:14:19.875 +05:30 [INF] Route matched with {action = "GetAllContacts", controller = "Contacts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllContacts(System.String, Int32, Int32) on controller xbytechat.api.CRM.Controllers.ContactsController (xbytechat.api).
2025-07-02 22:14:19.847 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 204 null null 23.7221ms
2025-07-02 22:14:19.851 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:14:19.875 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='2870e1d8-0e80-4b12-88bd-70a8113307d6'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."BusinessId", c."ContactId", c."LastReadAt", c."UserId"
FROM "ContactReads" AS c
WHERE c."UserId" = @__userId_0
2025-07-02 22:14:19.879 +05:30 [INF] Executing endpoint '/hubs/inbox/negotiate'
2025-07-02 22:14:19.881 +05:30 [INF] GetPagedContactsAsync: businessId="c13be597-6ae2-42bb-9d43-925815f24ff8", tab=all, page=1, pageSize=25
2025-07-02 22:14:19.886 +05:30 [INF] Executing endpoint '/hubs/inbox/negotiate'
2025-07-02 22:14:19.890 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."CreatedAt", m."ErrorMessage", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."IsIncoming" AND m."ContactId" IS NOT NULL
2025-07-02 22:14:19.891 +05:30 [INF] Executed endpoint '/hubs/inbox/negotiate'
2025-07-02 22:14:19.895 +05:30 [INF] Executed endpoint '/hubs/inbox/negotiate'
2025-07-02 22:14:19.901 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.Dictionary`2[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:14:19.902 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 200 316 application/json 50.0855ms
2025-07-02 22:14:19.903 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 200 316 application/json 65.8427ms
2025-07-02 22:14:19.905 +05:30 [INF] Executed action xbytechat.api.Features.Inbox.Controllers.InboxController.GetUnreadCounts (xbytechat.api) in 32.6504ms
2025-07-02 22:14:19.917 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Inbox.Controllers.InboxController.GetUnreadCounts (xbytechat.api)'
2025-07-02 22:14:19.918 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/inbox/unread-counts - 200 null application/json; charset=utf-8 108.6683ms
2025-07-02 22:14:19.989 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Contacts" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."IsActive"
2025-07-02 22:14:19.998 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/hubs/inbox?id=BFOerrLX6k6-MBMBdOrSSw - null null
2025-07-02 22:14:20.000 +05:30 [INF] Executed DbCommand (5ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__p_2='25', @__p_1='0'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."AssignedAgentId", t."BusinessId", t."CreatedAt", t."Email", t."Group", t."IsActive", t."IsArchived", t."IsAutomationPaused", t."IsFavorite", t."LastCTAInteraction", t."LastCTAType", t."LastClickedProductId", t."LastContactedAt", t."LeadSource", t."Name", t."NextFollowUpAt", t."Notes", t."PhoneNumber", t."Tags", t0."Id", t0."AssignedAt", t0."AssignedBy", t0."BusinessId", t0."ContactId", t0."TagId", t0."Id0", t0."BusinessId0", t0."Category", t0."ColorHex", t0."CreatedAt", t0."IsActive", t0."IsSystemTag", t0."LastUsedAt", t0."Name", t0."Notes"
FROM (
    SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."Tags"
    FROM "Contacts" AS c
    WHERE c."BusinessId" = @__businessId_0 AND c."IsActive"
    ORDER BY c."Name"
    LIMIT @__p_2 OFFSET @__p_1
) AS t
LEFT JOIN (
    SELECT c0."Id", c0."AssignedAt", c0."AssignedBy", c0."BusinessId", c0."ContactId", c0."TagId", t1."Id" AS "Id0", t1."BusinessId" AS "BusinessId0", t1."Category", t1."ColorHex", t1."CreatedAt", t1."IsActive", t1."IsSystemTag", t1."LastUsedAt", t1."Name", t1."Notes"
    FROM "ContactTags" AS c0
    INNER JOIN "Tags" AS t1 ON c0."TagId" = t1."Id"
) AS t0 ON t."Id" = t0."ContactId"
ORDER BY t."Name", t."Id", t0."Id"
2025-07-02 22:14:20.002 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:14:20.007 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Helpers.ResponseResult'.
2025-07-02 22:14:20.007 +05:30 [INF] Executing endpoint '/hubs/inbox'
2025-07-02 22:14:20.009 +05:30 [INF] Executed action xbytechat.api.CRM.Controllers.ContactsController.GetAllContacts (xbytechat.api) in 128.79ms
2025-07-02 22:14:20.015 +05:30 [INF] Executed endpoint 'xbytechat.api.CRM.Controllers.ContactsController.GetAllContacts (xbytechat.api)'
2025-07-02 22:14:20.017 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/contacts - 200 null application/json; charset=utf-8 207.3844ms
2025-07-02 22:14:20.047 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/hubs/inbox?id=TiZOphz9jB7k3YDHz4aPeA - null null
2025-07-02 22:14:20.050 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:14:20.052 +05:30 [INF] Executing endpoint '/hubs/inbox'
2025-07-02 22:14:21.212 +05:30 [INF] Request starting HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - application/json 550
2025-07-02 22:14:21.216 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:14:21.218 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-07-02 22:14:21.220 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSOTRCRUFGMTVGRTYwQzNFNEY3AA==","status":"delivered","timestamp":"1751189914","recipient_id":"917082156227","conversation":{"id":"90b38ee00c6455dcc79733c1fd93f79a","origin":{"type":"service"}},"pricing":{"billable":true,"pricing_model":"CBP","category":"service"}}]},"field":"messages"}]}]}
2025-07-02 22:14:21.222 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-07-02 22:14:21.223 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSOTRCRUFGMTVGRTYwQzNFNEY3AA==","status":"delivered","timestamp":"1751189914","recipient_id":"917082156227","conversation":{"id":"90b38ee00c6455dcc79733c1fd93f79a","origin":{"type":"service"}},"pricing":{"billable":true,"pricing_model":"CBP","category":"service"}}]},"field":"messages"}]}]}
2025-07-02 22:14:21.224 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType73`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:14:21.226 +05:30 [INF] 📦 Routing to Status Processor
2025-07-02 22:14:21.228 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 8.2204ms
2025-07-02 22:14:21.229 +05:30 [WRN] 🔍 Incoming timestamp raw value: {"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSOTRCRUFGMTVGRTYwQzNFNEY3AA==","status":"delivered","timestamp":"1751189914","recipient_id":"917082156227","conversation":{"id":"90b38ee00c6455dcc79733c1fd93f79a","origin":{"type":"service"}},"pricing":{"billable":true,"pricing_model":"CBP","category":"service"}}]},"field":"messages"}]}]}
2025-07-02 22:14:21.231 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:14:21.235 +05:30 [INF] Request finished HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 22.8303ms
2025-07-02 22:14:21.235 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__messageId_0='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSOTRCRUFGMTVGRTYwQzNFNEY3AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."MessageId" = @__messageId_0
LIMIT 1
2025-07-02 22:14:21.243 +05:30 [WRN] ⚠️ CampaignSendLog not found for MessageId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSOTRCRUFGMTVGRTYwQzNFNEY3AA==
2025-07-02 22:14:21.244 +05:30 [WRN] ⚠️ No matching CampaignSendLog for MessageId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSOTRCRUFGMTVGRTYwQzNFNEY3AA==
2025-07-02 22:14:46.325 +05:30 [INF] Request starting HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - application/json 715
2025-07-02 22:14:46.328 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:14:46.329 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-07-02 22:14:46.332 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSQTAzRTQ2MTgzNjAwQzQ3ODgyAA==","status":"failed","timestamp":"1751182671","recipient_id":"917082156227","errors":[{"code":131047,"title":"Re-engagement message","message":"Re-engagement message","error_data":{"details":"Message failed to send because more than 24 hours have passed since the customer last replied to this number."},"href":"https:\/\/developers.facebook.com\/docs\/whatsapp\/cloud-api\/support\/error-codes\/"}]}]},"field":"messages"}]}]}
2025-07-02 22:14:46.333 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-07-02 22:14:46.334 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSQTAzRTQ2MTgzNjAwQzQ3ODgyAA==","status":"failed","timestamp":"1751182671","recipient_id":"917082156227","errors":[{"code":131047,"title":"Re-engagement message","message":"Re-engagement message","error_data":{"details":"Message failed to send because more than 24 hours have passed since the customer last replied to this number."},"href":"https:\/\/developers.facebook.com\/docs\/whatsapp\/cloud-api\/support\/error-codes\/"}]}]},"field":"messages"}]}]}
2025-07-02 22:14:46.335 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType73`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:14:46.338 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 6.9104ms
2025-07-02 22:14:46.336 +05:30 [INF] 📦 Routing to Status Processor
2025-07-02 22:14:46.339 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:14:46.340 +05:30 [WRN] 🔍 Incoming timestamp raw value: {"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSQTAzRTQ2MTgzNjAwQzQ3ODgyAA==","status":"failed","timestamp":"1751182671","recipient_id":"917082156227","errors":[{"code":131047,"title":"Re-engagement message","message":"Re-engagement message","error_data":{"details":"Message failed to send because more than 24 hours have passed since the customer last replied to this number."},"href":"https:\/\/developers.facebook.com\/docs\/whatsapp\/cloud-api\/support\/error-codes\/"}]}]},"field":"messages"}]}]}
2025-07-02 22:14:46.341 +05:30 [INF] Request finished HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 16.9695ms
2025-07-02 22:14:46.346 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__messageId_0='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSQTAzRTQ2MTgzNjAwQzQ3ODgyAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."MessageId" = @__messageId_0
LIMIT 1
2025-07-02 22:14:46.352 +05:30 [WRN] ⚠️ CampaignSendLog not found for MessageId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSQTAzRTQ2MTgzNjAwQzQ3ODgyAA==
2025-07-02 22:14:46.354 +05:30 [WRN] ⚠️ No matching CampaignSendLog for MessageId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSQTAzRTQ2MTgzNjAwQzQ3ODgyAA==
2025-07-02 22:15:33.473 +05:30 [INF] Request starting HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - application/json 633
2025-07-02 22:15:33.478 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:15:33.479 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-07-02 22:15:33.482 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"contacts":[{"profile":{"name":"\ua9c1S.K\ua9c2"},"wa_id":"917082156227"}],"messages":[{"context":{"from":"15556395845","id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMjdGRjU3OTVBNkQzMkM4RUQzAA=="},"from":"917082156227","id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAEhggMjBCMkI2REExQjlGODMzREYyQUQ4NkQ1NTg3NkEwQUEA","timestamp":"1751474736","type":"button","button":{"payload":"Send Pricing","text":"Send Pricing"}}]},"field":"messages"}]}]}
2025-07-02 22:15:33.484 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-07-02 22:15:33.485 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"contacts":[{"profile":{"name":"\ua9c1S.K\ua9c2"},"wa_id":"917082156227"}],"messages":[{"context":{"from":"15556395845","id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMjdGRjU3OTVBNkQzMkM4RUQzAA=="},"from":"917082156227","id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAEhggMjBCMkI2REExQjlGODMzREYyQUQ4NkQ1NTg3NkEwQUEA","timestamp":"1751474736","type":"button","button":{"payload":"Send Pricing","text":"Send Pricing"}}]},"field":"messages"}]}]}
2025-07-02 22:15:33.486 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType73`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:15:33.488 +05:30 [INF] 👉 Routing to Click Processor
2025-07-02 22:15:33.490 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 8.2091ms
2025-07-02 22:15:33.492 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:15:33.494 +05:30 [INF] Request finished HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 20.9111ms
2025-07-02 22:15:33.497 +05:30 [WRN] 📥 [ENTERED CLICK PROCESSOR]
2025-07-02 22:15:33.500 +05:30 [INF] 🖱️ Button Click → From: 917082156227, ClickId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAEhggMjBCMkI2REExQjlGODMzREYyQUQ4NkQ1NTg3NkEwQUEA, OrigMsgId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMjdGRjU3OTVBNkQzMkM4RUQzAA==, Text: Send Pricing
2025-07-02 22:15:33.556 +05:30 [INF] Executed DbCommand (26ms) [Parameters=[@__originalMessageId_0='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMjdGRjU3OTVBNkQzMkM4RUQzAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId", c0."Id", c0."BusinessId", c0."CampaignId", c0."CampaignType", c0."CreatedAt", c0."CreatedBy", c0."CtaId", c0."DeletedAt", c0."DeletedBy", c0."FollowUpTemplateId", c0."ImageCaption", c0."ImageUrl", c0."IsDeleted", c0."MessageBody", c0."MessageTemplate", c0."Name", c0."ScheduledAt", c0."SourceCampaignId", c0."Status", c0."TemplateId", c0."TemplateParameters", c0."UpdatedAt", c1."Id", c1."AssignedAgentId", c1."BusinessId", c1."CreatedAt", c1."Email", c1."Group", c1."IsActive", c1."IsArchived", c1."IsAutomationPaused", c1."IsFavorite", c1."LastCTAInteraction", c1."LastCTAType", c1."LastClickedProductId", c1."LastContactedAt", c1."LeadSource", c1."Name", c1."NextFollowUpAt", c1."Notes", c1."PhoneNumber", c1."Tags"
FROM "CampaignSendLogs" AS c
INNER JOIN "Campaigns" AS c0 ON c."CampaignId" = c0."Id"
INNER JOIN "Contacts" AS c1 ON c."ContactId" = c1."Id"
WHERE c."MessageId" = @__originalMessageId_0
LIMIT 1
2025-07-02 22:15:33.618 +05:30 [INF] 📊 CampaignSendLog matched via context.id
2025-07-02 22:15:35.507 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__dto_MessageId_0='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMjdGRjU3OTVBNkQzMkM4RUQzAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."CreatedAt", m."ErrorMessage", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."MessageId" = @__dto_MessageId_0 OR m."Id"::text = @__dto_MessageId_0
LIMIT 1
2025-07-02 22:15:35.531 +05:30 [INF] Executed DbCommand (6ms) [Parameters=[@__dto_MessageId_0='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMjdGRjU3OTVBNkQzMkM4RUQzAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId", c0."Id", c0."BotId", c0."BusinessId", c0."CampaignId", c0."CategoryBrowsed", c0."ClickedCTA", c0."ContactId", c0."IsAutoTagged", c0."MessagePreview", c0."ProductBrowsed", c0."SentAt", c0."Status", c0."UpdatedAt"
FROM "CampaignSendLogs" AS c
INNER JOIN "CampaignRecipients" AS c0 ON c."RecipientId" = c0."Id"
WHERE c."MessageId" = @__dto_MessageId_0
LIMIT 1
2025-07-02 22:15:35.594 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@p3='c9ef0c77-eab2-40c3-8bb3-02a6118b1a4a', @p0='Send Pricing', @p1='2025-07-02T16:45:33.6217060Z' (Nullable = true) (DbType = DateTime), @p2='True'], CommandType='"Text"', CommandTimeout='30']
UPDATE "CampaignSendLogs" SET "ClickType" = @p0, "ClickedAt" = @p1, "IsClicked" = @p2
WHERE "Id" = @p3;
2025-07-02 22:15:35.684 +05:30 [INF] Executed DbCommand (13ms) [Parameters=[@p0='af5d13a5-569d-400a-b696-0c8f27ed0c80', @p1='WhatsApp', @p2='c13be597-6ae2-42bb-9d43-925815f24ff8', @p3='Send Pricing', @p4='Send Pricing', @p5='5b762111-ca31-42e3-aead-a65f67b4ff48' (Nullable = true), @p6='c9ef0c77-eab2-40c3-8bb3-02a6118b1a4a' (Nullable = true), @p7=NULL, @p8='2025-07-02T16:45:33.6217060Z' (DbType = DateTime), @p9='webhook', @p10='8aac7c57-6699-4511-897b-4121b407eb1c' (Nullable = true), @p11='+917082156227', @p12='Unknown', @p13='Unknown', @p14='False', @p15='webhook', @p16='Clicked', @p17='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMjdGRjU3OTVBNkQzMkM4RUQzAA==', @p18='caa3fdb3-45f9-437c-a927-f972defcf220' (Nullable = true), @p19=NULL, @p20=NULL (DbType = Guid), @p21='5b762111-ca31-42e3-aead-a65f67b4ff48' (Nullable = true), @p22='campaign' (Nullable = false), @p23=NULL (DbType = Guid), @p24=NULL, @p25=NULL (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "TrackingLogs" ("Id", "Browser", "BusinessId", "ButtonText", "CTAType", "CampaignId", "CampaignSendLogId", "City", "ClickedAt", "ClickedVia", "ContactId", "ContactPhone", "Country", "DeviceType", "FollowUpSent", "IPAddress", "LastInteractionType", "MessageId", "MessageLogId", "Referrer", "SessionId", "SourceId", "SourceType", "StepId", "TemplateId", "ThreadId")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22, @p23, @p24, @p25);
2025-07-02 22:15:35.691 +05:30 [INF] 📥 Click Tracked → Result: CTA click tracked successfully.
2025-07-02 22:15:35.712 +05:30 [INF] Executed DbCommand (5ms) [Parameters=[@__campaignId_0='5b762111-ca31-42e3-aead-a65f67b4ff48' (Nullable = true), @__normalizedButtonText_1='send pricing', @__normalizedTemplateName_2='flow_step_4'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."ButtonText", c."CampaignId", c."CreatedAt", c."CreatedBy", c."OverrideNextTemplate", c."TemplateName"
FROM "CampaignFlowOverrides" AS c
WHERE c."CampaignId" = @__campaignId_0 AND lower(c."ButtonText") = @__normalizedButtonText_1 AND lower(c."TemplateName") = @__normalizedTemplateName_2
LIMIT 1
2025-07-02 22:15:35.718 +05:30 [INF] 🟡 No campaign override found for button 'send pricing' on template 'flow_step_4'
2025-07-02 22:15:35.739 +05:30 [INF] Executed DbCommand (6ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__normalizedButtonText_1='send pricing', @__normalizedButtonType_2='quick_reply'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."CTAFlowConfigId", c."PositionX", c."PositionY", c."RequiredSource", c."RequiredTag", c."StepOrder", c."TemplateToSend", c."TemplateType", c."TriggerButtonText", c."TriggerButtonType", c0."Id", c0."BusinessId", c0."CreatedAt", c0."CreatedBy", c0."FlowName", c0."IsActive", c0."IsPublished", c0."UpdatedAt"
FROM "CTAFlowSteps" AS c
INNER JOIN "CTAFlowConfigs" AS c0 ON c."CTAFlowConfigId" = c0."Id"
WHERE c0."BusinessId" = @__businessId_0 AND c0."IsActive" AND c0."IsPublished" AND lower(c."TriggerButtonText") = @__normalizedButtonText_1 AND lower(c."TriggerButtonType") = @__normalizedButtonType_2
LIMIT 1
2025-07-02 22:15:35.743 +05:30 [WRN] ❌ No fallback step matched for button 'send pricing' of type 'quick_reply' in BusinessId: "c13be597-6ae2-42bb-9d43-925815f24ff8"
2025-07-02 22:15:35.746 +05:30 [INF] 🟡 No visual flow matched for this button: Send Pricing
2025-07-02 22:16:05.817 +05:30 [INF] Request starting HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - application/json 633
2025-07-02 22:16:05.821 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:16:05.823 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-07-02 22:16:05.827 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"contacts":[{"profile":{"name":"\ua9c1S.K\ua9c2"},"wa_id":"917082156227"}],"messages":[{"context":{"from":"15556395845","id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMjdGRjU3OTVBNkQzMkM4RUQzAA=="},"from":"917082156227","id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAEhggMjBCMkI2REExQjlGODMzREYyQUQ4NkQ1NTg3NkEwQUEA","timestamp":"1751474736","type":"button","button":{"payload":"Send Pricing","text":"Send Pricing"}}]},"field":"messages"}]}]}
2025-07-02 22:16:05.828 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-07-02 22:16:05.829 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"contacts":[{"profile":{"name":"\ua9c1S.K\ua9c2"},"wa_id":"917082156227"}],"messages":[{"context":{"from":"15556395845","id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMjdGRjU3OTVBNkQzMkM4RUQzAA=="},"from":"917082156227","id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAEhggMjBCMkI2REExQjlGODMzREYyQUQ4NkQ1NTg3NkEwQUEA","timestamp":"1751474736","type":"button","button":{"payload":"Send Pricing","text":"Send Pricing"}}]},"field":"messages"}]}]}
2025-07-02 22:16:05.829 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType73`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:16:05.833 +05:30 [INF] 👉 Routing to Click Processor
2025-07-02 22:16:05.835 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 9.2476ms
2025-07-02 22:16:05.837 +05:30 [WRN] 📥 [ENTERED CLICK PROCESSOR]
2025-07-02 22:16:05.838 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:16:05.839 +05:30 [INF] 🖱️ Button Click → From: 917082156227, ClickId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAEhggMjBCMkI2REExQjlGODMzREYyQUQ4NkQ1NTg3NkEwQUEA, OrigMsgId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMjdGRjU3OTVBNkQzMkM4RUQzAA==, Text: Send Pricing
2025-07-02 22:16:05.841 +05:30 [INF] Request finished HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 23.421ms
2025-07-02 22:16:05.850 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[@__originalMessageId_0='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMjdGRjU3OTVBNkQzMkM4RUQzAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId", c0."Id", c0."BusinessId", c0."CampaignId", c0."CampaignType", c0."CreatedAt", c0."CreatedBy", c0."CtaId", c0."DeletedAt", c0."DeletedBy", c0."FollowUpTemplateId", c0."ImageCaption", c0."ImageUrl", c0."IsDeleted", c0."MessageBody", c0."MessageTemplate", c0."Name", c0."ScheduledAt", c0."SourceCampaignId", c0."Status", c0."TemplateId", c0."TemplateParameters", c0."UpdatedAt", c1."Id", c1."AssignedAgentId", c1."BusinessId", c1."CreatedAt", c1."Email", c1."Group", c1."IsActive", c1."IsArchived", c1."IsAutomationPaused", c1."IsFavorite", c1."LastCTAInteraction", c1."LastCTAType", c1."LastClickedProductId", c1."LastContactedAt", c1."LeadSource", c1."Name", c1."NextFollowUpAt", c1."Notes", c1."PhoneNumber", c1."Tags"
FROM "CampaignSendLogs" AS c
INNER JOIN "Campaigns" AS c0 ON c."CampaignId" = c0."Id"
INNER JOIN "Contacts" AS c1 ON c."ContactId" = c1."Id"
WHERE c."MessageId" = @__originalMessageId_0
LIMIT 1
2025-07-02 22:16:05.854 +05:30 [INF] 📊 CampaignSendLog matched via context.id
2025-07-02 22:16:07.132 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__dto_MessageId_0='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMjdGRjU3OTVBNkQzMkM4RUQzAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."CreatedAt", m."ErrorMessage", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."MessageId" = @__dto_MessageId_0 OR m."Id"::text = @__dto_MessageId_0
LIMIT 1
2025-07-02 22:16:07.137 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__dto_MessageId_0='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMjdGRjU3OTVBNkQzMkM4RUQzAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId", c0."Id", c0."BotId", c0."BusinessId", c0."CampaignId", c0."CategoryBrowsed", c0."ClickedCTA", c0."ContactId", c0."IsAutoTagged", c0."MessagePreview", c0."ProductBrowsed", c0."SentAt", c0."Status", c0."UpdatedAt"
FROM "CampaignSendLogs" AS c
INNER JOIN "CampaignRecipients" AS c0 ON c."RecipientId" = c0."Id"
WHERE c."MessageId" = @__dto_MessageId_0
LIMIT 1
2025-07-02 22:16:07.161 +05:30 [INF] Executed DbCommand (20ms) [Parameters=[@p1='c9ef0c77-eab2-40c3-8bb3-02a6118b1a4a', @p0='2025-07-02T16:46:05.8552074Z' (Nullable = true) (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE "CampaignSendLogs" SET "ClickedAt" = @p0
WHERE "Id" = @p1;
2025-07-02 22:16:07.169 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@p0='69893ab7-b96b-4764-a756-029ce20b95dd', @p1='WhatsApp', @p2='c13be597-6ae2-42bb-9d43-925815f24ff8', @p3='Send Pricing', @p4='Send Pricing', @p5='5b762111-ca31-42e3-aead-a65f67b4ff48' (Nullable = true), @p6='c9ef0c77-eab2-40c3-8bb3-02a6118b1a4a' (Nullable = true), @p7=NULL, @p8='2025-07-02T16:46:05.8552074Z' (DbType = DateTime), @p9='webhook', @p10='8aac7c57-6699-4511-897b-4121b407eb1c' (Nullable = true), @p11='+917082156227', @p12='Unknown', @p13='Unknown', @p14='False', @p15='webhook', @p16='Clicked', @p17='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMjdGRjU3OTVBNkQzMkM4RUQzAA==', @p18='caa3fdb3-45f9-437c-a927-f972defcf220' (Nullable = true), @p19=NULL, @p20=NULL (DbType = Guid), @p21='5b762111-ca31-42e3-aead-a65f67b4ff48' (Nullable = true), @p22='campaign' (Nullable = false), @p23=NULL (DbType = Guid), @p24=NULL, @p25=NULL (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "TrackingLogs" ("Id", "Browser", "BusinessId", "ButtonText", "CTAType", "CampaignId", "CampaignSendLogId", "City", "ClickedAt", "ClickedVia", "ContactId", "ContactPhone", "Country", "DeviceType", "FollowUpSent", "IPAddress", "LastInteractionType", "MessageId", "MessageLogId", "Referrer", "SessionId", "SourceId", "SourceType", "StepId", "TemplateId", "ThreadId")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22, @p23, @p24, @p25);
2025-07-02 22:16:07.172 +05:30 [INF] 📥 Click Tracked → Result: CTA click tracked successfully.
2025-07-02 22:16:07.176 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__campaignId_0='5b762111-ca31-42e3-aead-a65f67b4ff48' (Nullable = true), @__normalizedButtonText_1='send pricing', @__normalizedTemplateName_2='flow_step_4'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."ButtonText", c."CampaignId", c."CreatedAt", c."CreatedBy", c."OverrideNextTemplate", c."TemplateName"
FROM "CampaignFlowOverrides" AS c
WHERE c."CampaignId" = @__campaignId_0 AND lower(c."ButtonText") = @__normalizedButtonText_1 AND lower(c."TemplateName") = @__normalizedTemplateName_2
LIMIT 1
2025-07-02 22:16:07.178 +05:30 [INF] 🟡 No campaign override found for button 'send pricing' on template 'flow_step_4'
2025-07-02 22:16:07.182 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__normalizedButtonText_1='send pricing', @__normalizedButtonType_2='quick_reply'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."CTAFlowConfigId", c."PositionX", c."PositionY", c."RequiredSource", c."RequiredTag", c."StepOrder", c."TemplateToSend", c."TemplateType", c."TriggerButtonText", c."TriggerButtonType", c0."Id", c0."BusinessId", c0."CreatedAt", c0."CreatedBy", c0."FlowName", c0."IsActive", c0."IsPublished", c0."UpdatedAt"
FROM "CTAFlowSteps" AS c
INNER JOIN "CTAFlowConfigs" AS c0 ON c."CTAFlowConfigId" = c0."Id"
WHERE c0."BusinessId" = @__businessId_0 AND c0."IsActive" AND c0."IsPublished" AND lower(c."TriggerButtonText") = @__normalizedButtonText_1 AND lower(c."TriggerButtonType") = @__normalizedButtonType_2
LIMIT 1
2025-07-02 22:16:07.185 +05:30 [WRN] ❌ No fallback step matched for button 'send pricing' of type 'quick_reply' in BusinessId: "c13be597-6ae2-42bb-9d43-925815f24ff8"
2025-07-02 22:16:07.187 +05:30 [INF] 🟡 No visual flow matched for this button: Send Pricing
2025-07-02 22:16:08.079 +05:30 [INF] Executed endpoint '/hubs/inbox'
2025-07-02 22:16:08.080 +05:30 [INF] Executed endpoint '/hubs/inbox'
2025-07-02 22:16:08.095 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/hubs/inbox?id=TiZOphz9jB7k3YDHz4aPeA - 101 null null 108048.5895ms
2025-07-02 22:16:08.098 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/hubs/inbox?id=BFOerrLX6k6-MBMBdOrSSw - 101 null null 108099.8681ms
2025-07-02 22:16:08.233 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/auth/session - null null
2025-07-02 22:16:08.241 +05:30 [INF] Executing endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 22:16:08.243 +05:30 [INF] Route matched with {action = "GetSession", controller = "Auth"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetSession() on controller xbytechat.api.AuthModule.Controllers.AuthController (xbytechat.api).
2025-07-02 22:16:08.246 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`4[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:16:08.248 +05:30 [INF] Executed action xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api) in 2.6392ms
2025-07-02 22:16:08.251 +05:30 [INF] Executed endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 22:16:08.252 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/auth/session - 200 null application/json; charset=utf-8 19.4835ms
2025-07-02 22:16:08.279 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/feature-access/me - null null
2025-07-02 22:16:08.284 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 22:16:08.287 +05:30 [INF] Route matched with {action = "GetMyFeatures", controller = "FeatureAccess"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto]]] GetMyFeatures() on controller xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController (xbytechat.api).
2025-07-02 22:16:08.295 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT b."Id", b."Address", b."ApprovedAt", b."ApprovedBy", b."BusinessEmail", b."BusinessName", b."CompanyName", b."CompanyPhone", b."CreatedAt", b."CreatedBy", b."CreatedByPartnerId", b."DeletedAt", b."DeletedBy", b."Industry", b."IsApproved", b."IsDeleted", b."LastLoginAt", b."LogoUrl", b."Notes", b."Phone", b."RepresentativeName", b."Source", b."Status", b."Tags", b."Website", b0."Id", b0."BusinessId", b0."CreatedAt", b0."Plan", b0."QuotaResetDate", b0."RemainingMessages", b0."TotalMonthlyQuota", b0."UpdatedAt", b0."WalletBalance"
FROM "Businesses" AS b
LEFT JOIN "BusinessPlanInfos" AS b0 ON b."Id" = b0."BusinessId"
WHERE b."Id" = @__businessId_0
LIMIT 1
2025-07-02 22:16:08.301 +05:30 [INF] 📦 Resolved plan for Business "c13be597-6ae2-42bb-9d43-925815f24ff8": Smart
2025-07-02 22:16:08.305 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."BusinessId", f."CreatedAt", f."Description", f."FeatureName", f."Group", f."IsEnabled", f."Notes", f."Plan"
FROM "FeatureAccess" AS f
WHERE f."BusinessId" = @__businessId_0
2025-07-02 22:16:08.309 +05:30 [INF] 🔧 Feature override: AddProduct = False
2025-07-02 22:16:08.311 +05:30 [INF] 🔧 Feature override: Automation = True
2025-07-02 22:16:08.312 +05:30 [INF] 🔧 Feature override: Campaigns = True
2025-07-02 22:16:08.313 +05:30 [INF] 🔧 Feature override: Catalog = True
2025-07-02 22:16:08.314 +05:30 [INF] 🔧 Feature override: CRM = True
2025-07-02 22:16:08.315 +05:30 [INF] 🔧 Feature override: CRMInsights = True
2025-07-02 22:16:08.317 +05:30 [INF] 🔧 Feature override: CTAFlow = True
2025-07-02 22:16:08.318 +05:30 [INF] 🔧 Feature override: FlowInsights = True
2025-07-02 22:16:08.319 +05:30 [INF] 🔧 Feature override: Messaging = True
2025-07-02 22:16:08.320 +05:30 [INF] 🔧 Feature override: ProfileCompletion = True
2025-07-02 22:16:08.321 +05:30 [INF] 🔧 Feature override: UpgradePlan = True
2025-07-02 22:16:08.323 +05:30 [INF] 🔧 Feature override: WhatsAppSettings = True
2025-07-02 22:16:08.326 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 22:16:08.329 +05:30 [INF] Executed action xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api) in 38.4545ms
2025-07-02 22:16:08.331 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 22:16:08.333 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/feature-access/me - 200 null application/json; charset=utf-8 54.0411ms
2025-07-02 22:16:08.369 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null null
2025-07-02 22:16:08.371 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/contacts - null null
2025-07-02 22:16:08.371 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/inbox/unread-counts - null null
2025-07-02 22:16:08.374 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:16:08.377 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:16:08.378 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null null
2025-07-02 22:16:08.381 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:16:08.383 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 204 null null 13.2016ms
2025-07-02 22:16:08.384 +05:30 [INF] Executing endpoint 'xbytechat.api.CRM.Controllers.ContactsController.GetAllContacts (xbytechat.api)'
2025-07-02 22:16:08.385 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null 0
2025-07-02 22:16:08.388 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:16:08.390 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Inbox.Controllers.InboxController.GetUnreadCounts (xbytechat.api)'
2025-07-02 22:16:08.396 +05:30 [INF] Route matched with {action = "GetAllContacts", controller = "Contacts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllContacts(System.String, Int32, Int32) on controller xbytechat.api.CRM.Controllers.ContactsController (xbytechat.api).
2025-07-02 22:16:08.400 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:16:08.401 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 204 null null 22.899ms
2025-07-02 22:16:08.403 +05:30 [INF] Route matched with {action = "GetUnreadCounts", controller = "Inbox"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUnreadCounts() on controller xbytechat.api.Features.Inbox.Controllers.InboxController (xbytechat.api).
2025-07-02 22:16:08.403 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null 0
2025-07-02 22:16:08.428 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:16:08.416 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='2870e1d8-0e80-4b12-88bd-70a8113307d6'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."BusinessId", c."ContactId", c."LastReadAt", c."UserId"
FROM "ContactReads" AS c
WHERE c."UserId" = @__userId_0
2025-07-02 22:16:08.406 +05:30 [INF] GetPagedContactsAsync: businessId="c13be597-6ae2-42bb-9d43-925815f24ff8", tab=all, page=1, pageSize=25
2025-07-02 22:16:08.407 +05:30 [INF] Executing endpoint '/hubs/inbox/negotiate'
2025-07-02 22:16:08.435 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."CreatedAt", m."ErrorMessage", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."IsIncoming" AND m."ContactId" IS NOT NULL
2025-07-02 22:16:08.439 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Contacts" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."IsActive"
2025-07-02 22:16:08.440 +05:30 [INF] Executed endpoint '/hubs/inbox/negotiate'
2025-07-02 22:16:08.446 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/hubs/inbox?id=MLkSaLqMPh29eFS0GM_fYQ - null null
2025-07-02 22:16:08.446 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.Dictionary`2[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:16:08.430 +05:30 [INF] Executing endpoint '/hubs/inbox/negotiate'
2025-07-02 22:16:08.452 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__p_2='25', @__p_1='0'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."AssignedAgentId", t."BusinessId", t."CreatedAt", t."Email", t."Group", t."IsActive", t."IsArchived", t."IsAutomationPaused", t."IsFavorite", t."LastCTAInteraction", t."LastCTAType", t."LastClickedProductId", t."LastContactedAt", t."LeadSource", t."Name", t."NextFollowUpAt", t."Notes", t."PhoneNumber", t."Tags", t0."Id", t0."AssignedAt", t0."AssignedBy", t0."BusinessId", t0."ContactId", t0."TagId", t0."Id0", t0."BusinessId0", t0."Category", t0."ColorHex", t0."CreatedAt", t0."IsActive", t0."IsSystemTag", t0."LastUsedAt", t0."Name", t0."Notes"
FROM (
    SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."Tags"
    FROM "Contacts" AS c
    WHERE c."BusinessId" = @__businessId_0 AND c."IsActive"
    ORDER BY c."Name"
    LIMIT @__p_2 OFFSET @__p_1
) AS t
LEFT JOIN (
    SELECT c0."Id", c0."AssignedAt", c0."AssignedBy", c0."BusinessId", c0."ContactId", c0."TagId", t1."Id" AS "Id0", t1."BusinessId" AS "BusinessId0", t1."Category", t1."ColorHex", t1."CreatedAt", t1."IsActive", t1."IsSystemTag", t1."LastUsedAt", t1."Name", t1."Notes"
    FROM "ContactTags" AS c0
    INNER JOIN "Tags" AS t1 ON c0."TagId" = t1."Id"
) AS t0 ON t."Id" = t0."ContactId"
ORDER BY t."Name", t."Id", t0."Id"
2025-07-02 22:16:08.453 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 200 316 application/json 67.9931ms
2025-07-02 22:16:08.457 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:16:08.459 +05:30 [INF] Executed action xbytechat.api.Features.Inbox.Controllers.InboxController.GetUnreadCounts (xbytechat.api) in 45.8343ms
2025-07-02 22:16:08.461 +05:30 [INF] Executed endpoint '/hubs/inbox/negotiate'
2025-07-02 22:16:08.465 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Helpers.ResponseResult'.
2025-07-02 22:16:08.470 +05:30 [INF] Executing endpoint '/hubs/inbox'
2025-07-02 22:16:08.473 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Inbox.Controllers.InboxController.GetUnreadCounts (xbytechat.api)'
2025-07-02 22:16:08.477 +05:30 [INF] Executed action xbytechat.api.CRM.Controllers.ContactsController.GetAllContacts (xbytechat.api) in 71.9648ms
2025-07-02 22:16:08.485 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/inbox/unread-counts - 200 null application/json; charset=utf-8 113.6989ms
2025-07-02 22:16:08.475 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 200 316 application/json 72.0419ms
2025-07-02 22:16:08.486 +05:30 [INF] Executed endpoint 'xbytechat.api.CRM.Controllers.ContactsController.GetAllContacts (xbytechat.api)'
2025-07-02 22:16:08.494 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/hubs/inbox?id=pZ34DRsm98s0nobmEBrUKA - null null
2025-07-02 22:16:08.498 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/contacts - 200 null application/json; charset=utf-8 127.8349ms
2025-07-02 22:16:08.502 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:16:08.509 +05:30 [INF] Executing endpoint '/hubs/inbox'
2025-07-02 22:16:21.437 +05:30 [INF] Executed endpoint '/hubs/inbox'
2025-07-02 22:16:21.437 +05:30 [INF] Executed endpoint '/hubs/inbox'
2025-07-02 22:16:21.439 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/hubs/inbox?id=pZ34DRsm98s0nobmEBrUKA - 101 null null 12944.3099ms
2025-07-02 22:16:21.440 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/hubs/inbox?id=MLkSaLqMPh29eFS0GM_fYQ - 101 null null 12994.4637ms
2025-07-02 22:16:21.581 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/auth/session - null null
2025-07-02 22:16:21.585 +05:30 [INF] Executing endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 22:16:21.587 +05:30 [INF] Route matched with {action = "GetSession", controller = "Auth"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetSession() on controller xbytechat.api.AuthModule.Controllers.AuthController (xbytechat.api).
2025-07-02 22:16:21.590 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`4[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:16:21.592 +05:30 [INF] Executed action xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api) in 2.3977ms
2025-07-02 22:16:21.594 +05:30 [INF] Executed endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 22:16:21.597 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/auth/session - 200 null application/json; charset=utf-8 15.8988ms
2025-07-02 22:16:21.639 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/feature-access/me - null null
2025-07-02 22:16:21.648 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 22:16:21.650 +05:30 [INF] Route matched with {action = "GetMyFeatures", controller = "FeatureAccess"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto]]] GetMyFeatures() on controller xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController (xbytechat.api).
2025-07-02 22:16:21.657 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT b."Id", b."Address", b."ApprovedAt", b."ApprovedBy", b."BusinessEmail", b."BusinessName", b."CompanyName", b."CompanyPhone", b."CreatedAt", b."CreatedBy", b."CreatedByPartnerId", b."DeletedAt", b."DeletedBy", b."Industry", b."IsApproved", b."IsDeleted", b."LastLoginAt", b."LogoUrl", b."Notes", b."Phone", b."RepresentativeName", b."Source", b."Status", b."Tags", b."Website", b0."Id", b0."BusinessId", b0."CreatedAt", b0."Plan", b0."QuotaResetDate", b0."RemainingMessages", b0."TotalMonthlyQuota", b0."UpdatedAt", b0."WalletBalance"
FROM "Businesses" AS b
LEFT JOIN "BusinessPlanInfos" AS b0 ON b."Id" = b0."BusinessId"
WHERE b."Id" = @__businessId_0
LIMIT 1
2025-07-02 22:16:21.664 +05:30 [INF] 📦 Resolved plan for Business "c13be597-6ae2-42bb-9d43-925815f24ff8": Smart
2025-07-02 22:16:21.668 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."BusinessId", f."CreatedAt", f."Description", f."FeatureName", f."Group", f."IsEnabled", f."Notes", f."Plan"
FROM "FeatureAccess" AS f
WHERE f."BusinessId" = @__businessId_0
2025-07-02 22:16:21.672 +05:30 [INF] 🔧 Feature override: AddProduct = False
2025-07-02 22:16:21.673 +05:30 [INF] 🔧 Feature override: Automation = True
2025-07-02 22:16:21.674 +05:30 [INF] 🔧 Feature override: Campaigns = True
2025-07-02 22:16:21.675 +05:30 [INF] 🔧 Feature override: Catalog = True
2025-07-02 22:16:21.676 +05:30 [INF] 🔧 Feature override: CRM = True
2025-07-02 22:16:21.677 +05:30 [INF] 🔧 Feature override: CRMInsights = True
2025-07-02 22:16:21.678 +05:30 [INF] 🔧 Feature override: CTAFlow = True
2025-07-02 22:16:21.679 +05:30 [INF] 🔧 Feature override: FlowInsights = True
2025-07-02 22:16:21.680 +05:30 [INF] 🔧 Feature override: Messaging = True
2025-07-02 22:16:21.682 +05:30 [INF] 🔧 Feature override: ProfileCompletion = True
2025-07-02 22:16:21.683 +05:30 [INF] 🔧 Feature override: UpgradePlan = True
2025-07-02 22:16:21.684 +05:30 [INF] 🔧 Feature override: WhatsAppSettings = True
2025-07-02 22:16:21.686 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 22:16:21.688 +05:30 [INF] Executed action xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api) in 35.2658ms
2025-07-02 22:16:21.690 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 22:16:21.692 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/feature-access/me - 200 null application/json; charset=utf-8 53.3899ms
2025-07-02 22:16:21.725 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null null
2025-07-02 22:16:21.726 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/contacts - null null
2025-07-02 22:16:21.726 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/inbox/unread-counts - null null
2025-07-02 22:16:21.730 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:16:21.732 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null null
2025-07-02 22:16:21.734 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:16:21.738 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:16:21.739 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 204 null null 13.9816ms
2025-07-02 22:16:21.741 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null 0
2025-07-02 22:16:21.743 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:16:21.745 +05:30 [INF] Executing endpoint 'xbytechat.api.CRM.Controllers.ContactsController.GetAllContacts (xbytechat.api)'
2025-07-02 22:16:21.746 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Inbox.Controllers.InboxController.GetUnreadCounts (xbytechat.api)'
2025-07-02 22:16:21.754 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:16:21.755 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 204 null null 22.9183ms
2025-07-02 22:16:21.757 +05:30 [INF] Route matched with {action = "GetAllContacts", controller = "Contacts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllContacts(System.String, Int32, Int32) on controller xbytechat.api.CRM.Controllers.ContactsController (xbytechat.api).
2025-07-02 22:16:21.757 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null 0
2025-07-02 22:16:21.758 +05:30 [INF] Route matched with {action = "GetUnreadCounts", controller = "Inbox"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUnreadCounts() on controller xbytechat.api.Features.Inbox.Controllers.InboxController (xbytechat.api).
2025-07-02 22:16:21.760 +05:30 [INF] Executing endpoint '/hubs/inbox/negotiate'
2025-07-02 22:16:21.771 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:16:21.777 +05:30 [INF] Executed endpoint '/hubs/inbox/negotiate'
2025-07-02 22:16:21.776 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='2870e1d8-0e80-4b12-88bd-70a8113307d6'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."BusinessId", c."ContactId", c."LastReadAt", c."UserId"
FROM "ContactReads" AS c
WHERE c."UserId" = @__userId_0
2025-07-02 22:16:21.780 +05:30 [INF] Executing endpoint '/hubs/inbox/negotiate'
2025-07-02 22:16:21.781 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 200 316 application/json 40.3291ms
2025-07-02 22:16:21.783 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/hubs/inbox?id=lL2ccQYTBzYjMn03gYjhGg - null null
2025-07-02 22:16:21.787 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."CreatedAt", m."ErrorMessage", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."IsIncoming" AND m."ContactId" IS NOT NULL
2025-07-02 22:16:21.768 +05:30 [INF] GetPagedContactsAsync: businessId="c13be597-6ae2-42bb-9d43-925815f24ff8", tab=all, page=1, pageSize=25
2025-07-02 22:16:21.788 +05:30 [INF] Executed endpoint '/hubs/inbox/negotiate'
2025-07-02 22:16:21.805 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Contacts" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."IsActive"
2025-07-02 22:16:21.805 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 200 316 application/json 48.4978ms
2025-07-02 22:16:21.796 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:16:21.800 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.Dictionary`2[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:16:21.814 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__p_2='25', @__p_1='0'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."AssignedAgentId", t."BusinessId", t."CreatedAt", t."Email", t."Group", t."IsActive", t."IsArchived", t."IsAutomationPaused", t."IsFavorite", t."LastCTAInteraction", t."LastCTAType", t."LastClickedProductId", t."LastContactedAt", t."LeadSource", t."Name", t."NextFollowUpAt", t."Notes", t."PhoneNumber", t."Tags", t0."Id", t0."AssignedAt", t0."AssignedBy", t0."BusinessId", t0."ContactId", t0."TagId", t0."Id0", t0."BusinessId0", t0."Category", t0."ColorHex", t0."CreatedAt", t0."IsActive", t0."IsSystemTag", t0."LastUsedAt", t0."Name", t0."Notes"
FROM (
    SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."Tags"
    FROM "Contacts" AS c
    WHERE c."BusinessId" = @__businessId_0 AND c."IsActive"
    ORDER BY c."Name"
    LIMIT @__p_2 OFFSET @__p_1
) AS t
LEFT JOIN (
    SELECT c0."Id", c0."AssignedAt", c0."AssignedBy", c0."BusinessId", c0."ContactId", c0."TagId", t1."Id" AS "Id0", t1."BusinessId" AS "BusinessId0", t1."Category", t1."ColorHex", t1."CreatedAt", t1."IsActive", t1."IsSystemTag", t1."LastUsedAt", t1."Name", t1."Notes"
    FROM "ContactTags" AS c0
    INNER JOIN "Tags" AS t1 ON c0."TagId" = t1."Id"
) AS t0 ON t."Id" = t0."ContactId"
ORDER BY t."Name", t."Id", t0."Id"
2025-07-02 22:16:21.819 +05:30 [INF] Executing endpoint '/hubs/inbox'
2025-07-02 22:16:21.821 +05:30 [INF] Executed action xbytechat.api.Features.Inbox.Controllers.InboxController.GetUnreadCounts (xbytechat.api) in 47.625ms
2025-07-02 22:16:21.825 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Helpers.ResponseResult'.
2025-07-02 22:16:21.832 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Inbox.Controllers.InboxController.GetUnreadCounts (xbytechat.api)'
2025-07-02 22:16:21.834 +05:30 [INF] Executed action xbytechat.api.CRM.Controllers.ContactsController.GetAllContacts (xbytechat.api) in 66.0177ms
2025-07-02 22:16:21.835 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/inbox/unread-counts - 200 null application/json; charset=utf-8 109.0661ms
2025-07-02 22:16:21.837 +05:30 [INF] Executed endpoint 'xbytechat.api.CRM.Controllers.ContactsController.GetAllContacts (xbytechat.api)'
2025-07-02 22:16:21.843 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/contacts - 200 null application/json; charset=utf-8 116.6488ms
2025-07-02 22:16:21.845 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/hubs/inbox?id=tN092gzjErQJXX1ad2Gh8Q - null null
2025-07-02 22:16:21.855 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:16:21.857 +05:30 [INF] Executing endpoint '/hubs/inbox'
2025-07-02 22:16:22.235 +05:30 [INF] Request starting HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - application/json 715
2025-07-02 22:16:22.239 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:16:22.241 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-07-02 22:16:22.244 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSNzQ1Q0VCNkVBOEIxQkQ4NzdBAA==","status":"failed","timestamp":"1750941263","recipient_id":"917082156227","errors":[{"code":131047,"title":"Re-engagement message","message":"Re-engagement message","error_data":{"details":"Message failed to send because more than 24 hours have passed since the customer last replied to this number."},"href":"https:\/\/developers.facebook.com\/docs\/whatsapp\/cloud-api\/support\/error-codes\/"}]}]},"field":"messages"}]}]}
2025-07-02 22:16:22.246 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-07-02 22:16:22.247 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSNzQ1Q0VCNkVBOEIxQkQ4NzdBAA==","status":"failed","timestamp":"1750941263","recipient_id":"917082156227","errors":[{"code":131047,"title":"Re-engagement message","message":"Re-engagement message","error_data":{"details":"Message failed to send because more than 24 hours have passed since the customer last replied to this number."},"href":"https:\/\/developers.facebook.com\/docs\/whatsapp\/cloud-api\/support\/error-codes\/"}]}]},"field":"messages"}]}]}
2025-07-02 22:16:22.248 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType73`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:16:22.250 +05:30 [INF] 📦 Routing to Status Processor
2025-07-02 22:16:22.252 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 8.4341ms
2025-07-02 22:16:22.253 +05:30 [WRN] 🔍 Incoming timestamp raw value: {"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSNzQ1Q0VCNkVBOEIxQkQ4NzdBAA==","status":"failed","timestamp":"1750941263","recipient_id":"917082156227","errors":[{"code":131047,"title":"Re-engagement message","message":"Re-engagement message","error_data":{"details":"Message failed to send because more than 24 hours have passed since the customer last replied to this number."},"href":"https:\/\/developers.facebook.com\/docs\/whatsapp\/cloud-api\/support\/error-codes\/"}]}]},"field":"messages"}]}]}
2025-07-02 22:16:22.255 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:16:22.257 +05:30 [INF] Request finished HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 22.562ms
2025-07-02 22:16:22.260 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__messageId_0='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSNzQ1Q0VCNkVBOEIxQkQ4NzdBAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."MessageId" = @__messageId_0
LIMIT 1
2025-07-02 22:16:22.268 +05:30 [WRN] ⚠️ CampaignSendLog not found for MessageId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSNzQ1Q0VCNkVBOEIxQkQ4NzdBAA==
2025-07-02 22:16:22.269 +05:30 [WRN] ⚠️ No matching CampaignSendLog for MessageId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSNzQ1Q0VCNkVBOEIxQkQ4NzdBAA==
2025-07-02 22:16:52.119 +05:30 [INF] Executed endpoint '/hubs/inbox'
2025-07-02 22:16:52.120 +05:30 [INF] Executed endpoint '/hubs/inbox'
2025-07-02 22:16:52.131 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/hubs/inbox?id=Uc7z0DwviA06vFSgw2UXnQ - 101 null null 325258.6499ms
2025-07-02 22:16:52.132 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/hubs/inbox?id=YZ7vaWpf3WjacapF_I8qBQ - 101 null null 325232.262ms
2025-07-02 22:16:52.191 +05:30 [INF] Executed endpoint '/hubs/inbox'
2025-07-02 22:16:52.195 +05:30 [INF] Executed endpoint '/hubs/inbox'
2025-07-02 22:16:52.195 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/hubs/inbox?id=lL2ccQYTBzYjMn03gYjhGg - 101 null null 30412.8224ms
2025-07-02 22:16:52.218 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/hubs/inbox?id=tN092gzjErQJXX1ad2Gh8Q - 101 null null 30372.685ms
2025-07-02 22:20:45.926 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/auth/session - null null
2025-07-02 22:20:45.936 +05:30 [INF] Executing endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 22:20:45.937 +05:30 [INF] Route matched with {action = "GetSession", controller = "Auth"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetSession() on controller xbytechat.api.AuthModule.Controllers.AuthController (xbytechat.api).
2025-07-02 22:20:45.941 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`4[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:20:45.943 +05:30 [INF] Executed action xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api) in 3.03ms
2025-07-02 22:20:45.944 +05:30 [INF] Executed endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 22:20:45.946 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/auth/session - 200 null application/json; charset=utf-8 20.0824ms
2025-07-02 22:20:46.048 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/feature-access/me - null null
2025-07-02 22:20:46.056 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 22:20:46.058 +05:30 [INF] Route matched with {action = "GetMyFeatures", controller = "FeatureAccess"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto]]] GetMyFeatures() on controller xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController (xbytechat.api).
2025-07-02 22:20:46.162 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT b."Id", b."Address", b."ApprovedAt", b."ApprovedBy", b."BusinessEmail", b."BusinessName", b."CompanyName", b."CompanyPhone", b."CreatedAt", b."CreatedBy", b."CreatedByPartnerId", b."DeletedAt", b."DeletedBy", b."Industry", b."IsApproved", b."IsDeleted", b."LastLoginAt", b."LogoUrl", b."Notes", b."Phone", b."RepresentativeName", b."Source", b."Status", b."Tags", b."Website", b0."Id", b0."BusinessId", b0."CreatedAt", b0."Plan", b0."QuotaResetDate", b0."RemainingMessages", b0."TotalMonthlyQuota", b0."UpdatedAt", b0."WalletBalance"
FROM "Businesses" AS b
LEFT JOIN "BusinessPlanInfos" AS b0 ON b."Id" = b0."BusinessId"
WHERE b."Id" = @__businessId_0
LIMIT 1
2025-07-02 22:20:46.165 +05:30 [INF] 📦 Resolved plan for Business "c13be597-6ae2-42bb-9d43-925815f24ff8": Smart
2025-07-02 22:20:46.169 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."BusinessId", f."CreatedAt", f."Description", f."FeatureName", f."Group", f."IsEnabled", f."Notes", f."Plan"
FROM "FeatureAccess" AS f
WHERE f."BusinessId" = @__businessId_0
2025-07-02 22:20:46.172 +05:30 [INF] 🔧 Feature override: AddProduct = False
2025-07-02 22:20:46.173 +05:30 [INF] 🔧 Feature override: Automation = True
2025-07-02 22:20:46.174 +05:30 [INF] 🔧 Feature override: Campaigns = True
2025-07-02 22:20:46.175 +05:30 [INF] 🔧 Feature override: Catalog = True
2025-07-02 22:20:46.176 +05:30 [INF] 🔧 Feature override: CRM = True
2025-07-02 22:20:46.176 +05:30 [INF] 🔧 Feature override: CRMInsights = True
2025-07-02 22:20:46.177 +05:30 [INF] 🔧 Feature override: CTAFlow = True
2025-07-02 22:20:46.179 +05:30 [INF] 🔧 Feature override: FlowInsights = True
2025-07-02 22:20:46.179 +05:30 [INF] 🔧 Feature override: Messaging = True
2025-07-02 22:20:46.180 +05:30 [INF] 🔧 Feature override: ProfileCompletion = True
2025-07-02 22:20:46.181 +05:30 [INF] 🔧 Feature override: UpgradePlan = True
2025-07-02 22:20:46.183 +05:30 [INF] 🔧 Feature override: WhatsAppSettings = True
2025-07-02 22:20:46.185 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 22:20:46.186 +05:30 [INF] Executed action xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api) in 124.97ms
2025-07-02 22:20:46.188 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 22:20:46.190 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/feature-access/me - 200 null application/json; charset=utf-8 141.5362ms
2025-07-02 22:20:48.613 +05:30 [INF] Request starting HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - application/json 550
2025-07-02 22:20:48.616 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:20:48.617 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-07-02 22:20:48.620 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSM0M5MUJBNjhBREQ4QjVEODgzAA==","status":"delivered","timestamp":"1751189904","recipient_id":"917082156227","conversation":{"id":"90b38ee00c6455dcc79733c1fd93f79a","origin":{"type":"service"}},"pricing":{"billable":true,"pricing_model":"CBP","category":"service"}}]},"field":"messages"}]}]}
2025-07-02 22:20:48.622 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-07-02 22:20:48.623 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSM0M5MUJBNjhBREQ4QjVEODgzAA==","status":"delivered","timestamp":"1751189904","recipient_id":"917082156227","conversation":{"id":"90b38ee00c6455dcc79733c1fd93f79a","origin":{"type":"service"}},"pricing":{"billable":true,"pricing_model":"CBP","category":"service"}}]},"field":"messages"}]}]}
2025-07-02 22:20:48.623 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType73`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:20:48.626 +05:30 [INF] 📦 Routing to Status Processor
2025-07-02 22:20:48.628 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 8.0072ms
2025-07-02 22:20:48.631 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:20:48.632 +05:30 [INF] Request finished HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 18.8485ms
2025-07-02 22:20:48.629 +05:30 [WRN] 🔍 Incoming timestamp raw value: {"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSM0M5MUJBNjhBREQ4QjVEODgzAA==","status":"delivered","timestamp":"1751189904","recipient_id":"917082156227","conversation":{"id":"90b38ee00c6455dcc79733c1fd93f79a","origin":{"type":"service"}},"pricing":{"billable":true,"pricing_model":"CBP","category":"service"}}]},"field":"messages"}]}]}
2025-07-02 22:20:48.640 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__messageId_0='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSM0M5MUJBNjhBREQ4QjVEODgzAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."MessageId" = @__messageId_0
LIMIT 1
2025-07-02 22:20:48.644 +05:30 [WRN] ⚠️ CampaignSendLog not found for MessageId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSM0M5MUJBNjhBREQ4QjVEODgzAA==
2025-07-02 22:20:48.646 +05:30 [WRN] ⚠️ No matching CampaignSendLog for MessageId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSM0M5MUJBNjhBREQ4QjVEODgzAA==
2025-07-02 22:21:00.300 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/api/auth/login - null null
2025-07-02 22:21:00.304 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:21:00.305 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/api/auth/login - 204 null null 5.3555ms
2025-07-02 22:21:00.313 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/api/auth/login - application/json 47
2025-07-02 22:21:00.318 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:21:00.319 +05:30 [INF] Executing endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.Login (xbytechat.api)'
2025-07-02 22:21:00.320 +05:30 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(xbytechat.api.AuthModule.DTOs.UserLoginDto) on controller xbytechat.api.AuthModule.Controllers.AuthController (xbytechat.api).
2025-07-02 22:21:00.324 +05:30 [INF] 🔑 Login attempt for email: ratan@tcs.com
2025-07-02 22:21:00.331 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__dto_Email_0='ratan@tcs.com', @__hashedPassword_1='JAvlGPq9JyTdtvBO6x2llnRI1+gxwIyPqCKAn3THIKk='], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."BusinessId", u."CreatedAt", u."DeletedAt", u."Email", u."IsDeleted", u."Name", u."PasswordHash", u."RefreshToken", u."RefreshTokenExpiry", u."RoleId", u."Status", r."Id", r."CreatedAt", r."Description", r."IsActive", r."IsSystemDefined", r."Name"
FROM "Users" AS u
LEFT JOIN "Roles" AS r ON u."RoleId" = r."Id"
WHERE u."Email" = @__dto_Email_0 AND u."PasswordHash" = @__hashedPassword_1 AND NOT (u."IsDeleted")
LIMIT 1
2025-07-02 22:21:00.343 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[@__user_BusinessId_Value_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT b."Id", b."Address", b."ApprovedAt", b."ApprovedBy", b."BusinessEmail", b."BusinessName", b."CompanyName", b."CompanyPhone", b."CreatedAt", b."CreatedBy", b."CreatedByPartnerId", b."DeletedAt", b."DeletedBy", b."Industry", b."IsApproved", b."IsDeleted", b."LastLoginAt", b."LogoUrl", b."Notes", b."Phone", b."RepresentativeName", b."Source", b."Status", b."Tags", b."Website", b0."Id", b0."BusinessId", b0."CreatedAt", b0."Plan", b0."QuotaResetDate", b0."RemainingMessages", b0."TotalMonthlyQuota", b0."UpdatedAt", b0."WalletBalance"
FROM "Businesses" AS b
LEFT JOIN "BusinessPlanInfos" AS b0 ON b."Id" = b0."BusinessId"
WHERE b."Id" = @__user_BusinessId_Value_0
LIMIT 1
2025-07-02 22:21:00.348 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__user_RoleId_0='00000000-0000-0000-0000-000000000004' (Nullable = true)], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."AssignedAt", r."AssignedBy", r."IsActive", r."IsRevoked", r."PermissionId", r."RoleId"
FROM "RolePermissions" AS r
WHERE r."RoleId" = @__user_RoleId_0 AND NOT (r."IsRevoked")
2025-07-02 22:21:00.352 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='2870e1d8-0e80-4b12-88bd-70a8113307d6'], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."AssignedAt", u."AssignedBy", u."IsGranted", u."IsRevoked", u."PermissionId", u."UserId"
FROM "UserPermissions" AS u
WHERE u."UserId" = @__userId_0 AND NOT (u."IsRevoked")
2025-07-02 22:21:00.360 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__permissionIds_0={ '30000000-0000-0000-0000-000000000000', '30000000-0000-0000-0000-000000000004', '30000000-0000-0000-0000-000000000001', '30000000-0000-0000-0000-000000000007' } (DbType = Object)], CommandType='"Text"', CommandTimeout='30']
SELECT p."Id", p."Code", p."CreatedAt", p."Description", p."Group", p."IsActive", p."Name"
FROM "Permissions" AS p
WHERE p."Id" = ANY (@__permissionIds_0)
2025-07-02 22:21:00.363 +05:30 [INF] ✅ Token generated for: ratan@tcs.com
2025-07-02 22:21:00.365 +05:30 [INF] ✅ Login successful for ratan@tcs.com, Role: business, Plan: Smart
2025-07-02 22:21:00.369 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`3[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:21:00.372 +05:30 [INF] Executed action xbytechat.api.AuthModule.Controllers.AuthController.Login (xbytechat.api) in 49.6178ms
2025-07-02 22:21:00.374 +05:30 [INF] Executed endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.Login (xbytechat.api)'
2025-07-02 22:21:00.376 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/api/auth/login - 200 null application/json; charset=utf-8 62.3324ms
2025-07-02 22:21:00.387 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/auth/session - null null
2025-07-02 22:21:00.393 +05:30 [INF] Executing endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 22:21:00.394 +05:30 [INF] Route matched with {action = "GetSession", controller = "Auth"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetSession() on controller xbytechat.api.AuthModule.Controllers.AuthController (xbytechat.api).
2025-07-02 22:21:00.398 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`4[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:21:00.399 +05:30 [INF] Executed action xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api) in 2.7209ms
2025-07-02 22:21:00.401 +05:30 [INF] Executed endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 22:21:00.402 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/auth/session - 200 null application/json; charset=utf-8 14.7781ms
2025-07-02 22:21:00.724 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/feature-access/me - null null
2025-07-02 22:21:00.727 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 22:21:00.729 +05:30 [INF] Route matched with {action = "GetMyFeatures", controller = "FeatureAccess"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto]]] GetMyFeatures() on controller xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController (xbytechat.api).
2025-07-02 22:21:00.734 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT b."Id", b."Address", b."ApprovedAt", b."ApprovedBy", b."BusinessEmail", b."BusinessName", b."CompanyName", b."CompanyPhone", b."CreatedAt", b."CreatedBy", b."CreatedByPartnerId", b."DeletedAt", b."DeletedBy", b."Industry", b."IsApproved", b."IsDeleted", b."LastLoginAt", b."LogoUrl", b."Notes", b."Phone", b."RepresentativeName", b."Source", b."Status", b."Tags", b."Website", b0."Id", b0."BusinessId", b0."CreatedAt", b0."Plan", b0."QuotaResetDate", b0."RemainingMessages", b0."TotalMonthlyQuota", b0."UpdatedAt", b0."WalletBalance"
FROM "Businesses" AS b
LEFT JOIN "BusinessPlanInfos" AS b0 ON b."Id" = b0."BusinessId"
WHERE b."Id" = @__businessId_0
LIMIT 1
2025-07-02 22:21:00.746 +05:30 [INF] 📦 Resolved plan for Business "c13be597-6ae2-42bb-9d43-925815f24ff8": Smart
2025-07-02 22:21:00.750 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."BusinessId", f."CreatedAt", f."Description", f."FeatureName", f."Group", f."IsEnabled", f."Notes", f."Plan"
FROM "FeatureAccess" AS f
WHERE f."BusinessId" = @__businessId_0
2025-07-02 22:21:00.753 +05:30 [INF] 🔧 Feature override: AddProduct = False
2025-07-02 22:21:00.754 +05:30 [INF] 🔧 Feature override: Automation = True
2025-07-02 22:21:00.755 +05:30 [INF] 🔧 Feature override: Campaigns = True
2025-07-02 22:21:00.756 +05:30 [INF] 🔧 Feature override: Catalog = True
2025-07-02 22:21:00.757 +05:30 [INF] 🔧 Feature override: CRM = True
2025-07-02 22:21:00.758 +05:30 [INF] 🔧 Feature override: CRMInsights = True
2025-07-02 22:21:00.759 +05:30 [INF] 🔧 Feature override: CTAFlow = True
2025-07-02 22:21:00.759 +05:30 [INF] 🔧 Feature override: FlowInsights = True
2025-07-02 22:21:00.760 +05:30 [INF] 🔧 Feature override: Messaging = True
2025-07-02 22:21:00.761 +05:30 [INF] 🔧 Feature override: ProfileCompletion = True
2025-07-02 22:21:00.762 +05:30 [INF] 🔧 Feature override: UpgradePlan = True
2025-07-02 22:21:00.762 +05:30 [INF] 🔧 Feature override: WhatsAppSettings = True
2025-07-02 22:21:00.764 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 22:21:00.766 +05:30 [INF] Executed action xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api) in 34.9751ms
2025-07-02 22:21:00.768 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 22:21:00.769 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/feature-access/me - 200 null application/json; charset=utf-8 45.4545ms
2025-07-02 22:21:07.640 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null null
2025-07-02 22:21:07.648 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/inbox/unread-counts - null null
2025-07-02 22:21:07.656 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:21:07.659 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null null
2025-07-02 22:21:07.663 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:21:07.667 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null 0
2025-07-02 22:21:07.668 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:21:07.663 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 204 null null 23.2804ms
2025-07-02 22:21:07.678 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:21:07.675 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Inbox.Controllers.InboxController.GetUnreadCounts (xbytechat.api)'
2025-07-02 22:21:07.680 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 204 null null 20.9331ms
2025-07-02 22:21:07.642 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/contacts - null null
2025-07-02 22:21:07.694 +05:30 [INF] Executing endpoint '/hubs/inbox/negotiate'
2025-07-02 22:21:07.695 +05:30 [INF] Route matched with {action = "GetUnreadCounts", controller = "Inbox"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUnreadCounts() on controller xbytechat.api.Features.Inbox.Controllers.InboxController (xbytechat.api).
2025-07-02 22:21:07.685 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null 0
2025-07-02 22:21:07.704 +05:30 [INF] Executed endpoint '/hubs/inbox/negotiate'
2025-07-02 22:21:07.711 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/hubs/inbox?id=I7l66kYTZxKAAGinDXDI0g - null null
2025-07-02 22:21:07.703 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:21:07.709 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='2870e1d8-0e80-4b12-88bd-70a8113307d6'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."BusinessId", c."ContactId", c."LastReadAt", c."UserId"
FROM "ContactReads" AS c
WHERE c."UserId" = @__userId_0
2025-07-02 22:21:07.712 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:21:07.713 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 200 316 application/json 45.9312ms
2025-07-02 22:21:07.723 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."CreatedAt", m."ErrorMessage", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."IsIncoming" AND m."ContactId" IS NOT NULL
2025-07-02 22:21:07.717 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:21:07.718 +05:30 [INF] Executing endpoint 'xbytechat.api.CRM.Controllers.ContactsController.GetAllContacts (xbytechat.api)'
2025-07-02 22:21:07.723 +05:30 [INF] Executing endpoint '/hubs/inbox/negotiate'
2025-07-02 22:21:07.735 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.Dictionary`2[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:21:07.736 +05:30 [INF] Executing endpoint '/hubs/inbox'
2025-07-02 22:21:07.737 +05:30 [INF] Route matched with {action = "GetAllContacts", controller = "Contacts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllContacts(System.String, Int32, Int32) on controller xbytechat.api.CRM.Controllers.ContactsController (xbytechat.api).
2025-07-02 22:21:07.741 +05:30 [INF] Executed action xbytechat.api.Features.Inbox.Controllers.InboxController.GetUnreadCounts (xbytechat.api) in 34.8799ms
2025-07-02 22:21:07.739 +05:30 [INF] Executed endpoint '/hubs/inbox/negotiate'
2025-07-02 22:21:07.748 +05:30 [INF] GetPagedContactsAsync: businessId="c13be597-6ae2-42bb-9d43-925815f24ff8", tab=all, page=1, pageSize=25
2025-07-02 22:21:07.750 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Inbox.Controllers.InboxController.GetUnreadCounts (xbytechat.api)'
2025-07-02 22:21:07.752 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 200 316 application/json 67.2373ms
2025-07-02 22:21:07.756 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Contacts" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."IsActive"
2025-07-02 22:21:07.756 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/inbox/unread-counts - 200 null application/json; charset=utf-8 107.7675ms
2025-07-02 22:21:07.758 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/hubs/inbox?id=rM0_ap8YUhMEV7YOWgVk6w - null null
2025-07-02 22:21:07.767 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__p_2='25', @__p_1='0'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."AssignedAgentId", t."BusinessId", t."CreatedAt", t."Email", t."Group", t."IsActive", t."IsArchived", t."IsAutomationPaused", t."IsFavorite", t."LastCTAInteraction", t."LastCTAType", t."LastClickedProductId", t."LastContactedAt", t."LeadSource", t."Name", t."NextFollowUpAt", t."Notes", t."PhoneNumber", t."Tags", t0."Id", t0."AssignedAt", t0."AssignedBy", t0."BusinessId", t0."ContactId", t0."TagId", t0."Id0", t0."BusinessId0", t0."Category", t0."ColorHex", t0."CreatedAt", t0."IsActive", t0."IsSystemTag", t0."LastUsedAt", t0."Name", t0."Notes"
FROM (
    SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."Tags"
    FROM "Contacts" AS c
    WHERE c."BusinessId" = @__businessId_0 AND c."IsActive"
    ORDER BY c."Name"
    LIMIT @__p_2 OFFSET @__p_1
) AS t
LEFT JOIN (
    SELECT c0."Id", c0."AssignedAt", c0."AssignedBy", c0."BusinessId", c0."ContactId", c0."TagId", t1."Id" AS "Id0", t1."BusinessId" AS "BusinessId0", t1."Category", t1."ColorHex", t1."CreatedAt", t1."IsActive", t1."IsSystemTag", t1."LastUsedAt", t1."Name", t1."Notes"
    FROM "ContactTags" AS c0
    INNER JOIN "Tags" AS t1 ON c0."TagId" = t1."Id"
) AS t0 ON t."Id" = t0."ContactId"
ORDER BY t."Name", t."Id", t0."Id"
2025-07-02 22:21:07.771 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:21:07.774 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Helpers.ResponseResult'.
2025-07-02 22:21:07.775 +05:30 [INF] Executing endpoint '/hubs/inbox'
2025-07-02 22:21:07.777 +05:30 [INF] Executed action xbytechat.api.CRM.Controllers.ContactsController.GetAllContacts (xbytechat.api) in 28.6448ms
2025-07-02 22:21:07.783 +05:30 [INF] Executed endpoint 'xbytechat.api.CRM.Controllers.ContactsController.GetAllContacts (xbytechat.api)'
2025-07-02 22:21:07.785 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/contacts - 200 null application/json; charset=utf-8 142.5986ms
2025-07-02 22:21:54.718 +05:30 [INF] Request starting HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - application/json 581
2025-07-02 22:21:54.722 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:21:54.723 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-07-02 22:21:54.727 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMTVGNEY4QUYwOURDOUU0NzZEAA==","status":"sent","timestamp":"1751182895","recipient_id":"917082156227","conversation":{"id":"90b38ee00c6455dcc79733c1fd93f79a","expiration_timestamp":"1751269260","origin":{"type":"service"}},"pricing":{"billable":true,"pricing_model":"CBP","category":"service"}}]},"field":"messages"}]}]}
2025-07-02 22:21:54.729 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-07-02 22:21:54.729 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMTVGNEY4QUYwOURDOUU0NzZEAA==","status":"sent","timestamp":"1751182895","recipient_id":"917082156227","conversation":{"id":"90b38ee00c6455dcc79733c1fd93f79a","expiration_timestamp":"1751269260","origin":{"type":"service"}},"pricing":{"billable":true,"pricing_model":"CBP","category":"service"}}]},"field":"messages"}]}]}
2025-07-02 22:21:54.730 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType73`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:21:54.732 +05:30 [INF] 📦 Routing to Status Processor
2025-07-02 22:21:54.733 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 6.9491ms
2025-07-02 22:21:54.734 +05:30 [WRN] 🔍 Incoming timestamp raw value: {"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMTVGNEY4QUYwOURDOUU0NzZEAA==","status":"sent","timestamp":"1751182895","recipient_id":"917082156227","conversation":{"id":"90b38ee00c6455dcc79733c1fd93f79a","expiration_timestamp":"1751269260","origin":{"type":"service"}},"pricing":{"billable":true,"pricing_model":"CBP","category":"service"}}]},"field":"messages"}]}]}
2025-07-02 22:21:54.736 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:21:54.740 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__messageId_0='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMTVGNEY4QUYwOURDOUU0NzZEAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."MessageId" = @__messageId_0
LIMIT 1
2025-07-02 22:21:54.740 +05:30 [INF] Request finished HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 22.0334ms
2025-07-02 22:21:54.744 +05:30 [WRN] ⚠️ CampaignSendLog not found for MessageId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMTVGNEY4QUYwOURDOUU0NzZEAA==
2025-07-02 22:21:54.750 +05:30 [WRN] ⚠️ No matching CampaignSendLog for MessageId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMTVGNEY4QUYwOURDOUU0NzZEAA==
2025-07-02 22:28:07.815 +05:30 [INF] Request starting HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - application/json 715
2025-07-02 22:28:07.820 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:28:07.822 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-07-02 22:28:07.825 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSRDE5QjgxMUI3Q0Q1RjZERkMxAA==","status":"failed","timestamp":"1751181140","recipient_id":"917082156227","errors":[{"code":131047,"title":"Re-engagement message","message":"Re-engagement message","error_data":{"details":"Message failed to send because more than 24 hours have passed since the customer last replied to this number."},"href":"https:\/\/developers.facebook.com\/docs\/whatsapp\/cloud-api\/support\/error-codes\/"}]}]},"field":"messages"}]}]}
2025-07-02 22:28:07.832 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-07-02 22:28:07.833 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSRDE5QjgxMUI3Q0Q1RjZERkMxAA==","status":"failed","timestamp":"1751181140","recipient_id":"917082156227","errors":[{"code":131047,"title":"Re-engagement message","message":"Re-engagement message","error_data":{"details":"Message failed to send because more than 24 hours have passed since the customer last replied to this number."},"href":"https:\/\/developers.facebook.com\/docs\/whatsapp\/cloud-api\/support\/error-codes\/"}]}]},"field":"messages"}]}]}
2025-07-02 22:28:07.834 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType73`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:28:07.836 +05:30 [INF] 📦 Routing to Status Processor
2025-07-02 22:28:07.838 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 13.751ms
2025-07-02 22:28:07.839 +05:30 [WRN] 🔍 Incoming timestamp raw value: {"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSRDE5QjgxMUI3Q0Q1RjZERkMxAA==","status":"failed","timestamp":"1751181140","recipient_id":"917082156227","errors":[{"code":131047,"title":"Re-engagement message","message":"Re-engagement message","error_data":{"details":"Message failed to send because more than 24 hours have passed since the customer last replied to this number."},"href":"https:\/\/developers.facebook.com\/docs\/whatsapp\/cloud-api\/support\/error-codes\/"}]}]},"field":"messages"}]}]}
2025-07-02 22:28:07.841 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:28:07.848 +05:30 [INF] Request finished HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 32.7998ms
2025-07-02 22:28:07.939 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__messageId_0='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSRDE5QjgxMUI3Q0Q1RjZERkMxAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."MessageId" = @__messageId_0
LIMIT 1
2025-07-02 22:28:07.943 +05:30 [WRN] ⚠️ CampaignSendLog not found for MessageId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSRDE5QjgxMUI3Q0Q1RjZERkMxAA==
2025-07-02 22:28:07.944 +05:30 [WRN] ⚠️ No matching CampaignSendLog for MessageId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSRDE5QjgxMUI3Q0Q1RjZERkMxAA==
2025-07-02 22:30:45.500 +05:30 [INF] Request starting HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - application/json 550
2025-07-02 22:30:45.504 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:30:45.505 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-07-02 22:30:45.508 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSQjJGN0NFNzQ3MUJBNTE4QjBGAA==","status":"delivered","timestamp":"1751292639","recipient_id":"917082156227","conversation":{"id":"74e9b5306f97217d0f99f0bc2192b179","origin":{"type":"utility"}},"pricing":{"billable":true,"pricing_model":"CBP","category":"utility"}}]},"field":"messages"}]}]}
2025-07-02 22:30:45.510 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-07-02 22:30:45.511 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSQjJGN0NFNzQ3MUJBNTE4QjBGAA==","status":"delivered","timestamp":"1751292639","recipient_id":"917082156227","conversation":{"id":"74e9b5306f97217d0f99f0bc2192b179","origin":{"type":"utility"}},"pricing":{"billable":true,"pricing_model":"CBP","category":"utility"}}]},"field":"messages"}]}]}
2025-07-02 22:30:45.512 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType73`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:30:45.513 +05:30 [INF] 📦 Routing to Status Processor
2025-07-02 22:30:45.515 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 7.3491ms
2025-07-02 22:30:45.516 +05:30 [WRN] 🔍 Incoming timestamp raw value: {"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSQjJGN0NFNzQ3MUJBNTE4QjBGAA==","status":"delivered","timestamp":"1751292639","recipient_id":"917082156227","conversation":{"id":"74e9b5306f97217d0f99f0bc2192b179","origin":{"type":"utility"}},"pricing":{"billable":true,"pricing_model":"CBP","category":"utility"}}]},"field":"messages"}]}]}
2025-07-02 22:30:45.518 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:30:45.521 +05:30 [INF] Request finished HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 21.1912ms
2025-07-02 22:30:45.523 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__messageId_0='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSQjJGN0NFNzQ3MUJBNTE4QjBGAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."MessageId" = @__messageId_0
LIMIT 1
2025-07-02 22:30:45.532 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__logId_Value_0='bf0a214c-aca2-44a3-a315-bb1e46696b5a'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."Id" = @__logId_Value_0
LIMIT 1
2025-07-02 22:30:45.576 +05:30 [INF] Executed DbCommand (21ms) [Parameters=[@p2='bf0a214c-aca2-44a3-a315-bb1e46696b5a', @p0='2025-06-30T14:10:39.0000000Z' (Nullable = true) (DbType = DateTime), @p1='Delivered'], CommandType='"Text"', CommandTimeout='30']
UPDATE "CampaignSendLogs" SET "DeliveredAt" = @p0, "SendStatus" = @p1
WHERE "Id" = @p2;
2025-07-02 22:30:45.580 +05:30 [INF] ✅ CampaignSendLog updated for MessageId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSQjJGN0NFNzQ3MUJBNTE4QjBGAA== → delivered
2025-07-02 22:32:44.400 +05:30 [INF] Request starting HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - application/json 585
2025-07-02 22:32:44.404 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:32:44.405 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-07-02 22:32:44.408 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMjdGRjU3OTVBNkQzMkM4RUQzAA==","status":"sent","timestamp":"1751293968","recipient_id":"917082156227","conversation":{"id":"641e179b573fb1a0f165124f357270bb","expiration_timestamp":"1751380380","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"CBP","category":"marketing"}}]},"field":"messages"}]}]}
2025-07-02 22:32:44.411 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-07-02 22:32:44.411 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMjdGRjU3OTVBNkQzMkM4RUQzAA==","status":"sent","timestamp":"1751293968","recipient_id":"917082156227","conversation":{"id":"641e179b573fb1a0f165124f357270bb","expiration_timestamp":"1751380380","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"CBP","category":"marketing"}}]},"field":"messages"}]}]}
2025-07-02 22:32:44.412 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType73`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:32:44.414 +05:30 [INF] 📦 Routing to Status Processor
2025-07-02 22:32:44.415 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 7.5016ms
2025-07-02 22:32:44.417 +05:30 [WRN] 🔍 Incoming timestamp raw value: {"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMjdGRjU3OTVBNkQzMkM4RUQzAA==","status":"sent","timestamp":"1751293968","recipient_id":"917082156227","conversation":{"id":"641e179b573fb1a0f165124f357270bb","expiration_timestamp":"1751380380","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"CBP","category":"marketing"}}]},"field":"messages"}]}]}
2025-07-02 22:32:44.418 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:32:44.423 +05:30 [INF] Request finished HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 22.3924ms
2025-07-02 22:32:44.423 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__messageId_0='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMjdGRjU3OTVBNkQzMkM4RUQzAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."MessageId" = @__messageId_0
LIMIT 1
2025-07-02 22:32:44.445 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__logId_Value_0='c9ef0c77-eab2-40c3-8bb3-02a6118b1a4a'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."Id" = @__logId_Value_0
LIMIT 1
2025-07-02 22:32:44.467 +05:30 [INF] Executed DbCommand (18ms) [Parameters=[@p1='c9ef0c77-eab2-40c3-8bb3-02a6118b1a4a', @p0='Sent'], CommandType='"Text"', CommandTimeout='30']
UPDATE "CampaignSendLogs" SET "SendStatus" = @p0
WHERE "Id" = @p1;
2025-07-02 22:32:44.471 +05:30 [INF] ✅ CampaignSendLog updated for MessageId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMjdGRjU3OTVBNkQzMkM4RUQzAA== → sent
2025-07-02 22:33:12.197 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null null
2025-07-02 22:33:12.199 +05:30 [INF] Executed endpoint '/hubs/inbox'
2025-07-02 22:33:12.206 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/inbox/unread-counts - null null
2025-07-02 22:33:12.199 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/contacts/all - null null
2025-07-02 22:33:12.209 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:33:12.211 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/hubs/inbox?id=I7l66kYTZxKAAGinDXDI0g - 101 null null 724499.7433ms
2025-07-02 22:33:12.224 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null 0
2025-07-02 22:33:12.214 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:33:12.219 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 204 null null 22.1309ms
2025-07-02 22:33:12.218 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:33:12.234 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:33:12.236 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Inbox.Controllers.InboxController.GetUnreadCounts (xbytechat.api)'
2025-07-02 22:33:12.242 +05:30 [INF] Executing endpoint 'xbytechat.api.CRM.Controllers.ContactsController.GetContactById (xbytechat.api)'
2025-07-02 22:33:12.243 +05:30 [INF] Executing endpoint '/hubs/inbox/negotiate'
2025-07-02 22:33:12.244 +05:30 [INF] Route matched with {action = "GetUnreadCounts", controller = "Inbox"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUnreadCounts() on controller xbytechat.api.Features.Inbox.Controllers.InboxController (xbytechat.api).
2025-07-02 22:33:12.247 +05:30 [INF] Executed endpoint '/hubs/inbox/negotiate'
2025-07-02 22:33:12.250 +05:30 [INF] Route matched with {action = "GetContactById", controller = "Contacts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetContactById(System.Guid) on controller xbytechat.api.CRM.Controllers.ContactsController (xbytechat.api).
2025-07-02 22:33:12.255 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 200 316 application/json 30.4489ms
2025-07-02 22:33:12.254 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/hubs/inbox?id=s3d7h-NsKHKVkcBuUWlZ5A - null null
2025-07-02 22:33:12.266 +05:30 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-07-02 22:33:12.266 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:33:12.271 +05:30 [INF] Executing endpoint '/hubs/inbox'
2025-07-02 22:33:12.301 +05:30 [INF] Executed action xbytechat.api.CRM.Controllers.ContactsController.GetContactById (xbytechat.api) in 43.0659ms
2025-07-02 22:33:12.304 +05:30 [INF] Executed endpoint 'xbytechat.api.CRM.Controllers.ContactsController.GetContactById (xbytechat.api)'
2025-07-02 22:33:12.306 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/contacts/all - 400 null application/problem+json; charset=utf-8 106.9103ms
2025-07-02 22:33:12.454 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='2870e1d8-0e80-4b12-88bd-70a8113307d6'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."BusinessId", c."ContactId", c."LastReadAt", c."UserId"
FROM "ContactReads" AS c
WHERE c."UserId" = @__userId_0
2025-07-02 22:33:12.460 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."CreatedAt", m."ErrorMessage", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."IsIncoming" AND m."ContactId" IS NOT NULL
2025-07-02 22:33:12.463 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.Dictionary`2[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:33:12.465 +05:30 [INF] Executed action xbytechat.api.Features.Inbox.Controllers.InboxController.GetUnreadCounts (xbytechat.api) in 215.5819ms
2025-07-02 22:33:12.468 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Inbox.Controllers.InboxController.GetUnreadCounts (xbytechat.api)'
2025-07-02 22:33:12.470 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/inbox/unread-counts - 200 null application/json; charset=utf-8 263.7442ms
2025-07-02 22:33:35.283 +05:30 [INF] User profile is available. Using 'C:\Users\sunde\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-07-02 22:33:35.326 +05:30 [INF] 🚀 Webhook Queue Worker started.
2025-07-02 22:33:35.342 +05:30 [INF] 🧹 FailedWebhookLogCleanupService started.
2025-07-02 22:33:36.151 +05:30 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2025-07-02 22:33:36.722 +05:30 [WRN] The query uses the 'First'/'FirstOrDefault' operator without 'OrderBy' and filter operators. This may lead to unpredictable results.
2025-07-02 22:33:36.898 +05:30 [INF] Now listening on: http://localhost:7113
2025-07-02 22:33:36.900 +05:30 [INF] Now listening on: http://localhost:5295
2025-07-02 22:33:36.901 +05:30 [INF] Application started. Press Ctrl+C to shut down.
2025-07-02 22:33:36.902 +05:30 [INF] Hosting environment: Development
2025-07-02 22:33:36.903 +05:30 [INF] Content root path: D:\xbytechat\xbytechat-api\xbytechat-api
2025-07-02 22:33:36.904 +05:30 [INF] Executed DbCommand (27ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."AutoCleanupEnabled", w."LastCleanupAt"
FROM "WebhookSettings" AS w
LIMIT 1
2025-07-02 22:33:36.928 +05:30 [INF] Executed DbCommand (48ms) [Parameters=[@__cutoff_0='2025-06-25T17:03:35.4480367Z' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."CreatedAt", f."ErrorMessage", f."FailureType", f."RawJson", f."SourceModule"
FROM "FailedWebhookLogs" AS f
WHERE f."CreatedAt" < @__cutoff_0
2025-07-02 22:33:36.996 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null null
2025-07-02 22:33:37.016 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null null
2025-07-02 22:33:37.045 +05:30 [WRN] Failed to determine the https port for redirect.
2025-07-02 22:33:37.047 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:33:37.047 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:33:37.053 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 204 null null 62.0286ms
2025-07-02 22:33:37.053 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 204 null null 36.8959ms
2025-07-02 22:33:37.057 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null 0
2025-07-02 22:33:37.057 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null 0
2025-07-02 22:33:37.065 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:33:37.065 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:33:37.269 +05:30 [INF] Executing endpoint '/hubs/inbox/negotiate'
2025-07-02 22:33:37.269 +05:30 [INF] Executing endpoint '/hubs/inbox/negotiate'
2025-07-02 22:33:37.278 +05:30 [INF] Executed endpoint '/hubs/inbox/negotiate'
2025-07-02 22:33:37.278 +05:30 [INF] Executed endpoint '/hubs/inbox/negotiate'
2025-07-02 22:33:37.280 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 200 316 application/json 222.7975ms
2025-07-02 22:33:37.281 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 200 316 application/json 223.6657ms
2025-07-02 22:33:37.282 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/hubs/inbox?id=vZq6HUVcGCz844SlY0ydrg - null null
2025-07-02 22:33:37.292 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:33:37.296 +05:30 [INF] Executing endpoint '/hubs/inbox'
2025-07-02 22:33:37.320 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/hubs/inbox?id=G9WKXsTJyRDGZ1JGRwRFDg - null null
2025-07-02 22:33:37.325 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:33:37.327 +05:30 [INF] Executing endpoint '/hubs/inbox'
2025-07-02 22:33:39.079 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/swagger/index.html - null null
2025-07-02 22:33:39.318 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/swagger/index.html - 200 null text/html;charset=utf-8 239.6155ms
2025-07-02 22:33:39.345 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/_framework/aspnetcore-browser-refresh.js - null null
2025-07-02 22:33:39.358 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/_framework/aspnetcore-browser-refresh.js - 200 13762 application/javascript; charset=utf-8 13.784ms
2025-07-02 22:33:39.465 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/_vs/browserLink - null null
2025-07-02 22:33:39.515 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/_vs/browserLink - 200 null text/javascript; charset=UTF-8 49.9368ms
2025-07-02 22:33:39.801 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/swagger/v1/swagger.json - null null
2025-07-02 22:33:40.057 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 256.1574ms
2025-07-02 22:33:42.882 +05:30 [INF] Executed endpoint '/hubs/inbox'
2025-07-02 22:33:42.882 +05:30 [INF] Executed endpoint '/hubs/inbox'
2025-07-02 22:33:42.887 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/hubs/inbox?id=G9WKXsTJyRDGZ1JGRwRFDg - 101 null null 5566.4405ms
2025-07-02 22:33:42.887 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/hubs/inbox?id=vZq6HUVcGCz844SlY0ydrg - 101 null null 5604.4687ms
2025-07-02 22:33:43.763 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/auth/session - null null
2025-07-02 22:33:43.769 +05:30 [INF] Executing endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 22:33:43.780 +05:30 [INF] Route matched with {action = "GetSession", controller = "Auth"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetSession() on controller xbytechat.api.AuthModule.Controllers.AuthController (xbytechat.api).
2025-07-02 22:33:43.868 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`4[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:33:43.888 +05:30 [INF] Executed action xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api) in 102.8285ms
2025-07-02 22:33:43.891 +05:30 [INF] Executed endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 22:33:43.894 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/auth/session - 200 null application/json; charset=utf-8 130.5862ms
2025-07-02 22:33:43.902 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/feature-access/me - null null
2025-07-02 22:33:43.914 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 22:33:43.920 +05:30 [INF] Route matched with {action = "GetMyFeatures", controller = "FeatureAccess"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto]]] GetMyFeatures() on controller xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController (xbytechat.api).
2025-07-02 22:33:44.010 +05:30 [INF] Executed DbCommand (6ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT b."Id", b."Address", b."ApprovedAt", b."ApprovedBy", b."BusinessEmail", b."BusinessName", b."CompanyName", b."CompanyPhone", b."CreatedAt", b."CreatedBy", b."CreatedByPartnerId", b."DeletedAt", b."DeletedBy", b."Industry", b."IsApproved", b."IsDeleted", b."LastLoginAt", b."LogoUrl", b."Notes", b."Phone", b."RepresentativeName", b."Source", b."Status", b."Tags", b."Website", b0."Id", b0."BusinessId", b0."CreatedAt", b0."Plan", b0."QuotaResetDate", b0."RemainingMessages", b0."TotalMonthlyQuota", b0."UpdatedAt", b0."WalletBalance"
FROM "Businesses" AS b
LEFT JOIN "BusinessPlanInfos" AS b0 ON b."Id" = b0."BusinessId"
WHERE b."Id" = @__businessId_0
LIMIT 1
2025-07-02 22:33:44.173 +05:30 [INF] 📦 Resolved plan for Business "c13be597-6ae2-42bb-9d43-925815f24ff8": Smart
2025-07-02 22:33:44.187 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."BusinessId", f."CreatedAt", f."Description", f."FeatureName", f."Group", f."IsEnabled", f."Notes", f."Plan"
FROM "FeatureAccess" AS f
WHERE f."BusinessId" = @__businessId_0
2025-07-02 22:33:44.215 +05:30 [INF] 🔧 Feature override: AddProduct = False
2025-07-02 22:33:44.216 +05:30 [INF] 🔧 Feature override: Automation = True
2025-07-02 22:33:44.217 +05:30 [INF] 🔧 Feature override: Campaigns = True
2025-07-02 22:33:44.219 +05:30 [INF] 🔧 Feature override: Catalog = True
2025-07-02 22:33:44.220 +05:30 [INF] 🔧 Feature override: CRM = True
2025-07-02 22:33:44.221 +05:30 [INF] 🔧 Feature override: CRMInsights = True
2025-07-02 22:33:44.222 +05:30 [INF] 🔧 Feature override: CTAFlow = True
2025-07-02 22:33:44.223 +05:30 [INF] 🔧 Feature override: FlowInsights = True
2025-07-02 22:33:44.223 +05:30 [INF] 🔧 Feature override: Messaging = True
2025-07-02 22:33:44.224 +05:30 [INF] 🔧 Feature override: ProfileCompletion = True
2025-07-02 22:33:44.225 +05:30 [INF] 🔧 Feature override: UpgradePlan = True
2025-07-02 22:33:44.226 +05:30 [INF] 🔧 Feature override: WhatsAppSettings = True
2025-07-02 22:33:44.233 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 22:33:44.245 +05:30 [INF] Executed action xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api) in 322.416ms
2025-07-02 22:33:44.247 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 22:33:44.251 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/feature-access/me - 200 null application/json; charset=utf-8 348.8683ms
2025-07-02 22:33:44.303 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null null
2025-07-02 22:33:44.305 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/contacts/all - null null
2025-07-02 22:33:44.305 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/inbox/unread-counts - null null
2025-07-02 22:33:44.308 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:33:44.311 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:33:44.314 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:33:44.317 +05:30 [INF] Executing endpoint 'xbytechat.api.CRM.Controllers.ContactsController.GetAllContactsFlat (xbytechat.api)'
2025-07-02 22:33:44.315 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 204 null null 12.3356ms
2025-07-02 22:33:44.315 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null null
2025-07-02 22:33:44.318 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null 0
2025-07-02 22:33:44.318 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Inbox.Controllers.InboxController.GetUnreadCounts (xbytechat.api)'
2025-07-02 22:33:44.324 +05:30 [INF] Route matched with {action = "GetAllContactsFlat", controller = "Contacts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllContactsFlat() on controller xbytechat.api.CRM.Controllers.ContactsController (xbytechat.api).
2025-07-02 22:33:44.327 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:33:44.339 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:33:44.347 +05:30 [INF] Route matched with {action = "GetUnreadCounts", controller = "Inbox"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUnreadCounts() on controller xbytechat.api.Features.Inbox.Controllers.InboxController (xbytechat.api).
2025-07-02 22:33:47.462 +05:30 [INF] Executing endpoint '/hubs/inbox/negotiate'
2025-07-02 22:33:48.119 +05:30 [INF] Executed endpoint '/hubs/inbox/negotiate'
2025-07-02 22:33:48.116 +05:30 [INF] GetAllContactsAsync: businessId="c13be597-6ae2-42bb-9d43-925815f24ff8", tab=all
2025-07-02 22:33:47.448 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null 0
2025-07-02 22:33:48.135 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 200 316 application/json 3816.6673ms
2025-07-02 22:33:48.153 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:33:48.145 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[@__userId_0='2870e1d8-0e80-4b12-88bd-70a8113307d6'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."BusinessId", c."ContactId", c."LastReadAt", c."UserId"
FROM "ContactReads" AS c
WHERE c."UserId" = @__userId_0
2025-07-02 22:33:48.133 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/hubs/inbox?id=UIj4igoj2lj8f7mKzbVSrw - null null
2025-07-02 22:33:44.349 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 204 null null 34.6264ms
2025-07-02 22:33:48.162 +05:30 [INF] Executing endpoint '/hubs/inbox/negotiate'
2025-07-02 22:33:48.168 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:33:48.175 +05:30 [INF] Executed endpoint '/hubs/inbox/negotiate'
2025-07-02 22:33:48.177 +05:30 [INF] Executing endpoint '/hubs/inbox'
2025-07-02 22:33:48.180 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 200 316 application/json 733.3181ms
2025-07-02 22:33:48.197 +05:30 [INF] Executed DbCommand (5ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."CreatedAt", m."ErrorMessage", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."IsIncoming" AND m."ContactId" IS NOT NULL
2025-07-02 22:33:48.197 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/hubs/inbox?id=Oj6c5WENvQlhJXy_ZbWYCg - null null
2025-07-02 22:33:48.205 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:33:48.208 +05:30 [INF] Executing endpoint '/hubs/inbox'
2025-07-02 22:33:48.272 +05:30 [INF] Executed DbCommand (31ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."Tags", t0."Id", t0."AssignedAt", t0."AssignedBy", t0."BusinessId", t0."ContactId", t0."TagId", t0."Id0", t0."BusinessId0", t0."Category", t0."ColorHex", t0."CreatedAt", t0."IsActive", t0."IsSystemTag", t0."LastUsedAt", t0."Name", t0."Notes"
FROM "Contacts" AS c
LEFT JOIN (
    SELECT c0."Id", c0."AssignedAt", c0."AssignedBy", c0."BusinessId", c0."ContactId", c0."TagId", t."Id" AS "Id0", t."BusinessId" AS "BusinessId0", t."Category", t."ColorHex", t."CreatedAt", t."IsActive", t."IsSystemTag", t."LastUsedAt", t."Name", t."Notes"
    FROM "ContactTags" AS c0
    INNER JOIN "Tags" AS t ON c0."TagId" = t."Id"
) AS t0 ON c."Id" = t0."ContactId"
WHERE c."BusinessId" = @__businessId_0 AND c."IsActive"
ORDER BY c."Id", t0."Id"
2025-07-02 22:33:48.299 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.Dictionary`2[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:33:48.307 +05:30 [INF] Executed action xbytechat.api.Features.Inbox.Controllers.InboxController.GetUnreadCounts (xbytechat.api) in 193.2516ms
2025-07-02 22:33:48.310 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Inbox.Controllers.InboxController.GetUnreadCounts (xbytechat.api)'
2025-07-02 22:33:48.312 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/inbox/unread-counts - 200 null application/json; charset=utf-8 4007.4336ms
2025-07-02 22:33:48.372 +05:30 [INF] GetAllContactsAsync returned 6 contacts
2025-07-02 22:33:51.126 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+SelectListIterator`2[[xbytechat.api.CRM.Models.Contact, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[xbytechat.api.CRM.Dtos.ContactDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 22:33:51.160 +05:30 [INF] Executed action xbytechat.api.CRM.Controllers.ContactsController.GetAllContactsFlat (xbytechat.api) in 6816.6516ms
2025-07-02 22:33:51.162 +05:30 [INF] Executed endpoint 'xbytechat.api.CRM.Controllers.ContactsController.GetAllContactsFlat (xbytechat.api)'
2025-07-02 22:33:51.163 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/contacts/all - 200 null application/json; charset=utf-8 6858.7357ms
2025-07-02 22:33:53.696 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/api/inbox/mark-read?contactId=0876f654-a362-420f-a912-6bce793436a5 - null 0
2025-07-02 22:33:53.708 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:33:53.708 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/contacts/0876f654-a362-420f-a912-6bce793436a5 - null null
2025-07-02 22:33:53.708 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/inbox/messages?contactId=0876f654-a362-420f-a912-6bce793436a5 - null null
2025-07-02 22:33:53.710 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Inbox.Controllers.InboxController.MarkMessagesAsRead (xbytechat.api)'
2025-07-02 22:33:53.715 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:33:53.716 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:33:53.720 +05:30 [INF] Executing endpoint 'xbytechat.api.CRM.Controllers.ContactsController.GetContactById (xbytechat.api)'
2025-07-02 22:33:53.720 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Inbox.Controllers.InboxController.GetMessagesByContact (xbytechat.api)'
2025-07-02 22:33:53.731 +05:30 [INF] Route matched with {action = "MarkMessagesAsRead", controller = "Inbox"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MarkMessagesAsRead(System.Guid) on controller xbytechat.api.Features.Inbox.Controllers.InboxController (xbytechat.api).
2025-07-02 22:33:53.731 +05:30 [INF] Route matched with {action = "GetContactById", controller = "Contacts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetContactById(System.Guid) on controller xbytechat.api.CRM.Controllers.ContactsController (xbytechat.api).
2025-07-02 22:33:53.731 +05:30 [INF] Route matched with {action = "GetMessagesByContact", controller = "Inbox"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesByContact(System.Guid) on controller xbytechat.api.Features.Inbox.Controllers.InboxController (xbytechat.api).
2025-07-02 22:33:55.628 +05:30 [INF] GetContactByIdAsync: businessId="c13be597-6ae2-42bb-9d43-925815f24ff8", contactId="0876f654-a362-420f-a912-6bce793436a5"
2025-07-02 22:33:55.649 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__contactId_1='0876f654-a362-420f-a912-6bce793436a5' (Nullable = true)], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."CreatedAt", m."ErrorMessage", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."ContactId" = @__contactId_1 AND m."IsIncoming" AND m."Status" <> 'Read'
2025-07-02 22:33:55.660 +05:30 [INF] Executed DbCommand (5ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__contactId_1='0876f654-a362-420f-a912-6bce793436a5' (Nullable = true)], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."CreatedAt", m."ErrorMessage", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."SentAt", m."Source", m."Status", c."Id", c."BusinessId", c."CampaignId", c."CampaignType", c."CreatedAt", c."CreatedBy", c."CtaId", c."DeletedAt", c."DeletedBy", c."FollowUpTemplateId", c."ImageCaption", c."ImageUrl", c."IsDeleted", c."MessageBody", c."MessageTemplate", c."Name", c."ScheduledAt", c."SourceCampaignId", c."Status", c."TemplateId", c."TemplateParameters", c."UpdatedAt"
FROM "MessageLogs" AS m
LEFT JOIN "Campaigns" AS c ON m."CampaignId" = c."Id"
WHERE m."BusinessId" = @__businessId_0 AND m."ContactId" = @__contactId_1
ORDER BY m."CreatedAt"
2025-07-02 22:33:55.671 +05:30 [INF] Executed DbCommand (5ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__contactId_1='0876f654-a362-420f-a912-6bce793436a5'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."AssignedAgentId", t."BusinessId", t."CreatedAt", t."Email", t."Group", t."IsActive", t."IsArchived", t."IsAutomationPaused", t."IsFavorite", t."LastCTAInteraction", t."LastCTAType", t."LastClickedProductId", t."LastContactedAt", t."LeadSource", t."Name", t."NextFollowUpAt", t."Notes", t."PhoneNumber", t."Tags", t0."Id", t0."AssignedAt", t0."AssignedBy", t0."BusinessId", t0."ContactId", t0."TagId", t0."Id0", t0."BusinessId0", t0."Category", t0."ColorHex", t0."CreatedAt", t0."IsActive", t0."IsSystemTag", t0."LastUsedAt", t0."Name", t0."Notes"
FROM (
    SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."Tags"
    FROM "Contacts" AS c
    WHERE c."BusinessId" = @__businessId_0 AND c."Id" = @__contactId_1 AND c."IsActive"
    LIMIT 1
) AS t
LEFT JOIN (
    SELECT c0."Id", c0."AssignedAt", c0."AssignedBy", c0."BusinessId", c0."ContactId", c0."TagId", t1."Id" AS "Id0", t1."BusinessId" AS "BusinessId0", t1."Category", t1."ColorHex", t1."CreatedAt", t1."IsActive", t1."IsSystemTag", t1."LastUsedAt", t1."Name", t1."Notes"
    FROM "ContactTags" AS c0
    INNER JOIN "Tags" AS t1 ON c0."TagId" = t1."Id"
) AS t0 ON t."Id" = t0."ContactId"
ORDER BY t."Id", t0."Id"
2025-07-02 22:33:55.686 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Helpers.ResponseResult'.
2025-07-02 22:33:55.704 +05:30 [INF] Executed action xbytechat.api.CRM.Controllers.ContactsController.GetContactById (xbytechat.api) in 1966.2312ms
2025-07-02 22:33:55.706 +05:30 [INF] Executed endpoint 'xbytechat.api.CRM.Controllers.ContactsController.GetContactById (xbytechat.api)'
2025-07-02 22:33:55.707 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/contacts/0876f654-a362-420f-a912-6bce793436a5 - null null
2025-07-02 22:33:55.708 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/contacts/0876f654-a362-420f-a912-6bce793436a5 - 200 null application/json; charset=utf-8 2000.5095ms
2025-07-02 22:33:55.709 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.MessageManagement.DTOs.MessageLogDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 22:33:55.711 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:33:55.721 +05:30 [INF] Executing endpoint 'xbytechat.api.CRM.Controllers.ContactsController.GetContactById (xbytechat.api)'
2025-07-02 22:33:55.722 +05:30 [INF] Route matched with {action = "GetContactById", controller = "Contacts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetContactById(System.Guid) on controller xbytechat.api.CRM.Controllers.ContactsController (xbytechat.api).
2025-07-02 22:33:57.685 +05:30 [INF] GetContactByIdAsync: businessId="c13be597-6ae2-42bb-9d43-925815f24ff8", contactId="0876f654-a362-420f-a912-6bce793436a5"
2025-07-02 22:33:57.698 +05:30 [INF] Executed DbCommand (5ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__contactId_1='0876f654-a362-420f-a912-6bce793436a5'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."AssignedAgentId", t."BusinessId", t."CreatedAt", t."Email", t."Group", t."IsActive", t."IsArchived", t."IsAutomationPaused", t."IsFavorite", t."LastCTAInteraction", t."LastCTAType", t."LastClickedProductId", t."LastContactedAt", t."LeadSource", t."Name", t."NextFollowUpAt", t."Notes", t."PhoneNumber", t."Tags", t0."Id", t0."AssignedAt", t0."AssignedBy", t0."BusinessId", t0."ContactId", t0."TagId", t0."Id0", t0."BusinessId0", t0."Category", t0."ColorHex", t0."CreatedAt", t0."IsActive", t0."IsSystemTag", t0."LastUsedAt", t0."Name", t0."Notes"
FROM (
    SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."Tags"
    FROM "Contacts" AS c
    WHERE c."BusinessId" = @__businessId_0 AND c."Id" = @__contactId_1 AND c."IsActive"
    LIMIT 1
) AS t
LEFT JOIN (
    SELECT c0."Id", c0."AssignedAt", c0."AssignedBy", c0."BusinessId", c0."ContactId", c0."TagId", t1."Id" AS "Id0", t1."BusinessId" AS "BusinessId0", t1."Category", t1."ColorHex", t1."CreatedAt", t1."IsActive", t1."IsSystemTag", t1."LastUsedAt", t1."Name", t1."Notes"
    FROM "ContactTags" AS c0
    INNER JOIN "Tags" AS t1 ON c0."TagId" = t1."Id"
) AS t0 ON t."Id" = t0."ContactId"
ORDER BY t."Id", t0."Id"
2025-07-02 22:33:57.701 +05:30 [INF] Executed action xbytechat.api.Features.Inbox.Controllers.InboxController.GetMessagesByContact (xbytechat.api) in 3961.0835ms
2025-07-02 22:33:57.703 +05:30 [INF] Executed DbCommand (5ms) [Parameters=[@__contactId_0='0876f654-a362-420f-a912-6bce793436a5', @__userGuid_1='2870e1d8-0e80-4b12-88bd-70a8113307d6'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."BusinessId", c."ContactId", c."LastReadAt", c."UserId"
FROM "ContactReads" AS c
WHERE c."ContactId" = @__contactId_0 AND c."UserId" = @__userGuid_1
LIMIT 1
2025-07-02 22:33:57.707 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Helpers.ResponseResult'.
2025-07-02 22:33:57.708 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Inbox.Controllers.InboxController.GetMessagesByContact (xbytechat.api)'
2025-07-02 22:33:57.714 +05:30 [INF] Executed action xbytechat.api.CRM.Controllers.ContactsController.GetContactById (xbytechat.api) in 1987.5355ms
2025-07-02 22:33:57.716 +05:30 [INF] Executed endpoint 'xbytechat.api.CRM.Controllers.ContactsController.GetContactById (xbytechat.api)'
2025-07-02 22:33:57.716 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/inbox/messages?contactId=0876f654-a362-420f-a912-6bce793436a5 - 200 null application/json; charset=utf-8 4007.5628ms
2025-07-02 22:33:57.717 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/contacts/0876f654-a362-420f-a912-6bce793436a5 - 200 null application/json; charset=utf-8 2010.9847ms
2025-07-02 22:33:57.800 +05:30 [INF] Executed DbCommand (23ms) [Parameters=[@p0='d225a11a-5dab-4768-baad-6036616eabad', @p1='c13be597-6ae2-42bb-9d43-925815f24ff8', @p2='0876f654-a362-420f-a912-6bce793436a5', @p3='2025-07-02T17:03:55.6663814Z' (DbType = DateTime), @p4='2870e1d8-0e80-4b12-88bd-70a8113307d6'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "ContactReads" ("Id", "BusinessId", "ContactId", "LastReadAt", "UserId")
VALUES (@p0, @p1, @p2, @p3, @p4);
2025-07-02 22:33:57.811 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[@p1='2a629ad2-f777-4f7a-b689-9535125b2b65', @p0='Read' (Nullable = false), @p3='81ecbb0f-eec2-43d6-b26a-4be2b3930a21', @p2='Read' (Nullable = false), @p5='b45504f9-cc57-4644-80c1-bdf70bbc64eb', @p4='Read' (Nullable = false), @p7='e07469e1-4aaf-4e03-b5c1-557c4f9bb3cf', @p6='Read' (Nullable = false)], CommandType='"Text"', CommandTimeout='30']
UPDATE "MessageLogs" SET "Status" = @p0
WHERE "Id" = @p1;
UPDATE "MessageLogs" SET "Status" = @p2
WHERE "Id" = @p3;
UPDATE "MessageLogs" SET "Status" = @p4
WHERE "Id" = @p5;
UPDATE "MessageLogs" SET "Status" = @p6
WHERE "Id" = @p7;
2025-07-02 22:33:57.822 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessGuid_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."CreatedAt", m."ErrorMessage", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessGuid_0 AND m."IsIncoming" AND m."ContactId" IS NOT NULL
2025-07-02 22:33:57.834 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__userGuid_0='2870e1d8-0e80-4b12-88bd-70a8113307d6'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."BusinessId", c."ContactId", c."LastReadAt", c."UserId"
FROM "ContactReads" AS c
WHERE c."UserId" = @__userGuid_0
2025-07-02 22:33:57.840 +05:30 [INF] Executing StatusCodeResult, setting HTTP status code 200
2025-07-02 22:33:57.841 +05:30 [INF] Executed action xbytechat.api.Features.Inbox.Controllers.InboxController.MarkMessagesAsRead (xbytechat.api) in 4108.2783ms
2025-07-02 22:33:57.843 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Inbox.Controllers.InboxController.MarkMessagesAsRead (xbytechat.api)'
2025-07-02 22:33:57.845 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/api/inbox/mark-read?contactId=0876f654-a362-420f-a912-6bce793436a5 - 200 0 null 4149.351ms
2025-07-02 22:34:12.573 +05:30 [INF] Request starting HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - application/json 491
2025-07-02 22:34:12.577 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:34:12.582 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-07-02 22:34:12.598 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"contacts":[{"profile":{"name":"\ua9c1S.K\ua9c2"},"wa_id":"917082156227"}],"messages":[{"from":"917082156227","id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAEhggNDQxMzc2QzVGNjRBNTdBMEJGOTY2MDcyNTMzRjFGMDUA","timestamp":"1751475855","text":{"body":"Hi"},"type":"text"}]},"field":"messages"}]}]}
2025-07-02 22:34:12.602 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-07-02 22:34:12.604 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType73`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:34:12.607 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 21.8013ms
2025-07-02 22:34:12.609 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:34:12.611 +05:30 [INF] Request finished HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 38.8176ms
2025-07-02 22:34:12.763 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"contacts":[{"profile":{"name":"\ua9c1S.K\ua9c2"},"wa_id":"917082156227"}],"messages":[{"from":"917082156227","id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAEhggNDQxMzc2QzVGNjRBNTdBMEJGOTY2MDcyNTMzRjFGMDUA","timestamp":"1751475855","text":{"body":"Hi"},"type":"text"}]},"field":"messages"}]}]}
2025-07-02 22:34:12.767 +05:30 [INF] 💬 Routing to InboundMessageProcessor (type: text)
2025-07-02 22:34:12.790 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[@__businessNumber_0='15556395845'], CommandType='"Text"', CommandTimeout='30']
SELECT b."Id", b."Address", b."ApprovedAt", b."ApprovedBy", b."BusinessEmail", b."BusinessName", b."CompanyName", b."CompanyPhone", b."CreatedAt", b."CreatedBy", b."CreatedByPartnerId", b."DeletedAt", b."DeletedBy", b."Industry", b."IsApproved", b."IsDeleted", b."LastLoginAt", b."LogoUrl", b."Notes", b."Phone", b."RepresentativeName", b."Source", b."Status", b."Tags", b."Website", w."Id", w."ApiToken", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WhatsAppBusinessNumber"
FROM "Businesses" AS b
LEFT JOIN "WhatsAppSettings" AS w ON b."Id" = w."BusinessId"
WHERE w."WhatsAppBusinessNumber" = @__businessNumber_0
LIMIT 1
2025-07-02 22:34:12.816 +05:30 [INF] FindOrCreateAsync: businessId="c13be597-6ae2-42bb-9d43-925815f24ff8", phoneNumber=917082156227
2025-07-02 22:34:12.827 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__phoneNumber_1='917082156227'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."Tags"
FROM "Contacts" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."PhoneNumber" = @__phoneNumber_1
LIMIT 1
2025-07-02 22:34:12.831 +05:30 [INF] Contact already exists: contactId="0876f654-a362-420f-a912-6bce793436a5"
2025-07-02 22:34:12.844 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__contactId_1='0876f654-a362-420f-a912-6bce793436a5'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."BusinessId", c."ContactId", c."LastUpdatedAt", c."Mode", c."UpdatedBy"
FROM "ChatSessionStates" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."ContactId" = @__contactId_1
LIMIT 1
2025-07-02 22:34:12.920 +05:30 [INF] Executed DbCommand (11ms) [Parameters=[@p0='07608e63-26d7-46ba-956e-24a4157fd677', @p1='c13be597-6ae2-42bb-9d43-925815f24ff8', @p2=NULL (DbType = Guid), @p3=NULL (DbType = Guid), @p4=NULL (DbType = Guid), @p5='0876f654-a362-420f-a912-6bce793436a5' (Nullable = true), @p6='2025-07-02T17:04:12.8491897Z' (DbType = DateTime), @p7=NULL, @p8='True', @p9=NULL, @p10='Hi' (Nullable = false), @p11=NULL, @p12=NULL, @p13='917082156227' (Nullable = false), @p14=NULL (DbType = Guid), @p15=NULL, @p16='2025-07-02T17:04:12.8492803Z' (Nullable = true) (DbType = DateTime), @p17=NULL, @p18='received' (Nullable = false)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "MessageLogs" ("Id", "BusinessId", "CTAFlowConfigId", "CTAFlowStepId", "CampaignId", "ContactId", "CreatedAt", "ErrorMessage", "IsIncoming", "MediaUrl", "MessageContent", "MessageId", "RawResponse", "RecipientNumber", "RefMessageId", "RenderedBody", "SentAt", "Source", "Status")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
2025-07-02 22:34:13.000 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."BusinessId", a."CreatedAt", a."FlowId", a."FlowName", a."IsActive", a."MediaUrl", a."Priority", a."ReplyMessage", a."TriggerKeyword", a."UpdatedAt"
FROM "AutoReplyRules" AS a
WHERE a."BusinessId" = @__businessId_0 AND a."IsActive"
2025-07-02 22:34:13.004 +05:30 [INF] 🔍 No flow match found or FlowId is null. Trying fallback auto-reply...
2025-07-02 22:34:13.025 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__incomingMessage_1='Hi'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."BusinessId", a."CreatedAt", a."FlowId", a."FlowName", a."IsActive", a."MediaUrl", a."Priority", a."ReplyMessage", a."TriggerKeyword", a."UpdatedAt"
FROM "AutoReplyRules" AS a
WHERE a."BusinessId" = @__businessId_0 AND a."IsActive" AND strpos(@__incomingMessage_1, a."TriggerKeyword") > 0
ORDER BY a."Priority"
LIMIT 1
2025-07-02 22:34:13.028 +05:30 [INF] ❌ No fallback rule matched for: Hi
2025-07-02 22:34:16.033 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@p0='0ee3d9f0-40f5-4483-a9b9-df2b2c93bc8a', @p1='c13be597-6ae2-42bb-9d43-925815f24ff8', @p2=NULL (DbType = Guid), @p3=NULL (DbType = Guid), @p4=NULL (DbType = Guid), @p5='0876f654-a362-420f-a912-6bce793436a5' (Nullable = true), @p6='2025-07-02T17:04:16.0136898Z' (DbType = DateTime), @p7=NULL, @p8='True', @p9=NULL, @p10='Hi' (Nullable = false), @p11=NULL, @p12=NULL, @p13='917082156227' (Nullable = false), @p14=NULL (DbType = Guid), @p15=NULL, @p16=NULL (DbType = DateTime), @p17=NULL, @p18='Queued' (Nullable = false)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "MessageLogs" ("Id", "BusinessId", "CTAFlowConfigId", "CTAFlowStepId", "CampaignId", "ContactId", "CreatedAt", "ErrorMessage", "IsIncoming", "MediaUrl", "MessageContent", "MessageId", "RawResponse", "RecipientNumber", "RefMessageId", "RenderedBody", "SentAt", "Source", "Status")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
2025-07-02 22:34:25.234 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__dto_ContactId_1='0876f654-a362-420f-a912-6bce793436a5'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."Tags"
FROM "Contacts" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."Id" = @__dto_ContactId_1
LIMIT 1
2025-07-02 22:34:25.280 +05:30 [INF] FindOrCreateAsync: businessId="c13be597-6ae2-42bb-9d43-925815f24ff8", phoneNumber=917082156227
2025-07-02 22:34:25.286 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__phoneNumber_1='917082156227'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."Tags"
FROM "Contacts" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."PhoneNumber" = @__phoneNumber_1
LIMIT 1
2025-07-02 22:34:25.289 +05:30 [INF] Contact already exists: contactId="0876f654-a362-420f-a912-6bce793436a5"
2025-07-02 22:34:25.463 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT b."Id", b."Address", b."ApprovedAt", b."ApprovedBy", b."BusinessEmail", b."BusinessName", b."CompanyName", b."CompanyPhone", b."CreatedAt", b."CreatedBy", b."CreatedByPartnerId", b."DeletedAt", b."DeletedBy", b."Industry", b."IsApproved", b."IsDeleted", b."LastLoginAt", b."LogoUrl", b."Notes", b."Phone", b."RepresentativeName", b."Source", b."Status", b."Tags", b."Website", w."Id", w."ApiToken", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WhatsAppBusinessNumber"
FROM "Businesses" AS b
LEFT JOIN "WhatsAppSettings" AS w ON b."Id" = w."BusinessId"
WHERE b."Id" = @__businessId_0
LIMIT 1
2025-07-02 22:34:25.473 +05:30 [INF] Start processing HTTP request POST https://graph.facebook.com/v22.0/601884673011340/messages
2025-07-02 22:34:25.478 +05:30 [INF] Sending HTTP request POST https://graph.facebook.com/v22.0/601884673011340/messages
2025-07-02 22:34:27.323 +05:30 [INF] Received HTTP response headers after 1840.0773ms - 200
2025-07-02 22:34:27.326 +05:30 [INF] End processing HTTP request after 1855.2041ms - 200
2025-07-02 22:34:27.490 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@p0='dce8fdde-672c-4b53-8d85-64079d7882cc', @p1='c13be597-6ae2-42bb-9d43-925815f24ff8', @p2=NULL (DbType = Guid), @p3=NULL (DbType = Guid), @p4=NULL (DbType = Guid), @p5='0876f654-a362-420f-a912-6bce793436a5' (Nullable = true), @p6='2025-07-02T17:04:27.4850933Z' (DbType = DateTime), @p7=NULL, @p8='False', @p9=NULL, @p10='hi' (Nullable = false), @p11='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSN0ExMjRFQTdBMEY1MkFBQTMxAA==', @p12='{"Success":true,"Message":"✅ Message sent successfully","Data":null,"ErrorMessage":null,"RawResponse":"{\"messaging_product\":\"whatsapp\",\"contacts\":[{\"input\":\"917082156227\",\"wa_id\":\"917082156227\"}],\"messages\":[{\"id\":\"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSN0ExMjRFQTdBMEY1MkFBQTMxAA==\"}]}","MessageId":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSN0ExMjRFQTdBMEY1MkFBQTMxAA==","LogId":null,"Token":null,"RefreshToken":null}', @p13='917082156227' (Nullable = false), @p14=NULL (DbType = Guid), @p15='hi', @p16='2025-07-02T17:04:27.4850937Z' (Nullable = true) (DbType = DateTime), @p17=NULL, @p18='Sent' (Nullable = false)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "MessageLogs" ("Id", "BusinessId", "CTAFlowConfigId", "CTAFlowStepId", "CampaignId", "ContactId", "CreatedAt", "ErrorMessage", "IsIncoming", "MediaUrl", "MessageContent", "MessageId", "RawResponse", "RecipientNumber", "RefMessageId", "RenderedBody", "SentAt", "Source", "Status")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
2025-07-02 22:34:28.234 +05:30 [INF] Request starting HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - application/json 613
2025-07-02 22:34:28.240 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:34:28.242 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-07-02 22:34:28.247 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSN0ExMjRFQTdBMEY1MkFBQTMxAA==","status":"sent","timestamp":"1751475871","recipient_id":"917082156227","conversation":{"id":"5492429c32e12ebf809dd9318bdcb7c2","expiration_timestamp":"1751475871","origin":{"type":"service"}},"pricing":{"billable":false,"pricing_model":"PMP","category":"service","type":"free_customer_service"}}]},"field":"messages"}]}]}
2025-07-02 22:34:28.249 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-07-02 22:34:28.251 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType73`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:34:28.252 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSN0ExMjRFQTdBMEY1MkFBQTMxAA==","status":"sent","timestamp":"1751475871","recipient_id":"917082156227","conversation":{"id":"5492429c32e12ebf809dd9318bdcb7c2","expiration_timestamp":"1751475871","origin":{"type":"service"}},"pricing":{"billable":false,"pricing_model":"PMP","category":"service","type":"free_customer_service"}}]},"field":"messages"}]}]}
2025-07-02 22:34:28.253 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 7.9552ms
2025-07-02 22:34:28.258 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:34:28.255 +05:30 [INF] 📦 Routing to Status Processor
2025-07-02 22:34:28.259 +05:30 [INF] Request finished HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 25.2076ms
2025-07-02 22:34:28.262 +05:30 [WRN] 🔍 Incoming timestamp raw value: {"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSN0ExMjRFQTdBMEY1MkFBQTMxAA==","status":"sent","timestamp":"1751475871","recipient_id":"917082156227","conversation":{"id":"5492429c32e12ebf809dd9318bdcb7c2","expiration_timestamp":"1751475871","origin":{"type":"service"}},"pricing":{"billable":false,"pricing_model":"PMP","category":"service","type":"free_customer_service"}}]},"field":"messages"}]}]}
2025-07-02 22:34:28.282 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__messageId_0='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSN0ExMjRFQTdBMEY1MkFBQTMxAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."MessageId" = @__messageId_0
LIMIT 1
2025-07-02 22:34:28.288 +05:30 [WRN] ⚠️ CampaignSendLog not found for MessageId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSN0ExMjRFQTdBMEY1MkFBQTMxAA==
2025-07-02 22:34:28.290 +05:30 [WRN] ⚠️ No matching CampaignSendLog for MessageId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSN0ExMjRFQTdBMEY1MkFBQTMxAA==
2025-07-02 22:34:28.746 +05:30 [INF] Request starting HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - application/json 582
2025-07-02 22:34:28.752 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:34:28.753 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-07-02 22:34:28.759 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSN0ExMjRFQTdBMEY1MkFBQTMxAA==","status":"delivered","timestamp":"1751475872","recipient_id":"917082156227","conversation":{"id":"5492429c32e12ebf809dd9318bdcb7c2","origin":{"type":"service"}},"pricing":{"billable":false,"pricing_model":"PMP","category":"service","type":"free_customer_service"}}]},"field":"messages"}]}]}
2025-07-02 22:34:28.761 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-07-02 22:34:28.762 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType73`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:34:28.764 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 7.8942ms
2025-07-02 22:34:28.767 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:34:28.768 +05:30 [INF] Request finished HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 21.7899ms
2025-07-02 22:34:28.769 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSN0ExMjRFQTdBMEY1MkFBQTMxAA==","status":"delivered","timestamp":"1751475872","recipient_id":"917082156227","conversation":{"id":"5492429c32e12ebf809dd9318bdcb7c2","origin":{"type":"service"}},"pricing":{"billable":false,"pricing_model":"PMP","category":"service","type":"free_customer_service"}}]},"field":"messages"}]}]}
2025-07-02 22:34:28.776 +05:30 [INF] 📦 Routing to Status Processor
2025-07-02 22:34:28.777 +05:30 [WRN] 🔍 Incoming timestamp raw value: {"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSN0ExMjRFQTdBMEY1MkFBQTMxAA==","status":"delivered","timestamp":"1751475872","recipient_id":"917082156227","conversation":{"id":"5492429c32e12ebf809dd9318bdcb7c2","origin":{"type":"service"}},"pricing":{"billable":false,"pricing_model":"PMP","category":"service","type":"free_customer_service"}}]},"field":"messages"}]}]}
2025-07-02 22:34:28.783 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__messageId_0='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSN0ExMjRFQTdBMEY1MkFBQTMxAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."MessageId" = @__messageId_0
LIMIT 1
2025-07-02 22:34:28.787 +05:30 [WRN] ⚠️ CampaignSendLog not found for MessageId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSN0ExMjRFQTdBMEY1MkFBQTMxAA==
2025-07-02 22:34:28.788 +05:30 [WRN] ⚠️ No matching CampaignSendLog for MessageId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSN0ExMjRFQTdBMEY1MkFBQTMxAA==
2025-07-02 22:34:34.737 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/api/inbox/mark-read?contactId=0876f654-a362-420f-a912-6bce793436a5 - null 0
2025-07-02 22:34:34.741 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:34:34.743 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Inbox.Controllers.InboxController.MarkMessagesAsRead (xbytechat.api)'
2025-07-02 22:34:34.745 +05:30 [INF] Route matched with {action = "MarkMessagesAsRead", controller = "Inbox"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MarkMessagesAsRead(System.Guid) on controller xbytechat.api.Features.Inbox.Controllers.InboxController (xbytechat.api).
2025-07-02 22:34:34.752 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__contactId_1='0876f654-a362-420f-a912-6bce793436a5' (Nullable = true)], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."CreatedAt", m."ErrorMessage", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."ContactId" = @__contactId_1 AND m."IsIncoming" AND m."Status" <> 'Read'
2025-07-02 22:34:34.761 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@p1='07608e63-26d7-46ba-956e-24a4157fd677', @p0='Read' (Nullable = false), @p3='0ee3d9f0-40f5-4483-a9b9-df2b2c93bc8a', @p2='Read' (Nullable = false)], CommandType='"Text"', CommandTimeout='30']
UPDATE "MessageLogs" SET "Status" = @p0
WHERE "Id" = @p1;
UPDATE "MessageLogs" SET "Status" = @p2
WHERE "Id" = @p3;
2025-07-02 22:34:34.765 +05:30 [INF] Executing StatusCodeResult, setting HTTP status code 200
2025-07-02 22:34:34.766 +05:30 [INF] Executed action xbytechat.api.Features.Inbox.Controllers.InboxController.MarkMessagesAsRead (xbytechat.api) in 18.891ms
2025-07-02 22:34:34.768 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Inbox.Controllers.InboxController.MarkMessagesAsRead (xbytechat.api)'
2025-07-02 22:34:34.770 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/api/inbox/mark-read?contactId=0876f654-a362-420f-a912-6bce793436a5 - 200 0 null 33.367ms
2025-07-02 22:34:36.149 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/api/inbox/mark-read?contactId=1b52f26e-9fad-4233-a6bb-57603945f8d6 - null 0
2025-07-02 22:34:36.156 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:34:36.159 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/contacts/1b52f26e-9fad-4233-a6bb-57603945f8d6 - null null
2025-07-02 22:34:36.159 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/inbox/messages?contactId=1b52f26e-9fad-4233-a6bb-57603945f8d6 - null null
2025-07-02 22:34:36.160 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Inbox.Controllers.InboxController.MarkMessagesAsRead (xbytechat.api)'
2025-07-02 22:34:36.168 +05:30 [INF] Route matched with {action = "MarkMessagesAsRead", controller = "Inbox"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MarkMessagesAsRead(System.Guid) on controller xbytechat.api.Features.Inbox.Controllers.InboxController (xbytechat.api).
2025-07-02 22:34:36.166 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:34:36.163 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:34:36.172 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Inbox.Controllers.InboxController.GetMessagesByContact (xbytechat.api)'
2025-07-02 22:34:36.173 +05:30 [INF] Executing endpoint 'xbytechat.api.CRM.Controllers.ContactsController.GetContactById (xbytechat.api)'
2025-07-02 22:34:36.176 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__contactId_1='1b52f26e-9fad-4233-a6bb-57603945f8d6' (Nullable = true)], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."CreatedAt", m."ErrorMessage", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."ContactId" = @__contactId_1 AND m."IsIncoming" AND m."Status" <> 'Read'
2025-07-02 22:34:36.175 +05:30 [INF] Route matched with {action = "GetMessagesByContact", controller = "Inbox"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesByContact(System.Guid) on controller xbytechat.api.Features.Inbox.Controllers.InboxController (xbytechat.api).
2025-07-02 22:34:36.179 +05:30 [INF] Route matched with {action = "GetContactById", controller = "Contacts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetContactById(System.Guid) on controller xbytechat.api.CRM.Controllers.ContactsController (xbytechat.api).
2025-07-02 22:34:36.182 +05:30 [INF] Executing StatusCodeResult, setting HTTP status code 200
2025-07-02 22:34:39.554 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/contacts/0876f654-a362-420f-a912-6bce793436a5 - null null
2025-07-02 22:34:39.562 +05:30 [INF] Executed action xbytechat.api.Features.Inbox.Controllers.InboxController.MarkMessagesAsRead (xbytechat.api) in 3391.3967ms
2025-07-02 22:34:39.579 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:34:39.555 +05:30 [INF] Executed DbCommand (3,369ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__contactId_1='1b52f26e-9fad-4233-a6bb-57603945f8d6' (Nullable = true)], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."CreatedAt", m."ErrorMessage", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."SentAt", m."Source", m."Status", c."Id", c."BusinessId", c."CampaignId", c."CampaignType", c."CreatedAt", c."CreatedBy", c."CtaId", c."DeletedAt", c."DeletedBy", c."FollowUpTemplateId", c."ImageCaption", c."ImageUrl", c."IsDeleted", c."MessageBody", c."MessageTemplate", c."Name", c."ScheduledAt", c."SourceCampaignId", c."Status", c."TemplateId", c."TemplateParameters", c."UpdatedAt"
FROM "MessageLogs" AS m
LEFT JOIN "Campaigns" AS c ON m."CampaignId" = c."Id"
WHERE m."BusinessId" = @__businessId_0 AND m."ContactId" = @__contactId_1
ORDER BY m."CreatedAt"
2025-07-02 22:34:39.589 +05:30 [INF] Executing endpoint 'xbytechat.api.CRM.Controllers.ContactsController.GetContactById (xbytechat.api)'
2025-07-02 22:34:39.587 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Inbox.Controllers.InboxController.MarkMessagesAsRead (xbytechat.api)'
2025-07-02 22:34:39.553 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/api/inbox/mark-read?contactId=0876f654-a362-420f-a912-6bce793436a5 - null 0
2025-07-02 22:34:39.599 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:34:39.576 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/inbox/messages?contactId=0876f654-a362-420f-a912-6bce793436a5 - null null
2025-07-02 22:34:39.550 +05:30 [INF] GetContactByIdAsync: businessId="c13be597-6ae2-42bb-9d43-925815f24ff8", contactId="1b52f26e-9fad-4233-a6bb-57603945f8d6"
2025-07-02 22:34:39.585 +05:30 [INF] Executed DbCommand (7ms) [Parameters=[@__contactId_0='1b52f26e-9fad-4233-a6bb-57603945f8d6', @__userGuid_1='2870e1d8-0e80-4b12-88bd-70a8113307d6'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."BusinessId", c."ContactId", c."LastReadAt", c."UserId"
FROM "ContactReads" AS c
WHERE c."ContactId" = @__contactId_0 AND c."UserId" = @__userGuid_1
LIMIT 1
2025-07-02 22:34:39.594 +05:30 [INF] Route matched with {action = "GetContactById", controller = "Contacts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetContactById(System.Guid) on controller xbytechat.api.CRM.Controllers.ContactsController (xbytechat.api).
2025-07-02 22:34:39.595 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/api/inbox/mark-read?contactId=1b52f26e-9fad-4233-a6bb-57603945f8d6 - 200 0 null 3446.4528ms
2025-07-02 22:34:39.611 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__contactId_1='1b52f26e-9fad-4233-a6bb-57603945f8d6'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."AssignedAgentId", t."BusinessId", t."CreatedAt", t."Email", t."Group", t."IsActive", t."IsArchived", t."IsAutomationPaused", t."IsFavorite", t."LastCTAInteraction", t."LastCTAType", t."LastClickedProductId", t."LastContactedAt", t."LeadSource", t."Name", t."NextFollowUpAt", t."Notes", t."PhoneNumber", t."Tags", t0."Id", t0."AssignedAt", t0."AssignedBy", t0."BusinessId", t0."ContactId", t0."TagId", t0."Id0", t0."BusinessId0", t0."Category", t0."ColorHex", t0."CreatedAt", t0."IsActive", t0."IsSystemTag", t0."LastUsedAt", t0."Name", t0."Notes"
FROM (
    SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."Tags"
    FROM "Contacts" AS c
    WHERE c."BusinessId" = @__businessId_0 AND c."Id" = @__contactId_1 AND c."IsActive"
    LIMIT 1
) AS t
LEFT JOIN (
    SELECT c0."Id", c0."AssignedAt", c0."AssignedBy", c0."BusinessId", c0."ContactId", c0."TagId", t1."Id" AS "Id0", t1."BusinessId" AS "BusinessId0", t1."Category", t1."ColorHex", t1."CreatedAt", t1."IsActive", t1."IsSystemTag", t1."LastUsedAt", t1."Name", t1."Notes"
    FROM "ContactTags" AS c0
    INNER JOIN "Tags" AS t1 ON c0."TagId" = t1."Id"
) AS t0 ON t."Id" = t0."ContactId"
ORDER BY t."Id", t0."Id"
2025-07-02 22:34:41.330 +05:30 [INF] GetContactByIdAsync: businessId="c13be597-6ae2-42bb-9d43-925815f24ff8", contactId="0876f654-a362-420f-a912-6bce793436a5"
2025-07-02 22:34:39.600 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Inbox.Controllers.InboxController.MarkMessagesAsRead (xbytechat.api)'
2025-07-02 22:34:39.604 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:34:41.345 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__contactId_1='0876f654-a362-420f-a912-6bce793436a5'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."AssignedAgentId", t."BusinessId", t."CreatedAt", t."Email", t."Group", t."IsActive", t."IsArchived", t."IsAutomationPaused", t."IsFavorite", t."LastCTAInteraction", t."LastCTAType", t."LastClickedProductId", t."LastContactedAt", t."LeadSource", t."Name", t."NextFollowUpAt", t."Notes", t."PhoneNumber", t."Tags", t0."Id", t0."AssignedAt", t0."AssignedBy", t0."BusinessId", t0."ContactId", t0."TagId", t0."Id0", t0."BusinessId0", t0."Category", t0."ColorHex", t0."CreatedAt", t0."IsActive", t0."IsSystemTag", t0."LastUsedAt", t0."Name", t0."Notes"
FROM (
    SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."Tags"
    FROM "Contacts" AS c
    WHERE c."BusinessId" = @__businessId_0 AND c."Id" = @__contactId_1 AND c."IsActive"
    LIMIT 1
) AS t
LEFT JOIN (
    SELECT c0."Id", c0."AssignedAt", c0."AssignedBy", c0."BusinessId", c0."ContactId", c0."TagId", t1."Id" AS "Id0", t1."BusinessId" AS "BusinessId0", t1."Category", t1."ColorHex", t1."CreatedAt", t1."IsActive", t1."IsSystemTag", t1."LastUsedAt", t1."Name", t1."Notes"
    FROM "ContactTags" AS c0
    INNER JOIN "Tags" AS t1 ON c0."TagId" = t1."Id"
) AS t0 ON t."Id" = t0."ContactId"
ORDER BY t."Id", t0."Id"
2025-07-02 22:34:41.341 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Helpers.ResponseResult'.
2025-07-02 22:34:41.343 +05:30 [INF] Route matched with {action = "MarkMessagesAsRead", controller = "Inbox"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MarkMessagesAsRead(System.Guid) on controller xbytechat.api.Features.Inbox.Controllers.InboxController (xbytechat.api).
2025-07-02 22:34:41.328 +05:30 [INF] Executed DbCommand (1,715ms) [Parameters=[@p0='f824024c-3e88-4f0d-b01e-1856899a4a57', @p1='c13be597-6ae2-42bb-9d43-925815f24ff8', @p2='1b52f26e-9fad-4233-a6bb-57603945f8d6', @p3='2025-07-02T17:04:39.5650921Z' (DbType = DateTime), @p4='2870e1d8-0e80-4b12-88bd-70a8113307d6'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "ContactReads" ("Id", "BusinessId", "ContactId", "LastReadAt", "UserId")
VALUES (@p0, @p1, @p2, @p3, @p4);
2025-07-02 22:34:41.351 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Helpers.ResponseResult'.
2025-07-02 22:34:41.353 +05:30 [INF] Executed action xbytechat.api.CRM.Controllers.ContactsController.GetContactById (xbytechat.api) in 5167.3062ms
2025-07-02 22:34:41.364 +05:30 [INF] Executed action xbytechat.api.CRM.Controllers.ContactsController.GetContactById (xbytechat.api) in 1747.2388ms
2025-07-02 22:34:41.348 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Inbox.Controllers.InboxController.GetMessagesByContact (xbytechat.api)'
2025-07-02 22:34:41.355 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/contacts/1b52f26e-9fad-4233-a6bb-57603945f8d6 - null null
2025-07-02 22:34:41.359 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__contactId_1='0876f654-a362-420f-a912-6bce793436a5' (Nullable = true)], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."CreatedAt", m."ErrorMessage", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."ContactId" = @__contactId_1 AND m."IsIncoming" AND m."Status" <> 'Read'
2025-07-02 22:34:41.366 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessGuid_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."CreatedAt", m."ErrorMessage", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessGuid_0 AND m."IsIncoming" AND m."ContactId" IS NOT NULL
2025-07-02 22:34:41.366 +05:30 [INF] Executed endpoint 'xbytechat.api.CRM.Controllers.ContactsController.GetContactById (xbytechat.api)'
2025-07-02 22:34:41.368 +05:30 [INF] Executed endpoint 'xbytechat.api.CRM.Controllers.ContactsController.GetContactById (xbytechat.api)'
2025-07-02 22:34:41.371 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.MessageManagement.DTOs.MessageLogDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 22:34:41.373 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:34:41.376 +05:30 [INF] Executing StatusCodeResult, setting HTTP status code 200
2025-07-02 22:34:41.381 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/contacts/1b52f26e-9fad-4233-a6bb-57603945f8d6 - 200 null application/json; charset=utf-8 5221.6718ms
2025-07-02 22:34:41.382 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__userGuid_0='2870e1d8-0e80-4b12-88bd-70a8113307d6'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."BusinessId", c."ContactId", c."LastReadAt", c."UserId"
FROM "ContactReads" AS c
WHERE c."UserId" = @__userGuid_0
2025-07-02 22:34:41.382 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/contacts/0876f654-a362-420f-a912-6bce793436a5 - 200 null application/json; charset=utf-8 1828.1418ms
2025-07-02 22:34:41.369 +05:30 [INF] Route matched with {action = "GetMessagesByContact", controller = "Inbox"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesByContact(System.Guid) on controller xbytechat.api.Features.Inbox.Controllers.InboxController (xbytechat.api).
2025-07-02 22:34:41.393 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/contacts/0876f654-a362-420f-a912-6bce793436a5 - null null
2025-07-02 22:34:41.385 +05:30 [INF] Executed action xbytechat.api.Features.Inbox.Controllers.InboxController.GetMessagesByContact (xbytechat.api) in 5201.2008ms
2025-07-02 22:34:41.411 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:34:41.403 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__contactId_0='0876f654-a362-420f-a912-6bce793436a5', @__userGuid_1='2870e1d8-0e80-4b12-88bd-70a8113307d6'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."BusinessId", c."ContactId", c."LastReadAt", c."UserId"
FROM "ContactReads" AS c
WHERE c."ContactId" = @__contactId_0 AND c."UserId" = @__userGuid_1
LIMIT 1
2025-07-02 22:34:41.387 +05:30 [INF] Executing endpoint 'xbytechat.api.CRM.Controllers.ContactsController.GetContactById (xbytechat.api)'
2025-07-02 22:34:41.409 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__contactId_1='0876f654-a362-420f-a912-6bce793436a5' (Nullable = true)], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."CreatedAt", m."ErrorMessage", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."SentAt", m."Source", m."Status", c."Id", c."BusinessId", c."CampaignId", c."CampaignType", c."CreatedAt", c."CreatedBy", c."CtaId", c."DeletedAt", c."DeletedBy", c."FollowUpTemplateId", c."ImageCaption", c."ImageUrl", c."IsDeleted", c."MessageBody", c."MessageTemplate", c."Name", c."ScheduledAt", c."SourceCampaignId", c."Status", c."TemplateId", c."TemplateParameters", c."UpdatedAt"
FROM "MessageLogs" AS m
LEFT JOIN "Campaigns" AS c ON m."CampaignId" = c."Id"
WHERE m."BusinessId" = @__businessId_0 AND m."ContactId" = @__contactId_1
ORDER BY m."CreatedAt"
2025-07-02 22:34:41.415 +05:30 [INF] Executing endpoint 'xbytechat.api.CRM.Controllers.ContactsController.GetContactById (xbytechat.api)'
2025-07-02 22:34:41.413 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Inbox.Controllers.InboxController.GetMessagesByContact (xbytechat.api)'
2025-07-02 22:34:41.418 +05:30 [INF] Route matched with {action = "GetContactById", controller = "Contacts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetContactById(System.Guid) on controller xbytechat.api.CRM.Controllers.ContactsController (xbytechat.api).
2025-07-02 22:34:41.388 +05:30 [INF] Executed action xbytechat.api.Features.Inbox.Controllers.InboxController.MarkMessagesAsRead (xbytechat.api) in 33.5136ms
2025-07-02 22:34:41.426 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/inbox/messages?contactId=1b52f26e-9fad-4233-a6bb-57603945f8d6 - 200 null application/json; charset=utf-8 5266.7725ms
2025-07-02 22:34:41.425 +05:30 [INF] Route matched with {action = "GetContactById", controller = "Contacts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetContactById(System.Guid) on controller xbytechat.api.CRM.Controllers.ContactsController (xbytechat.api).
2025-07-02 22:34:41.424 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.MessageManagement.DTOs.MessageLogDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 22:34:43.317 +05:30 [INF] GetContactByIdAsync: businessId="c13be597-6ae2-42bb-9d43-925815f24ff8", contactId="1b52f26e-9fad-4233-a6bb-57603945f8d6"
2025-07-02 22:34:41.431 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Inbox.Controllers.InboxController.MarkMessagesAsRead (xbytechat.api)'
2025-07-02 22:34:45.192 +05:30 [INF] GetContactByIdAsync: businessId="c13be597-6ae2-42bb-9d43-925815f24ff8", contactId="0876f654-a362-420f-a912-6bce793436a5"
2025-07-02 22:34:45.193 +05:30 [INF] Executed action xbytechat.api.Features.Inbox.Controllers.InboxController.GetMessagesByContact (xbytechat.api) in 3787.6905ms
2025-07-02 22:34:45.200 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__contactId_1='1b52f26e-9fad-4233-a6bb-57603945f8d6'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."AssignedAgentId", t."BusinessId", t."CreatedAt", t."Email", t."Group", t."IsActive", t."IsArchived", t."IsAutomationPaused", t."IsFavorite", t."LastCTAInteraction", t."LastCTAType", t."LastClickedProductId", t."LastContactedAt", t."LeadSource", t."Name", t."NextFollowUpAt", t."Notes", t."PhoneNumber", t."Tags", t0."Id", t0."AssignedAt", t0."AssignedBy", t0."BusinessId", t0."ContactId", t0."TagId", t0."Id0", t0."BusinessId0", t0."Category", t0."ColorHex", t0."CreatedAt", t0."IsActive", t0."IsSystemTag", t0."LastUsedAt", t0."Name", t0."Notes"
FROM (
    SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."Tags"
    FROM "Contacts" AS c
    WHERE c."BusinessId" = @__businessId_0 AND c."Id" = @__contactId_1 AND c."IsActive"
    LIMIT 1
) AS t
LEFT JOIN (
    SELECT c0."Id", c0."AssignedAt", c0."AssignedBy", c0."BusinessId", c0."ContactId", c0."TagId", t1."Id" AS "Id0", t1."BusinessId" AS "BusinessId0", t1."Category", t1."ColorHex", t1."CreatedAt", t1."IsActive", t1."IsSystemTag", t1."LastUsedAt", t1."Name", t1."Notes"
    FROM "ContactTags" AS c0
    INNER JOIN "Tags" AS t1 ON c0."TagId" = t1."Id"
) AS t0 ON t."Id" = t0."ContactId"
ORDER BY t."Id", t0."Id"
2025-07-02 22:34:45.207 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__contactId_1='0876f654-a362-420f-a912-6bce793436a5'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."AssignedAgentId", t."BusinessId", t."CreatedAt", t."Email", t."Group", t."IsActive", t."IsArchived", t."IsAutomationPaused", t."IsFavorite", t."LastCTAInteraction", t."LastCTAType", t."LastClickedProductId", t."LastContactedAt", t."LeadSource", t."Name", t."NextFollowUpAt", t."Notes", t."PhoneNumber", t."Tags", t0."Id", t0."AssignedAt", t0."AssignedBy", t0."BusinessId", t0."ContactId", t0."TagId", t0."Id0", t0."BusinessId0", t0."Category", t0."ColorHex", t0."CreatedAt", t0."IsActive", t0."IsSystemTag", t0."LastUsedAt", t0."Name", t0."Notes"
FROM (
    SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."Tags"
    FROM "Contacts" AS c
    WHERE c."BusinessId" = @__businessId_0 AND c."Id" = @__contactId_1 AND c."IsActive"
    LIMIT 1
) AS t
LEFT JOIN (
    SELECT c0."Id", c0."AssignedAt", c0."AssignedBy", c0."BusinessId", c0."ContactId", c0."TagId", t1."Id" AS "Id0", t1."BusinessId" AS "BusinessId0", t1."Category", t1."ColorHex", t1."CreatedAt", t1."IsActive", t1."IsSystemTag", t1."LastUsedAt", t1."Name", t1."Notes"
    FROM "ContactTags" AS c0
    INNER JOIN "Tags" AS t1 ON c0."TagId" = t1."Id"
) AS t0 ON t."Id" = t0."ContactId"
ORDER BY t."Id", t0."Id"
2025-07-02 22:34:45.214 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Helpers.ResponseResult'.
2025-07-02 22:34:45.201 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/api/inbox/mark-read?contactId=0876f654-a362-420f-a912-6bce793436a5 - 200 0 null 5647.7518ms
2025-07-02 22:34:43.317 +05:30 [INF] Executed DbCommand (1,898ms) [Parameters=[@p1='d225a11a-5dab-4768-baad-6036616eabad', @p0='2025-07-02T17:04:41.4005364Z' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE "ContactReads" SET "LastReadAt" = @p0
WHERE "Id" = @p1;
2025-07-02 22:34:45.212 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Helpers.ResponseResult'.
2025-07-02 22:34:45.215 +05:30 [INF] Executed action xbytechat.api.CRM.Controllers.ContactsController.GetContactById (xbytechat.api) in 1890.9535ms
2025-07-02 22:34:45.206 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Inbox.Controllers.InboxController.GetMessagesByContact (xbytechat.api)'
2025-07-02 22:34:45.225 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessGuid_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."CreatedAt", m."ErrorMessage", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessGuid_0 AND m."IsIncoming" AND m."ContactId" IS NOT NULL
2025-07-02 22:34:45.225 +05:30 [INF] Executed action xbytechat.api.CRM.Controllers.ContactsController.GetContactById (xbytechat.api) in 3797.1634ms
2025-07-02 22:34:45.227 +05:30 [INF] Executed endpoint 'xbytechat.api.CRM.Controllers.ContactsController.GetContactById (xbytechat.api)'
2025-07-02 22:34:45.229 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/inbox/messages?contactId=0876f654-a362-420f-a912-6bce793436a5 - 200 null application/json; charset=utf-8 5653.6352ms
2025-07-02 22:34:45.235 +05:30 [INF] Executed endpoint 'xbytechat.api.CRM.Controllers.ContactsController.GetContactById (xbytechat.api)'
2025-07-02 22:34:45.235 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__userGuid_0='2870e1d8-0e80-4b12-88bd-70a8113307d6'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."BusinessId", c."ContactId", c."LastReadAt", c."UserId"
FROM "ContactReads" AS c
WHERE c."UserId" = @__userGuid_0
2025-07-02 22:34:45.237 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/contacts/0876f654-a362-420f-a912-6bce793436a5 - 200 null application/json; charset=utf-8 3843.6835ms
2025-07-02 22:34:45.243 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/contacts/1b52f26e-9fad-4233-a6bb-57603945f8d6 - 200 null application/json; charset=utf-8 3888.0212ms
2025-07-02 22:35:25.377 +05:30 [INF] Request starting HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - application/json 581
2025-07-02 22:35:25.381 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:35:25.383 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-07-02 22:35:25.386 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSODgzNTlDNURBRUI5QTREMEMyAA==","status":"sent","timestamp":"1751190569","recipient_id":"917082156227","conversation":{"id":"90b38ee00c6455dcc79733c1fd93f79a","expiration_timestamp":"1751269260","origin":{"type":"service"}},"pricing":{"billable":true,"pricing_model":"CBP","category":"service"}}]},"field":"messages"}]}]}
2025-07-02 22:35:25.388 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-07-02 22:35:25.389 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSODgzNTlDNURBRUI5QTREMEMyAA==","status":"sent","timestamp":"1751190569","recipient_id":"917082156227","conversation":{"id":"90b38ee00c6455dcc79733c1fd93f79a","expiration_timestamp":"1751269260","origin":{"type":"service"}},"pricing":{"billable":true,"pricing_model":"CBP","category":"service"}}]},"field":"messages"}]}]}
2025-07-02 22:35:25.390 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType73`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:35:25.392 +05:30 [INF] 📦 Routing to Status Processor
2025-07-02 22:35:25.396 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 9.9335ms
2025-07-02 22:35:25.397 +05:30 [WRN] 🔍 Incoming timestamp raw value: {"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSODgzNTlDNURBRUI5QTREMEMyAA==","status":"sent","timestamp":"1751190569","recipient_id":"917082156227","conversation":{"id":"90b38ee00c6455dcc79733c1fd93f79a","expiration_timestamp":"1751269260","origin":{"type":"service"}},"pricing":{"billable":true,"pricing_model":"CBP","category":"service"}}]},"field":"messages"}]}]}
2025-07-02 22:35:25.398 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:35:25.400 +05:30 [INF] Request finished HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 23.2024ms
2025-07-02 22:35:25.404 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[@__messageId_0='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSODgzNTlDNURBRUI5QTREMEMyAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."MessageId" = @__messageId_0
LIMIT 1
2025-07-02 22:35:25.411 +05:30 [WRN] ⚠️ CampaignSendLog not found for MessageId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSODgzNTlDNURBRUI5QTREMEMyAA==
2025-07-02 22:35:25.412 +05:30 [WRN] ⚠️ No matching CampaignSendLog for MessageId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSODgzNTlDNURBRUI5QTREMEMyAA==
2025-07-02 22:35:35.012 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/api/inbox/mark-read?contactId=1b52f26e-9fad-4233-a6bb-57603945f8d6 - null 0
2025-07-02 22:35:35.017 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:35:35.019 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Inbox.Controllers.InboxController.MarkMessagesAsRead (xbytechat.api)'
2025-07-02 22:35:35.021 +05:30 [INF] Route matched with {action = "MarkMessagesAsRead", controller = "Inbox"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MarkMessagesAsRead(System.Guid) on controller xbytechat.api.Features.Inbox.Controllers.InboxController (xbytechat.api).
2025-07-02 22:35:35.024 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/inbox/messages?contactId=1b52f26e-9fad-4233-a6bb-57603945f8d6 - null null
2025-07-02 22:35:35.024 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/contacts/1b52f26e-9fad-4233-a6bb-57603945f8d6 - null null
2025-07-02 22:35:35.027 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__contactId_1='1b52f26e-9fad-4233-a6bb-57603945f8d6' (Nullable = true)], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."CreatedAt", m."ErrorMessage", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."ContactId" = @__contactId_1 AND m."IsIncoming" AND m."Status" <> 'Read'
2025-07-02 22:35:35.031 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:35:35.034 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:35:35.038 +05:30 [INF] Executing StatusCodeResult, setting HTTP status code 200
2025-07-02 22:35:35.039 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Inbox.Controllers.InboxController.GetMessagesByContact (xbytechat.api)'
2025-07-02 22:35:35.040 +05:30 [INF] Executing endpoint 'xbytechat.api.CRM.Controllers.ContactsController.GetContactById (xbytechat.api)'
2025-07-02 22:35:35.042 +05:30 [INF] Executed action xbytechat.api.Features.Inbox.Controllers.InboxController.MarkMessagesAsRead (xbytechat.api) in 18.7127ms
2025-07-02 22:35:35.043 +05:30 [INF] Route matched with {action = "GetMessagesByContact", controller = "Inbox"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesByContact(System.Guid) on controller xbytechat.api.Features.Inbox.Controllers.InboxController (xbytechat.api).
2025-07-02 22:35:35.045 +05:30 [INF] Route matched with {action = "GetContactById", controller = "Contacts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetContactById(System.Guid) on controller xbytechat.api.CRM.Controllers.ContactsController (xbytechat.api).
2025-07-02 22:35:35.047 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Inbox.Controllers.InboxController.MarkMessagesAsRead (xbytechat.api)'
2025-07-02 22:35:35.055 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__contactId_1='1b52f26e-9fad-4233-a6bb-57603945f8d6' (Nullable = true)], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."CreatedAt", m."ErrorMessage", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."SentAt", m."Source", m."Status", c."Id", c."BusinessId", c."CampaignId", c."CampaignType", c."CreatedAt", c."CreatedBy", c."CtaId", c."DeletedAt", c."DeletedBy", c."FollowUpTemplateId", c."ImageCaption", c."ImageUrl", c."IsDeleted", c."MessageBody", c."MessageTemplate", c."Name", c."ScheduledAt", c."SourceCampaignId", c."Status", c."TemplateId", c."TemplateParameters", c."UpdatedAt"
FROM "MessageLogs" AS m
LEFT JOIN "Campaigns" AS c ON m."CampaignId" = c."Id"
WHERE m."BusinessId" = @__businessId_0 AND m."ContactId" = @__contactId_1
ORDER BY m."CreatedAt"
2025-07-02 22:35:36.799 +05:30 [INF] GetContactByIdAsync: businessId="c13be597-6ae2-42bb-9d43-925815f24ff8", contactId="1b52f26e-9fad-4233-a6bb-57603945f8d6"
2025-07-02 22:35:36.806 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__contactId_0='1b52f26e-9fad-4233-a6bb-57603945f8d6', @__userGuid_1='2870e1d8-0e80-4b12-88bd-70a8113307d6'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."BusinessId", c."ContactId", c."LastReadAt", c."UserId"
FROM "ContactReads" AS c
WHERE c."ContactId" = @__contactId_0 AND c."UserId" = @__userGuid_1
LIMIT 1
2025-07-02 22:35:36.859 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.MessageManagement.DTOs.MessageLogDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 22:35:36.803 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/api/inbox/mark-read?contactId=1b52f26e-9fad-4233-a6bb-57603945f8d6 - 200 0 null 1790.9148ms
2025-07-02 22:35:36.864 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__contactId_1='1b52f26e-9fad-4233-a6bb-57603945f8d6'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."AssignedAgentId", t."BusinessId", t."CreatedAt", t."Email", t."Group", t."IsActive", t."IsArchived", t."IsAutomationPaused", t."IsFavorite", t."LastCTAInteraction", t."LastCTAType", t."LastClickedProductId", t."LastContactedAt", t."LeadSource", t."Name", t."NextFollowUpAt", t."Notes", t."PhoneNumber", t."Tags", t0."Id", t0."AssignedAt", t0."AssignedBy", t0."BusinessId", t0."ContactId", t0."TagId", t0."Id0", t0."BusinessId0", t0."Category", t0."ColorHex", t0."CreatedAt", t0."IsActive", t0."IsSystemTag", t0."LastUsedAt", t0."Name", t0."Notes"
FROM (
    SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."Tags"
    FROM "Contacts" AS c
    WHERE c."BusinessId" = @__businessId_0 AND c."Id" = @__contactId_1 AND c."IsActive"
    LIMIT 1
) AS t
LEFT JOIN (
    SELECT c0."Id", c0."AssignedAt", c0."AssignedBy", c0."BusinessId", c0."ContactId", c0."TagId", t1."Id" AS "Id0", t1."BusinessId" AS "BusinessId0", t1."Category", t1."ColorHex", t1."CreatedAt", t1."IsActive", t1."IsSystemTag", t1."LastUsedAt", t1."Name", t1."Notes"
    FROM "ContactTags" AS c0
    INNER JOIN "Tags" AS t1 ON c0."TagId" = t1."Id"
) AS t0 ON t."Id" = t0."ContactId"
ORDER BY t."Id", t0."Id"
2025-07-02 22:35:36.868 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@p1='f824024c-3e88-4f0d-b01e-1856899a4a57', @p0='2025-07-02T17:05:36.8027942Z' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE "ContactReads" SET "LastReadAt" = @p0
WHERE "Id" = @p1;
2025-07-02 22:35:36.868 +05:30 [INF] Executed action xbytechat.api.Features.Inbox.Controllers.InboxController.GetMessagesByContact (xbytechat.api) in 1818.0948ms
2025-07-02 22:35:36.882 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessGuid_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."CreatedAt", m."ErrorMessage", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessGuid_0 AND m."IsIncoming" AND m."ContactId" IS NOT NULL
2025-07-02 22:35:36.878 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Helpers.ResponseResult'.
2025-07-02 22:35:36.882 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Inbox.Controllers.InboxController.GetMessagesByContact (xbytechat.api)'
2025-07-02 22:35:36.887 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__userGuid_0='2870e1d8-0e80-4b12-88bd-70a8113307d6'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."BusinessId", c."ContactId", c."LastReadAt", c."UserId"
FROM "ContactReads" AS c
WHERE c."UserId" = @__userGuid_0
2025-07-02 22:35:36.889 +05:30 [INF] Executed action xbytechat.api.CRM.Controllers.ContactsController.GetContactById (xbytechat.api) in 1837.1802ms
2025-07-02 22:35:36.890 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/contacts/1b52f26e-9fad-4233-a6bb-57603945f8d6 - null null
2025-07-02 22:35:36.891 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/inbox/messages?contactId=1b52f26e-9fad-4233-a6bb-57603945f8d6 - 200 null application/json; charset=utf-8 1867.0923ms
2025-07-02 22:35:36.897 +05:30 [INF] Executed endpoint 'xbytechat.api.CRM.Controllers.ContactsController.GetContactById (xbytechat.api)'
2025-07-02 22:35:36.902 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:35:36.908 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/contacts/1b52f26e-9fad-4233-a6bb-57603945f8d6 - 200 null application/json; charset=utf-8 1884.6943ms
2025-07-02 22:35:36.910 +05:30 [INF] Executing endpoint 'xbytechat.api.CRM.Controllers.ContactsController.GetContactById (xbytechat.api)'
2025-07-02 22:35:36.916 +05:30 [INF] Route matched with {action = "GetContactById", controller = "Contacts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetContactById(System.Guid) on controller xbytechat.api.CRM.Controllers.ContactsController (xbytechat.api).
2025-07-02 22:35:39.209 +05:30 [INF] GetContactByIdAsync: businessId="c13be597-6ae2-42bb-9d43-925815f24ff8", contactId="1b52f26e-9fad-4233-a6bb-57603945f8d6"
2025-07-02 22:35:39.215 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__contactId_1='1b52f26e-9fad-4233-a6bb-57603945f8d6'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."AssignedAgentId", t."BusinessId", t."CreatedAt", t."Email", t."Group", t."IsActive", t."IsArchived", t."IsAutomationPaused", t."IsFavorite", t."LastCTAInteraction", t."LastCTAType", t."LastClickedProductId", t."LastContactedAt", t."LeadSource", t."Name", t."NextFollowUpAt", t."Notes", t."PhoneNumber", t."Tags", t0."Id", t0."AssignedAt", t0."AssignedBy", t0."BusinessId", t0."ContactId", t0."TagId", t0."Id0", t0."BusinessId0", t0."Category", t0."ColorHex", t0."CreatedAt", t0."IsActive", t0."IsSystemTag", t0."LastUsedAt", t0."Name", t0."Notes"
FROM (
    SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."Tags"
    FROM "Contacts" AS c
    WHERE c."BusinessId" = @__businessId_0 AND c."Id" = @__contactId_1 AND c."IsActive"
    LIMIT 1
) AS t
LEFT JOIN (
    SELECT c0."Id", c0."AssignedAt", c0."AssignedBy", c0."BusinessId", c0."ContactId", c0."TagId", t1."Id" AS "Id0", t1."BusinessId" AS "BusinessId0", t1."Category", t1."ColorHex", t1."CreatedAt", t1."IsActive", t1."IsSystemTag", t1."LastUsedAt", t1."Name", t1."Notes"
    FROM "ContactTags" AS c0
    INNER JOIN "Tags" AS t1 ON c0."TagId" = t1."Id"
) AS t0 ON t."Id" = t0."ContactId"
ORDER BY t."Id", t0."Id"
2025-07-02 22:35:39.222 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Helpers.ResponseResult'.
2025-07-02 22:35:39.225 +05:30 [INF] Executed action xbytechat.api.CRM.Controllers.ContactsController.GetContactById (xbytechat.api) in 2305.8386ms
2025-07-02 22:35:39.227 +05:30 [INF] Executed endpoint 'xbytechat.api.CRM.Controllers.ContactsController.GetContactById (xbytechat.api)'
2025-07-02 22:35:39.229 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/contacts/1b52f26e-9fad-4233-a6bb-57603945f8d6 - 200 null application/json; charset=utf-8 2338.3899ms
2025-07-02 22:35:46.352 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/api/inbox/mark-read?contactId=0876f654-a362-420f-a912-6bce793436a5 - null 0
2025-07-02 22:35:46.356 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:35:46.360 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Inbox.Controllers.InboxController.MarkMessagesAsRead (xbytechat.api)'
2025-07-02 22:35:46.361 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/contacts/0876f654-a362-420f-a912-6bce793436a5 - null null
2025-07-02 22:35:46.365 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:35:46.361 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/inbox/messages?contactId=0876f654-a362-420f-a912-6bce793436a5 - null null
2025-07-02 22:35:46.366 +05:30 [INF] Executing endpoint 'xbytechat.api.CRM.Controllers.ContactsController.GetContactById (xbytechat.api)'
2025-07-02 22:35:46.362 +05:30 [INF] Route matched with {action = "MarkMessagesAsRead", controller = "Inbox"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MarkMessagesAsRead(System.Guid) on controller xbytechat.api.Features.Inbox.Controllers.InboxController (xbytechat.api).
2025-07-02 22:35:46.370 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:35:46.372 +05:30 [INF] Route matched with {action = "GetContactById", controller = "Contacts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetContactById(System.Guid) on controller xbytechat.api.CRM.Controllers.ContactsController (xbytechat.api).
2025-07-02 22:35:46.376 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Inbox.Controllers.InboxController.GetMessagesByContact (xbytechat.api)'
2025-07-02 22:35:46.378 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__contactId_1='0876f654-a362-420f-a912-6bce793436a5' (Nullable = true)], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."CreatedAt", m."ErrorMessage", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."ContactId" = @__contactId_1 AND m."IsIncoming" AND m."Status" <> 'Read'
2025-07-02 22:35:48.018 +05:30 [INF] Route matched with {action = "GetMessagesByContact", controller = "Inbox"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesByContact(System.Guid) on controller xbytechat.api.Features.Inbox.Controllers.InboxController (xbytechat.api).
2025-07-02 22:35:48.024 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__contactId_0='0876f654-a362-420f-a912-6bce793436a5', @__userGuid_1='2870e1d8-0e80-4b12-88bd-70a8113307d6'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."BusinessId", c."ContactId", c."LastReadAt", c."UserId"
FROM "ContactReads" AS c
WHERE c."ContactId" = @__contactId_0 AND c."UserId" = @__userGuid_1
LIMIT 1
2025-07-02 22:35:48.019 +05:30 [INF] GetContactByIdAsync: businessId="c13be597-6ae2-42bb-9d43-925815f24ff8", contactId="0876f654-a362-420f-a912-6bce793436a5"
2025-07-02 22:35:48.021 +05:30 [INF] Executing StatusCodeResult, setting HTTP status code 200
2025-07-02 22:35:48.030 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__contactId_1='0876f654-a362-420f-a912-6bce793436a5' (Nullable = true)], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."CreatedAt", m."ErrorMessage", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."SentAt", m."Source", m."Status", c."Id", c."BusinessId", c."CampaignId", c."CampaignType", c."CreatedAt", c."CreatedBy", c."CtaId", c."DeletedAt", c."DeletedBy", c."FollowUpTemplateId", c."ImageCaption", c."ImageUrl", c."IsDeleted", c."MessageBody", c."MessageTemplate", c."Name", c."ScheduledAt", c."SourceCampaignId", c."Status", c."TemplateId", c."TemplateParameters", c."UpdatedAt"
FROM "MessageLogs" AS m
LEFT JOIN "Campaigns" AS c ON m."CampaignId" = c."Id"
WHERE m."BusinessId" = @__businessId_0 AND m."ContactId" = @__contactId_1
ORDER BY m."CreatedAt"
2025-07-02 22:35:48.038 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__contactId_1='0876f654-a362-420f-a912-6bce793436a5'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."AssignedAgentId", t."BusinessId", t."CreatedAt", t."Email", t."Group", t."IsActive", t."IsArchived", t."IsAutomationPaused", t."IsFavorite", t."LastCTAInteraction", t."LastCTAType", t."LastClickedProductId", t."LastContactedAt", t."LeadSource", t."Name", t."NextFollowUpAt", t."Notes", t."PhoneNumber", t."Tags", t0."Id", t0."AssignedAt", t0."AssignedBy", t0."BusinessId", t0."ContactId", t0."TagId", t0."Id0", t0."BusinessId0", t0."Category", t0."ColorHex", t0."CreatedAt", t0."IsActive", t0."IsSystemTag", t0."LastUsedAt", t0."Name", t0."Notes"
FROM (
    SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."Tags"
    FROM "Contacts" AS c
    WHERE c."BusinessId" = @__businessId_0 AND c."Id" = @__contactId_1 AND c."IsActive"
    LIMIT 1
) AS t
LEFT JOIN (
    SELECT c0."Id", c0."AssignedAt", c0."AssignedBy", c0."BusinessId", c0."ContactId", c0."TagId", t1."Id" AS "Id0", t1."BusinessId" AS "BusinessId0", t1."Category", t1."ColorHex", t1."CreatedAt", t1."IsActive", t1."IsSystemTag", t1."LastUsedAt", t1."Name", t1."Notes"
    FROM "ContactTags" AS c0
    INNER JOIN "Tags" AS t1 ON c0."TagId" = t1."Id"
) AS t0 ON t."Id" = t0."ContactId"
ORDER BY t."Id", t0."Id"
2025-07-02 22:35:48.035 +05:30 [INF] Executed action xbytechat.api.Features.Inbox.Controllers.InboxController.MarkMessagesAsRead (xbytechat.api) in 1660.8867ms
2025-07-02 22:35:48.042 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.MessageManagement.DTOs.MessageLogDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 22:35:48.045 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Helpers.ResponseResult'.
2025-07-02 22:35:48.046 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Inbox.Controllers.InboxController.MarkMessagesAsRead (xbytechat.api)'
2025-07-02 22:35:48.048 +05:30 [INF] Executed action xbytechat.api.Features.Inbox.Controllers.InboxController.GetMessagesByContact (xbytechat.api) in 22.0358ms
2025-07-02 22:35:48.050 +05:30 [INF] Executed action xbytechat.api.CRM.Controllers.ContactsController.GetContactById (xbytechat.api) in 1666.7683ms
2025-07-02 22:35:48.051 +05:30 [INF] Executed DbCommand (18ms) [Parameters=[@p1='d225a11a-5dab-4768-baad-6036616eabad', @p0='2025-07-02T17:05:48.0214176Z' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE "ContactReads" SET "LastReadAt" = @p0
WHERE "Id" = @p1;
2025-07-02 22:35:48.051 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/contacts/0876f654-a362-420f-a912-6bce793436a5 - null null
2025-07-02 22:35:48.053 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Inbox.Controllers.InboxController.GetMessagesByContact (xbytechat.api)'
2025-07-02 22:35:48.055 +05:30 [INF] Executed endpoint 'xbytechat.api.CRM.Controllers.ContactsController.GetContactById (xbytechat.api)'
2025-07-02 22:35:48.052 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/api/inbox/mark-read?contactId=0876f654-a362-420f-a912-6bce793436a5 - 200 0 null 1700.1824ms
2025-07-02 22:35:48.060 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessGuid_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."CreatedAt", m."ErrorMessage", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessGuid_0 AND m."IsIncoming" AND m."ContactId" IS NOT NULL
2025-07-02 22:35:48.063 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:35:48.064 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/inbox/messages?contactId=0876f654-a362-420f-a912-6bce793436a5 - 200 null application/json; charset=utf-8 1703.0709ms
2025-07-02 22:35:48.066 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/contacts/0876f654-a362-420f-a912-6bce793436a5 - 200 null application/json; charset=utf-8 1704.6742ms
2025-07-02 22:35:48.076 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__userGuid_0='2870e1d8-0e80-4b12-88bd-70a8113307d6'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."BusinessId", c."ContactId", c."LastReadAt", c."UserId"
FROM "ContactReads" AS c
WHERE c."UserId" = @__userGuid_0
2025-07-02 22:35:48.076 +05:30 [INF] Executing endpoint 'xbytechat.api.CRM.Controllers.ContactsController.GetContactById (xbytechat.api)'
2025-07-02 22:35:48.091 +05:30 [INF] Route matched with {action = "GetContactById", controller = "Contacts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetContactById(System.Guid) on controller xbytechat.api.CRM.Controllers.ContactsController (xbytechat.api).
2025-07-02 22:35:50.072 +05:30 [INF] GetContactByIdAsync: businessId="c13be597-6ae2-42bb-9d43-925815f24ff8", contactId="0876f654-a362-420f-a912-6bce793436a5"
2025-07-02 22:35:50.078 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__contactId_1='0876f654-a362-420f-a912-6bce793436a5'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."AssignedAgentId", t."BusinessId", t."CreatedAt", t."Email", t."Group", t."IsActive", t."IsArchived", t."IsAutomationPaused", t."IsFavorite", t."LastCTAInteraction", t."LastCTAType", t."LastClickedProductId", t."LastContactedAt", t."LeadSource", t."Name", t."NextFollowUpAt", t."Notes", t."PhoneNumber", t."Tags", t0."Id", t0."AssignedAt", t0."AssignedBy", t0."BusinessId", t0."ContactId", t0."TagId", t0."Id0", t0."BusinessId0", t0."Category", t0."ColorHex", t0."CreatedAt", t0."IsActive", t0."IsSystemTag", t0."LastUsedAt", t0."Name", t0."Notes"
FROM (
    SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."Tags"
    FROM "Contacts" AS c
    WHERE c."BusinessId" = @__businessId_0 AND c."Id" = @__contactId_1 AND c."IsActive"
    LIMIT 1
) AS t
LEFT JOIN (
    SELECT c0."Id", c0."AssignedAt", c0."AssignedBy", c0."BusinessId", c0."ContactId", c0."TagId", t1."Id" AS "Id0", t1."BusinessId" AS "BusinessId0", t1."Category", t1."ColorHex", t1."CreatedAt", t1."IsActive", t1."IsSystemTag", t1."LastUsedAt", t1."Name", t1."Notes"
    FROM "ContactTags" AS c0
    INNER JOIN "Tags" AS t1 ON c0."TagId" = t1."Id"
) AS t0 ON t."Id" = t0."ContactId"
ORDER BY t."Id", t0."Id"
2025-07-02 22:35:50.083 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Helpers.ResponseResult'.
2025-07-02 22:35:50.085 +05:30 [INF] Executed action xbytechat.api.CRM.Controllers.ContactsController.GetContactById (xbytechat.api) in 1991.644ms
2025-07-02 22:35:50.087 +05:30 [INF] Executed endpoint 'xbytechat.api.CRM.Controllers.ContactsController.GetContactById (xbytechat.api)'
2025-07-02 22:35:50.089 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/contacts/0876f654-a362-420f-a912-6bce793436a5 - 200 null application/json; charset=utf-8 2037.732ms
2025-07-02 22:35:58.176 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__dto_ContactId_1='0876f654-a362-420f-a912-6bce793436a5'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."Tags"
FROM "Contacts" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."Id" = @__dto_ContactId_1
LIMIT 1
2025-07-02 22:35:58.181 +05:30 [INF] FindOrCreateAsync: businessId="c13be597-6ae2-42bb-9d43-925815f24ff8", phoneNumber=917082156227
2025-07-02 22:35:58.185 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__phoneNumber_1='917082156227'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."Tags"
FROM "Contacts" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."PhoneNumber" = @__phoneNumber_1
LIMIT 1
2025-07-02 22:35:58.189 +05:30 [INF] Contact already exists: contactId="0876f654-a362-420f-a912-6bce793436a5"
2025-07-02 22:35:58.191 +05:30 [INF] Start processing HTTP request POST https://graph.facebook.com/v22.0/601884673011340/messages
2025-07-02 22:35:58.193 +05:30 [INF] Sending HTTP request POST https://graph.facebook.com/v22.0/601884673011340/messages
2025-07-02 22:35:59.775 +05:30 [INF] Received HTTP response headers after 1580.6625ms - 200
2025-07-02 22:35:59.777 +05:30 [INF] End processing HTTP request after 1585.7211ms - 200
2025-07-02 22:35:59.801 +05:30 [INF] Executed DbCommand (20ms) [Parameters=[@p0='1a300907-b80b-48ae-b7be-0f3b47df0c8b', @p1='c13be597-6ae2-42bb-9d43-925815f24ff8', @p2=NULL (DbType = Guid), @p3=NULL (DbType = Guid), @p4=NULL (DbType = Guid), @p5='0876f654-a362-420f-a912-6bce793436a5' (Nullable = true), @p6='2025-07-02T17:05:59.7810322Z' (DbType = DateTime), @p7=NULL, @p8='False', @p9=NULL, @p10='xsgsfgsg' (Nullable = false), @p11='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSOTNBMkFEQjhCM0U2OEM1NTIwAA==', @p12='{"Success":true,"Message":"✅ Message sent successfully","Data":null,"ErrorMessage":null,"RawResponse":"{\"messaging_product\":\"whatsapp\",\"contacts\":[{\"input\":\"917082156227\",\"wa_id\":\"917082156227\"}],\"messages\":[{\"id\":\"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSOTNBMkFEQjhCM0U2OEM1NTIwAA==\"}]}","MessageId":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSOTNBMkFEQjhCM0U2OEM1NTIwAA==","LogId":null,"Token":null,"RefreshToken":null}', @p13='917082156227' (Nullable = false), @p14=NULL (DbType = Guid), @p15='xsgsfgsg', @p16='2025-07-02T17:05:59.7810325Z' (Nullable = true) (DbType = DateTime), @p17=NULL, @p18='Sent' (Nullable = false)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "MessageLogs" ("Id", "BusinessId", "CTAFlowConfigId", "CTAFlowStepId", "CampaignId", "ContactId", "CreatedAt", "ErrorMessage", "IsIncoming", "MediaUrl", "MessageContent", "MessageId", "RawResponse", "RecipientNumber", "RefMessageId", "RenderedBody", "SentAt", "Source", "Status")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
2025-07-02 22:36:00.419 +05:30 [INF] Request starting HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - application/json 550
2025-07-02 22:36:00.423 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:36:00.425 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-07-02 22:36:00.428 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSQjJFREVDNDM5RjEzRDFFMEZBAA==","status":"delivered","timestamp":"1751189960","recipient_id":"917082156227","conversation":{"id":"90b38ee00c6455dcc79733c1fd93f79a","origin":{"type":"service"}},"pricing":{"billable":true,"pricing_model":"CBP","category":"service"}}]},"field":"messages"}]}]}
2025-07-02 22:36:00.430 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-07-02 22:36:00.431 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSQjJFREVDNDM5RjEzRDFFMEZBAA==","status":"delivered","timestamp":"1751189960","recipient_id":"917082156227","conversation":{"id":"90b38ee00c6455dcc79733c1fd93f79a","origin":{"type":"service"}},"pricing":{"billable":true,"pricing_model":"CBP","category":"service"}}]},"field":"messages"}]}]}
2025-07-02 22:36:00.431 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType73`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:36:00.433 +05:30 [INF] 📦 Routing to Status Processor
2025-07-02 22:36:00.435 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 7.6625ms
2025-07-02 22:36:00.437 +05:30 [WRN] 🔍 Incoming timestamp raw value: {"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSQjJFREVDNDM5RjEzRDFFMEZBAA==","status":"delivered","timestamp":"1751189960","recipient_id":"917082156227","conversation":{"id":"90b38ee00c6455dcc79733c1fd93f79a","origin":{"type":"service"}},"pricing":{"billable":true,"pricing_model":"CBP","category":"service"}}]},"field":"messages"}]}]}
2025-07-02 22:36:00.439 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:36:00.442 +05:30 [INF] Request finished HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 22.2592ms
2025-07-02 22:36:00.445 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__messageId_0='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSQjJFREVDNDM5RjEzRDFFMEZBAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."MessageId" = @__messageId_0
LIMIT 1
2025-07-02 22:36:00.452 +05:30 [WRN] ⚠️ CampaignSendLog not found for MessageId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSQjJFREVDNDM5RjEzRDFFMEZBAA==
2025-07-02 22:36:00.453 +05:30 [WRN] ⚠️ No matching CampaignSendLog for MessageId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSQjJFREVDNDM5RjEzRDFFMEZBAA==
2025-07-02 22:36:00.716 +05:30 [INF] Request starting HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - application/json 613
2025-07-02 22:36:00.720 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:36:00.721 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-07-02 22:36:00.724 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSOTNBMkFEQjhCM0U2OEM1NTIwAA==","status":"sent","timestamp":"1751475964","recipient_id":"917082156227","conversation":{"id":"fcac7cc250ce6eda57b71f792af24d4e","expiration_timestamp":"1751475964","origin":{"type":"service"}},"pricing":{"billable":false,"pricing_model":"PMP","category":"service","type":"free_customer_service"}}]},"field":"messages"}]}]}
2025-07-02 22:36:00.726 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-07-02 22:36:00.726 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSOTNBMkFEQjhCM0U2OEM1NTIwAA==","status":"sent","timestamp":"1751475964","recipient_id":"917082156227","conversation":{"id":"fcac7cc250ce6eda57b71f792af24d4e","expiration_timestamp":"1751475964","origin":{"type":"service"}},"pricing":{"billable":false,"pricing_model":"PMP","category":"service","type":"free_customer_service"}}]},"field":"messages"}]}]}
2025-07-02 22:36:00.727 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType73`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:36:00.730 +05:30 [INF] 📦 Routing to Status Processor
2025-07-02 22:36:00.731 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 8.0269ms
2025-07-02 22:36:00.732 +05:30 [WRN] 🔍 Incoming timestamp raw value: {"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSOTNBMkFEQjhCM0U2OEM1NTIwAA==","status":"sent","timestamp":"1751475964","recipient_id":"917082156227","conversation":{"id":"fcac7cc250ce6eda57b71f792af24d4e","expiration_timestamp":"1751475964","origin":{"type":"service"}},"pricing":{"billable":false,"pricing_model":"PMP","category":"service","type":"free_customer_service"}}]},"field":"messages"}]}]}
2025-07-02 22:36:00.734 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:36:00.738 +05:30 [INF] Request finished HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 21.7136ms
2025-07-02 22:36:00.738 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__messageId_0='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSOTNBMkFEQjhCM0U2OEM1NTIwAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."MessageId" = @__messageId_0
LIMIT 1
2025-07-02 22:36:00.746 +05:30 [WRN] ⚠️ CampaignSendLog not found for MessageId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSOTNBMkFEQjhCM0U2OEM1NTIwAA==
2025-07-02 22:36:00.747 +05:30 [WRN] ⚠️ No matching CampaignSendLog for MessageId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSOTNBMkFEQjhCM0U2OEM1NTIwAA==
2025-07-02 22:36:02.448 +05:30 [INF] Request starting HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - application/json 582
2025-07-02 22:36:02.452 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:36:02.454 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-07-02 22:36:02.457 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSOTNBMkFEQjhCM0U2OEM1NTIwAA==","status":"delivered","timestamp":"1751475965","recipient_id":"917082156227","conversation":{"id":"fcac7cc250ce6eda57b71f792af24d4e","origin":{"type":"service"}},"pricing":{"billable":false,"pricing_model":"PMP","category":"service","type":"free_customer_service"}}]},"field":"messages"}]}]}
2025-07-02 22:36:02.459 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-07-02 22:36:02.459 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSOTNBMkFEQjhCM0U2OEM1NTIwAA==","status":"delivered","timestamp":"1751475965","recipient_id":"917082156227","conversation":{"id":"fcac7cc250ce6eda57b71f792af24d4e","origin":{"type":"service"}},"pricing":{"billable":false,"pricing_model":"PMP","category":"service","type":"free_customer_service"}}]},"field":"messages"}]}]}
2025-07-02 22:36:02.460 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType73`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:36:02.462 +05:30 [INF] 📦 Routing to Status Processor
2025-07-02 22:36:02.465 +05:30 [WRN] 🔍 Incoming timestamp raw value: {"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSOTNBMkFEQjhCM0U2OEM1NTIwAA==","status":"delivered","timestamp":"1751475965","recipient_id":"917082156227","conversation":{"id":"fcac7cc250ce6eda57b71f792af24d4e","origin":{"type":"service"}},"pricing":{"billable":false,"pricing_model":"PMP","category":"service","type":"free_customer_service"}}]},"field":"messages"}]}]}
2025-07-02 22:36:02.464 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 7.72ms
2025-07-02 22:36:02.469 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:36:02.470 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__messageId_0='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSOTNBMkFEQjhCM0U2OEM1NTIwAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."MessageId" = @__messageId_0
LIMIT 1
2025-07-02 22:36:02.472 +05:30 [INF] Request finished HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 24.492ms
2025-07-02 22:36:02.475 +05:30 [WRN] ⚠️ CampaignSendLog not found for MessageId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSOTNBMkFEQjhCM0U2OEM1NTIwAA==
2025-07-02 22:36:02.481 +05:30 [WRN] ⚠️ No matching CampaignSendLog for MessageId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSOTNBMkFEQjhCM0U2OEM1NTIwAA==
2025-07-02 22:36:08.180 +05:30 [INF] Request starting HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - application/json 585
2025-07-02 22:36:08.184 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:36:08.186 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-07-02 22:36:08.189 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMDg4NjdBRDY2QUJCQUE5RDU0AA==","status":"sent","timestamp":"1751202808","recipient_id":"917082156227","conversation":{"id":"58f619d47c20c6be0ed13fc43b468b54","expiration_timestamp":"1751289240","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"CBP","category":"marketing"}}]},"field":"messages"}]}]}
2025-07-02 22:36:08.192 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-07-02 22:36:08.193 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMDg4NjdBRDY2QUJCQUE5RDU0AA==","status":"sent","timestamp":"1751202808","recipient_id":"917082156227","conversation":{"id":"58f619d47c20c6be0ed13fc43b468b54","expiration_timestamp":"1751289240","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"CBP","category":"marketing"}}]},"field":"messages"}]}]}
2025-07-02 22:36:08.194 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType73`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:36:08.197 +05:30 [INF] 📦 Routing to Status Processor
2025-07-02 22:36:08.199 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 10.072ms
2025-07-02 22:36:08.203 +05:30 [WRN] 🔍 Incoming timestamp raw value: {"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMDg4NjdBRDY2QUJCQUE5RDU0AA==","status":"sent","timestamp":"1751202808","recipient_id":"917082156227","conversation":{"id":"58f619d47c20c6be0ed13fc43b468b54","expiration_timestamp":"1751289240","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"CBP","category":"marketing"}}]},"field":"messages"}]}]}
2025-07-02 22:36:08.205 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:36:08.209 +05:30 [INF] Request finished HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 28.547ms
2025-07-02 22:36:08.210 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__messageId_0='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMDg4NjdBRDY2QUJCQUE5RDU0AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."MessageId" = @__messageId_0
LIMIT 1
2025-07-02 22:36:08.218 +05:30 [WRN] ⚠️ CampaignSendLog not found for MessageId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMDg4NjdBRDY2QUJCQUE5RDU0AA==
2025-07-02 22:36:08.219 +05:30 [WRN] ⚠️ No matching CampaignSendLog for MessageId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMDg4NjdBRDY2QUJCQUE5RDU0AA==
2025-07-02 22:36:09.225 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/api/inbox/mark-read?contactId=1b52f26e-9fad-4233-a6bb-57603945f8d6 - null 0
2025-07-02 22:36:09.230 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:36:09.233 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Inbox.Controllers.InboxController.MarkMessagesAsRead (xbytechat.api)'
2025-07-02 22:36:09.234 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/contacts/1b52f26e-9fad-4233-a6bb-57603945f8d6 - null null
2025-07-02 22:36:09.235 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/inbox/messages?contactId=1b52f26e-9fad-4233-a6bb-57603945f8d6 - null null
2025-07-02 22:36:09.235 +05:30 [INF] Route matched with {action = "MarkMessagesAsRead", controller = "Inbox"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MarkMessagesAsRead(System.Guid) on controller xbytechat.api.Features.Inbox.Controllers.InboxController (xbytechat.api).
2025-07-02 22:36:09.239 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:36:09.242 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:36:09.247 +05:30 [INF] Executing endpoint 'xbytechat.api.CRM.Controllers.ContactsController.GetContactById (xbytechat.api)'
2025-07-02 22:36:09.250 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Inbox.Controllers.InboxController.GetMessagesByContact (xbytechat.api)'
2025-07-02 22:36:09.250 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__contactId_1='1b52f26e-9fad-4233-a6bb-57603945f8d6' (Nullable = true)], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."CreatedAt", m."ErrorMessage", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."ContactId" = @__contactId_1 AND m."IsIncoming" AND m."Status" <> 'Read'
2025-07-02 22:36:09.253 +05:30 [INF] Route matched with {action = "GetContactById", controller = "Contacts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetContactById(System.Guid) on controller xbytechat.api.CRM.Controllers.ContactsController (xbytechat.api).
2025-07-02 22:36:09.255 +05:30 [INF] Route matched with {action = "GetMessagesByContact", controller = "Inbox"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesByContact(System.Guid) on controller xbytechat.api.Features.Inbox.Controllers.InboxController (xbytechat.api).
2025-07-02 22:36:10.962 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__contactId_0='1b52f26e-9fad-4233-a6bb-57603945f8d6', @__userGuid_1='2870e1d8-0e80-4b12-88bd-70a8113307d6'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."BusinessId", c."ContactId", c."LastReadAt", c."UserId"
FROM "ContactReads" AS c
WHERE c."ContactId" = @__contactId_0 AND c."UserId" = @__userGuid_1
LIMIT 1
2025-07-02 22:36:10.967 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__contactId_1='1b52f26e-9fad-4233-a6bb-57603945f8d6' (Nullable = true)], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."CreatedAt", m."ErrorMessage", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."SentAt", m."Source", m."Status", c."Id", c."BusinessId", c."CampaignId", c."CampaignType", c."CreatedAt", c."CreatedBy", c."CtaId", c."DeletedAt", c."DeletedBy", c."FollowUpTemplateId", c."ImageCaption", c."ImageUrl", c."IsDeleted", c."MessageBody", c."MessageTemplate", c."Name", c."ScheduledAt", c."SourceCampaignId", c."Status", c."TemplateId", c."TemplateParameters", c."UpdatedAt"
FROM "MessageLogs" AS m
LEFT JOIN "Campaigns" AS c ON m."CampaignId" = c."Id"
WHERE m."BusinessId" = @__businessId_0 AND m."ContactId" = @__contactId_1
ORDER BY m."CreatedAt"
2025-07-02 22:36:10.971 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@p1='f824024c-3e88-4f0d-b01e-1856899a4a57', @p0='2025-07-02T17:06:10.9601688Z' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE "ContactReads" SET "LastReadAt" = @p0
WHERE "Id" = @p1;
2025-07-02 22:36:10.959 +05:30 [INF] GetContactByIdAsync: businessId="c13be597-6ae2-42bb-9d43-925815f24ff8", contactId="1b52f26e-9fad-4233-a6bb-57603945f8d6"
2025-07-02 22:36:10.974 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.MessageManagement.DTOs.MessageLogDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 22:36:10.978 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessGuid_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."CreatedAt", m."ErrorMessage", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessGuid_0 AND m."IsIncoming" AND m."ContactId" IS NOT NULL
2025-07-02 22:36:10.984 +05:30 [INF] Executed action xbytechat.api.Features.Inbox.Controllers.InboxController.GetMessagesByContact (xbytechat.api) in 20.6295ms
2025-07-02 22:36:10.984 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__contactId_1='1b52f26e-9fad-4233-a6bb-57603945f8d6'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."AssignedAgentId", t."BusinessId", t."CreatedAt", t."Email", t."Group", t."IsActive", t."IsArchived", t."IsAutomationPaused", t."IsFavorite", t."LastCTAInteraction", t."LastCTAType", t."LastClickedProductId", t."LastContactedAt", t."LeadSource", t."Name", t."NextFollowUpAt", t."Notes", t."PhoneNumber", t."Tags", t0."Id", t0."AssignedAt", t0."AssignedBy", t0."BusinessId", t0."ContactId", t0."TagId", t0."Id0", t0."BusinessId0", t0."Category", t0."ColorHex", t0."CreatedAt", t0."IsActive", t0."IsSystemTag", t0."LastUsedAt", t0."Name", t0."Notes"
FROM (
    SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."Tags"
    FROM "Contacts" AS c
    WHERE c."BusinessId" = @__businessId_0 AND c."Id" = @__contactId_1 AND c."IsActive"
    LIMIT 1
) AS t
LEFT JOIN (
    SELECT c0."Id", c0."AssignedAt", c0."AssignedBy", c0."BusinessId", c0."ContactId", c0."TagId", t1."Id" AS "Id0", t1."BusinessId" AS "BusinessId0", t1."Category", t1."ColorHex", t1."CreatedAt", t1."IsActive", t1."IsSystemTag", t1."LastUsedAt", t1."Name", t1."Notes"
    FROM "ContactTags" AS c0
    INNER JOIN "Tags" AS t1 ON c0."TagId" = t1."Id"
) AS t0 ON t."Id" = t0."ContactId"
ORDER BY t."Id", t0."Id"
2025-07-02 22:36:09.258 +05:30 [INF] Executing StatusCodeResult, setting HTTP status code 200
2025-07-02 22:36:10.990 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__userGuid_0='2870e1d8-0e80-4b12-88bd-70a8113307d6'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."BusinessId", c."ContactId", c."LastReadAt", c."UserId"
FROM "ContactReads" AS c
WHERE c."UserId" = @__userGuid_0
2025-07-02 22:36:10.991 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Inbox.Controllers.InboxController.GetMessagesByContact (xbytechat.api)'
2025-07-02 22:36:10.997 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Helpers.ResponseResult'.
2025-07-02 22:36:10.997 +05:30 [INF] Executed action xbytechat.api.Features.Inbox.Controllers.InboxController.MarkMessagesAsRead (xbytechat.api) in 1751.9584ms
2025-07-02 22:36:11.006 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Inbox.Controllers.InboxController.MarkMessagesAsRead (xbytechat.api)'
2025-07-02 22:36:11.005 +05:30 [INF] Executed action xbytechat.api.CRM.Controllers.ContactsController.GetContactById (xbytechat.api) in 1744.257ms
2025-07-02 22:36:11.002 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/inbox/messages?contactId=1b52f26e-9fad-4233-a6bb-57603945f8d6 - 200 null application/json; charset=utf-8 1767.1759ms
2025-07-02 22:36:11.007 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/api/inbox/mark-read?contactId=1b52f26e-9fad-4233-a6bb-57603945f8d6 - 200 0 null 1782.1818ms
2025-07-02 22:36:11.012 +05:30 [INF] Executed endpoint 'xbytechat.api.CRM.Controllers.ContactsController.GetContactById (xbytechat.api)'
2025-07-02 22:36:11.022 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/contacts/1b52f26e-9fad-4233-a6bb-57603945f8d6 - null null
2025-07-02 22:36:11.034 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:36:11.028 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/contacts/1b52f26e-9fad-4233-a6bb-57603945f8d6 - 200 null application/json; charset=utf-8 1793.984ms
2025-07-02 22:36:11.036 +05:30 [INF] Executing endpoint 'xbytechat.api.CRM.Controllers.ContactsController.GetContactById (xbytechat.api)'
2025-07-02 22:36:11.045 +05:30 [INF] Route matched with {action = "GetContactById", controller = "Contacts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetContactById(System.Guid) on controller xbytechat.api.CRM.Controllers.ContactsController (xbytechat.api).
2025-07-02 22:36:13.396 +05:30 [INF] GetContactByIdAsync: businessId="c13be597-6ae2-42bb-9d43-925815f24ff8", contactId="1b52f26e-9fad-4233-a6bb-57603945f8d6"
2025-07-02 22:36:13.403 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__contactId_1='1b52f26e-9fad-4233-a6bb-57603945f8d6'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."AssignedAgentId", t."BusinessId", t."CreatedAt", t."Email", t."Group", t."IsActive", t."IsArchived", t."IsAutomationPaused", t."IsFavorite", t."LastCTAInteraction", t."LastCTAType", t."LastClickedProductId", t."LastContactedAt", t."LeadSource", t."Name", t."NextFollowUpAt", t."Notes", t."PhoneNumber", t."Tags", t0."Id", t0."AssignedAt", t0."AssignedBy", t0."BusinessId", t0."ContactId", t0."TagId", t0."Id0", t0."BusinessId0", t0."Category", t0."ColorHex", t0."CreatedAt", t0."IsActive", t0."IsSystemTag", t0."LastUsedAt", t0."Name", t0."Notes"
FROM (
    SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."Tags"
    FROM "Contacts" AS c
    WHERE c."BusinessId" = @__businessId_0 AND c."Id" = @__contactId_1 AND c."IsActive"
    LIMIT 1
) AS t
LEFT JOIN (
    SELECT c0."Id", c0."AssignedAt", c0."AssignedBy", c0."BusinessId", c0."ContactId", c0."TagId", t1."Id" AS "Id0", t1."BusinessId" AS "BusinessId0", t1."Category", t1."ColorHex", t1."CreatedAt", t1."IsActive", t1."IsSystemTag", t1."LastUsedAt", t1."Name", t1."Notes"
    FROM "ContactTags" AS c0
    INNER JOIN "Tags" AS t1 ON c0."TagId" = t1."Id"
) AS t0 ON t."Id" = t0."ContactId"
ORDER BY t."Id", t0."Id"
2025-07-02 22:36:13.411 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Helpers.ResponseResult'.
2025-07-02 22:36:13.413 +05:30 [INF] Executed action xbytechat.api.CRM.Controllers.ContactsController.GetContactById (xbytechat.api) in 2364.6328ms
2025-07-02 22:36:13.415 +05:30 [INF] Executed endpoint 'xbytechat.api.CRM.Controllers.ContactsController.GetContactById (xbytechat.api)'
2025-07-02 22:36:13.417 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/contacts/1b52f26e-9fad-4233-a6bb-57603945f8d6 - 200 null application/json; charset=utf-8 2395.3656ms
2025-07-02 22:37:02.674 +05:30 [INF] Request starting HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - application/json 554
2025-07-02 22:37:02.678 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:37:02.680 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-07-02 22:37:02.683 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMDg4NjdBRDY2QUJCQUE5RDU0AA==","status":"delivered","timestamp":"1751202808","recipient_id":"917082156227","conversation":{"id":"58f619d47c20c6be0ed13fc43b468b54","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"CBP","category":"marketing"}}]},"field":"messages"}]}]}
2025-07-02 22:37:02.686 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-07-02 22:37:02.687 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMDg4NjdBRDY2QUJCQUE5RDU0AA==","status":"delivered","timestamp":"1751202808","recipient_id":"917082156227","conversation":{"id":"58f619d47c20c6be0ed13fc43b468b54","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"CBP","category":"marketing"}}]},"field":"messages"}]}]}
2025-07-02 22:37:02.687 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType73`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:37:02.689 +05:30 [INF] 📦 Routing to Status Processor
2025-07-02 22:37:02.691 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 8.7075ms
2025-07-02 22:37:02.692 +05:30 [WRN] 🔍 Incoming timestamp raw value: {"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMDg4NjdBRDY2QUJCQUE5RDU0AA==","status":"delivered","timestamp":"1751202808","recipient_id":"917082156227","conversation":{"id":"58f619d47c20c6be0ed13fc43b468b54","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"CBP","category":"marketing"}}]},"field":"messages"}]}]}
2025-07-02 22:37:02.693 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:37:02.698 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__messageId_0='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMDg4NjdBRDY2QUJCQUE5RDU0AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."MessageId" = @__messageId_0
LIMIT 1
2025-07-02 22:37:02.701 +05:30 [WRN] ⚠️ CampaignSendLog not found for MessageId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMDg4NjdBRDY2QUJCQUE5RDU0AA==
2025-07-02 22:37:02.699 +05:30 [INF] Request finished HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 23.8281ms
2025-07-02 22:37:02.702 +05:30 [WRN] ⚠️ No matching CampaignSendLog for MessageId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMDg4NjdBRDY2QUJCQUE5RDU0AA==
2025-07-02 22:37:24.535 +05:30 [INF] Request starting HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - application/json 487
2025-07-02 22:37:24.538 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:37:24.539 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-07-02 22:37:24.543 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"contacts":[{"profile":{"name":"S. Kumar"},"wa_id":"447543746206"}],"messages":[{"from":"447543746206","id":"wamid.HBgMNDQ3NTQzNzQ2MjA2FQIAEhggMTY3NjM4NDlERUY2N0RDMzYyNEQwQjg5QjA5QUZFNjYA","timestamp":"1751476046","text":{"body":"Hello"},"type":"text"}]},"field":"messages"}]}]}
2025-07-02 22:37:24.545 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-07-02 22:37:24.545 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"contacts":[{"profile":{"name":"S. Kumar"},"wa_id":"447543746206"}],"messages":[{"from":"447543746206","id":"wamid.HBgMNDQ3NTQzNzQ2MjA2FQIAEhggMTY3NjM4NDlERUY2N0RDMzYyNEQwQjg5QjA5QUZFNjYA","timestamp":"1751476046","text":{"body":"Hello"},"type":"text"}]},"field":"messages"}]}]}
2025-07-02 22:37:24.546 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType73`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:37:24.548 +05:30 [INF] 💬 Routing to InboundMessageProcessor (type: text)
2025-07-02 22:37:24.549 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 7.395ms
2025-07-02 22:37:24.556 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:37:24.559 +05:30 [INF] Request finished HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 24.0889ms
2025-07-02 22:37:24.559 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessNumber_0='15556395845'], CommandType='"Text"', CommandTimeout='30']
SELECT b."Id", b."Address", b."ApprovedAt", b."ApprovedBy", b."BusinessEmail", b."BusinessName", b."CompanyName", b."CompanyPhone", b."CreatedAt", b."CreatedBy", b."CreatedByPartnerId", b."DeletedAt", b."DeletedBy", b."Industry", b."IsApproved", b."IsDeleted", b."LastLoginAt", b."LogoUrl", b."Notes", b."Phone", b."RepresentativeName", b."Source", b."Status", b."Tags", b."Website", w."Id", w."ApiToken", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WhatsAppBusinessNumber"
FROM "Businesses" AS b
LEFT JOIN "WhatsAppSettings" AS w ON b."Id" = w."BusinessId"
WHERE w."WhatsAppBusinessNumber" = @__businessNumber_0
LIMIT 1
2025-07-02 22:37:24.568 +05:30 [INF] FindOrCreateAsync: businessId="c13be597-6ae2-42bb-9d43-925815f24ff8", phoneNumber=447543746206
2025-07-02 22:37:24.571 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__phoneNumber_1='447543746206'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."Tags"
FROM "Contacts" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."PhoneNumber" = @__phoneNumber_1
LIMIT 1
2025-07-02 22:37:24.599 +05:30 [INF] Executed DbCommand (20ms) [Parameters=[@p0='80c43c6a-508b-47ff-9360-201bfd5521d3', @p1=NULL (DbType = Guid), @p2='c13be597-6ae2-42bb-9d43-925815f24ff8', @p3='2025-07-02T17:07:24.5755343Z' (DbType = DateTime), @p4=NULL, @p5=NULL, @p6='True', @p7='False', @p8='False', @p9='False', @p10=NULL (DbType = DateTime), @p11=NULL, @p12=NULL (DbType = Guid), @p13=NULL (DbType = DateTime), @p14=NULL, @p15='WhatsApp User' (Nullable = false), @p16=NULL (DbType = DateTime), @p17=NULL, @p18='447543746206' (Nullable = false), @p19=NULL], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Contacts" ("Id", "AssignedAgentId", "BusinessId", "CreatedAt", "Email", "Group", "IsActive", "IsArchived", "IsAutomationPaused", "IsFavorite", "LastCTAInteraction", "LastCTAType", "LastClickedProductId", "LastContactedAt", "LeadSource", "Name", "NextFollowUpAt", "Notes", "PhoneNumber", "Tags")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19);
2025-07-02 22:37:24.604 +05:30 [INF] Contact created: "80c43c6a-508b-47ff-9360-201bfd5521d3"
2025-07-02 22:37:24.608 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__contactId_1='80c43c6a-508b-47ff-9360-201bfd5521d3'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."BusinessId", c."ContactId", c."LastUpdatedAt", c."Mode", c."UpdatedBy"
FROM "ChatSessionStates" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."ContactId" = @__contactId_1
LIMIT 1
2025-07-02 22:37:24.613 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@p0='6eab7e64-ee00-4703-82c3-f28ae5f48865', @p1='c13be597-6ae2-42bb-9d43-925815f24ff8', @p2=NULL (DbType = Guid), @p3=NULL (DbType = Guid), @p4=NULL (DbType = Guid), @p5='80c43c6a-508b-47ff-9360-201bfd5521d3' (Nullable = true), @p6='2025-07-02T17:07:24.6108970Z' (DbType = DateTime), @p7=NULL, @p8='True', @p9=NULL, @p10='Hello' (Nullable = false), @p11=NULL, @p12=NULL, @p13='447543746206' (Nullable = false), @p14=NULL (DbType = Guid), @p15=NULL, @p16='2025-07-02T17:07:24.6108971Z' (Nullable = true) (DbType = DateTime), @p17=NULL, @p18='received' (Nullable = false)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "MessageLogs" ("Id", "BusinessId", "CTAFlowConfigId", "CTAFlowStepId", "CampaignId", "ContactId", "CreatedAt", "ErrorMessage", "IsIncoming", "MediaUrl", "MessageContent", "MessageId", "RawResponse", "RecipientNumber", "RefMessageId", "RenderedBody", "SentAt", "Source", "Status")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
2025-07-02 22:37:24.622 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."BusinessId", a."CreatedAt", a."FlowId", a."FlowName", a."IsActive", a."MediaUrl", a."Priority", a."ReplyMessage", a."TriggerKeyword", a."UpdatedAt"
FROM "AutoReplyRules" AS a
WHERE a."BusinessId" = @__businessId_0 AND a."IsActive"
2025-07-02 22:37:24.626 +05:30 [INF] 🔍 No flow match found or FlowId is null. Trying fallback auto-reply...
2025-07-02 22:37:24.631 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__incomingMessage_1='Hello'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."BusinessId", a."CreatedAt", a."FlowId", a."FlowName", a."IsActive", a."MediaUrl", a."Priority", a."ReplyMessage", a."TriggerKeyword", a."UpdatedAt"
FROM "AutoReplyRules" AS a
WHERE a."BusinessId" = @__businessId_0 AND a."IsActive" AND strpos(@__incomingMessage_1, a."TriggerKeyword") > 0
ORDER BY a."Priority"
LIMIT 1
2025-07-02 22:37:24.635 +05:30 [INF] ❌ No fallback rule matched for: Hello
2025-07-02 22:37:27.635 +05:30 [INF] Executed DbCommand (5ms) [Parameters=[@p0='e917c4c1-d0b6-4e69-9107-60e536a2e705', @p1='c13be597-6ae2-42bb-9d43-925815f24ff8', @p2=NULL (DbType = Guid), @p3=NULL (DbType = Guid), @p4=NULL (DbType = Guid), @p5='80c43c6a-508b-47ff-9360-201bfd5521d3' (Nullable = true), @p6='2025-07-02T17:07:27.6278339Z' (DbType = DateTime), @p7=NULL, @p8='True', @p9=NULL, @p10='Hello' (Nullable = false), @p11=NULL, @p12=NULL, @p13='447543746206' (Nullable = false), @p14=NULL (DbType = Guid), @p15=NULL, @p16=NULL (DbType = DateTime), @p17=NULL, @p18='Queued' (Nullable = false)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "MessageLogs" ("Id", "BusinessId", "CTAFlowConfigId", "CTAFlowStepId", "CampaignId", "ContactId", "CreatedAt", "ErrorMessage", "IsIncoming", "MediaUrl", "MessageContent", "MessageId", "RawResponse", "RecipientNumber", "RefMessageId", "RenderedBody", "SentAt", "Source", "Status")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
2025-07-02 22:37:35.533 +05:30 [INF] Executed endpoint '/hubs/inbox'
2025-07-02 22:37:35.533 +05:30 [INF] Executed endpoint '/hubs/inbox'
2025-07-02 22:37:35.536 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/hubs/inbox?id=Oj6c5WENvQlhJXy_ZbWYCg - 101 null null 227339.6987ms
2025-07-02 22:37:35.535 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/hubs/inbox?id=UIj4igoj2lj8f7mKzbVSrw - 101 null null 227402.2522ms
2025-07-02 22:37:36.058 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/auth/session - null null
2025-07-02 22:37:36.065 +05:30 [INF] Executing endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 22:37:36.066 +05:30 [INF] Route matched with {action = "GetSession", controller = "Auth"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetSession() on controller xbytechat.api.AuthModule.Controllers.AuthController (xbytechat.api).
2025-07-02 22:37:36.073 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`4[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:37:36.076 +05:30 [INF] Executed action xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api) in 7.2799ms
2025-07-02 22:37:36.079 +05:30 [INF] Executed endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 22:37:36.081 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/auth/session - 200 null application/json; charset=utf-8 22.2689ms
2025-07-02 22:37:36.097 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/feature-access/me - null null
2025-07-02 22:37:36.101 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 22:37:36.103 +05:30 [INF] Route matched with {action = "GetMyFeatures", controller = "FeatureAccess"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto]]] GetMyFeatures() on controller xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController (xbytechat.api).
2025-07-02 22:37:36.111 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT b."Id", b."Address", b."ApprovedAt", b."ApprovedBy", b."BusinessEmail", b."BusinessName", b."CompanyName", b."CompanyPhone", b."CreatedAt", b."CreatedBy", b."CreatedByPartnerId", b."DeletedAt", b."DeletedBy", b."Industry", b."IsApproved", b."IsDeleted", b."LastLoginAt", b."LogoUrl", b."Notes", b."Phone", b."RepresentativeName", b."Source", b."Status", b."Tags", b."Website", b0."Id", b0."BusinessId", b0."CreatedAt", b0."Plan", b0."QuotaResetDate", b0."RemainingMessages", b0."TotalMonthlyQuota", b0."UpdatedAt", b0."WalletBalance"
FROM "Businesses" AS b
LEFT JOIN "BusinessPlanInfos" AS b0 ON b."Id" = b0."BusinessId"
WHERE b."Id" = @__businessId_0
LIMIT 1
2025-07-02 22:37:36.117 +05:30 [INF] 📦 Resolved plan for Business "c13be597-6ae2-42bb-9d43-925815f24ff8": Smart
2025-07-02 22:37:36.121 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."BusinessId", f."CreatedAt", f."Description", f."FeatureName", f."Group", f."IsEnabled", f."Notes", f."Plan"
FROM "FeatureAccess" AS f
WHERE f."BusinessId" = @__businessId_0
2025-07-02 22:37:36.124 +05:30 [INF] 🔧 Feature override: AddProduct = False
2025-07-02 22:37:36.125 +05:30 [INF] 🔧 Feature override: Automation = True
2025-07-02 22:37:36.127 +05:30 [INF] 🔧 Feature override: Campaigns = True
2025-07-02 22:37:36.128 +05:30 [INF] 🔧 Feature override: Catalog = True
2025-07-02 22:37:36.129 +05:30 [INF] 🔧 Feature override: CRM = True
2025-07-02 22:37:36.130 +05:30 [INF] 🔧 Feature override: CRMInsights = True
2025-07-02 22:37:36.131 +05:30 [INF] 🔧 Feature override: CTAFlow = True
2025-07-02 22:37:36.131 +05:30 [INF] 🔧 Feature override: FlowInsights = True
2025-07-02 22:37:36.133 +05:30 [INF] 🔧 Feature override: Messaging = True
2025-07-02 22:37:36.134 +05:30 [INF] 🔧 Feature override: ProfileCompletion = True
2025-07-02 22:37:36.135 +05:30 [INF] 🔧 Feature override: UpgradePlan = True
2025-07-02 22:37:36.136 +05:30 [INF] 🔧 Feature override: WhatsAppSettings = True
2025-07-02 22:37:36.138 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 22:37:36.140 +05:30 [INF] Executed action xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api) in 34.2476ms
2025-07-02 22:37:36.142 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 22:37:36.144 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/feature-access/me - 200 null application/json; charset=utf-8 47.5027ms
2025-07-02 22:37:36.241 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null null
2025-07-02 22:37:36.243 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/contacts/all - null null
2025-07-02 22:37:36.245 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/inbox/unread-counts - null null
2025-07-02 22:37:36.246 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:37:36.249 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null null
2025-07-02 22:37:36.253 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:37:36.254 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 204 null null 13.1081ms
2025-07-02 22:37:36.258 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null 0
2025-07-02 22:37:36.250 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:37:36.259 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:37:36.260 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Inbox.Controllers.InboxController.GetUnreadCounts (xbytechat.api)'
2025-07-02 22:37:36.267 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:37:36.269 +05:30 [INF] Executing endpoint 'xbytechat.api.CRM.Controllers.ContactsController.GetAllContactsFlat (xbytechat.api)'
2025-07-02 22:37:36.270 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 204 null null 20.43ms
2025-07-02 22:37:36.271 +05:30 [INF] Route matched with {action = "GetUnreadCounts", controller = "Inbox"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUnreadCounts() on controller xbytechat.api.Features.Inbox.Controllers.InboxController (xbytechat.api).
2025-07-02 22:37:36.272 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null 0
2025-07-02 22:37:36.274 +05:30 [INF] Route matched with {action = "GetAllContactsFlat", controller = "Contacts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllContactsFlat() on controller xbytechat.api.CRM.Controllers.ContactsController (xbytechat.api).
2025-07-02 22:37:36.284 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='2870e1d8-0e80-4b12-88bd-70a8113307d6'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."BusinessId", c."ContactId", c."LastReadAt", c."UserId"
FROM "ContactReads" AS c
WHERE c."UserId" = @__userId_0
2025-07-02 22:37:36.273 +05:30 [INF] Executing endpoint '/hubs/inbox/negotiate'
2025-07-02 22:37:36.287 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:37:39.319 +05:30 [INF] GetAllContactsAsync: businessId="c13be597-6ae2-42bb-9d43-925815f24ff8", tab=all
2025-07-02 22:37:39.324 +05:30 [INF] Executed endpoint '/hubs/inbox/negotiate'
2025-07-02 22:37:39.327 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 200 316 application/json 3069.335ms
2025-07-02 22:37:39.324 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."CreatedAt", m."ErrorMessage", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."IsIncoming" AND m."ContactId" IS NOT NULL
2025-07-02 22:37:39.329 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."Tags", t0."Id", t0."AssignedAt", t0."AssignedBy", t0."BusinessId", t0."ContactId", t0."TagId", t0."Id0", t0."BusinessId0", t0."Category", t0."ColorHex", t0."CreatedAt", t0."IsActive", t0."IsSystemTag", t0."LastUsedAt", t0."Name", t0."Notes"
FROM "Contacts" AS c
LEFT JOIN (
    SELECT c0."Id", c0."AssignedAt", c0."AssignedBy", c0."BusinessId", c0."ContactId", c0."TagId", t."Id" AS "Id0", t."BusinessId" AS "BusinessId0", t."Category", t."ColorHex", t."CreatedAt", t."IsActive", t."IsSystemTag", t."LastUsedAt", t."Name", t."Notes"
    FROM "ContactTags" AS c0
    INNER JOIN "Tags" AS t ON c0."TagId" = t."Id"
) AS t0 ON c."Id" = t0."ContactId"
WHERE c."BusinessId" = @__businessId_0 AND c."IsActive"
ORDER BY c."Id", t0."Id"
2025-07-02 22:37:39.325 +05:30 [INF] Executing endpoint '/hubs/inbox/negotiate'
2025-07-02 22:37:39.338 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/hubs/inbox?id=a_3qYVdtJQi2adEddGLgNw - null null
2025-07-02 22:37:39.340 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.Dictionary`2[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:37:39.342 +05:30 [INF] GetAllContactsAsync returned 7 contacts
2025-07-02 22:37:39.343 +05:30 [INF] Executed endpoint '/hubs/inbox/negotiate'
2025-07-02 22:37:39.346 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:37:39.348 +05:30 [INF] Executed action xbytechat.api.Features.Inbox.Controllers.InboxController.GetUnreadCounts (xbytechat.api) in 3067.1321ms
2025-07-02 22:37:39.350 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+SelectListIterator`2[[xbytechat.api.CRM.Models.Contact, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[xbytechat.api.CRM.Dtos.ContactDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 22:37:39.351 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 200 316 application/json 3079.4324ms
2025-07-02 22:37:39.353 +05:30 [INF] Executing endpoint '/hubs/inbox'
2025-07-02 22:37:39.354 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Inbox.Controllers.InboxController.GetUnreadCounts (xbytechat.api)'
2025-07-02 22:37:39.356 +05:30 [INF] Executed action xbytechat.api.CRM.Controllers.ContactsController.GetAllContactsFlat (xbytechat.api) in 3065.7997ms
2025-07-02 22:37:39.366 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/inbox/unread-counts - 200 null application/json; charset=utf-8 3121.2023ms
2025-07-02 22:37:39.368 +05:30 [INF] Executed endpoint 'xbytechat.api.CRM.Controllers.ContactsController.GetAllContactsFlat (xbytechat.api)'
2025-07-02 22:37:39.375 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/contacts/all - 200 null application/json; charset=utf-8 3132.7395ms
2025-07-02 22:37:39.378 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/hubs/inbox?id=vqcV2vF4vJK1xDqbaJiMcA - null null
2025-07-02 22:37:39.384 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:37:39.386 +05:30 [INF] Executing endpoint '/hubs/inbox'
2025-07-02 22:37:42.808 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/api/inbox/mark-read?contactId=80c43c6a-508b-47ff-9360-201bfd5521d3 - null 0
2025-07-02 22:37:42.813 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:37:42.815 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/inbox/messages?contactId=80c43c6a-508b-47ff-9360-201bfd5521d3 - null null
2025-07-02 22:37:42.819 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:37:42.820 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Inbox.Controllers.InboxController.GetMessagesByContact (xbytechat.api)'
2025-07-02 22:37:42.816 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/contacts/80c43c6a-508b-47ff-9360-201bfd5521d3 - null null
2025-07-02 22:37:42.816 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Inbox.Controllers.InboxController.MarkMessagesAsRead (xbytechat.api)'
2025-07-02 22:37:42.821 +05:30 [INF] Route matched with {action = "GetMessagesByContact", controller = "Inbox"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesByContact(System.Guid) on controller xbytechat.api.Features.Inbox.Controllers.InboxController (xbytechat.api).
2025-07-02 22:37:42.826 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:37:42.827 +05:30 [INF] Route matched with {action = "MarkMessagesAsRead", controller = "Inbox"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MarkMessagesAsRead(System.Guid) on controller xbytechat.api.Features.Inbox.Controllers.InboxController (xbytechat.api).
2025-07-02 22:37:42.832 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__contactId_1='80c43c6a-508b-47ff-9360-201bfd5521d3' (Nullable = true)], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."CreatedAt", m."ErrorMessage", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."SentAt", m."Source", m."Status", c."Id", c."BusinessId", c."CampaignId", c."CampaignType", c."CreatedAt", c."CreatedBy", c."CtaId", c."DeletedAt", c."DeletedBy", c."FollowUpTemplateId", c."ImageCaption", c."ImageUrl", c."IsDeleted", c."MessageBody", c."MessageTemplate", c."Name", c."ScheduledAt", c."SourceCampaignId", c."Status", c."TemplateId", c."TemplateParameters", c."UpdatedAt"
FROM "MessageLogs" AS m
LEFT JOIN "Campaigns" AS c ON m."CampaignId" = c."Id"
WHERE m."BusinessId" = @__businessId_0 AND m."ContactId" = @__contactId_1
ORDER BY m."CreatedAt"
2025-07-02 22:37:42.830 +05:30 [INF] Executing endpoint 'xbytechat.api.CRM.Controllers.ContactsController.GetContactById (xbytechat.api)'
2025-07-02 22:37:42.841 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.MessageManagement.DTOs.MessageLogDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 22:37:42.841 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__contactId_1='80c43c6a-508b-47ff-9360-201bfd5521d3' (Nullable = true)], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."CreatedAt", m."ErrorMessage", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."ContactId" = @__contactId_1 AND m."IsIncoming" AND m."Status" <> 'Read'
2025-07-02 22:37:42.845 +05:30 [INF] Route matched with {action = "GetContactById", controller = "Contacts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetContactById(System.Guid) on controller xbytechat.api.CRM.Controllers.ContactsController (xbytechat.api).
2025-07-02 22:37:42.847 +05:30 [INF] Executed action xbytechat.api.Features.Inbox.Controllers.InboxController.GetMessagesByContact (xbytechat.api) in 17.6871ms
2025-07-02 22:37:44.458 +05:30 [INF] GetContactByIdAsync: businessId="c13be597-6ae2-42bb-9d43-925815f24ff8", contactId="80c43c6a-508b-47ff-9360-201bfd5521d3"
2025-07-02 22:37:44.459 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Inbox.Controllers.InboxController.GetMessagesByContact (xbytechat.api)'
2025-07-02 22:37:42.853 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@p1='6eab7e64-ee00-4703-82c3-f28ae5f48865', @p0='Read' (Nullable = false), @p3='e917c4c1-d0b6-4e69-9107-60e536a2e705', @p2='Read' (Nullable = false)], CommandType='"Text"', CommandTimeout='30']
UPDATE "MessageLogs" SET "Status" = @p0
WHERE "Id" = @p1;
UPDATE "MessageLogs" SET "Status" = @p2
WHERE "Id" = @p3;
2025-07-02 22:37:44.464 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/inbox/messages?contactId=80c43c6a-508b-47ff-9360-201bfd5521d3 - 200 null application/json; charset=utf-8 1648.1824ms
2025-07-02 22:37:44.466 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__contactId_1='80c43c6a-508b-47ff-9360-201bfd5521d3'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."AssignedAgentId", t."BusinessId", t."CreatedAt", t."Email", t."Group", t."IsActive", t."IsArchived", t."IsAutomationPaused", t."IsFavorite", t."LastCTAInteraction", t."LastCTAType", t."LastClickedProductId", t."LastContactedAt", t."LeadSource", t."Name", t."NextFollowUpAt", t."Notes", t."PhoneNumber", t."Tags", t0."Id", t0."AssignedAt", t0."AssignedBy", t0."BusinessId", t0."ContactId", t0."TagId", t0."Id0", t0."BusinessId0", t0."Category", t0."ColorHex", t0."CreatedAt", t0."IsActive", t0."IsSystemTag", t0."LastUsedAt", t0."Name", t0."Notes"
FROM (
    SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."Tags"
    FROM "Contacts" AS c
    WHERE c."BusinessId" = @__businessId_0 AND c."Id" = @__contactId_1 AND c."IsActive"
    LIMIT 1
) AS t
LEFT JOIN (
    SELECT c0."Id", c0."AssignedAt", c0."AssignedBy", c0."BusinessId", c0."ContactId", c0."TagId", t1."Id" AS "Id0", t1."BusinessId" AS "BusinessId0", t1."Category", t1."ColorHex", t1."CreatedAt", t1."IsActive", t1."IsSystemTag", t1."LastUsedAt", t1."Name", t1."Notes"
    FROM "ContactTags" AS c0
    INNER JOIN "Tags" AS t1 ON c0."TagId" = t1."Id"
) AS t0 ON t."Id" = t0."ContactId"
ORDER BY t."Id", t0."Id"
2025-07-02 22:37:44.462 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__contactId_0='80c43c6a-508b-47ff-9360-201bfd5521d3', @__userGuid_1='2870e1d8-0e80-4b12-88bd-70a8113307d6'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."BusinessId", c."ContactId", c."LastReadAt", c."UserId"
FROM "ContactReads" AS c
WHERE c."ContactId" = @__contactId_0 AND c."UserId" = @__userGuid_1
LIMIT 1
2025-07-02 22:37:44.472 +05:30 [INF] Executing StatusCodeResult, setting HTTP status code 200
2025-07-02 22:37:44.479 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Helpers.ResponseResult'.
2025-07-02 22:37:44.483 +05:30 [INF] Executed action xbytechat.api.Features.Inbox.Controllers.InboxController.MarkMessagesAsRead (xbytechat.api) in 1645.6525ms
2025-07-02 22:37:44.485 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@p0='65f8bfb6-4b4e-44f7-90d5-aaab06fdadad', @p1='c13be597-6ae2-42bb-9d43-925815f24ff8', @p2='80c43c6a-508b-47ff-9360-201bfd5521d3', @p3='2025-07-02T17:07:44.4595416Z' (DbType = DateTime), @p4='2870e1d8-0e80-4b12-88bd-70a8113307d6'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "ContactReads" ("Id", "BusinessId", "ContactId", "LastReadAt", "UserId")
VALUES (@p0, @p1, @p2, @p3, @p4);
2025-07-02 22:37:44.487 +05:30 [INF] Executed action xbytechat.api.CRM.Controllers.ContactsController.GetContactById (xbytechat.api) in 1632.2591ms
2025-07-02 22:37:44.488 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Inbox.Controllers.InboxController.MarkMessagesAsRead (xbytechat.api)'
2025-07-02 22:37:44.488 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/contacts/80c43c6a-508b-47ff-9360-201bfd5521d3 - null null
2025-07-02 22:37:44.493 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessGuid_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."CreatedAt", m."ErrorMessage", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessGuid_0 AND m."IsIncoming" AND m."ContactId" IS NOT NULL
2025-07-02 22:37:44.494 +05:30 [INF] Executed endpoint 'xbytechat.api.CRM.Controllers.ContactsController.GetContactById (xbytechat.api)'
2025-07-02 22:37:44.495 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/api/inbox/mark-read?contactId=80c43c6a-508b-47ff-9360-201bfd5521d3 - 200 0 null 1687.2402ms
2025-07-02 22:37:44.500 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:37:44.506 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__userGuid_0='2870e1d8-0e80-4b12-88bd-70a8113307d6'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."BusinessId", c."ContactId", c."LastReadAt", c."UserId"
FROM "ContactReads" AS c
WHERE c."UserId" = @__userGuid_0
2025-07-02 22:37:44.506 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/contacts/80c43c6a-508b-47ff-9360-201bfd5521d3 - 200 null application/json; charset=utf-8 1690.4247ms
2025-07-02 22:37:44.513 +05:30 [INF] Executing endpoint 'xbytechat.api.CRM.Controllers.ContactsController.GetContactById (xbytechat.api)'
2025-07-02 22:37:44.522 +05:30 [INF] Route matched with {action = "GetContactById", controller = "Contacts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetContactById(System.Guid) on controller xbytechat.api.CRM.Controllers.ContactsController (xbytechat.api).
2025-07-02 22:37:46.334 +05:30 [INF] GetContactByIdAsync: businessId="c13be597-6ae2-42bb-9d43-925815f24ff8", contactId="80c43c6a-508b-47ff-9360-201bfd5521d3"
2025-07-02 22:37:46.340 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__contactId_1='80c43c6a-508b-47ff-9360-201bfd5521d3'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."AssignedAgentId", t."BusinessId", t."CreatedAt", t."Email", t."Group", t."IsActive", t."IsArchived", t."IsAutomationPaused", t."IsFavorite", t."LastCTAInteraction", t."LastCTAType", t."LastClickedProductId", t."LastContactedAt", t."LeadSource", t."Name", t."NextFollowUpAt", t."Notes", t."PhoneNumber", t."Tags", t0."Id", t0."AssignedAt", t0."AssignedBy", t0."BusinessId", t0."ContactId", t0."TagId", t0."Id0", t0."BusinessId0", t0."Category", t0."ColorHex", t0."CreatedAt", t0."IsActive", t0."IsSystemTag", t0."LastUsedAt", t0."Name", t0."Notes"
FROM (
    SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."Tags"
    FROM "Contacts" AS c
    WHERE c."BusinessId" = @__businessId_0 AND c."Id" = @__contactId_1 AND c."IsActive"
    LIMIT 1
) AS t
LEFT JOIN (
    SELECT c0."Id", c0."AssignedAt", c0."AssignedBy", c0."BusinessId", c0."ContactId", c0."TagId", t1."Id" AS "Id0", t1."BusinessId" AS "BusinessId0", t1."Category", t1."ColorHex", t1."CreatedAt", t1."IsActive", t1."IsSystemTag", t1."LastUsedAt", t1."Name", t1."Notes"
    FROM "ContactTags" AS c0
    INNER JOIN "Tags" AS t1 ON c0."TagId" = t1."Id"
) AS t0 ON t."Id" = t0."ContactId"
ORDER BY t."Id", t0."Id"
2025-07-02 22:37:46.348 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Helpers.ResponseResult'.
2025-07-02 22:37:46.353 +05:30 [INF] Executed action xbytechat.api.CRM.Controllers.ContactsController.GetContactById (xbytechat.api) in 1828.5133ms
2025-07-02 22:37:46.356 +05:30 [INF] Executed endpoint 'xbytechat.api.CRM.Controllers.ContactsController.GetContactById (xbytechat.api)'
2025-07-02 22:37:46.357 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/contacts/80c43c6a-508b-47ff-9360-201bfd5521d3 - 200 null application/json; charset=utf-8 1869.5792ms
2025-07-02 22:37:51.417 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/api/inbox/mark-read?contactId=491ee04c-27c4-49e4-9bb8-ef8892951090 - null 0
2025-07-02 22:37:51.422 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:37:51.426 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/contacts/491ee04c-27c4-49e4-9bb8-ef8892951090 - null null
2025-07-02 22:37:51.426 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Inbox.Controllers.InboxController.MarkMessagesAsRead (xbytechat.api)'
2025-07-02 22:37:51.426 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/inbox/messages?contactId=491ee04c-27c4-49e4-9bb8-ef8892951090 - null null
2025-07-02 22:37:51.430 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:37:51.431 +05:30 [INF] Route matched with {action = "MarkMessagesAsRead", controller = "Inbox"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MarkMessagesAsRead(System.Guid) on controller xbytechat.api.Features.Inbox.Controllers.InboxController (xbytechat.api).
2025-07-02 22:37:51.435 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:37:51.436 +05:30 [INF] Executing endpoint 'xbytechat.api.CRM.Controllers.ContactsController.GetContactById (xbytechat.api)'
2025-07-02 22:37:51.442 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Inbox.Controllers.InboxController.GetMessagesByContact (xbytechat.api)'
2025-07-02 22:37:51.442 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__contactId_1='491ee04c-27c4-49e4-9bb8-ef8892951090' (Nullable = true)], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."CreatedAt", m."ErrorMessage", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."ContactId" = @__contactId_1 AND m."IsIncoming" AND m."Status" <> 'Read'
2025-07-02 22:37:51.445 +05:30 [INF] Route matched with {action = "GetContactById", controller = "Contacts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetContactById(System.Guid) on controller xbytechat.api.CRM.Controllers.ContactsController (xbytechat.api).
2025-07-02 22:37:51.447 +05:30 [INF] Route matched with {action = "GetMessagesByContact", controller = "Inbox"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessagesByContact(System.Guid) on controller xbytechat.api.Features.Inbox.Controllers.InboxController (xbytechat.api).
2025-07-02 22:37:51.451 +05:30 [INF] Executing StatusCodeResult, setting HTTP status code 200
2025-07-02 22:37:52.845 +05:30 [INF] GetContactByIdAsync: businessId="c13be597-6ae2-42bb-9d43-925815f24ff8", contactId="491ee04c-27c4-49e4-9bb8-ef8892951090"
2025-07-02 22:37:52.850 +05:30 [INF] Executed action xbytechat.api.Features.Inbox.Controllers.InboxController.MarkMessagesAsRead (xbytechat.api) in 1411.7015ms
2025-07-02 22:37:52.858 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__contactId_1='491ee04c-27c4-49e4-9bb8-ef8892951090'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."AssignedAgentId", t."BusinessId", t."CreatedAt", t."Email", t."Group", t."IsActive", t."IsArchived", t."IsAutomationPaused", t."IsFavorite", t."LastCTAInteraction", t."LastCTAType", t."LastClickedProductId", t."LastContactedAt", t."LeadSource", t."Name", t."NextFollowUpAt", t."Notes", t."PhoneNumber", t."Tags", t0."Id", t0."AssignedAt", t0."AssignedBy", t0."BusinessId", t0."ContactId", t0."TagId", t0."Id0", t0."BusinessId0", t0."Category", t0."ColorHex", t0."CreatedAt", t0."IsActive", t0."IsSystemTag", t0."LastUsedAt", t0."Name", t0."Notes"
FROM (
    SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."Tags"
    FROM "Contacts" AS c
    WHERE c."BusinessId" = @__businessId_0 AND c."Id" = @__contactId_1 AND c."IsActive"
    LIMIT 1
) AS t
LEFT JOIN (
    SELECT c0."Id", c0."AssignedAt", c0."AssignedBy", c0."BusinessId", c0."ContactId", c0."TagId", t1."Id" AS "Id0", t1."BusinessId" AS "BusinessId0", t1."Category", t1."ColorHex", t1."CreatedAt", t1."IsActive", t1."IsSystemTag", t1."LastUsedAt", t1."Name", t1."Notes"
    FROM "ContactTags" AS c0
    INNER JOIN "Tags" AS t1 ON c0."TagId" = t1."Id"
) AS t0 ON t."Id" = t0."ContactId"
ORDER BY t."Id", t0."Id"
2025-07-02 22:37:52.852 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__contactId_1='491ee04c-27c4-49e4-9bb8-ef8892951090' (Nullable = true)], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."CreatedAt", m."ErrorMessage", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."SentAt", m."Source", m."Status", c."Id", c."BusinessId", c."CampaignId", c."CampaignType", c."CreatedAt", c."CreatedBy", c."CtaId", c."DeletedAt", c."DeletedBy", c."FollowUpTemplateId", c."ImageCaption", c."ImageUrl", c."IsDeleted", c."MessageBody", c."MessageTemplate", c."Name", c."ScheduledAt", c."SourceCampaignId", c."Status", c."TemplateId", c."TemplateParameters", c."UpdatedAt"
FROM "MessageLogs" AS m
LEFT JOIN "Campaigns" AS c ON m."CampaignId" = c."Id"
WHERE m."BusinessId" = @__businessId_0 AND m."ContactId" = @__contactId_1
ORDER BY m."CreatedAt"
2025-07-02 22:37:52.859 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Inbox.Controllers.InboxController.MarkMessagesAsRead (xbytechat.api)'
2025-07-02 22:37:52.864 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Helpers.ResponseResult'.
2025-07-02 22:37:52.867 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.MessageManagement.DTOs.MessageLogDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 22:37:52.870 +05:30 [INF] Executed action xbytechat.api.CRM.Controllers.ContactsController.GetContactById (xbytechat.api) in 1417.4011ms
2025-07-02 22:37:52.868 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/api/inbox/mark-read?contactId=491ee04c-27c4-49e4-9bb8-ef8892951090 - 200 0 null 1451.4253ms
2025-07-02 22:37:52.873 +05:30 [INF] Executed action xbytechat.api.Features.Inbox.Controllers.InboxController.GetMessagesByContact (xbytechat.api) in 24.2017ms
2025-07-02 22:37:52.875 +05:30 [INF] Executed endpoint 'xbytechat.api.CRM.Controllers.ContactsController.GetContactById (xbytechat.api)'
2025-07-02 22:37:52.879 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/contacts/491ee04c-27c4-49e4-9bb8-ef8892951090 - null null
2025-07-02 22:37:52.881 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Inbox.Controllers.InboxController.GetMessagesByContact (xbytechat.api)'
2025-07-02 22:37:52.882 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/contacts/491ee04c-27c4-49e4-9bb8-ef8892951090 - 200 null application/json; charset=utf-8 1456.667ms
2025-07-02 22:37:52.886 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:37:52.888 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/inbox/messages?contactId=491ee04c-27c4-49e4-9bb8-ef8892951090 - 200 null application/json; charset=utf-8 1462.0425ms
2025-07-02 22:37:52.896 +05:30 [INF] Executing endpoint 'xbytechat.api.CRM.Controllers.ContactsController.GetContactById (xbytechat.api)'
2025-07-02 22:37:52.902 +05:30 [INF] Route matched with {action = "GetContactById", controller = "Contacts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetContactById(System.Guid) on controller xbytechat.api.CRM.Controllers.ContactsController (xbytechat.api).
2025-07-02 22:37:54.122 +05:30 [INF] GetContactByIdAsync: businessId="c13be597-6ae2-42bb-9d43-925815f24ff8", contactId="491ee04c-27c4-49e4-9bb8-ef8892951090"
2025-07-02 22:37:54.125 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__contactId_0='491ee04c-27c4-49e4-9bb8-ef8892951090', @__userGuid_1='2870e1d8-0e80-4b12-88bd-70a8113307d6'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."BusinessId", c."ContactId", c."LastReadAt", c."UserId"
FROM "ContactReads" AS c
WHERE c."ContactId" = @__contactId_0 AND c."UserId" = @__userGuid_1
LIMIT 1
2025-07-02 22:37:54.132 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__contactId_1='491ee04c-27c4-49e4-9bb8-ef8892951090'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."AssignedAgentId", t."BusinessId", t."CreatedAt", t."Email", t."Group", t."IsActive", t."IsArchived", t."IsAutomationPaused", t."IsFavorite", t."LastCTAInteraction", t."LastCTAType", t."LastClickedProductId", t."LastContactedAt", t."LeadSource", t."Name", t."NextFollowUpAt", t."Notes", t."PhoneNumber", t."Tags", t0."Id", t0."AssignedAt", t0."AssignedBy", t0."BusinessId", t0."ContactId", t0."TagId", t0."Id0", t0."BusinessId0", t0."Category", t0."ColorHex", t0."CreatedAt", t0."IsActive", t0."IsSystemTag", t0."LastUsedAt", t0."Name", t0."Notes"
FROM (
    SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."Tags"
    FROM "Contacts" AS c
    WHERE c."BusinessId" = @__businessId_0 AND c."Id" = @__contactId_1 AND c."IsActive"
    LIMIT 1
) AS t
LEFT JOIN (
    SELECT c0."Id", c0."AssignedAt", c0."AssignedBy", c0."BusinessId", c0."ContactId", c0."TagId", t1."Id" AS "Id0", t1."BusinessId" AS "BusinessId0", t1."Category", t1."ColorHex", t1."CreatedAt", t1."IsActive", t1."IsSystemTag", t1."LastUsedAt", t1."Name", t1."Notes"
    FROM "ContactTags" AS c0
    INNER JOIN "Tags" AS t1 ON c0."TagId" = t1."Id"
) AS t0 ON t."Id" = t0."ContactId"
ORDER BY t."Id", t0."Id"
2025-07-02 22:37:54.139 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Helpers.ResponseResult'.
2025-07-02 22:37:54.141 +05:30 [INF] Executed action xbytechat.api.CRM.Controllers.ContactsController.GetContactById (xbytechat.api) in 1235.2459ms
2025-07-02 22:37:54.143 +05:30 [INF] Executed endpoint 'xbytechat.api.CRM.Controllers.ContactsController.GetContactById (xbytechat.api)'
2025-07-02 22:37:54.144 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/contacts/491ee04c-27c4-49e4-9bb8-ef8892951090 - 200 null application/json; charset=utf-8 1264.5634ms
2025-07-02 22:37:54.154 +05:30 [INF] Executed DbCommand (20ms) [Parameters=[@p0='be0b9193-d7aa-42a0-920a-2ee1a60c3470', @p1='c13be597-6ae2-42bb-9d43-925815f24ff8', @p2='491ee04c-27c4-49e4-9bb8-ef8892951090', @p3='2025-07-02T17:07:54.1229045Z' (DbType = DateTime), @p4='2870e1d8-0e80-4b12-88bd-70a8113307d6'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "ContactReads" ("Id", "BusinessId", "ContactId", "LastReadAt", "UserId")
VALUES (@p0, @p1, @p2, @p3, @p4);
2025-07-02 22:37:54.160 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessGuid_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."CreatedAt", m."ErrorMessage", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessGuid_0 AND m."IsIncoming" AND m."ContactId" IS NOT NULL
2025-07-02 22:37:54.166 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__userGuid_0='2870e1d8-0e80-4b12-88bd-70a8113307d6'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."BusinessId", c."ContactId", c."LastReadAt", c."UserId"
FROM "ContactReads" AS c
WHERE c."UserId" = @__userGuid_0
2025-07-02 22:37:56.316 +05:30 [INF] Request starting HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - application/json 581
2025-07-02 22:37:56.320 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:37:56.322 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-07-02 22:37:56.326 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSM0RDNDM3M0Q3RjZBNjIyMTIzAA==","status":"sent","timestamp":"1751182917","recipient_id":"917082156227","conversation":{"id":"90b38ee00c6455dcc79733c1fd93f79a","expiration_timestamp":"1751269260","origin":{"type":"service"}},"pricing":{"billable":true,"pricing_model":"CBP","category":"service"}}]},"field":"messages"}]}]}
2025-07-02 22:37:56.329 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-07-02 22:37:56.330 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSM0RDNDM3M0Q3RjZBNjIyMTIzAA==","status":"sent","timestamp":"1751182917","recipient_id":"917082156227","conversation":{"id":"90b38ee00c6455dcc79733c1fd93f79a","expiration_timestamp":"1751269260","origin":{"type":"service"}},"pricing":{"billable":true,"pricing_model":"CBP","category":"service"}}]},"field":"messages"}]}]}
2025-07-02 22:37:56.330 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType73`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:37:56.332 +05:30 [INF] 📦 Routing to Status Processor
2025-07-02 22:37:56.334 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 8.842ms
2025-07-02 22:37:56.336 +05:30 [WRN] 🔍 Incoming timestamp raw value: {"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSM0RDNDM3M0Q3RjZBNjIyMTIzAA==","status":"sent","timestamp":"1751182917","recipient_id":"917082156227","conversation":{"id":"90b38ee00c6455dcc79733c1fd93f79a","expiration_timestamp":"1751269260","origin":{"type":"service"}},"pricing":{"billable":true,"pricing_model":"CBP","category":"service"}}]},"field":"messages"}]}]}
2025-07-02 22:37:56.337 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:37:56.342 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__messageId_0='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSM0RDNDM3M0Q3RjZBNjIyMTIzAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."MessageId" = @__messageId_0
LIMIT 1
2025-07-02 22:37:56.342 +05:30 [INF] Request finished HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 25.8729ms
2025-07-02 22:37:56.345 +05:30 [WRN] ⚠️ CampaignSendLog not found for MessageId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSM0RDNDM3M0Q3RjZBNjIyMTIzAA==
2025-07-02 22:37:56.350 +05:30 [WRN] ⚠️ No matching CampaignSendLog for MessageId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSM0RDNDM3M0Q3RjZBNjIyMTIzAA==
2025-07-02 22:38:01.857 +05:30 [INF] Request starting HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - application/json 581
2025-07-02 22:38:01.861 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:38:01.862 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-07-02 22:38:01.865 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSOTRCRUFGMTVGRTYwQzNFNEY3AA==","status":"sent","timestamp":"1751189913","recipient_id":"917082156227","conversation":{"id":"90b38ee00c6455dcc79733c1fd93f79a","expiration_timestamp":"1751269260","origin":{"type":"service"}},"pricing":{"billable":true,"pricing_model":"CBP","category":"service"}}]},"field":"messages"}]}]}
2025-07-02 22:38:01.867 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-07-02 22:38:01.868 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSOTRCRUFGMTVGRTYwQzNFNEY3AA==","status":"sent","timestamp":"1751189913","recipient_id":"917082156227","conversation":{"id":"90b38ee00c6455dcc79733c1fd93f79a","expiration_timestamp":"1751269260","origin":{"type":"service"}},"pricing":{"billable":true,"pricing_model":"CBP","category":"service"}}]},"field":"messages"}]}]}
2025-07-02 22:38:01.868 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType73`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:38:01.872 +05:30 [INF] 📦 Routing to Status Processor
2025-07-02 22:38:01.874 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 9.0314ms
2025-07-02 22:38:01.878 +05:30 [WRN] 🔍 Incoming timestamp raw value: {"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSOTRCRUFGMTVGRTYwQzNFNEY3AA==","status":"sent","timestamp":"1751189913","recipient_id":"917082156227","conversation":{"id":"90b38ee00c6455dcc79733c1fd93f79a","expiration_timestamp":"1751269260","origin":{"type":"service"}},"pricing":{"billable":true,"pricing_model":"CBP","category":"service"}}]},"field":"messages"}]}]}
2025-07-02 22:38:01.879 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:38:01.883 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__messageId_0='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSOTRCRUFGMTVGRTYwQzNFNEY3AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."MessageId" = @__messageId_0
LIMIT 1
2025-07-02 22:38:01.884 +05:30 [INF] Request finished HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 27.3568ms
2025-07-02 22:38:01.890 +05:30 [WRN] ⚠️ CampaignSendLog not found for MessageId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSOTRCRUFGMTVGRTYwQzNFNEY3AA==
2025-07-02 22:38:01.895 +05:30 [WRN] ⚠️ No matching CampaignSendLog for MessageId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSOTRCRUFGMTVGRTYwQzNFNEY3AA==
2025-07-02 22:38:12.598 +05:30 [INF] Request starting HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - application/json 626
2025-07-02 22:38:12.602 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:38:12.603 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-07-02 22:38:12.606 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"contacts":[{"profile":{"name":"S. Kumar"},"wa_id":"447543746206"}],"messages":[{"context":{"from":"15556395845","id":"wamid.HBgMNDQ3NTQzNzQ2MjA2FQIAERgSMzBEQUU0MDNCRjQ0MzJGODM2AA=="},"from":"447543746206","id":"wamid.HBgMNDQ3NTQzNzQ2MjA2FQIAEhggMjkwOTdENDlBQkQ5NzZDRjhGRjdCMjRBMkE3RjYzRDIA","timestamp":"1751476095","type":"button","button":{"payload":"Yes, show me","text":"Yes, show me"}}]},"field":"messages"}]}]}
2025-07-02 22:38:12.609 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-07-02 22:38:12.609 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"contacts":[{"profile":{"name":"S. Kumar"},"wa_id":"447543746206"}],"messages":[{"context":{"from":"15556395845","id":"wamid.HBgMNDQ3NTQzNzQ2MjA2FQIAERgSMzBEQUU0MDNCRjQ0MzJGODM2AA=="},"from":"447543746206","id":"wamid.HBgMNDQ3NTQzNzQ2MjA2FQIAEhggMjkwOTdENDlBQkQ5NzZDRjhGRjdCMjRBMkE3RjYzRDIA","timestamp":"1751476095","type":"button","button":{"payload":"Yes, show me","text":"Yes, show me"}}]},"field":"messages"}]}]}
2025-07-02 22:38:12.610 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType73`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:38:12.614 +05:30 [INF] 👉 Routing to Click Processor
2025-07-02 22:38:12.617 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 11.1266ms
2025-07-02 22:38:12.623 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:38:12.625 +05:30 [INF] Request finished HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 27.2743ms
2025-07-02 22:38:12.626 +05:30 [WRN] 📥 [ENTERED CLICK PROCESSOR]
2025-07-02 22:38:12.631 +05:30 [INF] 🖱️ Button Click → From: 447543746206, ClickId: wamid.HBgMNDQ3NTQzNzQ2MjA2FQIAEhggMjkwOTdENDlBQkQ5NzZDRjhGRjdCMjRBMkE3RjYzRDIA, OrigMsgId: wamid.HBgMNDQ3NTQzNzQ2MjA2FQIAERgSMzBEQUU0MDNCRjQ0MzJGODM2AA==, Text: Yes, show me
2025-07-02 22:38:12.658 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__originalMessageId_0='wamid.HBgMNDQ3NTQzNzQ2MjA2FQIAERgSMzBEQUU0MDNCRjQ0MzJGODM2AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId", c0."Id", c0."BusinessId", c0."CampaignId", c0."CampaignType", c0."CreatedAt", c0."CreatedBy", c0."CtaId", c0."DeletedAt", c0."DeletedBy", c0."FollowUpTemplateId", c0."ImageCaption", c0."ImageUrl", c0."IsDeleted", c0."MessageBody", c0."MessageTemplate", c0."Name", c0."ScheduledAt", c0."SourceCampaignId", c0."Status", c0."TemplateId", c0."TemplateParameters", c0."UpdatedAt", c1."Id", c1."AssignedAgentId", c1."BusinessId", c1."CreatedAt", c1."Email", c1."Group", c1."IsActive", c1."IsArchived", c1."IsAutomationPaused", c1."IsFavorite", c1."LastCTAInteraction", c1."LastCTAType", c1."LastClickedProductId", c1."LastContactedAt", c1."LeadSource", c1."Name", c1."NextFollowUpAt", c1."Notes", c1."PhoneNumber", c1."Tags"
FROM "CampaignSendLogs" AS c
INNER JOIN "Campaigns" AS c0 ON c."CampaignId" = c0."Id"
INNER JOIN "Contacts" AS c1 ON c."ContactId" = c1."Id"
WHERE c."MessageId" = @__originalMessageId_0
LIMIT 1
2025-07-02 22:38:12.696 +05:30 [INF] Executed DbCommand (22ms) [Parameters=[@__originalMessageId_0='wamid.HBgMNDQ3NTQzNzQ2MjA2FQIAERgSMzBEQUU0MDNCRjQ0MzJGODM2AA==', @__originalMessageId_0_contains='%wamid.HBgMNDQ3NTQzNzQ2MjA2FQIAERgSMzBEQUU0MDNCRjQ0MzJGODM2AA==%'], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."CreatedAt", m."ErrorMessage", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."MessageId" = @__originalMessageId_0 OR m."Id"::text = @__originalMessageId_0 OR m."RawResponse" LIKE @__originalMessageId_0_contains
LIMIT 1
2025-07-02 22:38:12.699 +05:30 [WRN] ❌ TrackingLog failed: No BusinessId available.
2025-07-02 22:38:34.908 +05:30 [INF] Executed endpoint '/hubs/inbox'
2025-07-02 22:38:34.914 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/hubs/inbox?id=vqcV2vF4vJK1xDqbaJiMcA - 101 null null 55536.2034ms
2025-07-02 22:38:34.916 +05:30 [INF] Executed endpoint '/hubs/inbox'
2025-07-02 22:38:34.922 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/hubs/inbox?id=a_3qYVdtJQi2adEddGLgNw - 101 null null 55583.5268ms
2025-07-02 22:38:41.987 +05:30 [INF] Request starting HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - application/json 715
2025-07-02 22:38:41.991 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:38:41.992 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-07-02 22:38:41.995 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSNjgzMzc0QURGRDlGRjNEMTk5AA==","status":"failed","timestamp":"1750941321","recipient_id":"917082156227","errors":[{"code":131047,"title":"Re-engagement message","message":"Re-engagement message","error_data":{"details":"Message failed to send because more than 24 hours have passed since the customer last replied to this number."},"href":"https:\/\/developers.facebook.com\/docs\/whatsapp\/cloud-api\/support\/error-codes\/"}]}]},"field":"messages"}]}]}
2025-07-02 22:38:41.997 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-07-02 22:38:41.997 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSNjgzMzc0QURGRDlGRjNEMTk5AA==","status":"failed","timestamp":"1750941321","recipient_id":"917082156227","errors":[{"code":131047,"title":"Re-engagement message","message":"Re-engagement message","error_data":{"details":"Message failed to send because more than 24 hours have passed since the customer last replied to this number."},"href":"https:\/\/developers.facebook.com\/docs\/whatsapp\/cloud-api\/support\/error-codes\/"}]}]},"field":"messages"}]}]}
2025-07-02 22:38:41.998 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType73`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:38:42.000 +05:30 [INF] 📦 Routing to Status Processor
2025-07-02 22:38:42.002 +05:30 [WRN] 🔍 Incoming timestamp raw value: {"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSNjgzMzc0QURGRDlGRjNEMTk5AA==","status":"failed","timestamp":"1750941321","recipient_id":"917082156227","errors":[{"code":131047,"title":"Re-engagement message","message":"Re-engagement message","error_data":{"details":"Message failed to send because more than 24 hours have passed since the customer last replied to this number."},"href":"https:\/\/developers.facebook.com\/docs\/whatsapp\/cloud-api\/support\/error-codes\/"}]}]},"field":"messages"}]}]}
2025-07-02 22:38:42.001 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 6.8762ms
2025-07-02 22:38:42.012 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:38:42.016 +05:30 [INF] Request finished HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 28.7935ms
2025-07-02 22:38:42.109 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__messageId_0='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSNjgzMzc0QURGRDlGRjNEMTk5AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."MessageId" = @__messageId_0
LIMIT 1
2025-07-02 22:38:42.112 +05:30 [WRN] ⚠️ CampaignSendLog not found for MessageId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSNjgzMzc0QURGRDlGRjNEMTk5AA==
2025-07-02 22:38:42.114 +05:30 [WRN] ⚠️ No matching CampaignSendLog for MessageId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSNjgzMzc0QURGRDlGRjNEMTk5AA==
2025-07-02 22:38:53.253 +05:30 [INF] Request starting HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - application/json 581
2025-07-02 22:38:53.260 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:38:53.263 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-07-02 22:38:53.267 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSNDBCRTEwODQ0RURGNEY4OTFCAA==","status":"sent","timestamp":"1751191052","recipient_id":"917082156227","conversation":{"id":"90b38ee00c6455dcc79733c1fd93f79a","expiration_timestamp":"1751269260","origin":{"type":"service"}},"pricing":{"billable":true,"pricing_model":"CBP","category":"service"}}]},"field":"messages"}]}]}
2025-07-02 22:38:53.270 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-07-02 22:38:53.270 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSNDBCRTEwODQ0RURGNEY4OTFCAA==","status":"sent","timestamp":"1751191052","recipient_id":"917082156227","conversation":{"id":"90b38ee00c6455dcc79733c1fd93f79a","expiration_timestamp":"1751269260","origin":{"type":"service"}},"pricing":{"billable":true,"pricing_model":"CBP","category":"service"}}]},"field":"messages"}]}]}
2025-07-02 22:38:53.271 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType73`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:38:53.273 +05:30 [INF] 📦 Routing to Status Processor
2025-07-02 22:38:53.275 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 9.0277ms
2025-07-02 22:38:53.279 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:38:53.277 +05:30 [WRN] 🔍 Incoming timestamp raw value: {"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSNDBCRTEwODQ0RURGNEY4OTFCAA==","status":"sent","timestamp":"1751191052","recipient_id":"917082156227","conversation":{"id":"90b38ee00c6455dcc79733c1fd93f79a","expiration_timestamp":"1751269260","origin":{"type":"service"}},"pricing":{"billable":true,"pricing_model":"CBP","category":"service"}}]},"field":"messages"}]}]}
2025-07-02 22:38:53.280 +05:30 [INF] Request finished HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 26.9906ms
2025-07-02 22:38:53.284 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__messageId_0='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSNDBCRTEwODQ0RURGNEY4OTFCAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."MessageId" = @__messageId_0
LIMIT 1
2025-07-02 22:38:53.292 +05:30 [WRN] ⚠️ CampaignSendLog not found for MessageId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSNDBCRTEwODQ0RURGNEY4OTFCAA==
2025-07-02 22:38:53.293 +05:30 [WRN] ⚠️ No matching CampaignSendLog for MessageId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSNDBCRTEwODQ0RURGNEY4OTFCAA==
2025-07-02 22:39:08.554 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/WhatsAppTemplateFetcher/get-template-all - null null
2025-07-02 22:39:08.558 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:39:08.560 +05:30 [INF] Executing endpoint 'xbytechat_api.WhatsAppSettings.Controllers.WhatsAppTemplateFetcherController.GetAllTemplatesAsync (xbytechat.api)'
2025-07-02 22:39:08.565 +05:30 [INF] Route matched with {action = "GetAllTemplates", controller = "WhatsAppTemplateFetcher"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllTemplatesAsync() on controller xbytechat_api.WhatsAppSettings.Controllers.WhatsAppTemplateFetcherController (xbytechat.api).
2025-07-02 22:39:08.604 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiToken", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."IsActive"
2025-07-02 22:39:08.610 +05:30 [INF] Start processing HTTP request GET https://graph.facebook.com/v22.0/999432368375320/message_templates
2025-07-02 22:39:08.612 +05:30 [INF] Sending HTTP request GET https://graph.facebook.com/v22.0/999432368375320/message_templates
2025-07-02 22:39:09.833 +05:30 [INF] Received HTTP response headers after 1218.7572ms - 200
2025-07-02 22:39:09.835 +05:30 [INF] End processing HTTP request after 1224.3029ms - 200
2025-07-02 22:39:09.837 +05:30 [INF] 📦 Meta Template API Raw JSON for "c13be597-6ae2-42bb-9d43-925815f24ff8":
{"data":[{"name":"flow_step_4","parameter_format":"POSITIONAL","components":[{"type":"HEADER","format":"TEXT","text":"Step -4"},{"type":"BODY","text":"Would you like pricing details for your selected product?"},{"type":"BUTTONS","buttons":[{"type":"QUICK_REPLY","text":"Send Pricing"},{"type":"QUICK_REPLY","text":"Back to Products"}]}],"language":"en_US","status":"APPROVED","category":"MARKETING","sub_category":"CUSTOM","id":"710642074690811"},{"name":"hello_world","parameter_format":"POSITIONAL","components":[{"type":"HEADER","format":"TEXT","text":"Hello World"},{"type":"BODY","text":"Welcome and congratulations!! This message demonstrates your ability to send a WhatsApp message notification from the Cloud API, hosted by Meta. Thank you for taking the time to test with us."},{"type":"FOOTER","text":"WhatsApp Business Platform sample message"}],"language":"en_US","status":"APPROVED","category":"UTILITY","id":"1726067301662421"},{"name":"flow_step_6","parameter_format":"POSITIONAL","components":[{"type":"HEADER","format":"TEXT","text":"Step -6"},{"type":"BODY","text":"Here's what our happy customers say. Would you like to read reviews?"},{"type":"BUTTONS","buttons":[{"type":"QUICK_REPLY","text":"Show Reviews"},{"type":"QUICK_REPLY","text":"Skip"}]}],"language":"en_US","status":"APPROVED","category":"MARKETING","sub_category":"CUSTOM","id":"1919507328796848"},{"name":"flow_step_5","parameter_format":"POSITIONAL","components":[{"type":"HEADER","format":"TEXT","text":"Step =5"},{"type":"BODY","text":"Limited time discount available. Want to grab it now?"},{"type":"BUTTONS","buttons":[{"type":"QUICK_REPLY","text":"Claim Discount"},{"type":"QUICK_REPLY","text":"Not Now"}]}],"language":"en_US","status":"APPROVED","category":"MARKETING","sub_category":"CUSTOM","id":"1780686429496003"},{"name":"flow_step_3","parameter_format":"POSITIONAL","components":[{"type":"HEADER","format":"TEXT","text":"Step -3"},{"type":"BODY","text":"We have 3 amazing products for you. Want to check them out?"},{"type":"BUTTONS","buttons":[{"type":"QUICK_REPLY","text":"Show Products"},{"type":"QUICK_REPLY","text":"Skip"}]}],"language":"en_US","status":"APPROVED","category":"MARKETING","sub_category":"CUSTOM","id":"2154240945038413"},{"name":"flow_step_2","parameter_format":"POSITIONAL","components":[{"type":"HEADER","format":"TEXT","text":"Step -2"},{"type":"BODY","text":"Here's our latest deal. Want to see more options?"},{"type":"BUTTONS","buttons":[{"type":"QUICK_REPLY","text":"More Options"},{"type":"PHONE_NUMBER","text":"Talk to Support","phone_number":"+917082156227"}]}],"language":"en_US","status":"APPROVED","category":"MARKETING","id":"721245346987995"},{"name":"flow_step_1","parameter_format":"POSITIONAL","components":[{"type":"BODY","text":"Hi \ud83d\udc4b, would you like to explore our special offer?"},{"type":"BUTTONS","buttons":[{"type":"QUICK_REPLY","text":"Yes, show me"},{"type":"QUICK_REPLY","text":"No, thanks"}]}],"language":"en_US","status":"APPROVED","category":"MARKETING","sub_category":"CUSTOM","id":"720586043866779"},{"name":"flow_step_7","parameter_format":"POSITIONAL","components":[{"type":"HEADER","format":"TEXT","text":"Step -7"},{"type":"BODY","text":"Would you like to talk to our support team for custom guidance?"},{"type":"BUTTONS","buttons":[{"type":"QUICK_REPLY","text":"Talk to Agent"},{"type":"QUICK_REPLY","text":"Later"}]}],"language":"en_US","status":"APPROVED","category":"MARKETING","sub_category":"CUSTOM","id":"1390795521994729"},{"name":"back_to_restart","parameter_format":"POSITIONAL","components":[{"type":"HEADER","format":"TEXT","text":"Chat Restarted"},{"type":"BODY","text":"Your Process has restarted."},{"type":"BUTTONS","buttons":[{"type":"QUICK_REPLY","text":"Yes, show me"},{"type":"QUICK_REPLY","text":"No, thanks"}]}],"language":"en_US","status":"APPROVED","category":"MARKETING","sub_category":"CUSTOM","id":"2174325859705396"},{"name":"flow_step_10_","parameter_format":"POSITIONAL","components":[{"type":"HEADER","format":"TEXT","text":"Step -10"},{"type":"BODY","text":"Thanks for your interest! Would you like to give feedback?"},{"type":"BUTTONS","buttons":[{"type":"QUICK_REPLY","text":"Give Feedback"},{"type":"QUICK_REPLY","text":"End Chat"}]}],"language":"en_US","status":"APPROVED","category":"MARKETING","sub_category":"CUSTOM","id":"700742109026088"},{"name":"flow_step_9","parameter_format":"POSITIONAL","components":[{"type":"HEADER","format":"TEXT","text":"Step -9"},{"type":"BODY","text":"This is your final offer summary. Ready to proceed?"},{"type":"BUTTONS","buttons":[{"type":"QUICK_REPLY","text":"Proceed"},{"type":"QUICK_REPLY","text":"Restart"}]}],"language":"en_US","status":"APPROVED","category":"MARKETING","sub_category":"CUSTOM","id":"703808575467306"},{"name":"flow_step_8","parameter_format":"POSITIONAL","components":[{"type":"HEADER","format":"TEXT","text":"Step -8"},{"type":"BODY","text":"We can compare 2 products for you. Shall we continue?"},{"type":"BUTTONS","buttons":[{"type":"QUICK_REPLY","text":"Compare Now"},{"type":"QUICK_REPLY","text":"No, thanks"}]}],"language":"en","status":"APPROVED","category":"MARKETING","sub_category":"CUSTOM","id":"1399963891041518"}],"paging":{"cursors":{"before":"MAZDZD","after":"MjQZD"}}}
2025-07-02 22:39:09.884 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType64`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[TemplateForUIResponseDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:39:09.894 +05:30 [INF] Executed action xbytechat_api.WhatsAppSettings.Controllers.WhatsAppTemplateFetcherController.GetAllTemplatesAsync (xbytechat.api) in 1325.3031ms
2025-07-02 22:39:09.896 +05:30 [INF] Executed endpoint 'xbytechat_api.WhatsAppSettings.Controllers.WhatsAppTemplateFetcherController.GetAllTemplatesAsync (xbytechat.api)'
2025-07-02 22:39:09.897 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/WhatsAppTemplateFetcher/get-template-all - 200 null application/json; charset=utf-8 1343.5396ms
2025-07-02 22:39:24.039 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/WhatsAppTemplateFetcher/get-template-all - null null
2025-07-02 22:39:24.045 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:39:24.046 +05:30 [INF] Executing endpoint 'xbytechat_api.WhatsAppSettings.Controllers.WhatsAppTemplateFetcherController.GetAllTemplatesAsync (xbytechat.api)'
2025-07-02 22:39:24.048 +05:30 [INF] Route matched with {action = "GetAllTemplates", controller = "WhatsAppTemplateFetcher"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllTemplatesAsync() on controller xbytechat_api.WhatsAppSettings.Controllers.WhatsAppTemplateFetcherController (xbytechat.api).
2025-07-02 22:39:24.052 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiToken", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."IsActive"
2025-07-02 22:39:24.059 +05:30 [INF] Start processing HTTP request GET https://graph.facebook.com/v22.0/999432368375320/message_templates
2025-07-02 22:39:24.060 +05:30 [INF] Sending HTTP request GET https://graph.facebook.com/v22.0/999432368375320/message_templates
2025-07-02 22:39:25.289 +05:30 [INF] Received HTTP response headers after 1226.2375ms - 200
2025-07-02 22:39:25.292 +05:30 [INF] End processing HTTP request after 1232.9796ms - 200
2025-07-02 22:39:25.294 +05:30 [INF] 📦 Meta Template API Raw JSON for "c13be597-6ae2-42bb-9d43-925815f24ff8":
{"data":[{"name":"flow_step_4","parameter_format":"POSITIONAL","components":[{"type":"HEADER","format":"TEXT","text":"Step -4"},{"type":"BODY","text":"Would you like pricing details for your selected product?"},{"type":"BUTTONS","buttons":[{"type":"QUICK_REPLY","text":"Send Pricing"},{"type":"QUICK_REPLY","text":"Back to Products"}]}],"language":"en_US","status":"APPROVED","category":"MARKETING","sub_category":"CUSTOM","id":"710642074690811"},{"name":"hello_world","parameter_format":"POSITIONAL","components":[{"type":"HEADER","format":"TEXT","text":"Hello World"},{"type":"BODY","text":"Welcome and congratulations!! This message demonstrates your ability to send a WhatsApp message notification from the Cloud API, hosted by Meta. Thank you for taking the time to test with us."},{"type":"FOOTER","text":"WhatsApp Business Platform sample message"}],"language":"en_US","status":"APPROVED","category":"UTILITY","id":"1726067301662421"},{"name":"flow_step_6","parameter_format":"POSITIONAL","components":[{"type":"HEADER","format":"TEXT","text":"Step -6"},{"type":"BODY","text":"Here's what our happy customers say. Would you like to read reviews?"},{"type":"BUTTONS","buttons":[{"type":"QUICK_REPLY","text":"Show Reviews"},{"type":"QUICK_REPLY","text":"Skip"}]}],"language":"en_US","status":"APPROVED","category":"MARKETING","sub_category":"CUSTOM","id":"1919507328796848"},{"name":"flow_step_5","parameter_format":"POSITIONAL","components":[{"type":"HEADER","format":"TEXT","text":"Step =5"},{"type":"BODY","text":"Limited time discount available. Want to grab it now?"},{"type":"BUTTONS","buttons":[{"type":"QUICK_REPLY","text":"Claim Discount"},{"type":"QUICK_REPLY","text":"Not Now"}]}],"language":"en_US","status":"APPROVED","category":"MARKETING","sub_category":"CUSTOM","id":"1780686429496003"},{"name":"flow_step_3","parameter_format":"POSITIONAL","components":[{"type":"HEADER","format":"TEXT","text":"Step -3"},{"type":"BODY","text":"We have 3 amazing products for you. Want to check them out?"},{"type":"BUTTONS","buttons":[{"type":"QUICK_REPLY","text":"Show Products"},{"type":"QUICK_REPLY","text":"Skip"}]}],"language":"en_US","status":"APPROVED","category":"MARKETING","sub_category":"CUSTOM","id":"2154240945038413"},{"name":"flow_step_2","parameter_format":"POSITIONAL","components":[{"type":"HEADER","format":"TEXT","text":"Step -2"},{"type":"BODY","text":"Here's our latest deal. Want to see more options?"},{"type":"BUTTONS","buttons":[{"type":"QUICK_REPLY","text":"More Options"},{"type":"PHONE_NUMBER","text":"Talk to Support","phone_number":"+917082156227"}]}],"language":"en_US","status":"APPROVED","category":"MARKETING","id":"721245346987995"},{"name":"flow_step_1","parameter_format":"POSITIONAL","components":[{"type":"BODY","text":"Hi \ud83d\udc4b, would you like to explore our special offer?"},{"type":"BUTTONS","buttons":[{"type":"QUICK_REPLY","text":"Yes, show me"},{"type":"QUICK_REPLY","text":"No, thanks"}]}],"language":"en_US","status":"APPROVED","category":"MARKETING","sub_category":"CUSTOM","id":"720586043866779"},{"name":"flow_step_7","parameter_format":"POSITIONAL","components":[{"type":"HEADER","format":"TEXT","text":"Step -7"},{"type":"BODY","text":"Would you like to talk to our support team for custom guidance?"},{"type":"BUTTONS","buttons":[{"type":"QUICK_REPLY","text":"Talk to Agent"},{"type":"QUICK_REPLY","text":"Later"}]}],"language":"en_US","status":"APPROVED","category":"MARKETING","sub_category":"CUSTOM","id":"1390795521994729"},{"name":"back_to_restart","parameter_format":"POSITIONAL","components":[{"type":"HEADER","format":"TEXT","text":"Chat Restarted"},{"type":"BODY","text":"Your Process has restarted."},{"type":"BUTTONS","buttons":[{"type":"QUICK_REPLY","text":"Yes, show me"},{"type":"QUICK_REPLY","text":"No, thanks"}]}],"language":"en_US","status":"APPROVED","category":"MARKETING","sub_category":"CUSTOM","id":"2174325859705396"},{"name":"flow_step_10_","parameter_format":"POSITIONAL","components":[{"type":"HEADER","format":"TEXT","text":"Step -10"},{"type":"BODY","text":"Thanks for your interest! Would you like to give feedback?"},{"type":"BUTTONS","buttons":[{"type":"QUICK_REPLY","text":"Give Feedback"},{"type":"QUICK_REPLY","text":"End Chat"}]}],"language":"en_US","status":"APPROVED","category":"MARKETING","sub_category":"CUSTOM","id":"700742109026088"},{"name":"flow_step_9","parameter_format":"POSITIONAL","components":[{"type":"HEADER","format":"TEXT","text":"Step -9"},{"type":"BODY","text":"This is your final offer summary. Ready to proceed?"},{"type":"BUTTONS","buttons":[{"type":"QUICK_REPLY","text":"Proceed"},{"type":"QUICK_REPLY","text":"Restart"}]}],"language":"en_US","status":"APPROVED","category":"MARKETING","sub_category":"CUSTOM","id":"703808575467306"},{"name":"flow_step_8","parameter_format":"POSITIONAL","components":[{"type":"HEADER","format":"TEXT","text":"Step -8"},{"type":"BODY","text":"We can compare 2 products for you. Shall we continue?"},{"type":"BUTTONS","buttons":[{"type":"QUICK_REPLY","text":"Compare Now"},{"type":"QUICK_REPLY","text":"No, thanks"}]}],"language":"en","status":"APPROVED","category":"MARKETING","sub_category":"CUSTOM","id":"1399963891041518"}],"paging":{"cursors":{"before":"MAZDZD","after":"MjQZD"}}}
2025-07-02 22:39:25.299 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType64`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[TemplateForUIResponseDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:39:25.301 +05:30 [INF] Executed action xbytechat_api.WhatsAppSettings.Controllers.WhatsAppTemplateFetcherController.GetAllTemplatesAsync (xbytechat.api) in 1251.8093ms
2025-07-02 22:39:25.304 +05:30 [INF] Executed endpoint 'xbytechat_api.WhatsAppSettings.Controllers.WhatsAppTemplateFetcherController.GetAllTemplatesAsync (xbytechat.api)'
2025-07-02 22:39:25.306 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/WhatsAppTemplateFetcher/get-template-all - 200 null application/json; charset=utf-8 1267.5294ms
2025-07-02 22:39:29.606 +05:30 [INF] Request starting HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - application/json 494
2025-07-02 22:39:29.609 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:39:29.610 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-07-02 22:39:29.613 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"contacts":[{"profile":{"name":"\ua9c1S.K\ua9c2"},"wa_id":"917082156227"}],"messages":[{"from":"917082156227","id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAEhggMjNBM0MxNTQ1MTZFRDE4NTVCODg1QTdCQjlDNzAyNUYA","timestamp":"1751189094","text":{"body":"Hello"},"type":"text"}]},"field":"messages"}]}]}
2025-07-02 22:39:29.615 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-07-02 22:39:29.615 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"contacts":[{"profile":{"name":"\ua9c1S.K\ua9c2"},"wa_id":"917082156227"}],"messages":[{"from":"917082156227","id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAEhggMjNBM0MxNTQ1MTZFRDE4NTVCODg1QTdCQjlDNzAyNUYA","timestamp":"1751189094","text":{"body":"Hello"},"type":"text"}]},"field":"messages"}]}]}
2025-07-02 22:39:29.616 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType73`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:39:29.618 +05:30 [INF] 💬 Routing to InboundMessageProcessor (type: text)
2025-07-02 22:39:29.620 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 7.0884ms
2025-07-02 22:39:29.622 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:39:29.625 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__businessNumber_0='15556395845'], CommandType='"Text"', CommandTimeout='30']
SELECT b."Id", b."Address", b."ApprovedAt", b."ApprovedBy", b."BusinessEmail", b."BusinessName", b."CompanyName", b."CompanyPhone", b."CreatedAt", b."CreatedBy", b."CreatedByPartnerId", b."DeletedAt", b."DeletedBy", b."Industry", b."IsApproved", b."IsDeleted", b."LastLoginAt", b."LogoUrl", b."Notes", b."Phone", b."RepresentativeName", b."Source", b."Status", b."Tags", b."Website", w."Id", w."ApiToken", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WhatsAppBusinessNumber"
FROM "Businesses" AS b
LEFT JOIN "WhatsAppSettings" AS w ON b."Id" = w."BusinessId"
WHERE w."WhatsAppBusinessNumber" = @__businessNumber_0
LIMIT 1
2025-07-02 22:39:29.625 +05:30 [INF] Request finished HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 19.7223ms
2025-07-02 22:39:29.628 +05:30 [INF] FindOrCreateAsync: businessId="c13be597-6ae2-42bb-9d43-925815f24ff8", phoneNumber=917082156227
2025-07-02 22:39:29.634 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__phoneNumber_1='917082156227'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."Tags"
FROM "Contacts" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."PhoneNumber" = @__phoneNumber_1
LIMIT 1
2025-07-02 22:39:29.637 +05:30 [INF] Contact already exists: contactId="0876f654-a362-420f-a912-6bce793436a5"
2025-07-02 22:39:29.640 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__contactId_1='0876f654-a362-420f-a912-6bce793436a5'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."BusinessId", c."ContactId", c."LastUpdatedAt", c."Mode", c."UpdatedBy"
FROM "ChatSessionStates" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."ContactId" = @__contactId_1
LIMIT 1
2025-07-02 22:39:29.665 +05:30 [INF] Executed DbCommand (21ms) [Parameters=[@p0='033bcc34-5325-48b7-a8d1-6fbab6d8ff92', @p1='c13be597-6ae2-42bb-9d43-925815f24ff8', @p2=NULL (DbType = Guid), @p3=NULL (DbType = Guid), @p4=NULL (DbType = Guid), @p5='0876f654-a362-420f-a912-6bce793436a5' (Nullable = true), @p6='2025-07-02T17:09:29.6439092Z' (DbType = DateTime), @p7=NULL, @p8='True', @p9=NULL, @p10='Hello' (Nullable = false), @p11=NULL, @p12=NULL, @p13='917082156227' (Nullable = false), @p14=NULL (DbType = Guid), @p15=NULL, @p16='2025-07-02T17:09:29.6439092Z' (Nullable = true) (DbType = DateTime), @p17=NULL, @p18='received' (Nullable = false)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "MessageLogs" ("Id", "BusinessId", "CTAFlowConfigId", "CTAFlowStepId", "CampaignId", "ContactId", "CreatedAt", "ErrorMessage", "IsIncoming", "MediaUrl", "MessageContent", "MessageId", "RawResponse", "RecipientNumber", "RefMessageId", "RenderedBody", "SentAt", "Source", "Status")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
2025-07-02 22:39:29.674 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."BusinessId", a."CreatedAt", a."FlowId", a."FlowName", a."IsActive", a."MediaUrl", a."Priority", a."ReplyMessage", a."TriggerKeyword", a."UpdatedAt"
FROM "AutoReplyRules" AS a
WHERE a."BusinessId" = @__businessId_0 AND a."IsActive"
2025-07-02 22:39:29.676 +05:30 [INF] 🔍 No flow match found or FlowId is null. Trying fallback auto-reply...
2025-07-02 22:39:29.699 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__incomingMessage_1='Hello'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."BusinessId", a."CreatedAt", a."FlowId", a."FlowName", a."IsActive", a."MediaUrl", a."Priority", a."ReplyMessage", a."TriggerKeyword", a."UpdatedAt"
FROM "AutoReplyRules" AS a
WHERE a."BusinessId" = @__businessId_0 AND a."IsActive" AND strpos(@__incomingMessage_1, a."TriggerKeyword") > 0
ORDER BY a."Priority"
LIMIT 1
2025-07-02 22:39:29.703 +05:30 [INF] ❌ No fallback rule matched for: Hello
2025-07-02 22:39:35.480 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@p0='deb97d10-e8bd-4fae-886a-0c9227b49af2', @p1='c13be597-6ae2-42bb-9d43-925815f24ff8', @p2=NULL (DbType = Guid), @p3=NULL (DbType = Guid), @p4=NULL (DbType = Guid), @p5='0876f654-a362-420f-a912-6bce793436a5' (Nullable = true), @p6='2025-07-02T17:09:35.4774107Z' (DbType = DateTime), @p7=NULL, @p8='True', @p9=NULL, @p10='Hello' (Nullable = false), @p11=NULL, @p12=NULL, @p13='917082156227' (Nullable = false), @p14=NULL (DbType = Guid), @p15=NULL, @p16=NULL (DbType = DateTime), @p17=NULL, @p18='Queued' (Nullable = false)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "MessageLogs" ("Id", "BusinessId", "CTAFlowConfigId", "CTAFlowStepId", "CampaignId", "ContactId", "CreatedAt", "ErrorMessage", "IsIncoming", "MediaUrl", "MessageContent", "MessageId", "RawResponse", "RecipientNumber", "RefMessageId", "RenderedBody", "SentAt", "Source", "Status")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
2025-07-02 22:39:43.286 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/WhatsAppTemplateFetcher/get-template-all - null null
2025-07-02 22:39:43.289 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:39:43.290 +05:30 [INF] Executing endpoint 'xbytechat_api.WhatsAppSettings.Controllers.WhatsAppTemplateFetcherController.GetAllTemplatesAsync (xbytechat.api)'
2025-07-02 22:39:43.291 +05:30 [INF] Route matched with {action = "GetAllTemplates", controller = "WhatsAppTemplateFetcher"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllTemplatesAsync() on controller xbytechat_api.WhatsAppSettings.Controllers.WhatsAppTemplateFetcherController (xbytechat.api).
2025-07-02 22:39:43.295 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiToken", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."IsActive"
2025-07-02 22:39:43.299 +05:30 [INF] Start processing HTTP request GET https://graph.facebook.com/v22.0/999432368375320/message_templates
2025-07-02 22:39:43.300 +05:30 [INF] Sending HTTP request GET https://graph.facebook.com/v22.0/999432368375320/message_templates
2025-07-02 22:39:44.341 +05:30 [INF] Received HTTP response headers after 1040.3016ms - 200
2025-07-02 22:39:44.344 +05:30 [INF] End processing HTTP request after 1044.8609ms - 200
2025-07-02 22:39:44.345 +05:30 [INF] 📦 Meta Template API Raw JSON for "c13be597-6ae2-42bb-9d43-925815f24ff8":
{"data":[{"name":"flow_step_4","parameter_format":"POSITIONAL","components":[{"type":"HEADER","format":"TEXT","text":"Step -4"},{"type":"BODY","text":"Would you like pricing details for your selected product?"},{"type":"BUTTONS","buttons":[{"type":"QUICK_REPLY","text":"Send Pricing"},{"type":"QUICK_REPLY","text":"Back to Products"}]}],"language":"en_US","status":"APPROVED","category":"MARKETING","sub_category":"CUSTOM","id":"710642074690811"},{"name":"hello_world","parameter_format":"POSITIONAL","components":[{"type":"HEADER","format":"TEXT","text":"Hello World"},{"type":"BODY","text":"Welcome and congratulations!! This message demonstrates your ability to send a WhatsApp message notification from the Cloud API, hosted by Meta. Thank you for taking the time to test with us."},{"type":"FOOTER","text":"WhatsApp Business Platform sample message"}],"language":"en_US","status":"APPROVED","category":"UTILITY","id":"1726067301662421"},{"name":"flow_step_6","parameter_format":"POSITIONAL","components":[{"type":"HEADER","format":"TEXT","text":"Step -6"},{"type":"BODY","text":"Here's what our happy customers say. Would you like to read reviews?"},{"type":"BUTTONS","buttons":[{"type":"QUICK_REPLY","text":"Show Reviews"},{"type":"QUICK_REPLY","text":"Skip"}]}],"language":"en_US","status":"APPROVED","category":"MARKETING","sub_category":"CUSTOM","id":"1919507328796848"},{"name":"flow_step_5","parameter_format":"POSITIONAL","components":[{"type":"HEADER","format":"TEXT","text":"Step =5"},{"type":"BODY","text":"Limited time discount available. Want to grab it now?"},{"type":"BUTTONS","buttons":[{"type":"QUICK_REPLY","text":"Claim Discount"},{"type":"QUICK_REPLY","text":"Not Now"}]}],"language":"en_US","status":"APPROVED","category":"MARKETING","sub_category":"CUSTOM","id":"1780686429496003"},{"name":"flow_step_3","parameter_format":"POSITIONAL","components":[{"type":"HEADER","format":"TEXT","text":"Step -3"},{"type":"BODY","text":"We have 3 amazing products for you. Want to check them out?"},{"type":"BUTTONS","buttons":[{"type":"QUICK_REPLY","text":"Show Products"},{"type":"QUICK_REPLY","text":"Skip"}]}],"language":"en_US","status":"APPROVED","category":"MARKETING","sub_category":"CUSTOM","id":"2154240945038413"},{"name":"flow_step_2","parameter_format":"POSITIONAL","components":[{"type":"HEADER","format":"TEXT","text":"Step -2"},{"type":"BODY","text":"Here's our latest deal. Want to see more options?"},{"type":"BUTTONS","buttons":[{"type":"QUICK_REPLY","text":"More Options"},{"type":"PHONE_NUMBER","text":"Talk to Support","phone_number":"+917082156227"}]}],"language":"en_US","status":"APPROVED","category":"MARKETING","id":"721245346987995"},{"name":"flow_step_1","parameter_format":"POSITIONAL","components":[{"type":"BODY","text":"Hi \ud83d\udc4b, would you like to explore our special offer?"},{"type":"BUTTONS","buttons":[{"type":"QUICK_REPLY","text":"Yes, show me"},{"type":"QUICK_REPLY","text":"No, thanks"}]}],"language":"en_US","status":"APPROVED","category":"MARKETING","sub_category":"CUSTOM","id":"720586043866779"},{"name":"flow_step_7","parameter_format":"POSITIONAL","components":[{"type":"HEADER","format":"TEXT","text":"Step -7"},{"type":"BODY","text":"Would you like to talk to our support team for custom guidance?"},{"type":"BUTTONS","buttons":[{"type":"QUICK_REPLY","text":"Talk to Agent"},{"type":"QUICK_REPLY","text":"Later"}]}],"language":"en_US","status":"APPROVED","category":"MARKETING","sub_category":"CUSTOM","id":"1390795521994729"},{"name":"back_to_restart","parameter_format":"POSITIONAL","components":[{"type":"HEADER","format":"TEXT","text":"Chat Restarted"},{"type":"BODY","text":"Your Process has restarted."},{"type":"BUTTONS","buttons":[{"type":"QUICK_REPLY","text":"Yes, show me"},{"type":"QUICK_REPLY","text":"No, thanks"}]}],"language":"en_US","status":"APPROVED","category":"MARKETING","sub_category":"CUSTOM","id":"2174325859705396"},{"name":"flow_step_10_","parameter_format":"POSITIONAL","components":[{"type":"HEADER","format":"TEXT","text":"Step -10"},{"type":"BODY","text":"Thanks for your interest! Would you like to give feedback?"},{"type":"BUTTONS","buttons":[{"type":"QUICK_REPLY","text":"Give Feedback"},{"type":"QUICK_REPLY","text":"End Chat"}]}],"language":"en_US","status":"APPROVED","category":"MARKETING","sub_category":"CUSTOM","id":"700742109026088"},{"name":"flow_step_9","parameter_format":"POSITIONAL","components":[{"type":"HEADER","format":"TEXT","text":"Step -9"},{"type":"BODY","text":"This is your final offer summary. Ready to proceed?"},{"type":"BUTTONS","buttons":[{"type":"QUICK_REPLY","text":"Proceed"},{"type":"QUICK_REPLY","text":"Restart"}]}],"language":"en_US","status":"APPROVED","category":"MARKETING","sub_category":"CUSTOM","id":"703808575467306"},{"name":"flow_step_8","parameter_format":"POSITIONAL","components":[{"type":"HEADER","format":"TEXT","text":"Step -8"},{"type":"BODY","text":"We can compare 2 products for you. Shall we continue?"},{"type":"BUTTONS","buttons":[{"type":"QUICK_REPLY","text":"Compare Now"},{"type":"QUICK_REPLY","text":"No, thanks"}]}],"language":"en","status":"APPROVED","category":"MARKETING","sub_category":"CUSTOM","id":"1399963891041518"}],"paging":{"cursors":{"before":"MAZDZD","after":"MjQZD"}}}
2025-07-02 22:39:44.349 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType64`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[TemplateForUIResponseDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:39:44.352 +05:30 [INF] Executed action xbytechat_api.WhatsAppSettings.Controllers.WhatsAppTemplateFetcherController.GetAllTemplatesAsync (xbytechat.api) in 1058.4616ms
2025-07-02 22:39:44.354 +05:30 [INF] Executed endpoint 'xbytechat_api.WhatsAppSettings.Controllers.WhatsAppTemplateFetcherController.GetAllTemplatesAsync (xbytechat.api)'
2025-07-02 22:39:44.357 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/WhatsAppTemplateFetcher/get-template-all - 200 null application/json; charset=utf-8 1070.7883ms
2025-07-02 22:40:11.464 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/api/cta-flow/save-visual - null null
2025-07-02 22:40:11.467 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:40:11.469 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/api/cta-flow/save-visual - 204 null null 4.8625ms
2025-07-02 22:40:11.470 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/api/cta-flow/save-visual - application/json 2007
2025-07-02 22:40:11.477 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:40:11.478 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController.SaveVisualFlow (xbytechat.api)'
2025-07-02 22:40:11.482 +05:30 [INF] Route matched with {action = "SaveVisualFlow", controller = "CTAFlow"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SaveVisualFlow(xbytechat.api.Features.CTAFlowBuilder.DTOs.SaveVisualFlowDto) on controller xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController (xbytechat.api).
2025-07-02 22:40:11.504 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/api/cta-flow/save-visual - application/json 2007
2025-07-02 22:40:11.507 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:40:11.508 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController.SaveVisualFlow (xbytechat.api)'
2025-07-02 22:40:11.510 +05:30 [INF] Route matched with {action = "SaveVisualFlow", controller = "CTAFlow"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SaveVisualFlow(xbytechat.api.Features.CTAFlowBuilder.DTOs.SaveVisualFlowDto) on controller xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController (xbytechat.api).
2025-07-02 22:40:18.447 +05:30 [INF] 📦 Saving CTA Flow: Tes001 by Tata Consultancy Services
2025-07-02 22:40:18.447 +05:30 [INF] 📦 Saving CTA Flow: Tes001 by Tata Consultancy Services
2025-07-02 22:40:18.457 +05:30 [INF] 🧠 SaveVisualFlow started | FlowName: Tes001 | BusinessId: "c13be597-6ae2-42bb-9d43-925815f24ff8"
2025-07-02 22:40:18.457 +05:30 [INF] 🧠 SaveVisualFlow started | FlowName: Tes001 | BusinessId: "c13be597-6ae2-42bb-9d43-925815f24ff8"
2025-07-02 22:40:18.467 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__dto_FlowName_0='Tes001', @__businessId_1='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."BusinessId", c."CreatedAt", c."CreatedBy", c."FlowName", c."IsActive", c."IsPublished", c."UpdatedAt"
FROM "CTAFlowConfigs" AS c
WHERE c."FlowName" = @__dto_FlowName_0 AND c."BusinessId" = @__businessId_1
LIMIT 1
2025-07-02 22:40:18.494 +05:30 [INF] ✅ New FlowConfig created with ID: "123b5480-fef7-4f42-8d58-c270fbd534c9"
2025-07-02 22:40:18.554 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__dto_FlowName_0='Tes001', @__businessId_1='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."BusinessId", c."CreatedAt", c."CreatedBy", c."FlowName", c."IsActive", c."IsPublished", c."UpdatedAt"
FROM "CTAFlowConfigs" AS c
WHERE c."FlowName" = @__dto_FlowName_0 AND c."BusinessId" = @__businessId_1
LIMIT 1
2025-07-02 22:40:18.556 +05:30 [INF] ✅ New FlowConfig created with ID: "ca0261fb-056f-4f7e-8f14-1c8da37618c8"
2025-07-02 22:40:18.579 +05:30 [INF] Executed DbCommand (8ms) [Parameters=[@p0='123b5480-fef7-4f42-8d58-c270fbd534c9', @p1='c13be597-6ae2-42bb-9d43-925815f24ff8', @p2='2025-07-02T17:10:18.4740387Z' (DbType = DateTime), @p3='Tata Consultancy Services', @p4='Tes001' (Nullable = false), @p5='True', @p6='True', @p7='2025-07-02T17:10:18.4741246Z' (Nullable = true) (DbType = DateTime), @p8='0ce461c8-6b14-40bc-929f-9c70a6ffb921', @p9='123b5480-fef7-4f42-8d58-c270fbd534c9', @p10='434.35007' (Nullable = true), @p11='156.79668' (Nullable = true), @p12=NULL, @p13=NULL, @p14='2', @p15='flow_step_3' (Nullable = false), @p16='text_template', @p17='Yes, show me' (Nullable = false), @p18='QUICK_REPLY' (Nullable = false), @p19='ccbf5f91-790a-4cf2-bf74-9c86f869b98b', @p20='123b5480-fef7-4f42-8d58-c270fbd534c9', @p21='127.48288' (Nullable = true), @p22='130.62108' (Nullable = true), @p23=NULL, @p24=NULL, @p25='0', @p26='flow_step_1' (Nullable = false), @p27='text_template', @p28='Yes, show me' (Nullable = false), @p29='cta' (Nullable = false), @p30='f275e674-9545-4c05-a830-3d531d7f3930', @p31='123b5480-fef7-4f42-8d58-c270fbd534c9', @p32='785.6508' (Nullable = true), @p33='222.93193' (Nullable = true), @p34=NULL, @p35=NULL, @p36='1', @p37='flow_step_2' (Nullable = false), @p38='text_template', @p39='Show Products' (Nullable = false), @p40='QUICK_REPLY' (Nullable = false), @p41='2e6fb695-5d52-4a0e-b908-bd34c18f3627', @p42='quick_reply' (Nullable = false), @p43='Yes, show me' (Nullable = false), @p44='QUICK_REPLY' (Nullable = false), @p45='' (Nullable = false), @p46='ccbf5f91-790a-4cf2-bf74-9c86f869b98b', @p47='0ce461c8-6b14-40bc-929f-9c70a6ffb921' (Nullable = true), @p48='64193c09-7bef-48a2-9e09-254409647618', @p49='quick_reply' (Nullable = false), @p50='Show Products' (Nullable = false), @p51='QUICK_REPLY' (Nullable = false), @p52='' (Nullable = false), @p53='0ce461c8-6b14-40bc-929f-9c70a6ffb921', @p54='f275e674-9545-4c05-a830-3d531d7f3930' (Nullable = true)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "CTAFlowConfigs" ("Id", "BusinessId", "CreatedAt", "CreatedBy", "FlowName", "IsActive", "IsPublished", "UpdatedAt")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
INSERT INTO "CTAFlowSteps" ("Id", "CTAFlowConfigId", "PositionX", "PositionY", "RequiredSource", "RequiredTag", "StepOrder", "TemplateToSend", "TemplateType", "TriggerButtonText", "TriggerButtonType")
VALUES (@p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
INSERT INTO "CTAFlowSteps" ("Id", "CTAFlowConfigId", "PositionX", "PositionY", "RequiredSource", "RequiredTag", "StepOrder", "TemplateToSend", "TemplateType", "TriggerButtonText", "TriggerButtonType")
VALUES (@p19, @p20, @p21, @p22, @p23, @p24, @p25, @p26, @p27, @p28, @p29);
INSERT INTO "CTAFlowSteps" ("Id", "CTAFlowConfigId", "PositionX", "PositionY", "RequiredSource", "RequiredTag", "StepOrder", "TemplateToSend", "TemplateType", "TriggerButtonText", "TriggerButtonType")
VALUES (@p30, @p31, @p32, @p33, @p34, @p35, @p36, @p37, @p38, @p39, @p40);
INSERT INTO "FlowButtonLinks" ("Id", "ButtonSubType", "ButtonText", "ButtonType", "ButtonValue", "CTAFlowStepId", "NextStepId")
VALUES (@p41, @p42, @p43, @p44, @p45, @p46, @p47);
INSERT INTO "FlowButtonLinks" ("Id", "ButtonSubType", "ButtonText", "ButtonType", "ButtonValue", "CTAFlowStepId", "NextStepId")
VALUES (@p48, @p49, @p50, @p51, @p52, @p53, @p54);
2025-07-02 22:40:18.579 +05:30 [INF] Executed DbCommand (8ms) [Parameters=[@p0='ca0261fb-056f-4f7e-8f14-1c8da37618c8', @p1='c13be597-6ae2-42bb-9d43-925815f24ff8', @p2='2025-07-02T17:10:18.5568683Z' (DbType = DateTime), @p3='Tata Consultancy Services', @p4='Tes001' (Nullable = false), @p5='True', @p6='True', @p7='2025-07-02T17:10:18.5568684Z' (Nullable = true) (DbType = DateTime), @p8='2242b9e3-050f-40e1-bde4-2971bfc16927', @p9='ca0261fb-056f-4f7e-8f14-1c8da37618c8', @p10='434.35007' (Nullable = true), @p11='156.79668' (Nullable = true), @p12=NULL, @p13=NULL, @p14='2', @p15='flow_step_3' (Nullable = false), @p16='text_template', @p17='Yes, show me' (Nullable = false), @p18='QUICK_REPLY' (Nullable = false), @p19='58076498-582b-479d-9dc5-0cca56547077', @p20='ca0261fb-056f-4f7e-8f14-1c8da37618c8', @p21='127.48288' (Nullable = true), @p22='130.62108' (Nullable = true), @p23=NULL, @p24=NULL, @p25='0', @p26='flow_step_1' (Nullable = false), @p27='text_template', @p28='Yes, show me' (Nullable = false), @p29='cta' (Nullable = false), @p30='f1eaf867-f73f-43e3-94ec-007fefe5c104', @p31='ca0261fb-056f-4f7e-8f14-1c8da37618c8', @p32='785.6508' (Nullable = true), @p33='222.93193' (Nullable = true), @p34=NULL, @p35=NULL, @p36='1', @p37='flow_step_2' (Nullable = false), @p38='text_template', @p39='Show Products' (Nullable = false), @p40='QUICK_REPLY' (Nullable = false), @p41='dd665ebc-ec1c-44ac-853b-9dda20c17989', @p42='quick_reply' (Nullable = false), @p43='Yes, show me' (Nullable = false), @p44='QUICK_REPLY' (Nullable = false), @p45='' (Nullable = false), @p46='58076498-582b-479d-9dc5-0cca56547077', @p47='2242b9e3-050f-40e1-bde4-2971bfc16927' (Nullable = true), @p48='f1d2b735-61ee-4c6c-943d-f7b7627181bb', @p49='quick_reply' (Nullable = false), @p50='Show Products' (Nullable = false), @p51='QUICK_REPLY' (Nullable = false), @p52='' (Nullable = false), @p53='2242b9e3-050f-40e1-bde4-2971bfc16927', @p54='f1eaf867-f73f-43e3-94ec-007fefe5c104' (Nullable = true)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "CTAFlowConfigs" ("Id", "BusinessId", "CreatedAt", "CreatedBy", "FlowName", "IsActive", "IsPublished", "UpdatedAt")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
INSERT INTO "CTAFlowSteps" ("Id", "CTAFlowConfigId", "PositionX", "PositionY", "RequiredSource", "RequiredTag", "StepOrder", "TemplateToSend", "TemplateType", "TriggerButtonText", "TriggerButtonType")
VALUES (@p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
INSERT INTO "CTAFlowSteps" ("Id", "CTAFlowConfigId", "PositionX", "PositionY", "RequiredSource", "RequiredTag", "StepOrder", "TemplateToSend", "TemplateType", "TriggerButtonText", "TriggerButtonType")
VALUES (@p19, @p20, @p21, @p22, @p23, @p24, @p25, @p26, @p27, @p28, @p29);
INSERT INTO "CTAFlowSteps" ("Id", "CTAFlowConfigId", "PositionX", "PositionY", "RequiredSource", "RequiredTag", "StepOrder", "TemplateToSend", "TemplateType", "TriggerButtonText", "TriggerButtonType")
VALUES (@p30, @p31, @p32, @p33, @p34, @p35, @p36, @p37, @p38, @p39, @p40);
INSERT INTO "FlowButtonLinks" ("Id", "ButtonSubType", "ButtonText", "ButtonType", "ButtonValue", "CTAFlowStepId", "NextStepId")
VALUES (@p41, @p42, @p43, @p44, @p45, @p46, @p47);
INSERT INTO "FlowButtonLinks" ("Id", "ButtonSubType", "ButtonText", "ButtonType", "ButtonValue", "CTAFlowStepId", "NextStepId")
VALUES (@p48, @p49, @p50, @p51, @p52, @p53, @p54);
2025-07-02 22:40:18.587 +05:30 [INF] ✅ Flow 'Tes001' saved | Steps: 3 | Links: 4
2025-07-02 22:40:18.587 +05:30 [INF] ✅ Flow 'Tes001' saved | Steps: 3 | Links: 4
2025-07-02 22:40:18.589 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType16`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:40:18.590 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType16`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:40:18.593 +05:30 [INF] Executed action xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController.SaveVisualFlow (xbytechat.api) in 7080.982ms
2025-07-02 22:40:18.593 +05:30 [INF] Executed action xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController.SaveVisualFlow (xbytechat.api) in 7108.0731ms
2025-07-02 22:40:18.594 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController.SaveVisualFlow (xbytechat.api)'
2025-07-02 22:40:18.596 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CTAFlowBuilder.Controllers.CTAFlowController.SaveVisualFlow (xbytechat.api)'
2025-07-02 22:40:18.597 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/api/cta-flow/save-visual - 200 null application/json; charset=utf-8 7092.671ms
2025-07-02 22:40:18.598 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/api/cta-flow/save-visual - 200 null application/json; charset=utf-8 7127.5173ms
2025-07-02 22:41:54.606 +05:30 [INF] Request starting HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - application/json 581
2025-07-02 22:41:54.609 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:41:54.611 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-07-02 22:41:54.613 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSODFCMTZBNDlFODkxMzYyNTQ0AA==","status":"sent","timestamp":"1751182851","recipient_id":"917082156227","conversation":{"id":"90b38ee00c6455dcc79733c1fd93f79a","expiration_timestamp":"1751269260","origin":{"type":"service"}},"pricing":{"billable":true,"pricing_model":"CBP","category":"service"}}]},"field":"messages"}]}]}
2025-07-02 22:41:54.615 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-07-02 22:41:54.616 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSODFCMTZBNDlFODkxMzYyNTQ0AA==","status":"sent","timestamp":"1751182851","recipient_id":"917082156227","conversation":{"id":"90b38ee00c6455dcc79733c1fd93f79a","expiration_timestamp":"1751269260","origin":{"type":"service"}},"pricing":{"billable":true,"pricing_model":"CBP","category":"service"}}]},"field":"messages"}]}]}
2025-07-02 22:41:54.616 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType73`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:41:54.620 +05:30 [INF] 📦 Routing to Status Processor
2025-07-02 22:41:54.622 +05:30 [WRN] 🔍 Incoming timestamp raw value: {"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSODFCMTZBNDlFODkxMzYyNTQ0AA==","status":"sent","timestamp":"1751182851","recipient_id":"917082156227","conversation":{"id":"90b38ee00c6455dcc79733c1fd93f79a","expiration_timestamp":"1751269260","origin":{"type":"service"}},"pricing":{"billable":true,"pricing_model":"CBP","category":"service"}}]},"field":"messages"}]}]}
2025-07-02 22:41:54.621 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 8.4767ms
2025-07-02 22:41:54.627 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:41:54.628 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__messageId_0='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSODFCMTZBNDlFODkxMzYyNTQ0AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."MessageId" = @__messageId_0
LIMIT 1
2025-07-02 22:41:54.629 +05:30 [INF] Request finished HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 23.2282ms
2025-07-02 22:41:54.632 +05:30 [WRN] ⚠️ CampaignSendLog not found for MessageId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSODFCMTZBNDlFODkxMzYyNTQ0AA==
2025-07-02 22:41:54.642 +05:30 [WRN] ⚠️ No matching CampaignSendLog for MessageId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSODFCMTZBNDlFODkxMzYyNTQ0AA==
2025-07-02 22:42:50.313 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/contacts - null null
2025-07-02 22:42:50.314 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/WhatsAppTemplateFetcher/get-template-all - null null
2025-07-02 22:42:50.321 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:42:50.329 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:42:50.330 +05:30 [INF] Executing endpoint 'xbytechat.api.CRM.Controllers.ContactsController.GetAllContacts (xbytechat.api)'
2025-07-02 22:42:50.331 +05:30 [INF] Executing endpoint 'xbytechat_api.WhatsAppSettings.Controllers.WhatsAppTemplateFetcherController.GetAllTemplatesAsync (xbytechat.api)'
2025-07-02 22:42:50.334 +05:30 [INF] Route matched with {action = "GetAllTemplates", controller = "WhatsAppTemplateFetcher"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllTemplatesAsync() on controller xbytechat_api.WhatsAppSettings.Controllers.WhatsAppTemplateFetcherController (xbytechat.api).
2025-07-02 22:42:50.340 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiToken", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."IsActive"
2025-07-02 22:42:50.345 +05:30 [INF] Route matched with {action = "GetAllContacts", controller = "Contacts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllContacts(System.String, Int32, Int32) on controller xbytechat.api.CRM.Controllers.ContactsController (xbytechat.api).
2025-07-02 22:42:50.347 +05:30 [INF] Start processing HTTP request GET https://graph.facebook.com/v22.0/999432368375320/message_templates
2025-07-02 22:42:50.350 +05:30 [INF] Sending HTTP request GET https://graph.facebook.com/v22.0/999432368375320/message_templates
2025-07-02 22:42:50.357 +05:30 [INF] GetPagedContactsAsync: businessId="c13be597-6ae2-42bb-9d43-925815f24ff8", tab=all, page=1, pageSize=25
2025-07-02 22:42:50.400 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Contacts" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."IsActive"
2025-07-02 22:42:50.428 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__p_2='25', @__p_1='0'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."AssignedAgentId", t."BusinessId", t."CreatedAt", t."Email", t."Group", t."IsActive", t."IsArchived", t."IsAutomationPaused", t."IsFavorite", t."LastCTAInteraction", t."LastCTAType", t."LastClickedProductId", t."LastContactedAt", t."LeadSource", t."Name", t."NextFollowUpAt", t."Notes", t."PhoneNumber", t."Tags", t0."Id", t0."AssignedAt", t0."AssignedBy", t0."BusinessId", t0."ContactId", t0."TagId", t0."Id0", t0."BusinessId0", t0."Category", t0."ColorHex", t0."CreatedAt", t0."IsActive", t0."IsSystemTag", t0."LastUsedAt", t0."Name", t0."Notes"
FROM (
    SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."Tags"
    FROM "Contacts" AS c
    WHERE c."BusinessId" = @__businessId_0 AND c."IsActive"
    ORDER BY c."Name"
    LIMIT @__p_2 OFFSET @__p_1
) AS t
LEFT JOIN (
    SELECT c0."Id", c0."AssignedAt", c0."AssignedBy", c0."BusinessId", c0."ContactId", c0."TagId", t1."Id" AS "Id0", t1."BusinessId" AS "BusinessId0", t1."Category", t1."ColorHex", t1."CreatedAt", t1."IsActive", t1."IsSystemTag", t1."LastUsedAt", t1."Name", t1."Notes"
    FROM "ContactTags" AS c0
    INNER JOIN "Tags" AS t1 ON c0."TagId" = t1."Id"
) AS t0 ON t."Id" = t0."ContactId"
ORDER BY t."Name", t."Id", t0."Id"
2025-07-02 22:42:50.434 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Helpers.ResponseResult'.
2025-07-02 22:42:50.438 +05:30 [INF] Executed action xbytechat.api.CRM.Controllers.ContactsController.GetAllContacts (xbytechat.api) in 89.0544ms
2025-07-02 22:42:50.440 +05:30 [INF] Executed endpoint 'xbytechat.api.CRM.Controllers.ContactsController.GetAllContacts (xbytechat.api)'
2025-07-02 22:42:50.442 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/contacts - 200 null application/json; charset=utf-8 128.2162ms
2025-07-02 22:42:51.437 +05:30 [INF] Received HTTP response headers after 1086.0472ms - 200
2025-07-02 22:42:51.439 +05:30 [INF] End processing HTTP request after 1092.6847ms - 200
2025-07-02 22:42:51.441 +05:30 [INF] 📦 Meta Template API Raw JSON for "c13be597-6ae2-42bb-9d43-925815f24ff8":
{"data":[{"name":"flow_step_4","parameter_format":"POSITIONAL","components":[{"type":"HEADER","format":"TEXT","text":"Step -4"},{"type":"BODY","text":"Would you like pricing details for your selected product?"},{"type":"BUTTONS","buttons":[{"type":"QUICK_REPLY","text":"Send Pricing"},{"type":"QUICK_REPLY","text":"Back to Products"}]}],"language":"en_US","status":"APPROVED","category":"MARKETING","sub_category":"CUSTOM","id":"710642074690811"},{"name":"hello_world","parameter_format":"POSITIONAL","components":[{"type":"HEADER","format":"TEXT","text":"Hello World"},{"type":"BODY","text":"Welcome and congratulations!! This message demonstrates your ability to send a WhatsApp message notification from the Cloud API, hosted by Meta. Thank you for taking the time to test with us."},{"type":"FOOTER","text":"WhatsApp Business Platform sample message"}],"language":"en_US","status":"APPROVED","category":"UTILITY","id":"1726067301662421"},{"name":"flow_step_6","parameter_format":"POSITIONAL","components":[{"type":"HEADER","format":"TEXT","text":"Step -6"},{"type":"BODY","text":"Here's what our happy customers say. Would you like to read reviews?"},{"type":"BUTTONS","buttons":[{"type":"QUICK_REPLY","text":"Show Reviews"},{"type":"QUICK_REPLY","text":"Skip"}]}],"language":"en_US","status":"APPROVED","category":"MARKETING","sub_category":"CUSTOM","id":"1919507328796848"},{"name":"flow_step_5","parameter_format":"POSITIONAL","components":[{"type":"HEADER","format":"TEXT","text":"Step =5"},{"type":"BODY","text":"Limited time discount available. Want to grab it now?"},{"type":"BUTTONS","buttons":[{"type":"QUICK_REPLY","text":"Claim Discount"},{"type":"QUICK_REPLY","text":"Not Now"}]}],"language":"en_US","status":"APPROVED","category":"MARKETING","sub_category":"CUSTOM","id":"1780686429496003"},{"name":"flow_step_3","parameter_format":"POSITIONAL","components":[{"type":"HEADER","format":"TEXT","text":"Step -3"},{"type":"BODY","text":"We have 3 amazing products for you. Want to check them out?"},{"type":"BUTTONS","buttons":[{"type":"QUICK_REPLY","text":"Show Products"},{"type":"QUICK_REPLY","text":"Skip"}]}],"language":"en_US","status":"APPROVED","category":"MARKETING","sub_category":"CUSTOM","id":"2154240945038413"},{"name":"flow_step_2","parameter_format":"POSITIONAL","components":[{"type":"HEADER","format":"TEXT","text":"Step -2"},{"type":"BODY","text":"Here's our latest deal. Want to see more options?"},{"type":"BUTTONS","buttons":[{"type":"QUICK_REPLY","text":"More Options"},{"type":"PHONE_NUMBER","text":"Talk to Support","phone_number":"+917082156227"}]}],"language":"en_US","status":"APPROVED","category":"MARKETING","id":"721245346987995"},{"name":"flow_step_1","parameter_format":"POSITIONAL","components":[{"type":"BODY","text":"Hi \ud83d\udc4b, would you like to explore our special offer?"},{"type":"BUTTONS","buttons":[{"type":"QUICK_REPLY","text":"Yes, show me"},{"type":"QUICK_REPLY","text":"No, thanks"}]}],"language":"en_US","status":"APPROVED","category":"MARKETING","sub_category":"CUSTOM","id":"720586043866779"},{"name":"flow_step_7","parameter_format":"POSITIONAL","components":[{"type":"HEADER","format":"TEXT","text":"Step -7"},{"type":"BODY","text":"Would you like to talk to our support team for custom guidance?"},{"type":"BUTTONS","buttons":[{"type":"QUICK_REPLY","text":"Talk to Agent"},{"type":"QUICK_REPLY","text":"Later"}]}],"language":"en_US","status":"APPROVED","category":"MARKETING","sub_category":"CUSTOM","id":"1390795521994729"},{"name":"back_to_restart","parameter_format":"POSITIONAL","components":[{"type":"HEADER","format":"TEXT","text":"Chat Restarted"},{"type":"BODY","text":"Your Process has restarted."},{"type":"BUTTONS","buttons":[{"type":"QUICK_REPLY","text":"Yes, show me"},{"type":"QUICK_REPLY","text":"No, thanks"}]}],"language":"en_US","status":"APPROVED","category":"MARKETING","sub_category":"CUSTOM","id":"2174325859705396"},{"name":"flow_step_10_","parameter_format":"POSITIONAL","components":[{"type":"HEADER","format":"TEXT","text":"Step -10"},{"type":"BODY","text":"Thanks for your interest! Would you like to give feedback?"},{"type":"BUTTONS","buttons":[{"type":"QUICK_REPLY","text":"Give Feedback"},{"type":"QUICK_REPLY","text":"End Chat"}]}],"language":"en_US","status":"APPROVED","category":"MARKETING","sub_category":"CUSTOM","id":"700742109026088"},{"name":"flow_step_9","parameter_format":"POSITIONAL","components":[{"type":"HEADER","format":"TEXT","text":"Step -9"},{"type":"BODY","text":"This is your final offer summary. Ready to proceed?"},{"type":"BUTTONS","buttons":[{"type":"QUICK_REPLY","text":"Proceed"},{"type":"QUICK_REPLY","text":"Restart"}]}],"language":"en_US","status":"APPROVED","category":"MARKETING","sub_category":"CUSTOM","id":"703808575467306"},{"name":"flow_step_8","parameter_format":"POSITIONAL","components":[{"type":"HEADER","format":"TEXT","text":"Step -8"},{"type":"BODY","text":"We can compare 2 products for you. Shall we continue?"},{"type":"BUTTONS","buttons":[{"type":"QUICK_REPLY","text":"Compare Now"},{"type":"QUICK_REPLY","text":"No, thanks"}]}],"language":"en","status":"APPROVED","category":"MARKETING","sub_category":"CUSTOM","id":"1399963891041518"}],"paging":{"cursors":{"before":"MAZDZD","after":"MjQZD"}}}
2025-07-02 22:42:51.444 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType64`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[TemplateForUIResponseDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:42:51.446 +05:30 [INF] Executed action xbytechat_api.WhatsAppSettings.Controllers.WhatsAppTemplateFetcherController.GetAllTemplatesAsync (xbytechat.api) in 1108.7849ms
2025-07-02 22:42:51.448 +05:30 [INF] Executed endpoint 'xbytechat_api.WhatsAppSettings.Controllers.WhatsAppTemplateFetcherController.GetAllTemplatesAsync (xbytechat.api)'
2025-07-02 22:42:51.450 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/WhatsAppTemplateFetcher/get-template-all - 200 null application/json; charset=utf-8 1136.1329ms
2025-07-02 22:42:59.009 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/api/messageengine/send-template-simple - null null
2025-07-02 22:42:59.014 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:42:59.015 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/api/messageengine/send-template-simple - 204 null null 6.2576ms
2025-07-02 22:42:59.019 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/api/messageengine/send-template-simple - application/json 296
2025-07-02 22:42:59.026 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:42:59.028 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.MessagesEngine.Controllers.MessageEngineController.SendTemplateMessageSimple (xbytechat.api)'
2025-07-02 22:42:59.034 +05:30 [INF] Route matched with {action = "SendTemplateMessageSimple", controller = "MessageEngine"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendTemplateMessageSimple(xbytechat.api.Features.MessagesEngine.DTOs.SimpleTemplateMessageDto) on controller xbytechat.api.Features.MessagesEngine.Controllers.MessageEngineController (xbytechat.api).
2025-07-02 22:42:59.054 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT b."Id", b."Address", b."ApprovedAt", b."ApprovedBy", b."BusinessEmail", b."BusinessName", b."CompanyName", b."CompanyPhone", b."CreatedAt", b."CreatedBy", b."CreatedByPartnerId", b."DeletedAt", b."DeletedBy", b."Industry", b."IsApproved", b."IsDeleted", b."LastLoginAt", b."LogoUrl", b."Notes", b."Phone", b."RepresentativeName", b."Source", b."Status", b."Tags", b."Website", w."Id", w."ApiToken", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WhatsAppBusinessNumber"
FROM "Businesses" AS b
LEFT JOIN "WhatsAppSettings" AS w ON b."Id" = w."BusinessId"
WHERE b."Id" = @__businessId_0
LIMIT 1
2025-07-02 22:42:59.075 +05:30 [INF] Start processing HTTP request POST https://graph.facebook.com/v22.0/601884673011340/messages
2025-07-02 22:42:59.077 +05:30 [INF] Sending HTTP request POST https://graph.facebook.com/v22.0/601884673011340/messages
2025-07-02 22:43:00.440 +05:30 [INF] Received HTTP response headers after 1361.5187ms - 200
2025-07-02 22:43:00.442 +05:30 [INF] End processing HTTP request after 1366.8245ms - 200
2025-07-02 22:43:00.467 +05:30 [INF] Executed DbCommand (20ms) [Parameters=[@p0='176f1f5c-db78-49b8-9b49-3df45db83512', @p1='c13be597-6ae2-42bb-9d43-925815f24ff8', @p2=NULL (DbType = Guid), @p3=NULL (DbType = Guid), @p4=NULL (DbType = Guid), @p5=NULL (DbType = Guid), @p6='2025-07-02T17:13:00.4463224Z' (DbType = DateTime), @p7=NULL, @p8='False', @p9=NULL, @p10='flow_step_1' (Nullable = false), @p11=NULL, @p12='{"Success":true,"Message":"✅ Message sent successfully","Data":null,"ErrorMessage":null,"RawResponse":"{\"messaging_product\":\"whatsapp\",\"contacts\":[{\"input\":\"+917082156227\",\"wa_id\":\"917082156227\"}],\"messages\":[{\"id\":\"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSRTU2OTE5QUYwRkE1MDk4MEY3AA==\",\"message_status\":\"accepted\"}]}","MessageId":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSRTU2OTE5QUYwRkE1MDk4MEY3AA==","LogId":null,"Token":null,"RefreshToken":null}', @p13='+917082156227' (Nullable = false), @p14=NULL (DbType = Guid), @p15='', @p16='2025-07-02T17:13:00.4463216Z' (Nullable = true) (DbType = DateTime), @p17=NULL, @p18='Sent' (Nullable = false)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "MessageLogs" ("Id", "BusinessId", "CTAFlowConfigId", "CTAFlowStepId", "CampaignId", "ContactId", "CreatedAt", "ErrorMessage", "IsIncoming", "MediaUrl", "MessageContent", "MessageId", "RawResponse", "RecipientNumber", "RefMessageId", "RenderedBody", "SentAt", "Source", "Status")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
2025-07-02 22:43:00.474 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Helpers.ResponseResult'.
2025-07-02 22:43:00.476 +05:30 [INF] Executed action xbytechat.api.Features.MessagesEngine.Controllers.MessageEngineController.SendTemplateMessageSimple (xbytechat.api) in 1437.8073ms
2025-07-02 22:43:00.478 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.MessagesEngine.Controllers.MessageEngineController.SendTemplateMessageSimple (xbytechat.api)'
2025-07-02 22:43:00.480 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/api/messageengine/send-template-simple - 200 null application/json; charset=utf-8 1461.3282ms
2025-07-02 22:43:01.474 +05:30 [INF] Request starting HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - application/json 602
2025-07-02 22:43:01.478 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:43:01.480 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-07-02 22:43:01.484 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSRTU2OTE5QUYwRkE1MDk4MEY3AA==","status":"sent","timestamp":"1751476384","recipient_id":"917082156227","conversation":{"id":"6b00cbc650cb26f04bf737783a94c1d7","expiration_timestamp":"1751476384","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-07-02 22:43:01.486 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-07-02 22:43:01.487 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSRTU2OTE5QUYwRkE1MDk4MEY3AA==","status":"sent","timestamp":"1751476384","recipient_id":"917082156227","conversation":{"id":"6b00cbc650cb26f04bf737783a94c1d7","expiration_timestamp":"1751476384","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-07-02 22:43:01.487 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType73`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:43:01.490 +05:30 [INF] 📦 Routing to Status Processor
2025-07-02 22:43:01.492 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 8.2147ms
2025-07-02 22:43:01.493 +05:30 [WRN] 🔍 Incoming timestamp raw value: {"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSRTU2OTE5QUYwRkE1MDk4MEY3AA==","status":"sent","timestamp":"1751476384","recipient_id":"917082156227","conversation":{"id":"6b00cbc650cb26f04bf737783a94c1d7","expiration_timestamp":"1751476384","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-07-02 22:43:01.495 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:43:01.500 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__messageId_0='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSRTU2OTE5QUYwRkE1MDk4MEY3AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."MessageId" = @__messageId_0
LIMIT 1
2025-07-02 22:43:01.501 +05:30 [INF] Request finished HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 27.2297ms
2025-07-02 22:43:01.505 +05:30 [WRN] ⚠️ CampaignSendLog not found for MessageId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSRTU2OTE5QUYwRkE1MDk4MEY3AA==
2025-07-02 22:43:01.511 +05:30 [WRN] ⚠️ No matching CampaignSendLog for MessageId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSRTU2OTE5QUYwRkE1MDk4MEY3AA==
2025-07-02 22:43:01.877 +05:30 [INF] Request starting HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - application/json 571
2025-07-02 22:43:01.882 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:43:01.884 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-07-02 22:43:01.888 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSRTU2OTE5QUYwRkE1MDk4MEY3AA==","status":"delivered","timestamp":"1751476385","recipient_id":"917082156227","conversation":{"id":"6b00cbc650cb26f04bf737783a94c1d7","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-07-02 22:43:01.890 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-07-02 22:43:01.890 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSRTU2OTE5QUYwRkE1MDk4MEY3AA==","status":"delivered","timestamp":"1751476385","recipient_id":"917082156227","conversation":{"id":"6b00cbc650cb26f04bf737783a94c1d7","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-07-02 22:43:01.891 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType73`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:43:01.893 +05:30 [INF] 📦 Routing to Status Processor
2025-07-02 22:43:01.895 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 7.8244ms
2025-07-02 22:43:01.896 +05:30 [WRN] 🔍 Incoming timestamp raw value: {"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSRTU2OTE5QUYwRkE1MDk4MEY3AA==","status":"delivered","timestamp":"1751476385","recipient_id":"917082156227","conversation":{"id":"6b00cbc650cb26f04bf737783a94c1d7","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-07-02 22:43:01.897 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:43:01.902 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__messageId_0='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSRTU2OTE5QUYwRkE1MDk4MEY3AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."MessageId" = @__messageId_0
LIMIT 1
2025-07-02 22:43:01.903 +05:30 [INF] Request finished HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 26.1352ms
2025-07-02 22:43:01.907 +05:30 [WRN] ⚠️ CampaignSendLog not found for MessageId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSRTU2OTE5QUYwRkE1MDk4MEY3AA==
2025-07-02 22:43:01.912 +05:30 [WRN] ⚠️ No matching CampaignSendLog for MessageId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSRTU2OTE5QUYwRkE1MDk4MEY3AA==
2025-07-02 22:43:13.248 +05:30 [INF] Request starting HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - application/json 633
2025-07-02 22:43:13.252 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:43:13.253 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-07-02 22:43:13.256 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"contacts":[{"profile":{"name":"\ua9c1S.K\ua9c2"},"wa_id":"917082156227"}],"messages":[{"context":{"from":"15556395845","id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSRTU2OTE5QUYwRkE1MDk4MEY3AA=="},"from":"917082156227","id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAEhggQjBDRTIwMDY4NDFEMzA2ODg1Q0E3QjBGNDlCQUE2OTQA","timestamp":"1751476396","type":"button","button":{"payload":"Yes, show me","text":"Yes, show me"}}]},"field":"messages"}]}]}
2025-07-02 22:43:13.259 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-07-02 22:43:13.259 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"contacts":[{"profile":{"name":"\ua9c1S.K\ua9c2"},"wa_id":"917082156227"}],"messages":[{"context":{"from":"15556395845","id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSRTU2OTE5QUYwRkE1MDk4MEY3AA=="},"from":"917082156227","id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAEhggQjBDRTIwMDY4NDFEMzA2ODg1Q0E3QjBGNDlCQUE2OTQA","timestamp":"1751476396","type":"button","button":{"payload":"Yes, show me","text":"Yes, show me"}}]},"field":"messages"}]}]}
2025-07-02 22:43:13.260 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType73`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:43:13.262 +05:30 [INF] 👉 Routing to Click Processor
2025-07-02 22:43:13.264 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 8.1066ms
2025-07-02 22:43:13.265 +05:30 [WRN] 📥 [ENTERED CLICK PROCESSOR]
2025-07-02 22:43:13.267 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:43:13.268 +05:30 [INF] 🖱️ Button Click → From: 917082156227, ClickId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAEhggQjBDRTIwMDY4NDFEMzA2ODg1Q0E3QjBGNDlCQUE2OTQA, OrigMsgId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSRTU2OTE5QUYwRkE1MDk4MEY3AA==, Text: Yes, show me
2025-07-02 22:43:13.269 +05:30 [INF] Request finished HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 21.215ms
2025-07-02 22:43:13.280 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__originalMessageId_0='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSRTU2OTE5QUYwRkE1MDk4MEY3AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId", c0."Id", c0."BusinessId", c0."CampaignId", c0."CampaignType", c0."CreatedAt", c0."CreatedBy", c0."CtaId", c0."DeletedAt", c0."DeletedBy", c0."FollowUpTemplateId", c0."ImageCaption", c0."ImageUrl", c0."IsDeleted", c0."MessageBody", c0."MessageTemplate", c0."Name", c0."ScheduledAt", c0."SourceCampaignId", c0."Status", c0."TemplateId", c0."TemplateParameters", c0."UpdatedAt", c1."Id", c1."AssignedAgentId", c1."BusinessId", c1."CreatedAt", c1."Email", c1."Group", c1."IsActive", c1."IsArchived", c1."IsAutomationPaused", c1."IsFavorite", c1."LastCTAInteraction", c1."LastCTAType", c1."LastClickedProductId", c1."LastContactedAt", c1."LeadSource", c1."Name", c1."NextFollowUpAt", c1."Notes", c1."PhoneNumber", c1."Tags"
FROM "CampaignSendLogs" AS c
INNER JOIN "Campaigns" AS c0 ON c."CampaignId" = c0."Id"
INNER JOIN "Contacts" AS c1 ON c."ContactId" = c1."Id"
WHERE c."MessageId" = @__originalMessageId_0
LIMIT 1
2025-07-02 22:43:13.288 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__originalMessageId_0='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSRTU2OTE5QUYwRkE1MDk4MEY3AA==', @__originalMessageId_0_contains='%wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSRTU2OTE5QUYwRkE1MDk4MEY3AA==%'], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."CreatedAt", m."ErrorMessage", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."MessageId" = @__originalMessageId_0 OR m."Id"::text = @__originalMessageId_0 OR m."RawResponse" LIKE @__originalMessageId_0_contains
LIMIT 1
2025-07-02 22:43:13.291 +05:30 [INF] ✅ Fallback matched MessageLog. BusinessId: "c13be597-6ae2-42bb-9d43-925815f24ff8"
2025-07-02 22:43:18.043 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__dto_MessageId_0='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSRTU2OTE5QUYwRkE1MDk4MEY3AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."CreatedAt", m."ErrorMessage", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."MessageId" = @__dto_MessageId_0 OR m."Id"::text = @__dto_MessageId_0
LIMIT 1
2025-07-02 22:43:18.136 +05:30 [INF] Executed DbCommand (22ms) [Parameters=[@p0='c58ba960-26d3-4abc-ac2d-a65a236239ea', @p1='WhatsApp', @p2='c13be597-6ae2-42bb-9d43-925815f24ff8', @p3='Yes, show me', @p4='Yes, show me', @p5=NULL (DbType = Guid), @p6=NULL (DbType = Guid), @p7=NULL, @p8='2025-07-02T17:13:13.2937159Z' (DbType = DateTime), @p9='webhook', @p10=NULL (DbType = Guid), @p11='+917082156227', @p12='Unknown', @p13='Unknown', @p14='False', @p15='webhook', @p16='Clicked', @p17='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSRTU2OTE5QUYwRkE1MDk4MEY3AA==', @p18=NULL (DbType = Guid), @p19=NULL, @p20=NULL (DbType = Guid), @p21=NULL (DbType = Guid), @p22='flow' (Nullable = false), @p23=NULL (DbType = Guid), @p24=NULL, @p25=NULL (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "TrackingLogs" ("Id", "Browser", "BusinessId", "ButtonText", "CTAType", "CampaignId", "CampaignSendLogId", "City", "ClickedAt", "ClickedVia", "ContactId", "ContactPhone", "Country", "DeviceType", "FollowUpSent", "IPAddress", "LastInteractionType", "MessageId", "MessageLogId", "Referrer", "SessionId", "SourceId", "SourceType", "StepId", "TemplateId", "ThreadId")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22, @p23, @p24, @p25);
2025-07-02 22:43:18.141 +05:30 [INF] 📥 Click Tracked → Result: CTA click tracked successfully.
2025-07-02 22:43:18.163 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__normalizedButtonText_1='yes, show me', @__normalizedButtonType_2='quick_reply'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."CTAFlowConfigId", c."PositionX", c."PositionY", c."RequiredSource", c."RequiredTag", c."StepOrder", c."TemplateToSend", c."TemplateType", c."TriggerButtonText", c."TriggerButtonType", c0."Id", c0."BusinessId", c0."CreatedAt", c0."CreatedBy", c0."FlowName", c0."IsActive", c0."IsPublished", c0."UpdatedAt"
FROM "CTAFlowSteps" AS c
INNER JOIN "CTAFlowConfigs" AS c0 ON c."CTAFlowConfigId" = c0."Id"
WHERE c0."BusinessId" = @__businessId_0 AND c0."IsActive" AND c0."IsPublished" AND lower(c."TriggerButtonText") = @__normalizedButtonText_1 AND lower(c."TriggerButtonType") = @__normalizedButtonType_2
LIMIT 1
2025-07-02 22:43:18.169 +05:30 [INF] ✅ Fallback flow step matched: StepId = "b2d0e1a3-846e-49aa-a954-8badae61643f", Flow = test01
2025-07-02 22:43:18.172 +05:30 [INF] 🔁 Matched CTA Step → "b2d0e1a3-846e-49aa-a954-8badae61643f"
2025-07-02 22:43:18.175 +05:30 [INF] 🚦 Executing Visual Flow → StepId: "b2d0e1a3-846e-49aa-a954-8badae61643f" | TrackingLogId: "c58ba960-26d3-4abc-ac2d-a65a236239ea"
2025-07-02 22:43:18.201 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__trackingLogId_0='c58ba960-26d3-4abc-ac2d-a65a236239ea'], CommandType='"Text"', CommandTimeout='30']
SELECT t0."Id", t0."Browser", t0."BusinessId", t0."ButtonText", t0."CTAType", t0."CampaignId", t0."CampaignSendLogId", t0."City", t0."ClickedAt", t0."ClickedVia", t0."ContactId", t0."ContactPhone", t0."Country", t0."DeviceType", t0."FollowUpSent", t0."IPAddress", t0."LastInteractionType", t0."MessageId", t0."MessageLogId", t0."Referrer", t0."SessionId", t0."SourceId", t0."SourceType", t0."StepId", t0."TemplateId", t0."ThreadId", t0."Id0", t0."AssignedAgentId", t0."BusinessId0", t0."CreatedAt", t0."Email", t0."Group", t0."IsActive", t0."IsArchived", t0."IsAutomationPaused", t0."IsFavorite", t0."LastCTAInteraction", t0."LastCTAType", t0."LastClickedProductId", t0."LastContactedAt", t0."LeadSource", t0."Name", t0."NextFollowUpAt", t0."Notes", t0."PhoneNumber", t0."Tags", t1."Id", t1."AssignedAt", t1."AssignedBy", t1."BusinessId", t1."ContactId", t1."TagId", t1."Id0", t1."BusinessId0", t1."Category", t1."ColorHex", t1."CreatedAt", t1."IsActive", t1."IsSystemTag", t1."LastUsedAt", t1."Name", t1."Notes"
FROM (
    SELECT t."Id", t."Browser", t."BusinessId", t."ButtonText", t."CTAType", t."CampaignId", t."CampaignSendLogId", t."City", t."ClickedAt", t."ClickedVia", t."ContactId", t."ContactPhone", t."Country", t."DeviceType", t."FollowUpSent", t."IPAddress", t."LastInteractionType", t."MessageId", t."MessageLogId", t."Referrer", t."SessionId", t."SourceId", t."SourceType", t."StepId", t."TemplateId", t."ThreadId", c."Id" AS "Id0", c."AssignedAgentId", c."BusinessId" AS "BusinessId0", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."Tags"
    FROM "TrackingLogs" AS t
    LEFT JOIN "Contacts" AS c ON t."ContactId" = c."Id"
    WHERE t."Id" = @__trackingLogId_0
    LIMIT 1
) AS t0
LEFT JOIN (
    SELECT c0."Id", c0."AssignedAt", c0."AssignedBy", c0."BusinessId", c0."ContactId", c0."TagId", t2."Id" AS "Id0", t2."BusinessId" AS "BusinessId0", t2."Category", t2."ColorHex", t2."CreatedAt", t2."IsActive", t2."IsSystemTag", t2."LastUsedAt", t2."Name", t2."Notes"
    FROM "ContactTags" AS c0
    INNER JOIN "Tags" AS t2 ON c0."TagId" = t2."Id"
) AS t1 ON t0."Id0" = t1."ContactId"
ORDER BY t0."Id", t0."Id0", t1."Id"
2025-07-02 22:43:18.228 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__nextStepId_1='b2d0e1a3-846e-49aa-a954-8badae61643f' (Nullable = true)], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."BusinessId", t."CreatedAt", t."CreatedBy", t."FlowName", t."IsActive", t."IsPublished", t."UpdatedAt", c1."Id", c1."CTAFlowConfigId", c1."PositionX", c1."PositionY", c1."RequiredSource", c1."RequiredTag", c1."StepOrder", c1."TemplateToSend", c1."TemplateType", c1."TriggerButtonText", c1."TriggerButtonType"
FROM (
    SELECT c."Id", c."BusinessId", c."CreatedAt", c."CreatedBy", c."FlowName", c."IsActive", c."IsPublished", c."UpdatedAt"
    FROM "CTAFlowConfigs" AS c
    WHERE c."BusinessId" = @__businessId_0 AND EXISTS (
        SELECT 1
        FROM "CTAFlowSteps" AS c0
        WHERE c."Id" = c0."CTAFlowConfigId" AND c0."Id" = @__nextStepId_1)
    LIMIT 1
) AS t
LEFT JOIN "CTAFlowSteps" AS c1 ON t."Id" = c1."CTAFlowConfigId"
ORDER BY t."Id"
2025-07-02 22:43:18.234 +05:30 [INF] ✅ Follow-up step found and matched → StepId: "b2d0e1a3-846e-49aa-a954-8badae61643f", Template: flow_step_2
2025-07-02 22:43:18.238 +05:30 [INF] Start processing HTTP request POST https://graph.facebook.com/v22.0/601884673011340/messages
2025-07-02 22:43:18.240 +05:30 [INF] Sending HTTP request POST https://graph.facebook.com/v22.0/601884673011340/messages
2025-07-02 22:43:19.692 +05:30 [INF] Received HTTP response headers after 1450.6371ms - 200
2025-07-02 22:43:19.694 +05:30 [INF] End processing HTTP request after 1455.8604ms - 200
2025-07-02 22:43:19.718 +05:30 [INF] Executed DbCommand (20ms) [Parameters=[@p0='111e16fe-ff41-4780-911b-6ac63d612f66', @p1='c13be597-6ae2-42bb-9d43-925815f24ff8', @p2=NULL (DbType = Guid), @p3=NULL (DbType = Guid), @p4=NULL (DbType = Guid), @p5=NULL (DbType = Guid), @p6='2025-07-02T17:13:19.6978735Z' (DbType = DateTime), @p7=NULL, @p8='False', @p9=NULL, @p10='flow_step_2' (Nullable = false), @p11=NULL, @p12='{"Success":true,"Message":"✅ Message sent successfully","Data":null,"ErrorMessage":null,"RawResponse":"{\"messaging_product\":\"whatsapp\",\"contacts\":[{\"input\":\"+917082156227\",\"wa_id\":\"917082156227\"}],\"messages\":[{\"id\":\"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSNEZBRDBDQURBMUFFNUYxNjM5AA==\",\"message_status\":\"accepted\"}]}","MessageId":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSNEZBRDBDQURBMUFFNUYxNjM5AA==","LogId":null,"Token":null,"RefreshToken":null}', @p13='+917082156227' (Nullable = false), @p14=NULL (DbType = Guid), @p15='', @p16='2025-07-02T17:13:19.6978728Z' (Nullable = true) (DbType = DateTime), @p17=NULL, @p18='Sent' (Nullable = false)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "MessageLogs" ("Id", "BusinessId", "CTAFlowConfigId", "CTAFlowStepId", "CampaignId", "ContactId", "CreatedAt", "ErrorMessage", "IsIncoming", "MediaUrl", "MessageContent", "MessageId", "RawResponse", "RecipientNumber", "RefMessageId", "RenderedBody", "SentAt", "Source", "Status")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
2025-07-02 22:43:19.763 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@p0='46d7ce2d-7f0d-40ca-b9a1-b6f3e2881c24', @p1='c13be597-6ae2-42bb-9d43-925815f24ff8', @p2='+917082156227', @p3=NULL, @p4='2025-07-02T17:13:19.7238842Z' (DbType = DateTime), @p5='8c065950-26a3-4fac-a3a4-462879e809e6' (Nullable = true), @p6=NULL, @p7='b2d0e1a3-846e-49aa-a954-8badae61643f', @p8='' (Nullable = false), @p9='True', @p10='flow_step_2', @p11='text_template', @p12='c58ba960-26d3-4abc-ac2d-a65a236239ea' (Nullable = true), @p13='Yes, show me'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "FlowExecutionLogs" ("Id", "BusinessId", "ContactPhone", "ErrorMessage", "ExecutedAt", "FlowId", "RawResponse", "StepId", "StepName", "Success", "TemplateName", "TemplateType", "TrackingLogId", "TriggeredByButton")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13);
2025-07-02 22:43:19.767 +05:30 [INF] ✅ Flow step executed → Template: flow_step_2 sent to +917082156227
2025-07-02 22:43:19.769 +05:30 [INF] ⚡ Visual flow triggered via CTA click.
2025-07-02 22:43:20.417 +05:30 [INF] Request starting HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - application/json 602
2025-07-02 22:43:20.420 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:43:20.422 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-07-02 22:43:20.424 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSNEZBRDBDQURBMUFFNUYxNjM5AA==","status":"sent","timestamp":"1751476403","recipient_id":"917082156227","conversation":{"id":"f44718edc26e1e21bddb8e5b446090a3","expiration_timestamp":"1751476403","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-07-02 22:43:20.427 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-07-02 22:43:20.427 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSNEZBRDBDQURBMUFFNUYxNjM5AA==","status":"sent","timestamp":"1751476403","recipient_id":"917082156227","conversation":{"id":"f44718edc26e1e21bddb8e5b446090a3","expiration_timestamp":"1751476403","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-07-02 22:43:20.429 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType73`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:43:20.431 +05:30 [INF] 📦 Routing to Status Processor
2025-07-02 22:43:20.433 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 9.2961ms
2025-07-02 22:43:20.434 +05:30 [WRN] 🔍 Incoming timestamp raw value: {"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSNEZBRDBDQURBMUFFNUYxNjM5AA==","status":"sent","timestamp":"1751476403","recipient_id":"917082156227","conversation":{"id":"f44718edc26e1e21bddb8e5b446090a3","expiration_timestamp":"1751476403","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-07-02 22:43:20.436 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:43:20.440 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__messageId_0='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSNEZBRDBDQURBMUFFNUYxNjM5AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."MessageId" = @__messageId_0
LIMIT 1
2025-07-02 22:43:20.440 +05:30 [INF] Request finished HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 23.765ms
2025-07-02 22:43:20.445 +05:30 [WRN] ⚠️ CampaignSendLog not found for MessageId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSNEZBRDBDQURBMUFFNUYxNjM5AA==
2025-07-02 22:43:20.451 +05:30 [WRN] ⚠️ No matching CampaignSendLog for MessageId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSNEZBRDBDQURBMUFFNUYxNjM5AA==
2025-07-02 22:43:20.719 +05:30 [INF] Request starting HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - application/json 571
2025-07-02 22:43:20.722 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:43:20.724 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-07-02 22:43:20.727 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSNEZBRDBDQURBMUFFNUYxNjM5AA==","status":"delivered","timestamp":"1751476404","recipient_id":"917082156227","conversation":{"id":"f44718edc26e1e21bddb8e5b446090a3","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-07-02 22:43:20.729 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-07-02 22:43:20.730 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSNEZBRDBDQURBMUFFNUYxNjM5AA==","status":"delivered","timestamp":"1751476404","recipient_id":"917082156227","conversation":{"id":"f44718edc26e1e21bddb8e5b446090a3","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-07-02 22:43:20.731 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType73`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:43:20.733 +05:30 [INF] 📦 Routing to Status Processor
2025-07-02 22:43:20.735 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 8.165ms
2025-07-02 22:43:20.736 +05:30 [WRN] 🔍 Incoming timestamp raw value: {"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSNEZBRDBDQURBMUFFNUYxNjM5AA==","status":"delivered","timestamp":"1751476404","recipient_id":"917082156227","conversation":{"id":"f44718edc26e1e21bddb8e5b446090a3","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-07-02 22:43:20.738 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:43:20.742 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__messageId_0='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSNEZBRDBDQURBMUFFNUYxNjM5AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."MessageId" = @__messageId_0
LIMIT 1
2025-07-02 22:43:20.744 +05:30 [INF] Request finished HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 25.3219ms
2025-07-02 22:43:20.747 +05:30 [WRN] ⚠️ CampaignSendLog not found for MessageId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSNEZBRDBDQURBMUFFNUYxNjM5AA==
2025-07-02 22:43:20.753 +05:30 [WRN] ⚠️ No matching CampaignSendLog for MessageId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSNEZBRDBDQURBMUFFNUYxNjM5AA==
2025-07-02 22:43:25.938 +05:30 [INF] Request starting HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - application/json 633
2025-07-02 22:43:25.941 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:43:25.943 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-07-02 22:43:25.946 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"contacts":[{"profile":{"name":"\ua9c1S.K\ua9c2"},"wa_id":"917082156227"}],"messages":[{"context":{"from":"15556395845","id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSNEZBRDBDQURBMUFFNUYxNjM5AA=="},"from":"917082156227","id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAEhggQzA2NEQ2NjBFOUQzMTJEN0ZFOTJBQTg4MUFCRjQ4NjkA","timestamp":"1751476408","type":"button","button":{"payload":"More Options","text":"More Options"}}]},"field":"messages"}]}]}
2025-07-02 22:43:25.950 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-07-02 22:43:25.950 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"contacts":[{"profile":{"name":"\ua9c1S.K\ua9c2"},"wa_id":"917082156227"}],"messages":[{"context":{"from":"15556395845","id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSNEZBRDBDQURBMUFFNUYxNjM5AA=="},"from":"917082156227","id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAEhggQzA2NEQ2NjBFOUQzMTJEN0ZFOTJBQTg4MUFCRjQ4NjkA","timestamp":"1751476408","type":"button","button":{"payload":"More Options","text":"More Options"}}]},"field":"messages"}]}]}
2025-07-02 22:43:25.952 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType73`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:43:25.954 +05:30 [INF] 👉 Routing to Click Processor
2025-07-02 22:43:25.955 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 9.1685ms
2025-07-02 22:43:25.956 +05:30 [WRN] 📥 [ENTERED CLICK PROCESSOR]
2025-07-02 22:43:25.958 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:43:25.961 +05:30 [INF] Request finished HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 22.693ms
2025-07-02 22:43:25.959 +05:30 [INF] 🖱️ Button Click → From: 917082156227, ClickId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAEhggQzA2NEQ2NjBFOUQzMTJEN0ZFOTJBQTg4MUFCRjQ4NjkA, OrigMsgId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSNEZBRDBDQURBMUFFNUYxNjM5AA==, Text: More Options
2025-07-02 22:43:25.971 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__originalMessageId_0='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSNEZBRDBDQURBMUFFNUYxNjM5AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId", c0."Id", c0."BusinessId", c0."CampaignId", c0."CampaignType", c0."CreatedAt", c0."CreatedBy", c0."CtaId", c0."DeletedAt", c0."DeletedBy", c0."FollowUpTemplateId", c0."ImageCaption", c0."ImageUrl", c0."IsDeleted", c0."MessageBody", c0."MessageTemplate", c0."Name", c0."ScheduledAt", c0."SourceCampaignId", c0."Status", c0."TemplateId", c0."TemplateParameters", c0."UpdatedAt", c1."Id", c1."AssignedAgentId", c1."BusinessId", c1."CreatedAt", c1."Email", c1."Group", c1."IsActive", c1."IsArchived", c1."IsAutomationPaused", c1."IsFavorite", c1."LastCTAInteraction", c1."LastCTAType", c1."LastClickedProductId", c1."LastContactedAt", c1."LeadSource", c1."Name", c1."NextFollowUpAt", c1."Notes", c1."PhoneNumber", c1."Tags"
FROM "CampaignSendLogs" AS c
INNER JOIN "Campaigns" AS c0 ON c."CampaignId" = c0."Id"
INNER JOIN "Contacts" AS c1 ON c."ContactId" = c1."Id"
WHERE c."MessageId" = @__originalMessageId_0
LIMIT 1
2025-07-02 22:43:25.975 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__originalMessageId_0='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSNEZBRDBDQURBMUFFNUYxNjM5AA==', @__originalMessageId_0_contains='%wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSNEZBRDBDQURBMUFFNUYxNjM5AA==%'], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."CreatedAt", m."ErrorMessage", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."MessageId" = @__originalMessageId_0 OR m."Id"::text = @__originalMessageId_0 OR m."RawResponse" LIKE @__originalMessageId_0_contains
LIMIT 1
2025-07-02 22:43:25.978 +05:30 [INF] ✅ Fallback matched MessageLog. BusinessId: "c13be597-6ae2-42bb-9d43-925815f24ff8"
2025-07-02 22:43:26.894 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__dto_MessageId_0='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSNEZBRDBDQURBMUFFNUYxNjM5AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."CreatedAt", m."ErrorMessage", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."MessageId" = @__dto_MessageId_0 OR m."Id"::text = @__dto_MessageId_0
LIMIT 1
2025-07-02 22:43:26.918 +05:30 [INF] Executed DbCommand (20ms) [Parameters=[@p0='f904f40c-830d-4974-a5e4-c86f1d933168', @p1='WhatsApp', @p2='c13be597-6ae2-42bb-9d43-925815f24ff8', @p3='More Options', @p4='More Options', @p5=NULL (DbType = Guid), @p6=NULL (DbType = Guid), @p7=NULL, @p8='2025-07-02T17:13:25.9798632Z' (DbType = DateTime), @p9='webhook', @p10=NULL (DbType = Guid), @p11='+917082156227', @p12='Unknown', @p13='Unknown', @p14='False', @p15='webhook', @p16='Clicked', @p17='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSNEZBRDBDQURBMUFFNUYxNjM5AA==', @p18=NULL (DbType = Guid), @p19=NULL, @p20=NULL (DbType = Guid), @p21=NULL (DbType = Guid), @p22='flow' (Nullable = false), @p23=NULL (DbType = Guid), @p24=NULL, @p25=NULL (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "TrackingLogs" ("Id", "Browser", "BusinessId", "ButtonText", "CTAType", "CampaignId", "CampaignSendLogId", "City", "ClickedAt", "ClickedVia", "ContactId", "ContactPhone", "Country", "DeviceType", "FollowUpSent", "IPAddress", "LastInteractionType", "MessageId", "MessageLogId", "Referrer", "SessionId", "SourceId", "SourceType", "StepId", "TemplateId", "ThreadId")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22, @p23, @p24, @p25);
2025-07-02 22:43:26.922 +05:30 [INF] 📥 Click Tracked → Result: CTA click tracked successfully.
2025-07-02 22:43:26.926 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__normalizedButtonText_1='more options', @__normalizedButtonType_2='quick_reply'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."CTAFlowConfigId", c."PositionX", c."PositionY", c."RequiredSource", c."RequiredTag", c."StepOrder", c."TemplateToSend", c."TemplateType", c."TriggerButtonText", c."TriggerButtonType", c0."Id", c0."BusinessId", c0."CreatedAt", c0."CreatedBy", c0."FlowName", c0."IsActive", c0."IsPublished", c0."UpdatedAt"
FROM "CTAFlowSteps" AS c
INNER JOIN "CTAFlowConfigs" AS c0 ON c."CTAFlowConfigId" = c0."Id"
WHERE c0."BusinessId" = @__businessId_0 AND c0."IsActive" AND c0."IsPublished" AND lower(c."TriggerButtonText") = @__normalizedButtonText_1 AND lower(c."TriggerButtonType") = @__normalizedButtonType_2
LIMIT 1
2025-07-02 22:43:26.930 +05:30 [WRN] ❌ No fallback step matched for button 'more options' of type 'quick_reply' in BusinessId: "c13be597-6ae2-42bb-9d43-925815f24ff8"
2025-07-02 22:43:26.932 +05:30 [INF] 🟡 No visual flow matched for this button: More Options
2025-07-02 22:44:13.867 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/WhatsAppTemplateFetcher/get-template-all - null null
2025-07-02 22:44:13.878 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:44:13.880 +05:30 [INF] Executing endpoint 'xbytechat_api.WhatsAppSettings.Controllers.WhatsAppTemplateFetcherController.GetAllTemplatesAsync (xbytechat.api)'
2025-07-02 22:44:13.882 +05:30 [INF] Route matched with {action = "GetAllTemplates", controller = "WhatsAppTemplateFetcher"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllTemplatesAsync() on controller xbytechat_api.WhatsAppSettings.Controllers.WhatsAppTemplateFetcherController (xbytechat.api).
2025-07-02 22:44:13.979 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiToken", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."IsActive"
2025-07-02 22:44:13.983 +05:30 [INF] Start processing HTTP request GET https://graph.facebook.com/v22.0/999432368375320/message_templates
2025-07-02 22:44:13.984 +05:30 [INF] Sending HTTP request GET https://graph.facebook.com/v22.0/999432368375320/message_templates
2025-07-02 22:44:15.297 +05:30 [INF] Received HTTP response headers after 1311.5886ms - 200
2025-07-02 22:44:15.299 +05:30 [INF] End processing HTTP request after 1316.8908ms - 200
2025-07-02 22:44:15.301 +05:30 [INF] 📦 Meta Template API Raw JSON for "c13be597-6ae2-42bb-9d43-925815f24ff8":
{"data":[{"name":"flow_step_2","parameter_format":"POSITIONAL","components":[{"type":"HEADER","format":"TEXT","text":"Step -2"},{"type":"BODY","text":"Here's our latest deal. Want to see more options?"},{"type":"BUTTONS","buttons":[{"type":"QUICK_REPLY","text":"More Options"},{"type":"PHONE_NUMBER","text":"Talk to Support","phone_number":"+917082156227"}]}],"language":"en_US","status":"APPROVED","category":"MARKETING","id":"721245346987995"},{"name":"flow_step_1","parameter_format":"POSITIONAL","components":[{"type":"BODY","text":"Hi \ud83d\udc4b, would you like to explore our special offer?"},{"type":"BUTTONS","buttons":[{"type":"QUICK_REPLY","text":"Yes, show me"},{"type":"QUICK_REPLY","text":"No, thanks"}]}],"language":"en_US","status":"APPROVED","category":"MARKETING","sub_category":"CUSTOM","id":"720586043866779"},{"name":"flow_step_4","parameter_format":"POSITIONAL","components":[{"type":"HEADER","format":"TEXT","text":"Step -4"},{"type":"BODY","text":"Would you like pricing details for your selected product?"},{"type":"BUTTONS","buttons":[{"type":"QUICK_REPLY","text":"Send Pricing"},{"type":"QUICK_REPLY","text":"Back to Products"}]}],"language":"en_US","status":"APPROVED","category":"MARKETING","sub_category":"CUSTOM","id":"710642074690811"},{"name":"hello_world","parameter_format":"POSITIONAL","components":[{"type":"HEADER","format":"TEXT","text":"Hello World"},{"type":"BODY","text":"Welcome and congratulations!! This message demonstrates your ability to send a WhatsApp message notification from the Cloud API, hosted by Meta. Thank you for taking the time to test with us."},{"type":"FOOTER","text":"WhatsApp Business Platform sample message"}],"language":"en_US","status":"APPROVED","category":"UTILITY","id":"1726067301662421"},{"name":"flow_step_6","parameter_format":"POSITIONAL","components":[{"type":"HEADER","format":"TEXT","text":"Step -6"},{"type":"BODY","text":"Here's what our happy customers say. Would you like to read reviews?"},{"type":"BUTTONS","buttons":[{"type":"QUICK_REPLY","text":"Show Reviews"},{"type":"QUICK_REPLY","text":"Skip"}]}],"language":"en_US","status":"APPROVED","category":"MARKETING","sub_category":"CUSTOM","id":"1919507328796848"},{"name":"flow_step_5","parameter_format":"POSITIONAL","components":[{"type":"HEADER","format":"TEXT","text":"Step =5"},{"type":"BODY","text":"Limited time discount available. Want to grab it now?"},{"type":"BUTTONS","buttons":[{"type":"QUICK_REPLY","text":"Claim Discount"},{"type":"QUICK_REPLY","text":"Not Now"}]}],"language":"en_US","status":"APPROVED","category":"MARKETING","sub_category":"CUSTOM","id":"1780686429496003"},{"name":"flow_step_3","parameter_format":"POSITIONAL","components":[{"type":"HEADER","format":"TEXT","text":"Step -3"},{"type":"BODY","text":"We have 3 amazing products for you. Want to check them out?"},{"type":"BUTTONS","buttons":[{"type":"QUICK_REPLY","text":"Show Products"},{"type":"QUICK_REPLY","text":"Skip"}]}],"language":"en_US","status":"APPROVED","category":"MARKETING","sub_category":"CUSTOM","id":"2154240945038413"},{"name":"flow_step_7","parameter_format":"POSITIONAL","components":[{"type":"HEADER","format":"TEXT","text":"Step -7"},{"type":"BODY","text":"Would you like to talk to our support team for custom guidance?"},{"type":"BUTTONS","buttons":[{"type":"QUICK_REPLY","text":"Talk to Agent"},{"type":"QUICK_REPLY","text":"Later"}]}],"language":"en_US","status":"APPROVED","category":"MARKETING","sub_category":"CUSTOM","id":"1390795521994729"},{"name":"back_to_restart","parameter_format":"POSITIONAL","components":[{"type":"HEADER","format":"TEXT","text":"Chat Restarted"},{"type":"BODY","text":"Your Process has restarted."},{"type":"BUTTONS","buttons":[{"type":"QUICK_REPLY","text":"Yes, show me"},{"type":"QUICK_REPLY","text":"No, thanks"}]}],"language":"en_US","status":"APPROVED","category":"MARKETING","sub_category":"CUSTOM","id":"2174325859705396"},{"name":"flow_step_10_","parameter_format":"POSITIONAL","components":[{"type":"HEADER","format":"TEXT","text":"Step -10"},{"type":"BODY","text":"Thanks for your interest! Would you like to give feedback?"},{"type":"BUTTONS","buttons":[{"type":"QUICK_REPLY","text":"Give Feedback"},{"type":"QUICK_REPLY","text":"End Chat"}]}],"language":"en_US","status":"APPROVED","category":"MARKETING","sub_category":"CUSTOM","id":"700742109026088"},{"name":"flow_step_9","parameter_format":"POSITIONAL","components":[{"type":"HEADER","format":"TEXT","text":"Step -9"},{"type":"BODY","text":"This is your final offer summary. Ready to proceed?"},{"type":"BUTTONS","buttons":[{"type":"QUICK_REPLY","text":"Proceed"},{"type":"QUICK_REPLY","text":"Restart"}]}],"language":"en_US","status":"APPROVED","category":"MARKETING","sub_category":"CUSTOM","id":"703808575467306"},{"name":"flow_step_8","parameter_format":"POSITIONAL","components":[{"type":"HEADER","format":"TEXT","text":"Step -8"},{"type":"BODY","text":"We can compare 2 products for you. Shall we continue?"},{"type":"BUTTONS","buttons":[{"type":"QUICK_REPLY","text":"Compare Now"},{"type":"QUICK_REPLY","text":"No, thanks"}]}],"language":"en","status":"APPROVED","category":"MARKETING","sub_category":"CUSTOM","id":"1399963891041518"}],"paging":{"cursors":{"before":"MAZDZD","after":"MjQZD"}}}
2025-07-02 22:44:15.304 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType64`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[TemplateForUIResponseDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:44:15.306 +05:30 [INF] Executed action xbytechat_api.WhatsAppSettings.Controllers.WhatsAppTemplateFetcherController.GetAllTemplatesAsync (xbytechat.api) in 1421.1093ms
2025-07-02 22:44:15.308 +05:30 [INF] Executed endpoint 'xbytechat_api.WhatsAppSettings.Controllers.WhatsAppTemplateFetcherController.GetAllTemplatesAsync (xbytechat.api)'
2025-07-02 22:44:15.310 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/WhatsAppTemplateFetcher/get-template-all - 200 null application/json; charset=utf-8 1443.1369ms
2025-07-02 22:45:54.701 +05:30 [INF] Request starting HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - application/json 715
2025-07-02 22:45:54.705 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:45:54.707 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-07-02 22:45:54.710 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSNjQ3QjExNjMyNTNFMDM1NkY5AA==","status":"failed","timestamp":"1751181235","recipient_id":"917082156227","errors":[{"code":131047,"title":"Re-engagement message","message":"Re-engagement message","error_data":{"details":"Message failed to send because more than 24 hours have passed since the customer last replied to this number."},"href":"https:\/\/developers.facebook.com\/docs\/whatsapp\/cloud-api\/support\/error-codes\/"}]}]},"field":"messages"}]}]}
2025-07-02 22:45:54.712 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-07-02 22:45:54.713 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSNjQ3QjExNjMyNTNFMDM1NkY5AA==","status":"failed","timestamp":"1751181235","recipient_id":"917082156227","errors":[{"code":131047,"title":"Re-engagement message","message":"Re-engagement message","error_data":{"details":"Message failed to send because more than 24 hours have passed since the customer last replied to this number."},"href":"https:\/\/developers.facebook.com\/docs\/whatsapp\/cloud-api\/support\/error-codes\/"}]}]},"field":"messages"}]}]}
2025-07-02 22:45:54.713 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType73`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:45:54.715 +05:30 [INF] 📦 Routing to Status Processor
2025-07-02 22:45:54.717 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 7.4669ms
2025-07-02 22:45:54.718 +05:30 [WRN] 🔍 Incoming timestamp raw value: {"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSNjQ3QjExNjMyNTNFMDM1NkY5AA==","status":"failed","timestamp":"1751181235","recipient_id":"917082156227","errors":[{"code":131047,"title":"Re-engagement message","message":"Re-engagement message","error_data":{"details":"Message failed to send because more than 24 hours have passed since the customer last replied to this number."},"href":"https:\/\/developers.facebook.com\/docs\/whatsapp\/cloud-api\/support\/error-codes\/"}]}]},"field":"messages"}]}]}
2025-07-02 22:45:54.719 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:45:54.725 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__messageId_0='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSNjQ3QjExNjMyNTNFMDM1NkY5AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."MessageId" = @__messageId_0
LIMIT 1
2025-07-02 22:45:54.726 +05:30 [INF] Request finished HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 25.4403ms
2025-07-02 22:45:54.734 +05:30 [WRN] ⚠️ CampaignSendLog not found for MessageId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSNjQ3QjExNjMyNTNFMDM1NkY5AA==
2025-07-02 22:45:54.739 +05:30 [WRN] ⚠️ No matching CampaignSendLog for MessageId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSNjQ3QjExNjMyNTNFMDM1NkY5AA==
2025-07-02 22:46:24.317 +05:30 [INF] Request starting HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - application/json 550
2025-07-02 22:46:24.319 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:46:24.320 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-07-02 22:46:24.322 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSODgzNTlDNURBRUI5QTREMEMyAA==","status":"delivered","timestamp":"1751190570","recipient_id":"917082156227","conversation":{"id":"90b38ee00c6455dcc79733c1fd93f79a","origin":{"type":"service"}},"pricing":{"billable":true,"pricing_model":"CBP","category":"service"}}]},"field":"messages"}]}]}
2025-07-02 22:46:24.324 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-07-02 22:46:24.325 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSODgzNTlDNURBRUI5QTREMEMyAA==","status":"delivered","timestamp":"1751190570","recipient_id":"917082156227","conversation":{"id":"90b38ee00c6455dcc79733c1fd93f79a","origin":{"type":"service"}},"pricing":{"billable":true,"pricing_model":"CBP","category":"service"}}]},"field":"messages"}]}]}
2025-07-02 22:46:24.326 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType73`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:46:24.328 +05:30 [INF] 📦 Routing to Status Processor
2025-07-02 22:46:24.330 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 7.5492ms
2025-07-02 22:46:24.334 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:46:24.331 +05:30 [WRN] 🔍 Incoming timestamp raw value: {"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSODgzNTlDNURBRUI5QTREMEMyAA==","status":"delivered","timestamp":"1751190570","recipient_id":"917082156227","conversation":{"id":"90b38ee00c6455dcc79733c1fd93f79a","origin":{"type":"service"}},"pricing":{"billable":true,"pricing_model":"CBP","category":"service"}}]},"field":"messages"}]}]}
2025-07-02 22:46:24.338 +05:30 [INF] Request finished HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 21.3413ms
2025-07-02 22:46:24.346 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__messageId_0='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSODgzNTlDNURBRUI5QTREMEMyAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."MessageId" = @__messageId_0
LIMIT 1
2025-07-02 22:46:24.359 +05:30 [WRN] ⚠️ CampaignSendLog not found for MessageId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSODgzNTlDNURBRUI5QTREMEMyAA==
2025-07-02 22:46:24.360 +05:30 [WRN] ⚠️ No matching CampaignSendLog for MessageId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSODgzNTlDNURBRUI5QTREMEMyAA==
2025-07-02 22:51:23.230 +05:30 [INF] Request starting HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - application/json 550
2025-07-02 22:51:23.241 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:51:23.242 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-07-02 22:51:23.245 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSRkNDMTAyODcwMTQyNTE3NEY4AA==","status":"delivered","timestamp":"1751189155","recipient_id":"917082156227","conversation":{"id":"90b38ee00c6455dcc79733c1fd93f79a","origin":{"type":"service"}},"pricing":{"billable":true,"pricing_model":"CBP","category":"service"}}]},"field":"messages"}]}]}
2025-07-02 22:51:23.249 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-07-02 22:51:23.250 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSRkNDMTAyODcwMTQyNTE3NEY4AA==","status":"delivered","timestamp":"1751189155","recipient_id":"917082156227","conversation":{"id":"90b38ee00c6455dcc79733c1fd93f79a","origin":{"type":"service"}},"pricing":{"billable":true,"pricing_model":"CBP","category":"service"}}]},"field":"messages"}]}]}
2025-07-02 22:51:23.253 +05:30 [INF] 📦 Routing to Status Processor
2025-07-02 22:51:23.250 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType73`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:51:23.254 +05:30 [WRN] 🔍 Incoming timestamp raw value: {"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSRkNDMTAyODcwMTQyNTE3NEY4AA==","status":"delivered","timestamp":"1751189155","recipient_id":"917082156227","conversation":{"id":"90b38ee00c6455dcc79733c1fd93f79a","origin":{"type":"service"}},"pricing":{"billable":true,"pricing_model":"CBP","category":"service"}}]},"field":"messages"}]}]}
2025-07-02 22:51:23.256 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 11.7662ms
2025-07-02 22:51:23.259 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:51:23.266 +05:30 [INF] Request finished HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 36.008ms
2025-07-02 22:51:23.365 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__messageId_0='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSRkNDMTAyODcwMTQyNTE3NEY4AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."MessageId" = @__messageId_0
LIMIT 1
2025-07-02 22:51:23.369 +05:30 [WRN] ⚠️ CampaignSendLog not found for MessageId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSRkNDMTAyODcwMTQyNTE3NEY4AA==
2025-07-02 22:51:23.370 +05:30 [WRN] ⚠️ No matching CampaignSendLog for MessageId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSRkNDMTAyODcwMTQyNTE3NEY4AA==
2025-07-02 22:52:14.047 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/auth/session - null null
2025-07-02 22:52:14.061 +05:30 [INF] Executing endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 22:52:14.062 +05:30 [INF] Route matched with {action = "GetSession", controller = "Auth"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetSession() on controller xbytechat.api.AuthModule.Controllers.AuthController (xbytechat.api).
2025-07-02 22:52:14.073 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`4[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:52:14.076 +05:30 [INF] Executed action xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api) in 11.3805ms
2025-07-02 22:52:14.078 +05:30 [INF] Executed endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 22:52:14.080 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/auth/session - 200 null application/json; charset=utf-8 32.8683ms
2025-07-02 22:52:14.150 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/feature-access/me - null null
2025-07-02 22:52:14.155 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 22:52:14.158 +05:30 [INF] Route matched with {action = "GetMyFeatures", controller = "FeatureAccess"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto]]] GetMyFeatures() on controller xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController (xbytechat.api).
2025-07-02 22:52:14.168 +05:30 [INF] Executed DbCommand (5ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT b."Id", b."Address", b."ApprovedAt", b."ApprovedBy", b."BusinessEmail", b."BusinessName", b."CompanyName", b."CompanyPhone", b."CreatedAt", b."CreatedBy", b."CreatedByPartnerId", b."DeletedAt", b."DeletedBy", b."Industry", b."IsApproved", b."IsDeleted", b."LastLoginAt", b."LogoUrl", b."Notes", b."Phone", b."RepresentativeName", b."Source", b."Status", b."Tags", b."Website", b0."Id", b0."BusinessId", b0."CreatedAt", b0."Plan", b0."QuotaResetDate", b0."RemainingMessages", b0."TotalMonthlyQuota", b0."UpdatedAt", b0."WalletBalance"
FROM "Businesses" AS b
LEFT JOIN "BusinessPlanInfos" AS b0 ON b."Id" = b0."BusinessId"
WHERE b."Id" = @__businessId_0
LIMIT 1
2025-07-02 22:52:14.178 +05:30 [INF] 📦 Resolved plan for Business "c13be597-6ae2-42bb-9d43-925815f24ff8": Smart
2025-07-02 22:52:14.182 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."BusinessId", f."CreatedAt", f."Description", f."FeatureName", f."Group", f."IsEnabled", f."Notes", f."Plan"
FROM "FeatureAccess" AS f
WHERE f."BusinessId" = @__businessId_0
2025-07-02 22:52:14.186 +05:30 [INF] 🔧 Feature override: AddProduct = False
2025-07-02 22:52:14.187 +05:30 [INF] 🔧 Feature override: Automation = True
2025-07-02 22:52:14.190 +05:30 [INF] 🔧 Feature override: Campaigns = True
2025-07-02 22:52:14.191 +05:30 [INF] 🔧 Feature override: Catalog = True
2025-07-02 22:52:14.192 +05:30 [INF] 🔧 Feature override: CRM = True
2025-07-02 22:52:14.193 +05:30 [INF] 🔧 Feature override: CRMInsights = True
2025-07-02 22:52:14.194 +05:30 [INF] 🔧 Feature override: CTAFlow = True
2025-07-02 22:52:14.195 +05:30 [INF] 🔧 Feature override: FlowInsights = True
2025-07-02 22:52:14.196 +05:30 [INF] 🔧 Feature override: Messaging = True
2025-07-02 22:52:14.197 +05:30 [INF] 🔧 Feature override: ProfileCompletion = True
2025-07-02 22:52:14.197 +05:30 [INF] 🔧 Feature override: UpgradePlan = True
2025-07-02 22:52:14.198 +05:30 [INF] 🔧 Feature override: WhatsAppSettings = True
2025-07-02 22:52:14.200 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 22:52:14.202 +05:30 [INF] Executed action xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api) in 41.6374ms
2025-07-02 22:52:14.205 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 22:52:14.206 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/feature-access/me - 200 null application/json; charset=utf-8 56.8063ms
2025-07-02 22:52:14.260 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/WhatsAppTemplateFetcher/get-template-all - null null
2025-07-02 22:52:14.265 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:52:14.267 +05:30 [INF] Executing endpoint 'xbytechat_api.WhatsAppSettings.Controllers.WhatsAppTemplateFetcherController.GetAllTemplatesAsync (xbytechat.api)'
2025-07-02 22:52:14.269 +05:30 [INF] Route matched with {action = "GetAllTemplates", controller = "WhatsAppTemplateFetcher"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllTemplatesAsync() on controller xbytechat_api.WhatsAppSettings.Controllers.WhatsAppTemplateFetcherController (xbytechat.api).
2025-07-02 22:52:14.275 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiToken", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."IsActive"
2025-07-02 22:52:14.284 +05:30 [INF] Start processing HTTP request GET https://graph.facebook.com/v22.0/999432368375320/message_templates
2025-07-02 22:52:14.286 +05:30 [INF] Sending HTTP request GET https://graph.facebook.com/v22.0/999432368375320/message_templates
2025-07-02 22:52:15.561 +05:30 [INF] Received HTTP response headers after 1273.8463ms - 200
2025-07-02 22:52:15.563 +05:30 [INF] End processing HTTP request after 1279.5864ms - 200
2025-07-02 22:52:15.574 +05:30 [INF] 📦 Meta Template API Raw JSON for "c13be597-6ae2-42bb-9d43-925815f24ff8":
{"data":[{"name":"imagecampaign","parameter_format":"POSITIONAL","components":[{"type":"HEADER","format":"IMAGE","example":{"header_handle":["https:\/\/scontent.whatsapp.net\/v\/t61.29466-34\/505192710_1239512614060917_4344497973514528434_n.png?ccb=1-7&_nc_sid=8b1bef&_nc_ohc=UW_i0L8_Rd4Q7kNvwHfGoSj&_nc_oc=AdmsRdP_Vob8A9D75ZGaRPUrrXzVTzYEMjdeP-rk5G6BjPbbOxWkpRoCnYU73XvswpIhs1_0RASHvYocrmz-liXh&_nc_zt=3&_nc_ht=scontent.whatsapp.net&edm=AH51TzQEAAAA&_nc_gid=s5zcaDAcg0BOs14ccYz6uQ&oh=01_Q5Aa1wHhZicXp1RzcFoUrUZxfDZ7IXkJ21tPo0RGoj9Q-XHOWw&oe=688CC2E3"]}},{"type":"BODY","text":"Hello,\nWe\u2019re excited to announce that we\u2019re launching some amazing new products at [Your Company Name]! \ud83d\ude80\n\nBe the first to check them out and grab special launch offers!\nIf you\u2019re interested, reply to this message or click here:"},{"type":"BUTTONS","buttons":[{"type":"URL","text":"Visit website","url":"https:\/\/www.myntra.com\/men-sweatshirts"},{"type":"PHONE_NUMBER","text":"Call Us","phone_number":"+918765436785"}]}],"language":"en_US","status":"APPROVED","category":"MARKETING","sub_category":"CUSTOM","id":"1239512610727584"},{"name":"flow_step_2","parameter_format":"POSITIONAL","components":[{"type":"HEADER","format":"TEXT","text":"Step -2"},{"type":"BODY","text":"Here's our latest deal. Want to see more options?"},{"type":"BUTTONS","buttons":[{"type":"QUICK_REPLY","text":"More Options"},{"type":"PHONE_NUMBER","text":"Talk to Support","phone_number":"+917082156227"}]}],"language":"en_US","status":"APPROVED","category":"MARKETING","id":"721245346987995"},{"name":"flow_step_1","parameter_format":"POSITIONAL","components":[{"type":"BODY","text":"Hi \ud83d\udc4b, would you like to explore our special offer?"},{"type":"BUTTONS","buttons":[{"type":"QUICK_REPLY","text":"Yes, show me"},{"type":"QUICK_REPLY","text":"No, thanks"}]}],"language":"en_US","status":"APPROVED","category":"MARKETING","sub_category":"CUSTOM","id":"720586043866779"},{"name":"flow_step_4","parameter_format":"POSITIONAL","components":[{"type":"HEADER","format":"TEXT","text":"Step -4"},{"type":"BODY","text":"Would you like pricing details for your selected product?"},{"type":"BUTTONS","buttons":[{"type":"QUICK_REPLY","text":"Send Pricing"},{"type":"QUICK_REPLY","text":"Back to Products"}]}],"language":"en_US","status":"APPROVED","category":"MARKETING","sub_category":"CUSTOM","id":"710642074690811"},{"name":"hello_world","parameter_format":"POSITIONAL","components":[{"type":"HEADER","format":"TEXT","text":"Hello World"},{"type":"BODY","text":"Welcome and congratulations!! This message demonstrates your ability to send a WhatsApp message notification from the Cloud API, hosted by Meta. Thank you for taking the time to test with us."},{"type":"FOOTER","text":"WhatsApp Business Platform sample message"}],"language":"en_US","status":"APPROVED","category":"UTILITY","id":"1726067301662421"},{"name":"flow_step_6","parameter_format":"POSITIONAL","components":[{"type":"HEADER","format":"TEXT","text":"Step -6"},{"type":"BODY","text":"Here's what our happy customers say. Would you like to read reviews?"},{"type":"BUTTONS","buttons":[{"type":"QUICK_REPLY","text":"Show Reviews"},{"type":"QUICK_REPLY","text":"Skip"}]}],"language":"en_US","status":"APPROVED","category":"MARKETING","sub_category":"CUSTOM","id":"1919507328796848"},{"name":"flow_step_5","parameter_format":"POSITIONAL","components":[{"type":"HEADER","format":"TEXT","text":"Step =5"},{"type":"BODY","text":"Limited time discount available. Want to grab it now?"},{"type":"BUTTONS","buttons":[{"type":"QUICK_REPLY","text":"Claim Discount"},{"type":"QUICK_REPLY","text":"Not Now"}]}],"language":"en_US","status":"APPROVED","category":"MARKETING","sub_category":"CUSTOM","id":"1780686429496003"},{"name":"flow_step_3","parameter_format":"POSITIONAL","components":[{"type":"HEADER","format":"TEXT","text":"Step -3"},{"type":"BODY","text":"We have 3 amazing products for you. Want to check them out?"},{"type":"BUTTONS","buttons":[{"type":"QUICK_REPLY","text":"Show Products"},{"type":"QUICK_REPLY","text":"Skip"}]}],"language":"en_US","status":"APPROVED","category":"MARKETING","sub_category":"CUSTOM","id":"2154240945038413"},{"name":"flow_step_7","parameter_format":"POSITIONAL","components":[{"type":"HEADER","format":"TEXT","text":"Step -7"},{"type":"BODY","text":"Would you like to talk to our support team for custom guidance?"},{"type":"BUTTONS","buttons":[{"type":"QUICK_REPLY","text":"Talk to Agent"},{"type":"QUICK_REPLY","text":"Later"}]}],"language":"en_US","status":"APPROVED","category":"MARKETING","sub_category":"CUSTOM","id":"1390795521994729"},{"name":"back_to_restart","parameter_format":"POSITIONAL","components":[{"type":"HEADER","format":"TEXT","text":"Chat Restarted"},{"type":"BODY","text":"Your Process has restarted."},{"type":"BUTTONS","buttons":[{"type":"QUICK_REPLY","text":"Yes, show me"},{"type":"QUICK_REPLY","text":"No, thanks"}]}],"language":"en_US","status":"APPROVED","category":"MARKETING","sub_category":"CUSTOM","id":"2174325859705396"},{"name":"flow_step_10_","parameter_format":"POSITIONAL","components":[{"type":"HEADER","format":"TEXT","text":"Step -10"},{"type":"BODY","text":"Thanks for your interest! Would you like to give feedback?"},{"type":"BUTTONS","buttons":[{"type":"QUICK_REPLY","text":"Give Feedback"},{"type":"QUICK_REPLY","text":"End Chat"}]}],"language":"en_US","status":"APPROVED","category":"MARKETING","sub_category":"CUSTOM","id":"700742109026088"},{"name":"flow_step_9","parameter_format":"POSITIONAL","components":[{"type":"HEADER","format":"TEXT","text":"Step -9"},{"type":"BODY","text":"This is your final offer summary. Ready to proceed?"},{"type":"BUTTONS","buttons":[{"type":"QUICK_REPLY","text":"Proceed"},{"type":"QUICK_REPLY","text":"Restart"}]}],"language":"en_US","status":"APPROVED","category":"MARKETING","sub_category":"CUSTOM","id":"703808575467306"},{"name":"flow_step_8","parameter_format":"POSITIONAL","components":[{"type":"HEADER","format":"TEXT","text":"Step -8"},{"type":"BODY","text":"We can compare 2 products for you. Shall we continue?"},{"type":"BUTTONS","buttons":[{"type":"QUICK_REPLY","text":"Compare Now"},{"type":"QUICK_REPLY","text":"No, thanks"}]}],"language":"en","status":"APPROVED","category":"MARKETING","sub_category":"CUSTOM","id":"1399963891041518"}],"paging":{"cursors":{"before":"MAZDZD","after":"MjQZD"}}}
2025-07-02 22:52:15.578 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType64`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[TemplateForUIResponseDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:52:15.579 +05:30 [INF] Executed action xbytechat_api.WhatsAppSettings.Controllers.WhatsAppTemplateFetcherController.GetAllTemplatesAsync (xbytechat.api) in 1307.5658ms
2025-07-02 22:52:15.581 +05:30 [INF] Executed endpoint 'xbytechat_api.WhatsAppSettings.Controllers.WhatsAppTemplateFetcherController.GetAllTemplatesAsync (xbytechat.api)'
2025-07-02 22:52:15.583 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/WhatsAppTemplateFetcher/get-template-all - 200 null application/json; charset=utf-8 1322.6941ms
2025-07-02 22:52:17.309 +05:30 [INF] Request starting HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - application/json 326
2025-07-02 22:52:17.313 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:52:17.314 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-07-02 22:52:17.317 +05:30 [WRN] 📥 Webhook received at controller:
{"entry": [{"id": "999432368375320", "time": 1751476940, "changes": [{"value": {"event": "APPROVED", "message_template_id": 1239512610727584, "message_template_name": "imagecampaign", "message_template_language": "en_US", "reason": "NONE"}, "field": "message_template_status_update"}]}], "object": "whatsapp_business_account"}
2025-07-02 22:52:17.319 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-07-02 22:52:17.319 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"entry": [{"id": "999432368375320", "time": 1751476940, "changes": [{"value": {"event": "APPROVED", "message_template_id": 1239512610727584, "message_template_name": "imagecampaign", "message_template_language": "en_US", "reason": "NONE"}, "field": "message_template_status_update"}]}], "object": "whatsapp_business_account"}
2025-07-02 22:52:17.320 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType73`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:52:17.321 +05:30 [WRN] ⚠️ No matching event processor found.
2025-07-02 22:52:17.323 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 6.7958ms
2025-07-02 22:52:17.328 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:52:17.330 +05:30 [INF] Request finished HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 20.9083ms
2025-07-02 22:53:39.025 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/api/campaign/create-text-campaign - null null
2025-07-02 22:53:39.035 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:53:39.036 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/api/campaign/create-text-campaign - 204 null null 12.6199ms
2025-07-02 22:53:39.040 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/api/campaign/create-text-campaign - application/json 439
2025-07-02 22:53:39.049 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:53:39.051 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.CreateTextCampaign (xbytechat.api)'
2025-07-02 22:53:39.060 +05:30 [INF] Route matched with {action = "CreateTextCampaign", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateTextCampaign(xbytechat.api.Features.CampaignModule.DTOs.CampaignCreateDto) on controller xbytechat.api.Features.CampaignModule.Controllers.CampaignController (xbytechat.api).
2025-07-02 22:53:40.856 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiToken", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."IsActive" AND w."BusinessId" = @__businessId_0
LIMIT 1
2025-07-02 22:53:40.862 +05:30 [INF] Start processing HTTP request GET https://graph.facebook.com/v22.0/999432368375320/message_templates
2025-07-02 22:53:40.865 +05:30 [INF] Sending HTTP request GET https://graph.facebook.com/v22.0/999432368375320/message_templates
2025-07-02 22:53:42.090 +05:30 [INF] Received HTTP response headers after 1223.0929ms - 200
2025-07-02 22:53:42.092 +05:30 [INF] End processing HTTP request after 1229.6462ms - 200
2025-07-02 22:53:42.150 +05:30 [INF] Executed DbCommand (6ms) [Parameters=[@p0='ba36287b-8233-4a42-af9d-60274555b00f', @p1='c13be597-6ae2-42bb-9d43-925815f24ff8', @p2=NULL (DbType = Guid), @p3='image', @p4='2025-07-02T17:23:42.0976009Z' (DbType = DateTime), @p5='system', @p6=NULL (DbType = Guid), @p7=NULL (DbType = DateTime), @p8=NULL, @p9=NULL, @p10=NULL, @p11='https://picsum.photos/200/300', @p12='False', @p13='Hello,
We’re excited to announce that we’re launching some amazing new products at [Your Company Name]! 🚀

Be the first to check them out and grab special launch offers!
If you’re interested, reply to this message or click here:', @p14='imagecampaign' (Nullable = false), @p15='ImageCampaign' (Nullable = false), @p16=NULL (DbType = DateTime), @p17=NULL (DbType = Guid), @p18='Draft' (Nullable = false), @p19='imagecampaign', @p20='[]', @p21='2025-07-02T17:23:42.0976997Z' (DbType = DateTime), @p22='b8d6c0ab-3280-4716-9d3d-b53f40dd3984', @p23='ba36287b-8233-4a42-af9d-60274555b00f', @p24='True', @p25='1', @p26='Visit website' (Nullable = false), @p27='URL' (Nullable = false), @p28='https://www.myntra.com/men-sweatshirts' (Nullable = false), @p29='ddaecc7b-b758-48b1-8129-01f8cbfc3c09', @p30='ba36287b-8233-4a42-af9d-60274555b00f', @p31='True', @p32='2', @p33='Call Us' (Nullable = false), @p34='PHONE_NUMBER' (Nullable = false), @p35='+918765436785' (Nullable = false)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Campaigns" ("Id", "BusinessId", "CampaignId", "CampaignType", "CreatedAt", "CreatedBy", "CtaId", "DeletedAt", "DeletedBy", "FollowUpTemplateId", "ImageCaption", "ImageUrl", "IsDeleted", "MessageBody", "MessageTemplate", "Name", "ScheduledAt", "SourceCampaignId", "Status", "TemplateId", "TemplateParameters", "UpdatedAt")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21);
INSERT INTO "CampaignButtons" ("Id", "CampaignId", "IsFromTemplate", "Position", "Title", "Type", "Value")
VALUES (@p22, @p23, @p24, @p25, @p26, @p27, @p28);
INSERT INTO "CampaignButtons" ("Id", "CampaignId", "IsFromTemplate", "Position", "Title", "Type", "Value")
VALUES (@p29, @p30, @p31, @p32, @p33, @p34, @p35);
2025-07-02 22:53:42.157 +05:30 [INF] ✅ Campaign 'ImageCampaign' created with 0 recipients, 0 user buttons, 2 template buttons and 0 template parameters
2025-07-02 22:53:42.160 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType20`3[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:53:42.164 +05:30 [INF] Executed action xbytechat.api.Features.CampaignModule.Controllers.CampaignController.CreateTextCampaign (xbytechat.api) in 3101.253ms
2025-07-02 22:53:42.166 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.CreateTextCampaign (xbytechat.api)'
2025-07-02 22:53:42.168 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/api/campaign/create-text-campaign - 200 null application/json; charset=utf-8 3128.6434ms
2025-07-02 22:53:42.241 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/tags - null null
2025-07-02 22:53:42.242 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/campaign/ba36287b-8233-4a42-af9d-60274555b00f - null null
2025-07-02 22:53:42.248 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/contacts?tab=all&page=1&pageSize=1000 - null null
2025-07-02 22:53:42.252 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:53:42.256 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:53:42.260 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:53:42.262 +05:30 [INF] Executing endpoint 'xbytechat.api.CRM.Controllers.TagsController.GetAllTags (xbytechat.api)'
2025-07-02 22:53:42.263 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetCampaignById (xbytechat.api)'
2025-07-02 22:53:42.264 +05:30 [INF] Executing endpoint 'xbytechat.api.CRM.Controllers.ContactsController.GetAllContacts (xbytechat.api)'
2025-07-02 22:53:42.269 +05:30 [INF] Route matched with {action = "GetAllContacts", controller = "Contacts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllContacts(System.String, Int32, Int32) on controller xbytechat.api.CRM.Controllers.ContactsController (xbytechat.api).
2025-07-02 22:53:42.270 +05:30 [INF] Route matched with {action = "GetAllTags", controller = "Tags"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllTags() on controller xbytechat.api.CRM.Controllers.TagsController (xbytechat.api).
2025-07-02 22:53:42.272 +05:30 [INF] Route matched with {action = "GetCampaignById", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[xbytechat.api.Features.CampaignModule.DTOs.CampaignDto]] GetCampaignById(System.Guid) on controller xbytechat.api.Features.CampaignModule.Controllers.CampaignController (xbytechat.api).
2025-07-02 22:53:42.273 +05:30 [INF] GetPagedContactsAsync: businessId="c13be597-6ae2-42bb-9d43-925815f24ff8", tab=all, page=1, pageSize=1000
2025-07-02 22:53:42.292 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Contacts" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."IsActive"
2025-07-02 22:53:42.302 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__p_2='100', @__p_1='0'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."AssignedAgentId", t."BusinessId", t."CreatedAt", t."Email", t."Group", t."IsActive", t."IsArchived", t."IsAutomationPaused", t."IsFavorite", t."LastCTAInteraction", t."LastCTAType", t."LastClickedProductId", t."LastContactedAt", t."LeadSource", t."Name", t."NextFollowUpAt", t."Notes", t."PhoneNumber", t."Tags", t0."Id", t0."AssignedAt", t0."AssignedBy", t0."BusinessId", t0."ContactId", t0."TagId", t0."Id0", t0."BusinessId0", t0."Category", t0."ColorHex", t0."CreatedAt", t0."IsActive", t0."IsSystemTag", t0."LastUsedAt", t0."Name", t0."Notes"
FROM (
    SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."Tags"
    FROM "Contacts" AS c
    WHERE c."BusinessId" = @__businessId_0 AND c."IsActive"
    ORDER BY c."Name"
    LIMIT @__p_2 OFFSET @__p_1
) AS t
LEFT JOIN (
    SELECT c0."Id", c0."AssignedAt", c0."AssignedBy", c0."BusinessId", c0."ContactId", c0."TagId", t1."Id" AS "Id0", t1."BusinessId" AS "BusinessId0", t1."Category", t1."ColorHex", t1."CreatedAt", t1."IsActive", t1."IsSystemTag", t1."LastUsedAt", t1."Name", t1."Notes"
    FROM "ContactTags" AS c0
    INNER JOIN "Tags" AS t1 ON c0."TagId" = t1."Id"
) AS t0 ON t."Id" = t0."ContactId"
ORDER BY t."Name", t."Id", t0."Id"
2025-07-02 22:53:42.307 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Helpers.ResponseResult'.
2025-07-02 22:53:42.311 +05:30 [INF] Executed action xbytechat.api.CRM.Controllers.ContactsController.GetAllContacts (xbytechat.api) in 38.9584ms
2025-07-02 22:53:42.315 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."Name", t."ColorHex", t."Category", t."Notes", t."IsSystemTag", t."IsActive", t."CreatedAt", t."LastUsedAt"
FROM "Tags" AS t
WHERE t."BusinessId" = @__businessId_0 AND t."IsActive"
ORDER BY t."CreatedAt" DESC
2025-07-02 22:53:42.315 +05:30 [INF] Executed endpoint 'xbytechat.api.CRM.Controllers.ContactsController.GetAllContacts (xbytechat.api)'
2025-07-02 22:53:42.323 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Helpers.ResponseResult'.
2025-07-02 22:53:42.323 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/contacts?tab=all&page=1&pageSize=1000 - 200 null application/json; charset=utf-8 74.7631ms
2025-07-02 22:53:42.331 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[@__campaignId_0='ba36287b-8233-4a42-af9d-60274555b00f', @__businessId_1='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."BusinessId", t."CampaignId", t."CampaignType", t."CreatedAt", t."CreatedBy", t."CtaId", t."DeletedAt", t."DeletedBy", t."FollowUpTemplateId", t."ImageCaption", t."ImageUrl", t."IsDeleted", t."MessageBody", t."MessageTemplate", t."Name", t."ScheduledAt", t."SourceCampaignId", t."Status", t."TemplateId", t."TemplateParameters", t."UpdatedAt", t."Id0", t."BusinessId0", t."ButtonText", t."ButtonType", t."CreatedAt0", t."Description", t."IsActive", t."TargetUrl", t."Title", t."UpdatedAt0", c1."Id", c1."CampaignId", c1."IsFromTemplate", c1."Position", c1."Title", c1."Type", c1."Value"
FROM (
    SELECT c."Id", c."BusinessId", c."CampaignId", c."CampaignType", c."CreatedAt", c."CreatedBy", c."CtaId", c."DeletedAt", c."DeletedBy", c."FollowUpTemplateId", c."ImageCaption", c."ImageUrl", c."IsDeleted", c."MessageBody", c."MessageTemplate", c."Name", c."ScheduledAt", c."SourceCampaignId", c."Status", c."TemplateId", c."TemplateParameters", c."UpdatedAt", c0."Id" AS "Id0", c0."BusinessId" AS "BusinessId0", c0."ButtonText", c0."ButtonType", c0."CreatedAt" AS "CreatedAt0", c0."Description", c0."IsActive", c0."TargetUrl", c0."Title", c0."UpdatedAt" AS "UpdatedAt0"
    FROM "Campaigns" AS c
    LEFT JOIN "CTADefinitions" AS c0 ON c."CtaId" = c0."Id"
    WHERE c."Id" = @__campaignId_0 AND c."BusinessId" = @__businessId_1
    LIMIT 1
) AS t
LEFT JOIN "CampaignButtons" AS c1 ON t."Id" = c1."CampaignId"
ORDER BY t."Id", t."Id0"
2025-07-02 22:53:42.337 +05:30 [INF] Executed action xbytechat.api.CRM.Controllers.TagsController.GetAllTags (xbytechat.api) in 62.2212ms
2025-07-02 22:53:42.338 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/tags - null null
2025-07-02 22:53:42.340 +05:30 [INF] Executed endpoint 'xbytechat.api.CRM.Controllers.TagsController.GetAllTags (xbytechat.api)'
2025-07-02 22:53:42.344 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:53:42.346 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/tags - 200 null application/json; charset=utf-8 104.86ms
2025-07-02 22:53:42.347 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Features.CampaignModule.DTOs.CampaignDto'.
2025-07-02 22:53:42.347 +05:30 [INF] Executing endpoint 'xbytechat.api.CRM.Controllers.TagsController.GetAllTags (xbytechat.api)'
2025-07-02 22:53:42.355 +05:30 [INF] Route matched with {action = "GetAllTags", controller = "Tags"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllTags() on controller xbytechat.api.CRM.Controllers.TagsController (xbytechat.api).
2025-07-02 22:53:42.361 +05:30 [INF] Executed action xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetCampaignById (xbytechat.api) in 83.5155ms
2025-07-02 22:53:42.361 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."Name", t."ColorHex", t."Category", t."Notes", t."IsSystemTag", t."IsActive", t."CreatedAt", t."LastUsedAt"
FROM "Tags" AS t
WHERE t."BusinessId" = @__businessId_0 AND t."IsActive"
ORDER BY t."CreatedAt" DESC
2025-07-02 22:53:42.365 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetCampaignById (xbytechat.api)'
2025-07-02 22:53:42.368 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Helpers.ResponseResult'.
2025-07-02 22:53:42.369 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/campaign/ba36287b-8233-4a42-af9d-60274555b00f - 200 null application/json; charset=utf-8 127.7073ms
2025-07-02 22:53:42.371 +05:30 [INF] Executed action xbytechat.api.CRM.Controllers.TagsController.GetAllTags (xbytechat.api) in 14.2499ms
2025-07-02 22:53:42.378 +05:30 [INF] Executed endpoint 'xbytechat.api.CRM.Controllers.TagsController.GetAllTags (xbytechat.api)'
2025-07-02 22:53:42.379 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/tags - 200 null application/json; charset=utf-8 41.4591ms
2025-07-02 22:53:57.106 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/api/campaign/ba36287b-8233-4a42-af9d-60274555b00f/assign-contacts - null null
2025-07-02 22:53:57.110 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:53:57.111 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/api/campaign/ba36287b-8233-4a42-af9d-60274555b00f/assign-contacts - 204 null null 5.7187ms
2025-07-02 22:53:57.113 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/api/campaign/ba36287b-8233-4a42-af9d-60274555b00f/assign-contacts - application/json 94
2025-07-02 22:53:57.119 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:53:57.121 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.AssignContactsToCampaign (xbytechat.api)'
2025-07-02 22:53:57.128 +05:30 [INF] Route matched with {action = "AssignContactsToCampaign", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AssignContactsToCampaign(System.Guid, xbytechat.api.Features.CampaignModule.DTOs.AssignContactsDto) on controller xbytechat.api.Features.CampaignModule.Controllers.CampaignController (xbytechat.api).
2025-07-02 22:53:59.494 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__campaignId_0='ba36287b-8233-4a42-af9d-60274555b00f', @__businessId_1='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."BusinessId", t."CampaignId", t."CampaignType", t."CreatedAt", t."CreatedBy", t."CtaId", t."DeletedAt", t."DeletedBy", t."FollowUpTemplateId", t."ImageCaption", t."ImageUrl", t."IsDeleted", t."MessageBody", t."MessageTemplate", t."Name", t."ScheduledAt", t."SourceCampaignId", t."Status", t."TemplateId", t."TemplateParameters", t."UpdatedAt", c0."Id", c0."BotId", c0."BusinessId", c0."CampaignId", c0."CategoryBrowsed", c0."ClickedCTA", c0."ContactId", c0."IsAutoTagged", c0."MessagePreview", c0."ProductBrowsed", c0."SentAt", c0."Status", c0."UpdatedAt"
FROM (
    SELECT c."Id", c."BusinessId", c."CampaignId", c."CampaignType", c."CreatedAt", c."CreatedBy", c."CtaId", c."DeletedAt", c."DeletedBy", c."FollowUpTemplateId", c."ImageCaption", c."ImageUrl", c."IsDeleted", c."MessageBody", c."MessageTemplate", c."Name", c."ScheduledAt", c."SourceCampaignId", c."Status", c."TemplateId", c."TemplateParameters", c."UpdatedAt"
    FROM "Campaigns" AS c
    WHERE c."Id" = @__campaignId_0 AND c."BusinessId" = @__businessId_1
    LIMIT 1
) AS t
LEFT JOIN "CampaignRecipients" AS c0 ON t."Id" = c0."CampaignId"
ORDER BY t."Id"
2025-07-02 22:53:59.549 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@p0='bced2bea-8114-4359-a954-861d42addbcb', @p1=NULL, @p2='c13be597-6ae2-42bb-9d43-925815f24ff8', @p3='ba36287b-8233-4a42-af9d-60274555b00f', @p4=NULL, @p5=NULL, @p6='80c43c6a-508b-47ff-9360-201bfd5521d3', @p7='False', @p8=NULL, @p9=NULL, @p10='2025-07-02T17:23:59.5404881Z' (Nullable = true) (DbType = DateTime), @p11='Pending' (Nullable = false), @p12='2025-07-02T17:23:59.5404885Z' (DbType = DateTime), @p13='f14e7bd6-b9d7-40bf-93c6-a03d1970e74b', @p14=NULL, @p15='c13be597-6ae2-42bb-9d43-925815f24ff8', @p16='ba36287b-8233-4a42-af9d-60274555b00f', @p17=NULL, @p18=NULL, @p19='8aac7c57-6699-4511-897b-4121b407eb1c', @p20='False', @p21=NULL, @p22=NULL, @p23='2025-07-02T17:23:59.5046855Z' (Nullable = true) (DbType = DateTime), @p24='Pending' (Nullable = false), @p25='2025-07-02T17:23:59.5047863Z' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "CampaignRecipients" ("Id", "BotId", "BusinessId", "CampaignId", "CategoryBrowsed", "ClickedCTA", "ContactId", "IsAutoTagged", "MessagePreview", "ProductBrowsed", "SentAt", "Status", "UpdatedAt")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12);
INSERT INTO "CampaignRecipients" ("Id", "BotId", "BusinessId", "CampaignId", "CategoryBrowsed", "ClickedCTA", "ContactId", "IsAutoTagged", "MessagePreview", "ProductBrowsed", "SentAt", "Status", "UpdatedAt")
VALUES (@p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22, @p23, @p24, @p25);
2025-07-02 22:53:59.555 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType16`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:53:59.557 +05:30 [INF] Executed action xbytechat.api.Features.CampaignModule.Controllers.CampaignController.AssignContactsToCampaign (xbytechat.api) in 2426.6126ms
2025-07-02 22:53:59.559 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.AssignContactsToCampaign (xbytechat.api)'
2025-07-02 22:53:59.561 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/api/campaign/ba36287b-8233-4a42-af9d-60274555b00f/assign-contacts - 200 null application/json; charset=utf-8 2447.2599ms
2025-07-02 22:54:04.526 +05:30 [INF] Request starting HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - application/json 581
2025-07-02 22:54:04.530 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:54:04.531 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-07-02 22:54:04.535 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMDEzRkFGOTcxMjgyNDZFOENFAA==","status":"sent","timestamp":"1751202765","recipient_id":"917082156227","conversation":{"id":"b5bdfe9338c8b7c6740d9b579e228738","expiration_timestamp":"1751289180","origin":{"type":"utility"}},"pricing":{"billable":true,"pricing_model":"CBP","category":"utility"}}]},"field":"messages"}]}]}
2025-07-02 22:54:04.538 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-07-02 22:54:04.538 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMDEzRkFGOTcxMjgyNDZFOENFAA==","status":"sent","timestamp":"1751202765","recipient_id":"917082156227","conversation":{"id":"b5bdfe9338c8b7c6740d9b579e228738","expiration_timestamp":"1751289180","origin":{"type":"utility"}},"pricing":{"billable":true,"pricing_model":"CBP","category":"utility"}}]},"field":"messages"}]}]}
2025-07-02 22:54:04.539 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType73`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:54:04.541 +05:30 [INF] 📦 Routing to Status Processor
2025-07-02 22:54:04.542 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 8.0255ms
2025-07-02 22:54:04.544 +05:30 [WRN] 🔍 Incoming timestamp raw value: {"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMDEzRkFGOTcxMjgyNDZFOENFAA==","status":"sent","timestamp":"1751202765","recipient_id":"917082156227","conversation":{"id":"b5bdfe9338c8b7c6740d9b579e228738","expiration_timestamp":"1751289180","origin":{"type":"utility"}},"pricing":{"billable":true,"pricing_model":"CBP","category":"utility"}}]},"field":"messages"}]}]}
2025-07-02 22:54:04.546 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:54:04.553 +05:30 [INF] Request finished HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 26.4415ms
2025-07-02 22:54:04.556 +05:30 [INF] Executed DbCommand (5ms) [Parameters=[@__messageId_0='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMDEzRkFGOTcxMjgyNDZFOENFAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."MessageId" = @__messageId_0
LIMIT 1
2025-07-02 22:54:04.565 +05:30 [WRN] ⚠️ CampaignSendLog not found for MessageId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMDEzRkFGOTcxMjgyNDZFOENFAA==
2025-07-02 22:54:04.567 +05:30 [WRN] ⚠️ No matching CampaignSendLog for MessageId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMDEzRkFGOTcxMjgyNDZFOENFAA==
2025-07-02 22:54:15.396 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/Campaign/paginated?page=1&pageSize=10&status= - null null
2025-07-02 22:54:15.404 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:54:15.405 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetPaginatedCampaigns (xbytechat.api)'
2025-07-02 22:54:15.419 +05:30 [INF] Route matched with {action = "GetPaginatedCampaigns", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPaginatedCampaigns(xbytechat.api.Shared.PaginatedRequest) on controller xbytechat.api.Features.CampaignModule.Controllers.CampaignController (xbytechat.api).
2025-07-02 22:54:15.442 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Campaigns" AS c
WHERE c."BusinessId" = @__businessId_0
2025-07-02 22:54:15.455 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__p_2='10', @__p_1='0'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Name", c."Status", c."ScheduledAt", c."CreatedAt"
FROM "Campaigns" AS c
WHERE c."BusinessId" = @__businessId_0
ORDER BY c."CreatedAt" DESC
LIMIT @__p_2 OFFSET @__p_1
2025-07-02 22:54:15.461 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Shared.PaginatedResponse`1[[xbytechat.api.Features.CampaignModule.DTOs.CampaignSummaryDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 22:54:15.467 +05:30 [INF] Executed action xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetPaginatedCampaigns (xbytechat.api) in 44.9629ms
2025-07-02 22:54:15.470 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetPaginatedCampaigns (xbytechat.api)'
2025-07-02 22:54:15.471 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/Campaign/paginated?page=1&pageSize=10&status= - 200 null application/json; charset=utf-8 75.3852ms
2025-07-02 22:54:23.264 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/tags - null null
2025-07-02 22:54:23.268 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/campaign/ba36287b-8233-4a42-af9d-60274555b00f - null null
2025-07-02 22:54:23.269 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:54:23.273 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/contacts?tab=all&page=1&pageSize=1000 - null null
2025-07-02 22:54:23.273 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:54:23.274 +05:30 [INF] Executing endpoint 'xbytechat.api.CRM.Controllers.TagsController.GetAllTags (xbytechat.api)'
2025-07-02 22:54:23.277 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:54:23.279 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetCampaignById (xbytechat.api)'
2025-07-02 22:54:23.280 +05:30 [INF] Route matched with {action = "GetAllTags", controller = "Tags"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllTags() on controller xbytechat.api.CRM.Controllers.TagsController (xbytechat.api).
2025-07-02 22:54:23.281 +05:30 [INF] Executing endpoint 'xbytechat.api.CRM.Controllers.ContactsController.GetAllContacts (xbytechat.api)'
2025-07-02 22:54:23.283 +05:30 [INF] Route matched with {action = "GetCampaignById", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[xbytechat.api.Features.CampaignModule.DTOs.CampaignDto]] GetCampaignById(System.Guid) on controller xbytechat.api.Features.CampaignModule.Controllers.CampaignController (xbytechat.api).
2025-07-02 22:54:23.289 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."Name", t."ColorHex", t."Category", t."Notes", t."IsSystemTag", t."IsActive", t."CreatedAt", t."LastUsedAt"
FROM "Tags" AS t
WHERE t."BusinessId" = @__businessId_0 AND t."IsActive"
ORDER BY t."CreatedAt" DESC
2025-07-02 22:54:23.289 +05:30 [INF] Route matched with {action = "GetAllContacts", controller = "Contacts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllContacts(System.String, Int32, Int32) on controller xbytechat.api.CRM.Controllers.ContactsController (xbytechat.api).
2025-07-02 22:54:23.301 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Helpers.ResponseResult'.
2025-07-02 22:54:23.306 +05:30 [INF] GetPagedContactsAsync: businessId="c13be597-6ae2-42bb-9d43-925815f24ff8", tab=all, page=1, pageSize=1000
2025-07-02 22:54:23.307 +05:30 [INF] Executed action xbytechat.api.CRM.Controllers.TagsController.GetAllTags (xbytechat.api) in 21.7416ms
2025-07-02 22:54:23.310 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/tags - null null
2025-07-02 22:54:23.314 +05:30 [INF] Executed endpoint 'xbytechat.api.CRM.Controllers.TagsController.GetAllTags (xbytechat.api)'
2025-07-02 22:54:23.312 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Contacts" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."IsActive"
2025-07-02 22:54:23.318 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:54:23.320 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/tags - 200 null application/json; charset=utf-8 55.5611ms
2025-07-02 22:54:23.326 +05:30 [INF] Executing endpoint 'xbytechat.api.CRM.Controllers.TagsController.GetAllTags (xbytechat.api)'
2025-07-02 22:54:23.326 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__p_2='100', @__p_1='0'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."AssignedAgentId", t."BusinessId", t."CreatedAt", t."Email", t."Group", t."IsActive", t."IsArchived", t."IsAutomationPaused", t."IsFavorite", t."LastCTAInteraction", t."LastCTAType", t."LastClickedProductId", t."LastContactedAt", t."LeadSource", t."Name", t."NextFollowUpAt", t."Notes", t."PhoneNumber", t."Tags", t0."Id", t0."AssignedAt", t0."AssignedBy", t0."BusinessId", t0."ContactId", t0."TagId", t0."Id0", t0."BusinessId0", t0."Category", t0."ColorHex", t0."CreatedAt", t0."IsActive", t0."IsSystemTag", t0."LastUsedAt", t0."Name", t0."Notes"
FROM (
    SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."Tags"
    FROM "Contacts" AS c
    WHERE c."BusinessId" = @__businessId_0 AND c."IsActive"
    ORDER BY c."Name"
    LIMIT @__p_2 OFFSET @__p_1
) AS t
LEFT JOIN (
    SELECT c0."Id", c0."AssignedAt", c0."AssignedBy", c0."BusinessId", c0."ContactId", c0."TagId", t1."Id" AS "Id0", t1."BusinessId" AS "BusinessId0", t1."Category", t1."ColorHex", t1."CreatedAt", t1."IsActive", t1."IsSystemTag", t1."LastUsedAt", t1."Name", t1."Notes"
    FROM "ContactTags" AS c0
    INNER JOIN "Tags" AS t1 ON c0."TagId" = t1."Id"
) AS t0 ON t."Id" = t0."ContactId"
ORDER BY t."Name", t."Id", t0."Id"
2025-07-02 22:54:23.331 +05:30 [INF] Route matched with {action = "GetAllTags", controller = "Tags"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllTags() on controller xbytechat.api.CRM.Controllers.TagsController (xbytechat.api).
2025-07-02 22:54:23.335 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Helpers.ResponseResult'.
2025-07-02 22:54:23.340 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."Name", t."ColorHex", t."Category", t."Notes", t."IsSystemTag", t."IsActive", t."CreatedAt", t."LastUsedAt"
FROM "Tags" AS t
WHERE t."BusinessId" = @__businessId_0 AND t."IsActive"
ORDER BY t."CreatedAt" DESC
2025-07-02 22:54:23.341 +05:30 [INF] Executed action xbytechat.api.CRM.Controllers.ContactsController.GetAllContacts (xbytechat.api) in 35.6953ms
2025-07-02 22:54:23.346 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Helpers.ResponseResult'.
2025-07-02 22:54:23.347 +05:30 [INF] Executed endpoint 'xbytechat.api.CRM.Controllers.ContactsController.GetAllContacts (xbytechat.api)'
2025-07-02 22:54:23.349 +05:30 [INF] Executed action xbytechat.api.CRM.Controllers.TagsController.GetAllTags (xbytechat.api) in 12.8764ms
2025-07-02 22:54:23.351 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/contacts?tab=all&page=1&pageSize=1000 - 200 null application/json; charset=utf-8 77.7353ms
2025-07-02 22:54:23.352 +05:30 [INF] Executed endpoint 'xbytechat.api.CRM.Controllers.TagsController.GetAllTags (xbytechat.api)'
2025-07-02 22:54:23.359 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/tags - 200 null application/json; charset=utf-8 48.7307ms
2025-07-02 22:54:23.410 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[@__campaignId_0='ba36287b-8233-4a42-af9d-60274555b00f', @__businessId_1='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."BusinessId", t."CampaignId", t."CampaignType", t."CreatedAt", t."CreatedBy", t."CtaId", t."DeletedAt", t."DeletedBy", t."FollowUpTemplateId", t."ImageCaption", t."ImageUrl", t."IsDeleted", t."MessageBody", t."MessageTemplate", t."Name", t."ScheduledAt", t."SourceCampaignId", t."Status", t."TemplateId", t."TemplateParameters", t."UpdatedAt", t."Id0", t."BusinessId0", t."ButtonText", t."ButtonType", t."CreatedAt0", t."Description", t."IsActive", t."TargetUrl", t."Title", t."UpdatedAt0", c1."Id", c1."CampaignId", c1."IsFromTemplate", c1."Position", c1."Title", c1."Type", c1."Value"
FROM (
    SELECT c."Id", c."BusinessId", c."CampaignId", c."CampaignType", c."CreatedAt", c."CreatedBy", c."CtaId", c."DeletedAt", c."DeletedBy", c."FollowUpTemplateId", c."ImageCaption", c."ImageUrl", c."IsDeleted", c."MessageBody", c."MessageTemplate", c."Name", c."ScheduledAt", c."SourceCampaignId", c."Status", c."TemplateId", c."TemplateParameters", c."UpdatedAt", c0."Id" AS "Id0", c0."BusinessId" AS "BusinessId0", c0."ButtonText", c0."ButtonType", c0."CreatedAt" AS "CreatedAt0", c0."Description", c0."IsActive", c0."TargetUrl", c0."Title", c0."UpdatedAt" AS "UpdatedAt0"
    FROM "Campaigns" AS c
    LEFT JOIN "CTADefinitions" AS c0 ON c."CtaId" = c0."Id"
    WHERE c."Id" = @__campaignId_0 AND c."BusinessId" = @__businessId_1
    LIMIT 1
) AS t
LEFT JOIN "CampaignButtons" AS c1 ON t."Id" = c1."CampaignId"
ORDER BY t."Id", t."Id0"
2025-07-02 22:54:23.414 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Features.CampaignModule.DTOs.CampaignDto'.
2025-07-02 22:54:23.416 +05:30 [INF] Executed action xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetCampaignById (xbytechat.api) in 122.4261ms
2025-07-02 22:54:23.419 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetCampaignById (xbytechat.api)'
2025-07-02 22:54:23.421 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/campaign/ba36287b-8233-4a42-af9d-60274555b00f - 200 null application/json; charset=utf-8 152.2702ms
2025-07-02 22:54:35.801 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/campaign/get-image-campaign - null null
2025-07-02 22:54:35.810 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:54:35.812 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetAll (xbytechat.api)'
2025-07-02 22:54:35.818 +05:30 [INF] Route matched with {action = "GetAll", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAll(System.String) on controller xbytechat.api.Features.CampaignModule.Controllers.CampaignController (xbytechat.api).
2025-07-02 22:54:35.837 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Name", c."Status", c."ScheduledAt", c."CreatedAt", c."ImageUrl", c."ImageCaption", c0."Title" AS "CtaTitle", (
    SELECT count(*)::int
    FROM "CampaignRecipients" AS c1
    WHERE c."Id" = c1."CampaignId") AS "RecipientCount"
FROM "Campaigns" AS c
LEFT JOIN "CTADefinitions" AS c0 ON c."CtaId" = c0."Id"
WHERE c."BusinessId" = @__businessId_0
ORDER BY c."CreatedAt" DESC
2025-07-02 22:54:35.843 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.CampaignModule.DTOs.CampaignSummaryDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 22:54:35.845 +05:30 [INF] Executed action xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetAll (xbytechat.api) in 24.4348ms
2025-07-02 22:54:35.847 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetAll (xbytechat.api)'
2025-07-02 22:54:35.849 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/campaign/get-image-campaign - 200 null application/json; charset=utf-8 47.9345ms
2025-07-02 22:54:44.857 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/api/campaign/send-campaign/ba36287b-8233-4a42-af9d-60274555b00f - null 0
2025-07-02 22:54:44.862 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:54:44.863 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.SendTemplateCampaign (xbytechat.api)'
2025-07-02 22:54:44.871 +05:30 [INF] Route matched with {action = "SendTemplateCampaign", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendTemplateCampaign(System.Guid) on controller xbytechat.api.Features.CampaignModule.Controllers.CampaignController (xbytechat.api).
2025-07-02 22:54:44.900 +05:30 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-07-02 22:54:44.913 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[@__campaignId_0='ba36287b-8233-4a42-af9d-60274555b00f'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."BusinessId", t."CampaignId", t."CampaignType", t."CreatedAt", t."CreatedBy", t."CtaId", t."DeletedAt", t."DeletedBy", t."FollowUpTemplateId", t."ImageCaption", t."ImageUrl", t."IsDeleted", t."MessageBody", t."MessageTemplate", t."Name", t."ScheduledAt", t."SourceCampaignId", t."Status", t."TemplateId", t."TemplateParameters", t."UpdatedAt", t0."Id", t0."BotId", t0."BusinessId", t0."CampaignId", t0."CategoryBrowsed", t0."ClickedCTA", t0."ContactId", t0."IsAutoTagged", t0."MessagePreview", t0."ProductBrowsed", t0."SentAt", t0."Status", t0."UpdatedAt", t0."Id0", t0."AssignedAgentId", t0."BusinessId0", t0."CreatedAt", t0."Email", t0."Group", t0."IsActive", t0."IsArchived", t0."IsAutomationPaused", t0."IsFavorite", t0."LastCTAInteraction", t0."LastCTAType", t0."LastClickedProductId", t0."LastContactedAt", t0."LeadSource", t0."Name", t0."NextFollowUpAt", t0."Notes", t0."PhoneNumber", t0."Tags", c2."Id", c2."CampaignId", c2."IsFromTemplate", c2."Position", c2."Title", c2."Type", c2."Value"
FROM (
    SELECT c."Id", c."BusinessId", c."CampaignId", c."CampaignType", c."CreatedAt", c."CreatedBy", c."CtaId", c."DeletedAt", c."DeletedBy", c."FollowUpTemplateId", c."ImageCaption", c."ImageUrl", c."IsDeleted", c."MessageBody", c."MessageTemplate", c."Name", c."ScheduledAt", c."SourceCampaignId", c."Status", c."TemplateId", c."TemplateParameters", c."UpdatedAt"
    FROM "Campaigns" AS c
    WHERE c."Id" = @__campaignId_0 AND NOT (c."IsDeleted")
    LIMIT 1
) AS t
LEFT JOIN (
    SELECT c0."Id", c0."BotId", c0."BusinessId", c0."CampaignId", c0."CategoryBrowsed", c0."ClickedCTA", c0."ContactId", c0."IsAutoTagged", c0."MessagePreview", c0."ProductBrowsed", c0."SentAt", c0."Status", c0."UpdatedAt", c1."Id" AS "Id0", c1."AssignedAgentId", c1."BusinessId" AS "BusinessId0", c1."CreatedAt", c1."Email", c1."Group", c1."IsActive", c1."IsArchived", c1."IsAutomationPaused", c1."IsFavorite", c1."LastCTAInteraction", c1."LastCTAType", c1."LastClickedProductId", c1."LastContactedAt", c1."LeadSource", c1."Name", c1."NextFollowUpAt", c1."Notes", c1."PhoneNumber", c1."Tags"
    FROM "CampaignRecipients" AS c0
    INNER JOIN "Contacts" AS c1 ON c0."ContactId" = c1."Id"
) AS t0 ON t."Id" = t0."CampaignId"
LEFT JOIN "CampaignButtons" AS c2 ON t."Id" = c2."CampaignId"
ORDER BY t."Id", t0."Id", t0."Id0"
2025-07-02 22:54:44.924 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiToken", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."IsActive" AND w."BusinessId" = @__businessId_0
LIMIT 1
2025-07-02 22:54:44.928 +05:30 [INF] Start processing HTTP request GET https://graph.facebook.com/v22.0/999432368375320/message_templates
2025-07-02 22:54:44.929 +05:30 [INF] Sending HTTP request GET https://graph.facebook.com/v22.0/999432368375320/message_templates
2025-07-02 22:54:46.090 +05:30 [INF] Received HTTP response headers after 1159.0143ms - 200
2025-07-02 22:54:46.092 +05:30 [INF] End processing HTTP request after 1164.5058ms - 200
2025-07-02 22:54:46.096 +05:30 [INF] 📨 Preparing to send to 447543746206
2025-07-02 22:54:48.475 +05:30 [INF] ℹ️ Skipping parameters for static button 'Visit website' (url)
2025-07-02 22:54:48.479 +05:30 [INF] ℹ️ Skipping parameters for static button 'Call Us' (voice_call)
2025-07-02 22:54:48.499 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT b."Id", b."Address", b."ApprovedAt", b."ApprovedBy", b."BusinessEmail", b."BusinessName", b."CompanyName", b."CompanyPhone", b."CreatedAt", b."CreatedBy", b."CreatedByPartnerId", b."DeletedAt", b."DeletedBy", b."Industry", b."IsApproved", b."IsDeleted", b."LastLoginAt", b."LogoUrl", b."Notes", b."Phone", b."RepresentativeName", b."Source", b."Status", b."Tags", b."Website", w."Id", w."ApiToken", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WhatsAppBusinessNumber"
FROM "Businesses" AS b
LEFT JOIN "WhatsAppSettings" AS w ON b."Id" = w."BusinessId"
WHERE b."Id" = @__businessId_0
LIMIT 1
2025-07-02 22:54:48.505 +05:30 [INF] Start processing HTTP request POST https://graph.facebook.com/v22.0/601884673011340/messages
2025-07-02 22:54:48.507 +05:30 [INF] Sending HTTP request POST https://graph.facebook.com/v22.0/601884673011340/messages
2025-07-02 22:54:49.674 +05:30 [INF] Received HTTP response headers after 1164.5939ms - 400
2025-07-02 22:54:49.676 +05:30 [INF] End processing HTTP request after 1170.3647ms - 400
2025-07-02 22:54:49.680 +05:30 [INF] 📬 Send result: {"Success":false,"Message":"❌ WhatsApp API returned an error.","Data":null,"ErrorMessage":"API returned error","RawResponse":"{\"error\":{\"message\":\"(#100) Invalid parameter\",\"type\":\"OAuthException\",\"code\":100,\"error_data\":{\"messaging_product\":\"whatsapp\",\"details\":\"buttons: Button at index 0 of type Url does not require parameters\"},\"fbtrace_id\":\"A9obkXmxt_LpuxeoitrtoPm\"}}","MessageId":null,"LogId":null,"Token":null,"RefreshToken":null}
2025-07-02 22:54:49.683 +05:30 [INF] 📥 MessageLog saved for 447543746206
2025-07-02 22:54:49.756 +05:30 [INF] 🗃️ CampaignSendLog saved for recipient "bced2bea-8114-4359-a954-861d42addbcb"
2025-07-02 22:54:49.758 +05:30 [INF] 📨 Preparing to send to +917082156227
2025-07-02 22:54:51.708 +05:30 [INF] ℹ️ Skipping parameters for static button 'Visit website' (url)
2025-07-02 22:54:51.715 +05:30 [INF] ℹ️ Skipping parameters for static button 'Call Us' (voice_call)
2025-07-02 22:54:51.718 +05:30 [INF] Start processing HTTP request POST https://graph.facebook.com/v22.0/601884673011340/messages
2025-07-02 22:54:51.720 +05:30 [INF] Sending HTTP request POST https://graph.facebook.com/v22.0/601884673011340/messages
2025-07-02 22:54:52.644 +05:30 [INF] Received HTTP response headers after 922.8818ms - 400
2025-07-02 22:54:52.646 +05:30 [INF] End processing HTTP request after 928.7186ms - 400
2025-07-02 22:54:52.649 +05:30 [INF] 📬 Send result: {"Success":false,"Message":"❌ WhatsApp API returned an error.","Data":null,"ErrorMessage":"API returned error","RawResponse":"{\"error\":{\"message\":\"(#100) Invalid parameter\",\"type\":\"OAuthException\",\"code\":100,\"error_data\":{\"messaging_product\":\"whatsapp\",\"details\":\"buttons: Button at index 0 of type Url does not require parameters\"},\"fbtrace_id\":\"AmG0DngzueITRl6HdeKVTie\"}}","MessageId":null,"LogId":null,"Token":null,"RefreshToken":null}
2025-07-02 22:54:52.651 +05:30 [INF] 📥 MessageLog saved for +917082156227
2025-07-02 22:54:52.652 +05:30 [INF] 🗃️ CampaignSendLog saved for recipient "f14e7bd6-b9d7-40bf-93c6-a03d1970e74b"
2025-07-02 22:54:52.654 +05:30 [INF] 💾 Saving all DB changes...
2025-07-02 22:54:52.677 +05:30 [INF] Executed DbCommand (5ms) [Parameters=[@p0='11af5c57-084c-493e-9824-973f89317cb9', @p1='c13be597-6ae2-42bb-9d43-925815f24ff8', @p2=NULL (DbType = Guid), @p3=NULL (DbType = Guid), @p4='ba36287b-8233-4a42-af9d-60274555b00f' (Nullable = true), @p5='8aac7c57-6699-4511-897b-4121b407eb1c' (Nullable = true), @p6='2025-07-02T17:24:52.6510472Z' (DbType = DateTime), @p7='API returned error', @p8='False', @p9='https://picsum.photos/200/300', @p10='imagecampaign' (Nullable = false), @p11=NULL, @p12='{"error":{"message":"(#100) Invalid parameter","type":"OAuthException","code":100,"error_data":{"messaging_product":"whatsapp","details":"buttons: Button at index 0 of type Url does not require parameters"},"fbtrace_id":"AmG0DngzueITRl6HdeKVTie"}}', @p13='+917082156227' (Nullable = false), @p14=NULL (DbType = Guid), @p15=NULL, @p16=NULL (DbType = DateTime), @p17=NULL, @p18='Failed' (Nullable = false), @p19='998fd650-5e01-40ee-bcec-5093a7bce9fd', @p20='c13be597-6ae2-42bb-9d43-925815f24ff8', @p21=NULL (DbType = Guid), @p22=NULL (DbType = Guid), @p23='ba36287b-8233-4a42-af9d-60274555b00f' (Nullable = true), @p24='80c43c6a-508b-47ff-9360-201bfd5521d3' (Nullable = true), @p25='2025-07-02T17:24:49.6822039Z' (DbType = DateTime), @p26='API returned error', @p27='False', @p28='https://picsum.photos/200/300', @p29='imagecampaign' (Nullable = false), @p30=NULL, @p31='{"error":{"message":"(#100) Invalid parameter","type":"OAuthException","code":100,"error_data":{"messaging_product":"whatsapp","details":"buttons: Button at index 0 of type Url does not require parameters"},"fbtrace_id":"A9obkXmxt_LpuxeoitrtoPm"}}', @p32='447543746206' (Nullable = false), @p33=NULL (DbType = Guid), @p34=NULL, @p35=NULL (DbType = DateTime), @p36=NULL, @p37='Failed' (Nullable = false), @p38='ae8ff4f2-5471-4286-a878-22f7cee1474f', @p39='True', @p40=NULL, @p41='c13be597-6ae2-42bb-9d43-925815f24ff8', @p42='ba36287b-8233-4a42-af9d-60274555b00f', @p43=NULL, @p44=NULL, @p45=NULL (DbType = DateTime), @p46='8aac7c57-6699-4511-897b-4121b407eb1c', @p47=NULL, @p48='2025-07-02T17:24:52.6523877Z' (DbType = DateTime), @p49='system', @p50=NULL (DbType = DateTime), @p51=NULL, @p52=NULL, @p53=NULL, @p54=NULL, @p55='False', @p56=NULL (DbType = DateTime), @p57=NULL, @p58=NULL, @p59='Hello,
We’re excited to announce that we’re launching some amazing new products at [Your Company Name]! 🚀

Be the first to check them out and grab special launch offers!
If you’re interested, reply to this message or click here:' (Nullable = false), @p60=NULL, @p61='11af5c57-084c-493e-9824-973f89317cb9' (Nullable = true), @p62=NULL (DbType = DateTime), @p63='f14e7bd6-b9d7-40bf-93c6-a03d1970e74b', @p64='0', @p65='Failed', @p66='2025-07-02T17:24:52.6523879Z' (Nullable = true) (DbType = DateTime), @p67=NULL, @p68='imagecampaign', @p69=NULL (DbType = Guid), @p70='e9b52d51-c037-4a2b-b7b7-ce094dc2bdc1', @p71='True', @p72=NULL, @p73='c13be597-6ae2-42bb-9d43-925815f24ff8', @p74='ba36287b-8233-4a42-af9d-60274555b00f', @p75=NULL, @p76=NULL, @p77=NULL (DbType = DateTime), @p78='80c43c6a-508b-47ff-9360-201bfd5521d3', @p79=NULL, @p80='2025-07-02T17:24:49.6866882Z' (DbType = DateTime), @p81='system', @p82=NULL (DbType = DateTime), @p83=NULL, @p84=NULL, @p85=NULL, @p86=NULL, @p87='False', @p88=NULL (DbType = DateTime), @p89=NULL, @p90=NULL, @p91='Hello,
We’re excited to announce that we’re launching some amazing new products at [Your Company Name]! 🚀

Be the first to check them out and grab special launch offers!
If you’re interested, reply to this message or click here:' (Nullable = false), @p92=NULL, @p93='998fd650-5e01-40ee-bcec-5093a7bce9fd' (Nullable = true), @p94=NULL (DbType = DateTime), @p95='bced2bea-8114-4359-a954-861d42addbcb', @p96='0', @p97='Failed', @p98='2025-07-02T17:24:49.6867670Z' (Nullable = true) (DbType = DateTime), @p99=NULL, @p100='imagecampaign', @p101=NULL (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "MessageLogs" ("Id", "BusinessId", "CTAFlowConfigId", "CTAFlowStepId", "CampaignId", "ContactId", "CreatedAt", "ErrorMessage", "IsIncoming", "MediaUrl", "MessageContent", "MessageId", "RawResponse", "RecipientNumber", "RefMessageId", "RenderedBody", "SentAt", "Source", "Status")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
INSERT INTO "MessageLogs" ("Id", "BusinessId", "CTAFlowConfigId", "CTAFlowStepId", "CampaignId", "ContactId", "CreatedAt", "ErrorMessage", "IsIncoming", "MediaUrl", "MessageContent", "MessageId", "RawResponse", "RecipientNumber", "RefMessageId", "RenderedBody", "SentAt", "Source", "Status")
VALUES (@p19, @p20, @p21, @p22, @p23, @p24, @p25, @p26, @p27, @p28, @p29, @p30, @p31, @p32, @p33, @p34, @p35, @p36, @p37);
INSERT INTO "CampaignSendLogs" ("Id", "AllowRetry", "Browser", "BusinessId", "CampaignId", "City", "ClickType", "ClickedAt", "ContactId", "Country", "CreatedAt", "CreatedBy", "DeliveredAt", "DeviceInfo", "DeviceType", "ErrorMessage", "IpAddress", "IsClicked", "LastRetryAt", "LastRetryStatus", "MacAddress", "MessageBody", "MessageId", "MessageLogId", "ReadAt", "RecipientId", "RetryCount", "SendStatus", "SentAt", "SourceChannel", "TemplateId", "UserId")
VALUES (@p38, @p39, @p40, @p41, @p42, @p43, @p44, @p45, @p46, @p47, @p48, @p49, @p50, @p51, @p52, @p53, @p54, @p55, @p56, @p57, @p58, @p59, @p60, @p61, @p62, @p63, @p64, @p65, @p66, @p67, @p68, @p69);
INSERT INTO "CampaignSendLogs" ("Id", "AllowRetry", "Browser", "BusinessId", "CampaignId", "City", "ClickType", "ClickedAt", "ContactId", "Country", "CreatedAt", "CreatedBy", "DeliveredAt", "DeviceInfo", "DeviceType", "ErrorMessage", "IpAddress", "IsClicked", "LastRetryAt", "LastRetryStatus", "MacAddress", "MessageBody", "MessageId", "MessageLogId", "ReadAt", "RecipientId", "RetryCount", "SendStatus", "SentAt", "SourceChannel", "TemplateId", "UserId")
VALUES (@p70, @p71, @p72, @p73, @p74, @p75, @p76, @p77, @p78, @p79, @p80, @p81, @p82, @p83, @p84, @p85, @p86, @p87, @p88, @p89, @p90, @p91, @p92, @p93, @p94, @p95, @p96, @p97, @p98, @p99, @p100, @p101);
2025-07-02 22:54:52.699 +05:30 [INF] ✅ All saved successfully.
2025-07-02 22:54:52.700 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Helpers.ResponseResult'.
2025-07-02 22:54:52.702 +05:30 [INF] Executed action xbytechat.api.Features.CampaignModule.Controllers.CampaignController.SendTemplateCampaign (xbytechat.api) in 7827.2038ms
2025-07-02 22:54:52.705 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.SendTemplateCampaign (xbytechat.api)'
2025-07-02 22:54:52.708 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/api/campaign/send-campaign/ba36287b-8233-4a42-af9d-60274555b00f - 200 null application/json; charset=utf-8 7850.2182ms
2025-07-02 22:55:03.404 +05:30 [INF] Request starting HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - application/json 715
2025-07-02 22:55:03.408 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:55:03.410 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-07-02 22:55:03.412 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSNDYzMTg3MjVGMUQ1MkNCNzEyAA==","status":"failed","timestamp":"1750941174","recipient_id":"917082156227","errors":[{"code":131047,"title":"Re-engagement message","message":"Re-engagement message","error_data":{"details":"Message failed to send because more than 24 hours have passed since the customer last replied to this number."},"href":"https:\/\/developers.facebook.com\/docs\/whatsapp\/cloud-api\/support\/error-codes\/"}]}]},"field":"messages"}]}]}
2025-07-02 22:55:03.414 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-07-02 22:55:03.414 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSNDYzMTg3MjVGMUQ1MkNCNzEyAA==","status":"failed","timestamp":"1750941174","recipient_id":"917082156227","errors":[{"code":131047,"title":"Re-engagement message","message":"Re-engagement message","error_data":{"details":"Message failed to send because more than 24 hours have passed since the customer last replied to this number."},"href":"https:\/\/developers.facebook.com\/docs\/whatsapp\/cloud-api\/support\/error-codes\/"}]}]},"field":"messages"}]}]}
2025-07-02 22:55:03.416 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType73`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:55:03.418 +05:30 [INF] 📦 Routing to Status Processor
2025-07-02 22:55:03.420 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 7.7356ms
2025-07-02 22:55:03.421 +05:30 [WRN] 🔍 Incoming timestamp raw value: {"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSNDYzMTg3MjVGMUQ1MkNCNzEyAA==","status":"failed","timestamp":"1750941174","recipient_id":"917082156227","errors":[{"code":131047,"title":"Re-engagement message","message":"Re-engagement message","error_data":{"details":"Message failed to send because more than 24 hours have passed since the customer last replied to this number."},"href":"https:\/\/developers.facebook.com\/docs\/whatsapp\/cloud-api\/support\/error-codes\/"}]}]},"field":"messages"}]}]}
2025-07-02 22:55:03.422 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:55:03.427 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__messageId_0='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSNDYzMTg3MjVGMUQ1MkNCNzEyAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."MessageId" = @__messageId_0
LIMIT 1
2025-07-02 22:55:03.427 +05:30 [INF] Request finished HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 22.7645ms
2025-07-02 22:55:03.430 +05:30 [WRN] ⚠️ CampaignSendLog not found for MessageId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSNDYzMTg3MjVGMUQ1MkNCNzEyAA==
2025-07-02 22:55:03.436 +05:30 [WRN] ⚠️ No matching CampaignSendLog for MessageId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSNDYzMTg3MjVGMUQ1MkNCNzEyAA==
2025-07-02 22:55:08.490 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/api/campaign/send-campaign/ba36287b-8233-4a42-af9d-60274555b00f - null 0
2025-07-02 22:55:08.496 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:55:08.498 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.SendTemplateCampaign (xbytechat.api)'
2025-07-02 22:55:08.499 +05:30 [INF] Route matched with {action = "SendTemplateCampaign", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendTemplateCampaign(System.Guid) on controller xbytechat.api.Features.CampaignModule.Controllers.CampaignController (xbytechat.api).
2025-07-02 22:55:08.507 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[@__campaignId_0='ba36287b-8233-4a42-af9d-60274555b00f'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."BusinessId", t."CampaignId", t."CampaignType", t."CreatedAt", t."CreatedBy", t."CtaId", t."DeletedAt", t."DeletedBy", t."FollowUpTemplateId", t."ImageCaption", t."ImageUrl", t."IsDeleted", t."MessageBody", t."MessageTemplate", t."Name", t."ScheduledAt", t."SourceCampaignId", t."Status", t."TemplateId", t."TemplateParameters", t."UpdatedAt", t0."Id", t0."BotId", t0."BusinessId", t0."CampaignId", t0."CategoryBrowsed", t0."ClickedCTA", t0."ContactId", t0."IsAutoTagged", t0."MessagePreview", t0."ProductBrowsed", t0."SentAt", t0."Status", t0."UpdatedAt", t0."Id0", t0."AssignedAgentId", t0."BusinessId0", t0."CreatedAt", t0."Email", t0."Group", t0."IsActive", t0."IsArchived", t0."IsAutomationPaused", t0."IsFavorite", t0."LastCTAInteraction", t0."LastCTAType", t0."LastClickedProductId", t0."LastContactedAt", t0."LeadSource", t0."Name", t0."NextFollowUpAt", t0."Notes", t0."PhoneNumber", t0."Tags", c2."Id", c2."CampaignId", c2."IsFromTemplate", c2."Position", c2."Title", c2."Type", c2."Value"
FROM (
    SELECT c."Id", c."BusinessId", c."CampaignId", c."CampaignType", c."CreatedAt", c."CreatedBy", c."CtaId", c."DeletedAt", c."DeletedBy", c."FollowUpTemplateId", c."ImageCaption", c."ImageUrl", c."IsDeleted", c."MessageBody", c."MessageTemplate", c."Name", c."ScheduledAt", c."SourceCampaignId", c."Status", c."TemplateId", c."TemplateParameters", c."UpdatedAt"
    FROM "Campaigns" AS c
    WHERE c."Id" = @__campaignId_0 AND NOT (c."IsDeleted")
    LIMIT 1
) AS t
LEFT JOIN (
    SELECT c0."Id", c0."BotId", c0."BusinessId", c0."CampaignId", c0."CategoryBrowsed", c0."ClickedCTA", c0."ContactId", c0."IsAutoTagged", c0."MessagePreview", c0."ProductBrowsed", c0."SentAt", c0."Status", c0."UpdatedAt", c1."Id" AS "Id0", c1."AssignedAgentId", c1."BusinessId" AS "BusinessId0", c1."CreatedAt", c1."Email", c1."Group", c1."IsActive", c1."IsArchived", c1."IsAutomationPaused", c1."IsFavorite", c1."LastCTAInteraction", c1."LastCTAType", c1."LastClickedProductId", c1."LastContactedAt", c1."LeadSource", c1."Name", c1."NextFollowUpAt", c1."Notes", c1."PhoneNumber", c1."Tags"
    FROM "CampaignRecipients" AS c0
    INNER JOIN "Contacts" AS c1 ON c0."ContactId" = c1."Id"
) AS t0 ON t."Id" = t0."CampaignId"
LEFT JOIN "CampaignButtons" AS c2 ON t."Id" = c2."CampaignId"
ORDER BY t."Id", t0."Id", t0."Id0"
2025-07-02 22:55:08.515 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiToken", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."IsActive" AND w."BusinessId" = @__businessId_0
LIMIT 1
2025-07-02 22:55:08.519 +05:30 [INF] Start processing HTTP request GET https://graph.facebook.com/v22.0/999432368375320/message_templates
2025-07-02 22:55:08.520 +05:30 [INF] Sending HTTP request GET https://graph.facebook.com/v22.0/999432368375320/message_templates
2025-07-02 22:55:09.501 +05:30 [INF] Received HTTP response headers after 979.0083ms - 200
2025-07-02 22:55:09.507 +05:30 [INF] End processing HTTP request after 988.2055ms - 200
2025-07-02 22:55:09.510 +05:30 [INF] 📨 Preparing to send to 447543746206
2025-07-02 22:55:26.699 +05:30 [INF] ℹ️ Skipping parameters for static button 'Visit website' (url)
2025-07-02 22:55:38.959 +05:30 [INF] ℹ️ Skipping parameters for static button 'Call Us' (voice_call)
2025-07-02 22:55:38.963 +05:30 [INF] Start processing HTTP request POST https://graph.facebook.com/v22.0/601884673011340/messages
2025-07-02 22:55:38.965 +05:30 [INF] Sending HTTP request POST https://graph.facebook.com/v22.0/601884673011340/messages
2025-07-02 22:55:39.589 +05:30 [INF] Received HTTP response headers after 622.6414ms - 400
2025-07-02 22:55:39.591 +05:30 [INF] End processing HTTP request after 627.9734ms - 400
2025-07-02 22:55:39.594 +05:30 [INF] 📬 Send result: {"Success":false,"Message":"❌ WhatsApp API returned an error.","Data":null,"ErrorMessage":"API returned error","RawResponse":"{\"error\":{\"message\":\"(#100) Invalid parameter\",\"type\":\"OAuthException\",\"code\":100,\"error_data\":{\"messaging_product\":\"whatsapp\",\"details\":\"buttons: Button at index 0 of type Url does not require parameters\"},\"fbtrace_id\":\"AQlpdsYaxFoxC4oWof1sdRh\"}}","MessageId":null,"LogId":null,"Token":null,"RefreshToken":null}
2025-07-02 22:55:39.596 +05:30 [INF] 📥 MessageLog saved for 447543746206
2025-07-02 22:55:39.597 +05:30 [INF] 🗃️ CampaignSendLog saved for recipient "bced2bea-8114-4359-a954-861d42addbcb"
2025-07-02 22:55:39.598 +05:30 [INF] 📨 Preparing to send to +917082156227
2025-07-02 22:55:41.656 +05:30 [INF] ℹ️ Skipping parameters for static button 'Visit website' (url)
2025-07-02 22:55:41.659 +05:30 [INF] ℹ️ Skipping parameters for static button 'Call Us' (voice_call)
2025-07-02 22:55:41.661 +05:30 [INF] Start processing HTTP request POST https://graph.facebook.com/v22.0/601884673011340/messages
2025-07-02 22:55:41.663 +05:30 [INF] Sending HTTP request POST https://graph.facebook.com/v22.0/601884673011340/messages
2025-07-02 22:55:42.308 +05:30 [INF] Received HTTP response headers after 643.5579ms - 400
2025-07-02 22:55:42.310 +05:30 [INF] End processing HTTP request after 648.4278ms - 400
2025-07-02 22:55:42.313 +05:30 [INF] 📬 Send result: {"Success":false,"Message":"❌ WhatsApp API returned an error.","Data":null,"ErrorMessage":"API returned error","RawResponse":"{\"error\":{\"message\":\"(#100) Invalid parameter\",\"type\":\"OAuthException\",\"code\":100,\"error_data\":{\"messaging_product\":\"whatsapp\",\"details\":\"buttons: Button at index 0 of type Url does not require parameters\"},\"fbtrace_id\":\"AuC4eyD0PAG5ExRXJx0WzcY\"}}","MessageId":null,"LogId":null,"Token":null,"RefreshToken":null}
2025-07-02 22:55:42.314 +05:30 [INF] 📥 MessageLog saved for +917082156227
2025-07-02 22:55:42.316 +05:30 [INF] 🗃️ CampaignSendLog saved for recipient "f14e7bd6-b9d7-40bf-93c6-a03d1970e74b"
2025-07-02 22:55:42.317 +05:30 [INF] 💾 Saving all DB changes...
2025-07-02 22:55:42.324 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[@p0='4553c90d-94f9-4f37-ac12-9cd02d09284f', @p1='c13be597-6ae2-42bb-9d43-925815f24ff8', @p2=NULL (DbType = Guid), @p3=NULL (DbType = Guid), @p4='ba36287b-8233-4a42-af9d-60274555b00f' (Nullable = true), @p5='8aac7c57-6699-4511-897b-4121b407eb1c' (Nullable = true), @p6='2025-07-02T17:25:42.3146509Z' (DbType = DateTime), @p7='API returned error', @p8='False', @p9='https://picsum.photos/200/300', @p10='imagecampaign' (Nullable = false), @p11=NULL, @p12='{"error":{"message":"(#100) Invalid parameter","type":"OAuthException","code":100,"error_data":{"messaging_product":"whatsapp","details":"buttons: Button at index 0 of type Url does not require parameters"},"fbtrace_id":"AuC4eyD0PAG5ExRXJx0WzcY"}}', @p13='+917082156227' (Nullable = false), @p14=NULL (DbType = Guid), @p15=NULL, @p16=NULL (DbType = DateTime), @p17=NULL, @p18='Failed' (Nullable = false), @p19='475773bd-75e2-4c2f-8d42-5943670726e5', @p20='c13be597-6ae2-42bb-9d43-925815f24ff8', @p21=NULL (DbType = Guid), @p22=NULL (DbType = Guid), @p23='ba36287b-8233-4a42-af9d-60274555b00f' (Nullable = true), @p24='80c43c6a-508b-47ff-9360-201bfd5521d3' (Nullable = true), @p25='2025-07-02T17:25:39.5959773Z' (DbType = DateTime), @p26='API returned error', @p27='False', @p28='https://picsum.photos/200/300', @p29='imagecampaign' (Nullable = false), @p30=NULL, @p31='{"error":{"message":"(#100) Invalid parameter","type":"OAuthException","code":100,"error_data":{"messaging_product":"whatsapp","details":"buttons: Button at index 0 of type Url does not require parameters"},"fbtrace_id":"AQlpdsYaxFoxC4oWof1sdRh"}}', @p32='447543746206' (Nullable = false), @p33=NULL (DbType = Guid), @p34=NULL, @p35=NULL (DbType = DateTime), @p36=NULL, @p37='Failed' (Nullable = false), @p38='337501cb-bf2c-49b9-9a99-62164aa776c0', @p39='True', @p40=NULL, @p41='c13be597-6ae2-42bb-9d43-925815f24ff8', @p42='ba36287b-8233-4a42-af9d-60274555b00f', @p43=NULL, @p44=NULL, @p45=NULL (DbType = DateTime), @p46='8aac7c57-6699-4511-897b-4121b407eb1c', @p47=NULL, @p48='2025-07-02T17:25:42.3159495Z' (DbType = DateTime), @p49='system', @p50=NULL (DbType = DateTime), @p51=NULL, @p52=NULL, @p53=NULL, @p54=NULL, @p55='False', @p56=NULL (DbType = DateTime), @p57=NULL, @p58=NULL, @p59='Hello,
We’re excited to announce that we’re launching some amazing new products at [Your Company Name]! 🚀

Be the first to check them out and grab special launch offers!
If you’re interested, reply to this message or click here:' (Nullable = false), @p60=NULL, @p61='4553c90d-94f9-4f37-ac12-9cd02d09284f' (Nullable = true), @p62=NULL (DbType = DateTime), @p63='f14e7bd6-b9d7-40bf-93c6-a03d1970e74b', @p64='0', @p65='Failed', @p66='2025-07-02T17:25:42.3159495Z' (Nullable = true) (DbType = DateTime), @p67=NULL, @p68='imagecampaign', @p69=NULL (DbType = Guid), @p70='d4d796a4-b368-4c6f-8da1-505899f7b342', @p71='True', @p72=NULL, @p73='c13be597-6ae2-42bb-9d43-925815f24ff8', @p74='ba36287b-8233-4a42-af9d-60274555b00f', @p75=NULL, @p76=NULL, @p77=NULL (DbType = DateTime), @p78='80c43c6a-508b-47ff-9360-201bfd5521d3', @p79=NULL, @p80='2025-07-02T17:25:39.5974107Z' (DbType = DateTime), @p81='system', @p82=NULL (DbType = DateTime), @p83=NULL, @p84=NULL, @p85=NULL, @p86=NULL, @p87='False', @p88=NULL (DbType = DateTime), @p89=NULL, @p90=NULL, @p91='Hello,
We’re excited to announce that we’re launching some amazing new products at [Your Company Name]! 🚀

Be the first to check them out and grab special launch offers!
If you’re interested, reply to this message or click here:' (Nullable = false), @p92=NULL, @p93='475773bd-75e2-4c2f-8d42-5943670726e5' (Nullable = true), @p94=NULL (DbType = DateTime), @p95='bced2bea-8114-4359-a954-861d42addbcb', @p96='0', @p97='Failed', @p98='2025-07-02T17:25:39.5974110Z' (Nullable = true) (DbType = DateTime), @p99=NULL, @p100='imagecampaign', @p101=NULL (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "MessageLogs" ("Id", "BusinessId", "CTAFlowConfigId", "CTAFlowStepId", "CampaignId", "ContactId", "CreatedAt", "ErrorMessage", "IsIncoming", "MediaUrl", "MessageContent", "MessageId", "RawResponse", "RecipientNumber", "RefMessageId", "RenderedBody", "SentAt", "Source", "Status")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
INSERT INTO "MessageLogs" ("Id", "BusinessId", "CTAFlowConfigId", "CTAFlowStepId", "CampaignId", "ContactId", "CreatedAt", "ErrorMessage", "IsIncoming", "MediaUrl", "MessageContent", "MessageId", "RawResponse", "RecipientNumber", "RefMessageId", "RenderedBody", "SentAt", "Source", "Status")
VALUES (@p19, @p20, @p21, @p22, @p23, @p24, @p25, @p26, @p27, @p28, @p29, @p30, @p31, @p32, @p33, @p34, @p35, @p36, @p37);
INSERT INTO "CampaignSendLogs" ("Id", "AllowRetry", "Browser", "BusinessId", "CampaignId", "City", "ClickType", "ClickedAt", "ContactId", "Country", "CreatedAt", "CreatedBy", "DeliveredAt", "DeviceInfo", "DeviceType", "ErrorMessage", "IpAddress", "IsClicked", "LastRetryAt", "LastRetryStatus", "MacAddress", "MessageBody", "MessageId", "MessageLogId", "ReadAt", "RecipientId", "RetryCount", "SendStatus", "SentAt", "SourceChannel", "TemplateId", "UserId")
VALUES (@p38, @p39, @p40, @p41, @p42, @p43, @p44, @p45, @p46, @p47, @p48, @p49, @p50, @p51, @p52, @p53, @p54, @p55, @p56, @p57, @p58, @p59, @p60, @p61, @p62, @p63, @p64, @p65, @p66, @p67, @p68, @p69);
INSERT INTO "CampaignSendLogs" ("Id", "AllowRetry", "Browser", "BusinessId", "CampaignId", "City", "ClickType", "ClickedAt", "ContactId", "Country", "CreatedAt", "CreatedBy", "DeliveredAt", "DeviceInfo", "DeviceType", "ErrorMessage", "IpAddress", "IsClicked", "LastRetryAt", "LastRetryStatus", "MacAddress", "MessageBody", "MessageId", "MessageLogId", "ReadAt", "RecipientId", "RetryCount", "SendStatus", "SentAt", "SourceChannel", "TemplateId", "UserId")
VALUES (@p70, @p71, @p72, @p73, @p74, @p75, @p76, @p77, @p78, @p79, @p80, @p81, @p82, @p83, @p84, @p85, @p86, @p87, @p88, @p89, @p90, @p91, @p92, @p93, @p94, @p95, @p96, @p97, @p98, @p99, @p100, @p101);
2025-07-02 22:55:42.346 +05:30 [INF] ✅ All saved successfully.
2025-07-02 22:55:42.348 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Helpers.ResponseResult'.
2025-07-02 22:55:42.350 +05:30 [INF] Executed action xbytechat.api.Features.CampaignModule.Controllers.CampaignController.SendTemplateCampaign (xbytechat.api) in 33849.7974ms
2025-07-02 22:55:42.352 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.SendTemplateCampaign (xbytechat.api)'
2025-07-02 22:55:42.353 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/api/campaign/send-campaign/ba36287b-8233-4a42-af9d-60274555b00f - 200 null application/json; charset=utf-8 33863.9944ms
2025-07-02 22:55:45.773 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/api/campaign/send-campaign/5b762111-ca31-42e3-aead-a65f67b4ff48 - null 0
2025-07-02 22:55:45.779 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:55:45.781 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.SendTemplateCampaign (xbytechat.api)'
2025-07-02 22:55:45.783 +05:30 [INF] Route matched with {action = "SendTemplateCampaign", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendTemplateCampaign(System.Guid) on controller xbytechat.api.Features.CampaignModule.Controllers.CampaignController (xbytechat.api).
2025-07-02 22:55:45.806 +05:30 [INF] Executed DbCommand (7ms) [Parameters=[@__campaignId_0='5b762111-ca31-42e3-aead-a65f67b4ff48'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."BusinessId", t."CampaignId", t."CampaignType", t."CreatedAt", t."CreatedBy", t."CtaId", t."DeletedAt", t."DeletedBy", t."FollowUpTemplateId", t."ImageCaption", t."ImageUrl", t."IsDeleted", t."MessageBody", t."MessageTemplate", t."Name", t."ScheduledAt", t."SourceCampaignId", t."Status", t."TemplateId", t."TemplateParameters", t."UpdatedAt", t0."Id", t0."BotId", t0."BusinessId", t0."CampaignId", t0."CategoryBrowsed", t0."ClickedCTA", t0."ContactId", t0."IsAutoTagged", t0."MessagePreview", t0."ProductBrowsed", t0."SentAt", t0."Status", t0."UpdatedAt", t0."Id0", t0."AssignedAgentId", t0."BusinessId0", t0."CreatedAt", t0."Email", t0."Group", t0."IsActive", t0."IsArchived", t0."IsAutomationPaused", t0."IsFavorite", t0."LastCTAInteraction", t0."LastCTAType", t0."LastClickedProductId", t0."LastContactedAt", t0."LeadSource", t0."Name", t0."NextFollowUpAt", t0."Notes", t0."PhoneNumber", t0."Tags", c2."Id", c2."CampaignId", c2."IsFromTemplate", c2."Position", c2."Title", c2."Type", c2."Value"
FROM (
    SELECT c."Id", c."BusinessId", c."CampaignId", c."CampaignType", c."CreatedAt", c."CreatedBy", c."CtaId", c."DeletedAt", c."DeletedBy", c."FollowUpTemplateId", c."ImageCaption", c."ImageUrl", c."IsDeleted", c."MessageBody", c."MessageTemplate", c."Name", c."ScheduledAt", c."SourceCampaignId", c."Status", c."TemplateId", c."TemplateParameters", c."UpdatedAt"
    FROM "Campaigns" AS c
    WHERE c."Id" = @__campaignId_0 AND NOT (c."IsDeleted")
    LIMIT 1
) AS t
LEFT JOIN (
    SELECT c0."Id", c0."BotId", c0."BusinessId", c0."CampaignId", c0."CategoryBrowsed", c0."ClickedCTA", c0."ContactId", c0."IsAutoTagged", c0."MessagePreview", c0."ProductBrowsed", c0."SentAt", c0."Status", c0."UpdatedAt", c1."Id" AS "Id0", c1."AssignedAgentId", c1."BusinessId" AS "BusinessId0", c1."CreatedAt", c1."Email", c1."Group", c1."IsActive", c1."IsArchived", c1."IsAutomationPaused", c1."IsFavorite", c1."LastCTAInteraction", c1."LastCTAType", c1."LastClickedProductId", c1."LastContactedAt", c1."LeadSource", c1."Name", c1."NextFollowUpAt", c1."Notes", c1."PhoneNumber", c1."Tags"
    FROM "CampaignRecipients" AS c0
    INNER JOIN "Contacts" AS c1 ON c0."ContactId" = c1."Id"
) AS t0 ON t."Id" = t0."CampaignId"
LEFT JOIN "CampaignButtons" AS c2 ON t."Id" = c2."CampaignId"
ORDER BY t."Id", t0."Id", t0."Id0"
2025-07-02 22:55:45.817 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiToken", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."IsActive" AND w."BusinessId" = @__businessId_0
LIMIT 1
2025-07-02 22:55:45.822 +05:30 [INF] Start processing HTTP request GET https://graph.facebook.com/v22.0/999432368375320/message_templates
2025-07-02 22:55:45.824 +05:30 [INF] Sending HTTP request GET https://graph.facebook.com/v22.0/999432368375320/message_templates
2025-07-02 22:55:47.835 +05:30 [INF] Received HTTP response headers after 2010.3165ms - 200
2025-07-02 22:55:47.837 +05:30 [INF] End processing HTTP request after 2015.0948ms - 200
2025-07-02 22:55:47.840 +05:30 [INF] 📨 Preparing to send to +917082156227
2025-07-02 22:55:47.843 +05:30 [INF] ⏩ Skipping static button 'Send Pricing' as it requires no parameters
2025-07-02 22:55:47.844 +05:30 [INF] ⏩ Skipping static button 'Back to Products' as it requires no parameters
2025-07-02 22:55:47.846 +05:30 [INF] Start processing HTTP request POST https://graph.facebook.com/v22.0/601884673011340/messages
2025-07-02 22:55:47.848 +05:30 [INF] Sending HTTP request POST https://graph.facebook.com/v22.0/601884673011340/messages
2025-07-02 22:55:49.374 +05:30 [INF] Received HTTP response headers after 1524.3854ms - 200
2025-07-02 22:55:49.376 +05:30 [INF] End processing HTTP request after 1529.8805ms - 200
2025-07-02 22:55:49.379 +05:30 [INF] 📬 Send result: {"Success":true,"Message":"✅ Message sent successfully","Data":null,"ErrorMessage":null,"RawResponse":"{\"messaging_product\":\"whatsapp\",\"contacts\":[{\"input\":\"+917082156227\",\"wa_id\":\"917082156227\"}],\"messages\":[{\"id\":\"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSOUI4MTFCQjYyNTYyNTFBQzAyAA==\",\"message_status\":\"accepted\"}]}","MessageId":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSOUI4MTFCQjYyNTYyNTFBQzAyAA==","LogId":null,"Token":null,"RefreshToken":null}
2025-07-02 22:55:49.380 +05:30 [INF] ✅ Added MessageLog for +917082156227
2025-07-02 22:55:49.384 +05:30 [INF] 📘 Added CampaignSendLog for recipient "47d878cb-ca41-4265-bfd4-fd8d6fd80b5b"
2025-07-02 22:55:49.385 +05:30 [INF] 💾 Saving all DB changes...
2025-07-02 22:55:49.391 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[@p0='8a5e4c33-a504-4e4a-afd1-4ed52534cd9b', @p1='c13be597-6ae2-42bb-9d43-925815f24ff8', @p2=NULL (DbType = Guid), @p3=NULL (DbType = Guid), @p4='5b762111-ca31-42e3-aead-a65f67b4ff48' (Nullable = true), @p5='8aac7c57-6699-4511-897b-4121b407eb1c' (Nullable = true), @p6='2025-07-02T17:25:49.3806818Z' (DbType = DateTime), @p7=NULL, @p8='False', @p9=NULL, @p10='flow_step_4' (Nullable = false), @p11='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSOUI4MTFCQjYyNTYyNTFBQzAyAA==', @p12='{"messaging_product":"whatsapp","contacts":[{"input":"+917082156227","wa_id":"917082156227"}],"messages":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSOUI4MTFCQjYyNTYyNTFBQzAyAA==","message_status":"accepted"}]}', @p13='+917082156227' (Nullable = false), @p14=NULL (DbType = Guid), @p15=NULL, @p16='2025-07-02T17:25:49.3806821Z' (Nullable = true) (DbType = DateTime), @p17=NULL, @p18='Sent' (Nullable = false), @p19='7af8335c-6b3b-4e49-a962-4390c4caf168', @p20='True', @p21=NULL, @p22='00000000-0000-0000-0000-000000000000', @p23='5b762111-ca31-42e3-aead-a65f67b4ff48', @p24=NULL, @p25=NULL, @p26=NULL (DbType = DateTime), @p27='8aac7c57-6699-4511-897b-4121b407eb1c', @p28=NULL, @p29='2025-07-02T17:25:49.3836859Z' (DbType = DateTime), @p30='system', @p31=NULL (DbType = DateTime), @p32=NULL, @p33=NULL, @p34=NULL, @p35=NULL, @p36='False', @p37=NULL (DbType = DateTime), @p38=NULL, @p39=NULL, @p40='Would you like pricing details for your selected product?' (Nullable = false), @p41='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSOUI4MTFCQjYyNTYyNTFBQzAyAA==', @p42='8a5e4c33-a504-4e4a-afd1-4ed52534cd9b' (Nullable = true), @p43=NULL (DbType = DateTime), @p44='47d878cb-ca41-4265-bfd4-fd8d6fd80b5b', @p45='0', @p46='Sent', @p47='2025-07-02T17:25:49.3836859Z' (Nullable = true) (DbType = DateTime), @p48=NULL, @p49='flow_step_4', @p50=NULL (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "MessageLogs" ("Id", "BusinessId", "CTAFlowConfigId", "CTAFlowStepId", "CampaignId", "ContactId", "CreatedAt", "ErrorMessage", "IsIncoming", "MediaUrl", "MessageContent", "MessageId", "RawResponse", "RecipientNumber", "RefMessageId", "RenderedBody", "SentAt", "Source", "Status")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
INSERT INTO "CampaignSendLogs" ("Id", "AllowRetry", "Browser", "BusinessId", "CampaignId", "City", "ClickType", "ClickedAt", "ContactId", "Country", "CreatedAt", "CreatedBy", "DeliveredAt", "DeviceInfo", "DeviceType", "ErrorMessage", "IpAddress", "IsClicked", "LastRetryAt", "LastRetryStatus", "MacAddress", "MessageBody", "MessageId", "MessageLogId", "ReadAt", "RecipientId", "RetryCount", "SendStatus", "SentAt", "SourceChannel", "TemplateId", "UserId")
VALUES (@p19, @p20, @p21, @p22, @p23, @p24, @p25, @p26, @p27, @p28, @p29, @p30, @p31, @p32, @p33, @p34, @p35, @p36, @p37, @p38, @p39, @p40, @p41, @p42, @p43, @p44, @p45, @p46, @p47, @p48, @p49, @p50);
2025-07-02 22:55:49.413 +05:30 [INF] ✅ All saved successfully.
2025-07-02 22:55:49.415 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Helpers.ResponseResult'.
2025-07-02 22:55:49.418 +05:30 [INF] Executed action xbytechat.api.Features.CampaignModule.Controllers.CampaignController.SendTemplateCampaign (xbytechat.api) in 3620.8134ms
2025-07-02 22:55:49.420 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.SendTemplateCampaign (xbytechat.api)'
2025-07-02 22:55:49.422 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/api/campaign/send-campaign/5b762111-ca31-42e3-aead-a65f67b4ff48 - 200 null application/json; charset=utf-8 3650.1363ms
2025-07-02 22:55:50.610 +05:30 [INF] Request starting HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - application/json 602
2025-07-02 22:55:50.614 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:55:50.617 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-07-02 22:55:50.620 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSOUI4MTFCQjYyNTYyNTFBQzAyAA==","status":"sent","timestamp":"1751477153","recipient_id":"917082156227","conversation":{"id":"010945abee961f75eb3fabd31f6a0e1d","expiration_timestamp":"1751477153","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-07-02 22:55:50.622 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-07-02 22:55:50.622 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSOUI4MTFCQjYyNTYyNTFBQzAyAA==","status":"sent","timestamp":"1751477153","recipient_id":"917082156227","conversation":{"id":"010945abee961f75eb3fabd31f6a0e1d","expiration_timestamp":"1751477153","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-07-02 22:55:50.623 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType73`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:55:50.625 +05:30 [INF] 📦 Routing to Status Processor
2025-07-02 22:55:50.629 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 9.6778ms
2025-07-02 22:55:50.630 +05:30 [WRN] 🔍 Incoming timestamp raw value: {"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSOUI4MTFCQjYyNTYyNTFBQzAyAA==","status":"sent","timestamp":"1751477153","recipient_id":"917082156227","conversation":{"id":"010945abee961f75eb3fabd31f6a0e1d","expiration_timestamp":"1751477153","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-07-02 22:55:50.633 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:55:50.637 +05:30 [INF] Request finished HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 26.353ms
2025-07-02 22:55:50.637 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__messageId_0='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSOUI4MTFCQjYyNTYyNTFBQzAyAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."MessageId" = @__messageId_0
LIMIT 1
2025-07-02 22:55:50.655 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__logId_Value_0='7af8335c-6b3b-4e49-a962-4390c4caf168'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."Id" = @__logId_Value_0
LIMIT 1
2025-07-02 22:55:50.659 +05:30 [INF] ✅ CampaignSendLog updated for MessageId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSOUI4MTFCQjYyNTYyNTFBQzAyAA== → sent
2025-07-02 22:55:51.704 +05:30 [INF] Request starting HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - application/json 571
2025-07-02 22:55:51.708 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:55:51.710 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-07-02 22:55:51.712 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSOUI4MTFCQjYyNTYyNTFBQzAyAA==","status":"delivered","timestamp":"1751477154","recipient_id":"917082156227","conversation":{"id":"010945abee961f75eb3fabd31f6a0e1d","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-07-02 22:55:51.716 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-07-02 22:55:51.716 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSOUI4MTFCQjYyNTYyNTFBQzAyAA==","status":"delivered","timestamp":"1751477154","recipient_id":"917082156227","conversation":{"id":"010945abee961f75eb3fabd31f6a0e1d","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-07-02 22:55:51.717 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType73`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:55:51.719 +05:30 [INF] 📦 Routing to Status Processor
2025-07-02 22:55:51.720 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 8.5194ms
2025-07-02 22:55:51.722 +05:30 [WRN] 🔍 Incoming timestamp raw value: {"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSOUI4MTFCQjYyNTYyNTFBQzAyAA==","status":"delivered","timestamp":"1751477154","recipient_id":"917082156227","conversation":{"id":"010945abee961f75eb3fabd31f6a0e1d","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-07-02 22:55:51.724 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:55:51.727 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__messageId_0='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSOUI4MTFCQjYyNTYyNTFBQzAyAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."MessageId" = @__messageId_0
LIMIT 1
2025-07-02 22:55:51.728 +05:30 [INF] Request finished HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 24.0001ms
2025-07-02 22:55:51.737 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__logId_Value_0='7af8335c-6b3b-4e49-a962-4390c4caf168'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."Id" = @__logId_Value_0
LIMIT 1
2025-07-02 22:55:51.763 +05:30 [INF] Executed DbCommand (20ms) [Parameters=[@p2='7af8335c-6b3b-4e49-a962-4390c4caf168', @p0='2025-07-02T17:25:54.0000000Z' (Nullable = true) (DbType = DateTime), @p1='Delivered'], CommandType='"Text"', CommandTimeout='30']
UPDATE "CampaignSendLogs" SET "DeliveredAt" = @p0, "SendStatus" = @p1
WHERE "Id" = @p2;
2025-07-02 22:55:51.768 +05:30 [INF] ✅ CampaignSendLog updated for MessageId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSOUI4MTFCQjYyNTYyNTFBQzAyAA== → delivered
2025-07-02 22:56:11.572 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/campaigns/analytics/:campaignId/summary - null null
2025-07-02 22:56:11.579 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:56:11.580 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CampaignTracking.Controllers.CampaignAnalyticsController.GetSummary (xbytechat.api)'
2025-07-02 22:56:11.593 +05:30 [INF] Route matched with {action = "GetSummary", controller = "CampaignAnalytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[xbytechat.api.Features.CampaignTracking.DTOs.CampaignStatusDashboardDto]] GetSummary(System.Guid) on controller xbytechat.api.Features.CampaignTracking.Controllers.CampaignAnalyticsController (xbytechat.api).
2025-07-02 22:56:11.602 +05:30 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-07-02 22:56:11.627 +05:30 [INF] Executed action xbytechat.api.Features.CampaignTracking.Controllers.CampaignAnalyticsController.GetSummary (xbytechat.api) in 31.2489ms
2025-07-02 22:56:11.629 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CampaignTracking.Controllers.CampaignAnalyticsController.GetSummary (xbytechat.api)'
2025-07-02 22:56:11.631 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/campaigns/analytics/:campaignId/summary - 400 null application/problem+json; charset=utf-8 59.3261ms
2025-07-02 22:56:31.572 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null null
2025-07-02 22:56:31.581 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/inbox/unread-counts - null null
2025-07-02 22:56:31.578 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/contacts/all - null null
2025-07-02 22:56:31.595 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null null
2025-07-02 22:56:31.601 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:56:31.604 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:56:31.612 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:56:31.615 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Inbox.Controllers.InboxController.GetUnreadCounts (xbytechat.api)'
2025-07-02 22:56:31.627 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 204 null null 31.4142ms
2025-07-02 22:56:31.633 +05:30 [INF] Route matched with {action = "GetUnreadCounts", controller = "Inbox"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUnreadCounts() on controller xbytechat.api.Features.Inbox.Controllers.InboxController (xbytechat.api).
2025-07-02 22:56:31.614 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 204 null null 42.1618ms
2025-07-02 22:56:31.609 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:56:31.619 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null 0
2025-07-02 22:56:31.633 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - null 0
2025-07-02 22:56:31.646 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__userId_0='2870e1d8-0e80-4b12-88bd-70a8113307d6'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."BusinessId", c."ContactId", c."LastReadAt", c."UserId"
FROM "ContactReads" AS c
WHERE c."UserId" = @__userId_0
2025-07-02 22:56:31.657 +05:30 [INF] Executing endpoint 'xbytechat.api.CRM.Controllers.ContactsController.GetAllContactsFlat (xbytechat.api)'
2025-07-02 22:56:31.660 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:56:31.669 +05:30 [INF] Route matched with {action = "GetAllContactsFlat", controller = "Contacts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllContactsFlat() on controller xbytechat.api.CRM.Controllers.ContactsController (xbytechat.api).
2025-07-02 22:56:31.664 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:56:31.672 +05:30 [INF] Executing endpoint '/hubs/inbox/negotiate'
2025-07-02 22:56:31.670 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."CreatedAt", m."ErrorMessage", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."IsIncoming" AND m."ContactId" IS NOT NULL
2025-07-02 22:56:33.220 +05:30 [INF] GetAllContactsAsync: businessId="c13be597-6ae2-42bb-9d43-925815f24ff8", tab=all
2025-07-02 22:56:33.222 +05:30 [INF] Executed endpoint '/hubs/inbox/negotiate'
2025-07-02 22:56:33.232 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/hubs/inbox?id=FuM7wUEO_cl-fCQSUPGobg - null null
2025-07-02 22:56:33.236 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."Tags", t0."Id", t0."AssignedAt", t0."AssignedBy", t0."BusinessId", t0."ContactId", t0."TagId", t0."Id0", t0."BusinessId0", t0."Category", t0."ColorHex", t0."CreatedAt", t0."IsActive", t0."IsSystemTag", t0."LastUsedAt", t0."Name", t0."Notes"
FROM "Contacts" AS c
LEFT JOIN (
    SELECT c0."Id", c0."AssignedAt", c0."AssignedBy", c0."BusinessId", c0."ContactId", c0."TagId", t."Id" AS "Id0", t."BusinessId" AS "BusinessId0", t."Category", t."ColorHex", t."CreatedAt", t."IsActive", t."IsSystemTag", t."LastUsedAt", t."Name", t."Notes"
    FROM "ContactTags" AS c0
    INNER JOIN "Tags" AS t ON c0."TagId" = t."Id"
) AS t0 ON c."Id" = t0."ContactId"
WHERE c."BusinessId" = @__businessId_0 AND c."IsActive"
ORDER BY c."Id", t0."Id"
2025-07-02 22:56:33.236 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 200 316 application/json 1617.0252ms
2025-07-02 22:56:33.221 +05:30 [INF] Executing endpoint '/hubs/inbox/negotiate'
2025-07-02 22:56:33.227 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.Dictionary`2[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:56:33.241 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:56:33.244 +05:30 [INF] GetAllContactsAsync returned 7 contacts
2025-07-02 22:56:33.251 +05:30 [INF] Executed endpoint '/hubs/inbox/negotiate'
2025-07-02 22:56:33.253 +05:30 [INF] Executed action xbytechat.api.Features.Inbox.Controllers.InboxController.GetUnreadCounts (xbytechat.api) in 1610.6493ms
2025-07-02 22:56:33.254 +05:30 [INF] Executing endpoint '/hubs/inbox'
2025-07-02 22:56:33.256 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+SelectListIterator`2[[xbytechat.api.CRM.Models.Contact, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[xbytechat.api.CRM.Dtos.ContactDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 22:56:33.257 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/hubs/inbox/negotiate?negotiateVersion=1 - 200 316 application/json 1623.998ms
2025-07-02 22:56:33.266 +05:30 [INF] Executed action xbytechat.api.CRM.Controllers.ContactsController.GetAllContactsFlat (xbytechat.api) in 1592.1667ms
2025-07-02 22:56:33.259 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Inbox.Controllers.InboxController.GetUnreadCounts (xbytechat.api)'
2025-07-02 22:56:33.273 +05:30 [INF] Executed endpoint 'xbytechat.api.CRM.Controllers.ContactsController.GetAllContactsFlat (xbytechat.api)'
2025-07-02 22:56:33.274 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/hubs/inbox?id=844CNLYcagCirr81lmE2UQ - null null
2025-07-02 22:56:33.275 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/inbox/unread-counts - 200 null application/json; charset=utf-8 1694.7196ms
2025-07-02 22:56:33.277 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/contacts/all - 200 null application/json; charset=utf-8 1699.3181ms
2025-07-02 22:56:33.281 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:56:33.291 +05:30 [INF] Executing endpoint '/hubs/inbox'
2025-07-02 22:56:36.807 +05:30 [INF] Executed endpoint '/hubs/inbox'
2025-07-02 22:56:36.807 +05:30 [INF] Executed endpoint '/hubs/inbox'
2025-07-02 22:56:36.809 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/hubs/inbox?id=844CNLYcagCirr81lmE2UQ - 101 null null 3534.8836ms
2025-07-02 22:56:36.811 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/hubs/inbox?id=FuM7wUEO_cl-fCQSUPGobg - 101 null null 3579.4182ms
2025-07-02 22:56:52.723 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/WhatsAppTemplateFetcher/get-template-all - null null
2025-07-02 22:56:52.736 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:56:52.739 +05:30 [INF] Executing endpoint 'xbytechat_api.WhatsAppSettings.Controllers.WhatsAppTemplateFetcherController.GetAllTemplatesAsync (xbytechat.api)'
2025-07-02 22:56:52.741 +05:30 [INF] Route matched with {action = "GetAllTemplates", controller = "WhatsAppTemplateFetcher"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllTemplatesAsync() on controller xbytechat_api.WhatsAppSettings.Controllers.WhatsAppTemplateFetcherController (xbytechat.api).
2025-07-02 22:56:52.746 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiToken", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."IsActive"
2025-07-02 22:56:52.753 +05:30 [INF] Start processing HTTP request GET https://graph.facebook.com/v22.0/999432368375320/message_templates
2025-07-02 22:56:52.755 +05:30 [INF] Sending HTTP request GET https://graph.facebook.com/v22.0/999432368375320/message_templates
2025-07-02 22:56:53.480 +05:30 [INF] Received HTTP response headers after 722.3319ms - 200
2025-07-02 22:56:53.482 +05:30 [INF] End processing HTTP request after 728.6804ms - 200
2025-07-02 22:56:53.485 +05:30 [INF] 📦 Meta Template API Raw JSON for "c13be597-6ae2-42bb-9d43-925815f24ff8":
{"data":[{"name":"flow_step_4","parameter_format":"POSITIONAL","components":[{"type":"HEADER","format":"TEXT","text":"Step -4"},{"type":"BODY","text":"Would you like pricing details for your selected product?"},{"type":"BUTTONS","buttons":[{"type":"QUICK_REPLY","text":"Send Pricing"},{"type":"QUICK_REPLY","text":"Back to Products"}]}],"language":"en_US","status":"APPROVED","category":"MARKETING","sub_category":"CUSTOM","id":"710642074690811"},{"name":"imagecampaign","parameter_format":"POSITIONAL","components":[{"type":"HEADER","format":"IMAGE","example":{"header_handle":["https:\/\/scontent.whatsapp.net\/v\/t61.29466-34\/505192710_1239512614060917_4344497973514528434_n.png?ccb=1-7&_nc_sid=8b1bef&_nc_ohc=UW_i0L8_Rd4Q7kNvwHfGoSj&_nc_oc=AdmsRdP_Vob8A9D75ZGaRPUrrXzVTzYEMjdeP-rk5G6BjPbbOxWkpRoCnYU73XvswpIhs1_0RASHvYocrmz-liXh&_nc_zt=3&_nc_ht=scontent.whatsapp.net&edm=AH51TzQEAAAA&_nc_gid=8y_GydYj-Y7vUsHma1tFWw&oh=01_Q5Aa1wE0m82rV7gPAiAPiwyWb_j8eaL9f8W2x0hdWdyrm1GTbQ&oe=688CC2E3"]}},{"type":"BODY","text":"Hello,\nWe\u2019re excited to announce that we\u2019re launching some amazing new products at [Your Company Name]! \ud83d\ude80\n\nBe the first to check them out and grab special launch offers!\nIf you\u2019re interested, reply to this message or click here:"},{"type":"BUTTONS","buttons":[{"type":"URL","text":"Visit website","url":"https:\/\/www.myntra.com\/men-sweatshirts"},{"type":"PHONE_NUMBER","text":"Call Us","phone_number":"+918765436785"}]}],"language":"en_US","status":"APPROVED","category":"MARKETING","sub_category":"CUSTOM","id":"1239512610727584"},{"name":"flow_step_2","parameter_format":"POSITIONAL","components":[{"type":"HEADER","format":"TEXT","text":"Step -2"},{"type":"BODY","text":"Here's our latest deal. Want to see more options?"},{"type":"BUTTONS","buttons":[{"type":"QUICK_REPLY","text":"More Options"},{"type":"PHONE_NUMBER","text":"Talk to Support","phone_number":"+917082156227"}]}],"language":"en_US","status":"APPROVED","category":"MARKETING","id":"721245346987995"},{"name":"flow_step_1","parameter_format":"POSITIONAL","components":[{"type":"BODY","text":"Hi \ud83d\udc4b, would you like to explore our special offer?"},{"type":"BUTTONS","buttons":[{"type":"QUICK_REPLY","text":"Yes, show me"},{"type":"QUICK_REPLY","text":"No, thanks"}]}],"language":"en_US","status":"APPROVED","category":"MARKETING","sub_category":"CUSTOM","id":"720586043866779"},{"name":"hello_world","parameter_format":"POSITIONAL","components":[{"type":"HEADER","format":"TEXT","text":"Hello World"},{"type":"BODY","text":"Welcome and congratulations!! This message demonstrates your ability to send a WhatsApp message notification from the Cloud API, hosted by Meta. Thank you for taking the time to test with us."},{"type":"FOOTER","text":"WhatsApp Business Platform sample message"}],"language":"en_US","status":"APPROVED","category":"UTILITY","id":"1726067301662421"},{"name":"flow_step_6","parameter_format":"POSITIONAL","components":[{"type":"HEADER","format":"TEXT","text":"Step -6"},{"type":"BODY","text":"Here's what our happy customers say. Would you like to read reviews?"},{"type":"BUTTONS","buttons":[{"type":"QUICK_REPLY","text":"Show Reviews"},{"type":"QUICK_REPLY","text":"Skip"}]}],"language":"en_US","status":"APPROVED","category":"MARKETING","sub_category":"CUSTOM","id":"1919507328796848"},{"name":"flow_step_5","parameter_format":"POSITIONAL","components":[{"type":"HEADER","format":"TEXT","text":"Step =5"},{"type":"BODY","text":"Limited time discount available. Want to grab it now?"},{"type":"BUTTONS","buttons":[{"type":"QUICK_REPLY","text":"Claim Discount"},{"type":"QUICK_REPLY","text":"Not Now"}]}],"language":"en_US","status":"APPROVED","category":"MARKETING","sub_category":"CUSTOM","id":"1780686429496003"},{"name":"flow_step_3","parameter_format":"POSITIONAL","components":[{"type":"HEADER","format":"TEXT","text":"Step -3"},{"type":"BODY","text":"We have 3 amazing products for you. Want to check them out?"},{"type":"BUTTONS","buttons":[{"type":"QUICK_REPLY","text":"Show Products"},{"type":"QUICK_REPLY","text":"Skip"}]}],"language":"en_US","status":"APPROVED","category":"MARKETING","sub_category":"CUSTOM","id":"2154240945038413"},{"name":"flow_step_7","parameter_format":"POSITIONAL","components":[{"type":"HEADER","format":"TEXT","text":"Step -7"},{"type":"BODY","text":"Would you like to talk to our support team for custom guidance?"},{"type":"BUTTONS","buttons":[{"type":"QUICK_REPLY","text":"Talk to Agent"},{"type":"QUICK_REPLY","text":"Later"}]}],"language":"en_US","status":"APPROVED","category":"MARKETING","sub_category":"CUSTOM","id":"1390795521994729"},{"name":"back_to_restart","parameter_format":"POSITIONAL","components":[{"type":"HEADER","format":"TEXT","text":"Chat Restarted"},{"type":"BODY","text":"Your Process has restarted."},{"type":"BUTTONS","buttons":[{"type":"QUICK_REPLY","text":"Yes, show me"},{"type":"QUICK_REPLY","text":"No, thanks"}]}],"language":"en_US","status":"APPROVED","category":"MARKETING","sub_category":"CUSTOM","id":"2174325859705396"},{"name":"flow_step_10_","parameter_format":"POSITIONAL","components":[{"type":"HEADER","format":"TEXT","text":"Step -10"},{"type":"BODY","text":"Thanks for your interest! Would you like to give feedback?"},{"type":"BUTTONS","buttons":[{"type":"QUICK_REPLY","text":"Give Feedback"},{"type":"QUICK_REPLY","text":"End Chat"}]}],"language":"en_US","status":"APPROVED","category":"MARKETING","sub_category":"CUSTOM","id":"700742109026088"},{"name":"flow_step_9","parameter_format":"POSITIONAL","components":[{"type":"HEADER","format":"TEXT","text":"Step -9"},{"type":"BODY","text":"This is your final offer summary. Ready to proceed?"},{"type":"BUTTONS","buttons":[{"type":"QUICK_REPLY","text":"Proceed"},{"type":"QUICK_REPLY","text":"Restart"}]}],"language":"en_US","status":"APPROVED","category":"MARKETING","sub_category":"CUSTOM","id":"703808575467306"},{"name":"flow_step_8","parameter_format":"POSITIONAL","components":[{"type":"HEADER","format":"TEXT","text":"Step -8"},{"type":"BODY","text":"We can compare 2 products for you. Shall we continue?"},{"type":"BUTTONS","buttons":[{"type":"QUICK_REPLY","text":"Compare Now"},{"type":"QUICK_REPLY","text":"No, thanks"}]}],"language":"en","status":"APPROVED","category":"MARKETING","sub_category":"CUSTOM","id":"1399963891041518"}],"paging":{"cursors":{"before":"MAZDZD","after":"MjQZD"}}}
2025-07-02 22:56:53.489 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType64`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[TemplateForUIResponseDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:56:53.490 +05:30 [INF] Executed action xbytechat_api.WhatsAppSettings.Controllers.WhatsAppTemplateFetcherController.GetAllTemplatesAsync (xbytechat.api) in 747.1569ms
2025-07-02 22:56:53.492 +05:30 [INF] Executed endpoint 'xbytechat_api.WhatsAppSettings.Controllers.WhatsAppTemplateFetcherController.GetAllTemplatesAsync (xbytechat.api)'
2025-07-02 22:56:53.494 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/WhatsAppTemplateFetcher/get-template-all - 200 null application/json; charset=utf-8 770.8624ms
2025-07-02 22:57:11.171 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/api/campaign/create-text-campaign - null null
2025-07-02 22:57:11.177 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:57:11.178 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/api/campaign/create-text-campaign - 204 null null 7.2094ms
2025-07-02 22:57:11.221 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/api/campaign/create-text-campaign - application/json 381
2025-07-02 22:57:11.227 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:57:11.228 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.CreateTextCampaign (xbytechat.api)'
2025-07-02 22:57:11.230 +05:30 [INF] Route matched with {action = "CreateTextCampaign", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateTextCampaign(xbytechat.api.Features.CampaignModule.DTOs.CampaignCreateDto) on controller xbytechat.api.Features.CampaignModule.Controllers.CampaignController (xbytechat.api).
2025-07-02 22:57:12.461 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiToken", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."IsActive" AND w."BusinessId" = @__businessId_0
LIMIT 1
2025-07-02 22:57:12.467 +05:30 [INF] Start processing HTTP request GET https://graph.facebook.com/v22.0/999432368375320/message_templates
2025-07-02 22:57:12.470 +05:30 [INF] Sending HTTP request GET https://graph.facebook.com/v22.0/999432368375320/message_templates
2025-07-02 22:57:13.610 +05:30 [INF] Received HTTP response headers after 1138.8414ms - 200
2025-07-02 22:57:13.612 +05:30 [INF] End processing HTTP request after 1144.8387ms - 200
2025-07-02 22:57:13.620 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@p0='01ffa7dc-8f65-4328-88bc-8021808a1001', @p1='c13be597-6ae2-42bb-9d43-925815f24ff8', @p2=NULL (DbType = Guid), @p3='text', @p4='2025-07-02T17:27:13.6148923Z' (DbType = DateTime), @p5='system', @p6=NULL (DbType = Guid), @p7=NULL (DbType = DateTime), @p8=NULL, @p9=NULL, @p10=NULL, @p11=NULL, @p12='False', @p13='Hi 👋, would you like to explore our special offer?', @p14='flow_step_1' (Nullable = false), @p15='TestCampaignFollowUp' (Nullable = false), @p16=NULL (DbType = DateTime), @p17=NULL (DbType = Guid), @p18='Draft' (Nullable = false), @p19='flow_step_1', @p20='[]', @p21='2025-07-02T17:27:13.6148926Z' (DbType = DateTime), @p22='43c55698-3d05-4255-a0f3-70de6f611b85', @p23='01ffa7dc-8f65-4328-88bc-8021808a1001', @p24='True', @p25='2', @p26='No, thanks' (Nullable = false), @p27='QUICK_REPLY' (Nullable = false), @p28='' (Nullable = false), @p29='fdd4693f-39de-4b91-aa5b-b9c397ab0178', @p30='01ffa7dc-8f65-4328-88bc-8021808a1001', @p31='True', @p32='1', @p33='Yes, show me' (Nullable = false), @p34='QUICK_REPLY' (Nullable = false), @p35='' (Nullable = false)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Campaigns" ("Id", "BusinessId", "CampaignId", "CampaignType", "CreatedAt", "CreatedBy", "CtaId", "DeletedAt", "DeletedBy", "FollowUpTemplateId", "ImageCaption", "ImageUrl", "IsDeleted", "MessageBody", "MessageTemplate", "Name", "ScheduledAt", "SourceCampaignId", "Status", "TemplateId", "TemplateParameters", "UpdatedAt")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21);
INSERT INTO "CampaignButtons" ("Id", "CampaignId", "IsFromTemplate", "Position", "Title", "Type", "Value")
VALUES (@p22, @p23, @p24, @p25, @p26, @p27, @p28);
INSERT INTO "CampaignButtons" ("Id", "CampaignId", "IsFromTemplate", "Position", "Title", "Type", "Value")
VALUES (@p29, @p30, @p31, @p32, @p33, @p34, @p35);
2025-07-02 22:57:13.624 +05:30 [INF] ✅ Campaign 'TestCampaignFollowUp' created with 0 recipients, 0 user buttons, 2 template buttons and 0 template parameters
2025-07-02 22:57:13.627 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType20`3[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:57:13.629 +05:30 [INF] Executed action xbytechat.api.Features.CampaignModule.Controllers.CampaignController.CreateTextCampaign (xbytechat.api) in 2397.0522ms
2025-07-02 22:57:13.631 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.CreateTextCampaign (xbytechat.api)'
2025-07-02 22:57:13.633 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/api/campaign/create-text-campaign - 200 null application/json; charset=utf-8 2411.8001ms
2025-07-02 22:57:13.692 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/campaign/01ffa7dc-8f65-4328-88bc-8021808a1001 - null null
2025-07-02 22:57:13.692 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/tags - null null
2025-07-02 22:57:13.693 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/contacts?tab=all&page=1&pageSize=1000 - null null
2025-07-02 22:57:13.696 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:57:13.699 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:57:13.702 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:57:13.704 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetCampaignById (xbytechat.api)'
2025-07-02 22:57:13.705 +05:30 [INF] Executing endpoint 'xbytechat.api.CRM.Controllers.TagsController.GetAllTags (xbytechat.api)'
2025-07-02 22:57:13.706 +05:30 [INF] Executing endpoint 'xbytechat.api.CRM.Controllers.ContactsController.GetAllContacts (xbytechat.api)'
2025-07-02 22:57:13.707 +05:30 [INF] Route matched with {action = "GetCampaignById", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[xbytechat.api.Features.CampaignModule.DTOs.CampaignDto]] GetCampaignById(System.Guid) on controller xbytechat.api.Features.CampaignModule.Controllers.CampaignController (xbytechat.api).
2025-07-02 22:57:13.709 +05:30 [INF] Route matched with {action = "GetAllTags", controller = "Tags"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllTags() on controller xbytechat.api.CRM.Controllers.TagsController (xbytechat.api).
2025-07-02 22:57:13.717 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__campaignId_0='01ffa7dc-8f65-4328-88bc-8021808a1001', @__businessId_1='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."BusinessId", t."CampaignId", t."CampaignType", t."CreatedAt", t."CreatedBy", t."CtaId", t."DeletedAt", t."DeletedBy", t."FollowUpTemplateId", t."ImageCaption", t."ImageUrl", t."IsDeleted", t."MessageBody", t."MessageTemplate", t."Name", t."ScheduledAt", t."SourceCampaignId", t."Status", t."TemplateId", t."TemplateParameters", t."UpdatedAt", t."Id0", t."BusinessId0", t."ButtonText", t."ButtonType", t."CreatedAt0", t."Description", t."IsActive", t."TargetUrl", t."Title", t."UpdatedAt0", c1."Id", c1."CampaignId", c1."IsFromTemplate", c1."Position", c1."Title", c1."Type", c1."Value"
FROM (
    SELECT c."Id", c."BusinessId", c."CampaignId", c."CampaignType", c."CreatedAt", c."CreatedBy", c."CtaId", c."DeletedAt", c."DeletedBy", c."FollowUpTemplateId", c."ImageCaption", c."ImageUrl", c."IsDeleted", c."MessageBody", c."MessageTemplate", c."Name", c."ScheduledAt", c."SourceCampaignId", c."Status", c."TemplateId", c."TemplateParameters", c."UpdatedAt", c0."Id" AS "Id0", c0."BusinessId" AS "BusinessId0", c0."ButtonText", c0."ButtonType", c0."CreatedAt" AS "CreatedAt0", c0."Description", c0."IsActive", c0."TargetUrl", c0."Title", c0."UpdatedAt" AS "UpdatedAt0"
    FROM "Campaigns" AS c
    LEFT JOIN "CTADefinitions" AS c0 ON c."CtaId" = c0."Id"
    WHERE c."Id" = @__campaignId_0 AND c."BusinessId" = @__businessId_1
    LIMIT 1
) AS t
LEFT JOIN "CampaignButtons" AS c1 ON t."Id" = c1."CampaignId"
ORDER BY t."Id", t."Id0"
2025-07-02 22:57:13.710 +05:30 [INF] Route matched with {action = "GetAllContacts", controller = "Contacts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllContacts(System.String, Int32, Int32) on controller xbytechat.api.CRM.Controllers.ContactsController (xbytechat.api).
2025-07-02 22:57:13.728 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Features.CampaignModule.DTOs.CampaignDto'.
2025-07-02 22:57:13.730 +05:30 [INF] GetPagedContactsAsync: businessId="c13be597-6ae2-42bb-9d43-925815f24ff8", tab=all, page=1, pageSize=1000
2025-07-02 22:57:13.733 +05:30 [INF] Executed action xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetCampaignById (xbytechat.api) in 21.1034ms
2025-07-02 22:57:13.739 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Contacts" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."IsActive"
2025-07-02 22:57:13.741 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetCampaignById (xbytechat.api)'
2025-07-02 22:57:13.749 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/campaign/01ffa7dc-8f65-4328-88bc-8021808a1001 - 200 null application/json; charset=utf-8 56.7668ms
2025-07-02 22:57:13.750 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__p_2='100', @__p_1='0'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."AssignedAgentId", t."BusinessId", t."CreatedAt", t."Email", t."Group", t."IsActive", t."IsArchived", t."IsAutomationPaused", t."IsFavorite", t."LastCTAInteraction", t."LastCTAType", t."LastClickedProductId", t."LastContactedAt", t."LeadSource", t."Name", t."NextFollowUpAt", t."Notes", t."PhoneNumber", t."Tags", t0."Id", t0."AssignedAt", t0."AssignedBy", t0."BusinessId", t0."ContactId", t0."TagId", t0."Id0", t0."BusinessId0", t0."Category", t0."ColorHex", t0."CreatedAt", t0."IsActive", t0."IsSystemTag", t0."LastUsedAt", t0."Name", t0."Notes"
FROM (
    SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."Tags"
    FROM "Contacts" AS c
    WHERE c."BusinessId" = @__businessId_0 AND c."IsActive"
    ORDER BY c."Name"
    LIMIT @__p_2 OFFSET @__p_1
) AS t
LEFT JOIN (
    SELECT c0."Id", c0."AssignedAt", c0."AssignedBy", c0."BusinessId", c0."ContactId", c0."TagId", t1."Id" AS "Id0", t1."BusinessId" AS "BusinessId0", t1."Category", t1."ColorHex", t1."CreatedAt", t1."IsActive", t1."IsSystemTag", t1."LastUsedAt", t1."Name", t1."Notes"
    FROM "ContactTags" AS c0
    INNER JOIN "Tags" AS t1 ON c0."TagId" = t1."Id"
) AS t0 ON t."Id" = t0."ContactId"
ORDER BY t."Name", t."Id", t0."Id"
2025-07-02 22:57:13.759 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Helpers.ResponseResult'.
2025-07-02 22:57:13.762 +05:30 [INF] Executed action xbytechat.api.CRM.Controllers.ContactsController.GetAllContacts (xbytechat.api) in 32.5132ms
2025-07-02 22:57:13.764 +05:30 [INF] Executed endpoint 'xbytechat.api.CRM.Controllers.ContactsController.GetAllContacts (xbytechat.api)'
2025-07-02 22:57:13.766 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/contacts?tab=all&page=1&pageSize=1000 - 200 null application/json; charset=utf-8 73.4539ms
2025-07-02 22:57:13.827 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."Name", t."ColorHex", t."Category", t."Notes", t."IsSystemTag", t."IsActive", t."CreatedAt", t."LastUsedAt"
FROM "Tags" AS t
WHERE t."BusinessId" = @__businessId_0 AND t."IsActive"
ORDER BY t."CreatedAt" DESC
2025-07-02 22:57:13.831 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Helpers.ResponseResult'.
2025-07-02 22:57:13.833 +05:30 [INF] Executed action xbytechat.api.CRM.Controllers.TagsController.GetAllTags (xbytechat.api) in 114.1025ms
2025-07-02 22:57:13.834 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/tags - null null
2025-07-02 22:57:13.835 +05:30 [INF] Executed endpoint 'xbytechat.api.CRM.Controllers.TagsController.GetAllTags (xbytechat.api)'
2025-07-02 22:57:13.838 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:57:13.840 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/tags - 200 null application/json; charset=utf-8 148.166ms
2025-07-02 22:57:13.842 +05:30 [INF] Executing endpoint 'xbytechat.api.CRM.Controllers.TagsController.GetAllTags (xbytechat.api)'
2025-07-02 22:57:13.847 +05:30 [INF] Route matched with {action = "GetAllTags", controller = "Tags"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllTags() on controller xbytechat.api.CRM.Controllers.TagsController (xbytechat.api).
2025-07-02 22:57:13.854 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."Name", t."ColorHex", t."Category", t."Notes", t."IsSystemTag", t."IsActive", t."CreatedAt", t."LastUsedAt"
FROM "Tags" AS t
WHERE t."BusinessId" = @__businessId_0 AND t."IsActive"
ORDER BY t."CreatedAt" DESC
2025-07-02 22:57:13.859 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Helpers.ResponseResult'.
2025-07-02 22:57:13.860 +05:30 [INF] Executed action xbytechat.api.CRM.Controllers.TagsController.GetAllTags (xbytechat.api) in 10.3716ms
2025-07-02 22:57:13.863 +05:30 [INF] Executed endpoint 'xbytechat.api.CRM.Controllers.TagsController.GetAllTags (xbytechat.api)'
2025-07-02 22:57:13.864 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/tags - 200 null application/json; charset=utf-8 29.9217ms
2025-07-02 22:57:22.331 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/api/campaign/01ffa7dc-8f65-4328-88bc-8021808a1001/assign-contacts - null null
2025-07-02 22:57:22.334 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:57:22.335 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/api/campaign/01ffa7dc-8f65-4328-88bc-8021808a1001/assign-contacts - 204 null null 4.4643ms
2025-07-02 22:57:22.337 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/api/campaign/01ffa7dc-8f65-4328-88bc-8021808a1001/assign-contacts - application/json 55
2025-07-02 22:57:22.342 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:57:22.344 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.AssignContactsToCampaign (xbytechat.api)'
2025-07-02 22:57:22.345 +05:30 [INF] Route matched with {action = "AssignContactsToCampaign", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AssignContactsToCampaign(System.Guid, xbytechat.api.Features.CampaignModule.DTOs.AssignContactsDto) on controller xbytechat.api.Features.CampaignModule.Controllers.CampaignController (xbytechat.api).
2025-07-02 22:57:25.338 +05:30 [INF] Executed DbCommand (5ms) [Parameters=[@__campaignId_0='01ffa7dc-8f65-4328-88bc-8021808a1001', @__businessId_1='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."BusinessId", t."CampaignId", t."CampaignType", t."CreatedAt", t."CreatedBy", t."CtaId", t."DeletedAt", t."DeletedBy", t."FollowUpTemplateId", t."ImageCaption", t."ImageUrl", t."IsDeleted", t."MessageBody", t."MessageTemplate", t."Name", t."ScheduledAt", t."SourceCampaignId", t."Status", t."TemplateId", t."TemplateParameters", t."UpdatedAt", c0."Id", c0."BotId", c0."BusinessId", c0."CampaignId", c0."CategoryBrowsed", c0."ClickedCTA", c0."ContactId", c0."IsAutoTagged", c0."MessagePreview", c0."ProductBrowsed", c0."SentAt", c0."Status", c0."UpdatedAt"
FROM (
    SELECT c."Id", c."BusinessId", c."CampaignId", c."CampaignType", c."CreatedAt", c."CreatedBy", c."CtaId", c."DeletedAt", c."DeletedBy", c."FollowUpTemplateId", c."ImageCaption", c."ImageUrl", c."IsDeleted", c."MessageBody", c."MessageTemplate", c."Name", c."ScheduledAt", c."SourceCampaignId", c."Status", c."TemplateId", c."TemplateParameters", c."UpdatedAt"
    FROM "Campaigns" AS c
    WHERE c."Id" = @__campaignId_0 AND c."BusinessId" = @__businessId_1
    LIMIT 1
) AS t
LEFT JOIN "CampaignRecipients" AS c0 ON t."Id" = c0."CampaignId"
ORDER BY t."Id"
2025-07-02 22:57:25.361 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@p0='04e49bed-37c7-4d7f-bf61-bd21880d715e', @p1=NULL, @p2='c13be597-6ae2-42bb-9d43-925815f24ff8', @p3='01ffa7dc-8f65-4328-88bc-8021808a1001', @p4=NULL, @p5=NULL, @p6='8aac7c57-6699-4511-897b-4121b407eb1c', @p7='False', @p8=NULL, @p9=NULL, @p10='2025-07-02T17:27:25.3580953Z' (Nullable = true) (DbType = DateTime), @p11='Pending' (Nullable = false), @p12='2025-07-02T17:27:25.3580956Z' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "CampaignRecipients" ("Id", "BotId", "BusinessId", "CampaignId", "CategoryBrowsed", "ClickedCTA", "ContactId", "IsAutoTagged", "MessagePreview", "ProductBrowsed", "SentAt", "Status", "UpdatedAt")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12);
2025-07-02 22:57:25.364 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType16`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:57:25.365 +05:30 [INF] Executed action xbytechat.api.Features.CampaignModule.Controllers.CampaignController.AssignContactsToCampaign (xbytechat.api) in 3018.4427ms
2025-07-02 22:57:25.368 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.AssignContactsToCampaign (xbytechat.api)'
2025-07-02 22:57:25.370 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/api/campaign/01ffa7dc-8f65-4328-88bc-8021808a1001/assign-contacts - 200 null application/json; charset=utf-8 3032.9886ms
2025-07-02 22:57:38.269 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/campaign/get-image-campaign - null null
2025-07-02 22:57:38.274 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:57:38.277 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetAll (xbytechat.api)'
2025-07-02 22:57:38.281 +05:30 [INF] Route matched with {action = "GetAll", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAll(System.String) on controller xbytechat.api.Features.CampaignModule.Controllers.CampaignController (xbytechat.api).
2025-07-02 22:57:38.293 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Name", c."Status", c."ScheduledAt", c."CreatedAt", c."ImageUrl", c."ImageCaption", c0."Title" AS "CtaTitle", (
    SELECT count(*)::int
    FROM "CampaignRecipients" AS c1
    WHERE c."Id" = c1."CampaignId") AS "RecipientCount"
FROM "Campaigns" AS c
LEFT JOIN "CTADefinitions" AS c0 ON c."CtaId" = c0."Id"
WHERE c."BusinessId" = @__businessId_0
ORDER BY c."CreatedAt" DESC
2025-07-02 22:57:38.297 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.CampaignModule.DTOs.CampaignSummaryDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 22:57:38.299 +05:30 [INF] Executed action xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetAll (xbytechat.api) in 13.9826ms
2025-07-02 22:57:38.301 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetAll (xbytechat.api)'
2025-07-02 22:57:38.303 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/campaign/get-image-campaign - 200 null application/json; charset=utf-8 33.7553ms
2025-07-02 22:57:43.108 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/api/campaign/send-campaign/01ffa7dc-8f65-4328-88bc-8021808a1001 - null 0
2025-07-02 22:57:43.114 +05:30 [INF] CORS policy execution successful.
2025-07-02 22:57:43.116 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.SendTemplateCampaign (xbytechat.api)'
2025-07-02 22:57:43.117 +05:30 [INF] Route matched with {action = "SendTemplateCampaign", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendTemplateCampaign(System.Guid) on controller xbytechat.api.Features.CampaignModule.Controllers.CampaignController (xbytechat.api).
2025-07-02 22:57:43.124 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__campaignId_0='01ffa7dc-8f65-4328-88bc-8021808a1001'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."BusinessId", t."CampaignId", t."CampaignType", t."CreatedAt", t."CreatedBy", t."CtaId", t."DeletedAt", t."DeletedBy", t."FollowUpTemplateId", t."ImageCaption", t."ImageUrl", t."IsDeleted", t."MessageBody", t."MessageTemplate", t."Name", t."ScheduledAt", t."SourceCampaignId", t."Status", t."TemplateId", t."TemplateParameters", t."UpdatedAt", t0."Id", t0."BotId", t0."BusinessId", t0."CampaignId", t0."CategoryBrowsed", t0."ClickedCTA", t0."ContactId", t0."IsAutoTagged", t0."MessagePreview", t0."ProductBrowsed", t0."SentAt", t0."Status", t0."UpdatedAt", t0."Id0", t0."AssignedAgentId", t0."BusinessId0", t0."CreatedAt", t0."Email", t0."Group", t0."IsActive", t0."IsArchived", t0."IsAutomationPaused", t0."IsFavorite", t0."LastCTAInteraction", t0."LastCTAType", t0."LastClickedProductId", t0."LastContactedAt", t0."LeadSource", t0."Name", t0."NextFollowUpAt", t0."Notes", t0."PhoneNumber", t0."Tags", c2."Id", c2."CampaignId", c2."IsFromTemplate", c2."Position", c2."Title", c2."Type", c2."Value"
FROM (
    SELECT c."Id", c."BusinessId", c."CampaignId", c."CampaignType", c."CreatedAt", c."CreatedBy", c."CtaId", c."DeletedAt", c."DeletedBy", c."FollowUpTemplateId", c."ImageCaption", c."ImageUrl", c."IsDeleted", c."MessageBody", c."MessageTemplate", c."Name", c."ScheduledAt", c."SourceCampaignId", c."Status", c."TemplateId", c."TemplateParameters", c."UpdatedAt"
    FROM "Campaigns" AS c
    WHERE c."Id" = @__campaignId_0 AND NOT (c."IsDeleted")
    LIMIT 1
) AS t
LEFT JOIN (
    SELECT c0."Id", c0."BotId", c0."BusinessId", c0."CampaignId", c0."CategoryBrowsed", c0."ClickedCTA", c0."ContactId", c0."IsAutoTagged", c0."MessagePreview", c0."ProductBrowsed", c0."SentAt", c0."Status", c0."UpdatedAt", c1."Id" AS "Id0", c1."AssignedAgentId", c1."BusinessId" AS "BusinessId0", c1."CreatedAt", c1."Email", c1."Group", c1."IsActive", c1."IsArchived", c1."IsAutomationPaused", c1."IsFavorite", c1."LastCTAInteraction", c1."LastCTAType", c1."LastClickedProductId", c1."LastContactedAt", c1."LeadSource", c1."Name", c1."NextFollowUpAt", c1."Notes", c1."PhoneNumber", c1."Tags"
    FROM "CampaignRecipients" AS c0
    INNER JOIN "Contacts" AS c1 ON c0."ContactId" = c1."Id"
) AS t0 ON t."Id" = t0."CampaignId"
LEFT JOIN "CampaignButtons" AS c2 ON t."Id" = c2."CampaignId"
ORDER BY t."Id", t0."Id", t0."Id0"
2025-07-02 22:57:43.132 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiToken", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."IsActive" AND w."BusinessId" = @__businessId_0
LIMIT 1
2025-07-02 22:57:43.136 +05:30 [INF] Start processing HTTP request GET https://graph.facebook.com/v22.0/999432368375320/message_templates
2025-07-02 22:57:43.138 +05:30 [INF] Sending HTTP request GET https://graph.facebook.com/v22.0/999432368375320/message_templates
2025-07-02 22:57:44.066 +05:30 [INF] Received HTTP response headers after 926.3202ms - 200
2025-07-02 22:57:44.068 +05:30 [INF] End processing HTTP request after 931.8287ms - 200
2025-07-02 22:57:44.070 +05:30 [INF] 📨 Preparing to send to +917082156227
2025-07-02 22:57:44.071 +05:30 [INF] ⏩ Skipping static button 'No, thanks' as it requires no parameters
2025-07-02 22:57:44.073 +05:30 [INF] ⏩ Skipping static button 'Yes, show me' as it requires no parameters
2025-07-02 22:57:44.075 +05:30 [INF] Start processing HTTP request POST https://graph.facebook.com/v22.0/601884673011340/messages
2025-07-02 22:57:44.078 +05:30 [INF] Sending HTTP request POST https://graph.facebook.com/v22.0/601884673011340/messages
2025-07-02 22:57:45.601 +05:30 [INF] Received HTTP response headers after 1521.5596ms - 200
2025-07-02 22:57:45.605 +05:30 [INF] End processing HTTP request after 1529.4993ms - 200
2025-07-02 22:57:45.611 +05:30 [INF] 📬 Send result: {"Success":true,"Message":"✅ Message sent successfully","Data":null,"ErrorMessage":null,"RawResponse":"{\"messaging_product\":\"whatsapp\",\"contacts\":[{\"input\":\"+917082156227\",\"wa_id\":\"917082156227\"}],\"messages\":[{\"id\":\"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSRUZCNzJDRTYwMERCMDEzMTEyAA==\",\"message_status\":\"accepted\"}]}","MessageId":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSRUZCNzJDRTYwMERCMDEzMTEyAA==","LogId":null,"Token":null,"RefreshToken":null}
2025-07-02 22:57:45.613 +05:30 [INF] ✅ Added MessageLog for +917082156227
2025-07-02 22:57:45.614 +05:30 [INF] 📘 Added CampaignSendLog for recipient "04e49bed-37c7-4d7f-bf61-bd21880d715e"
2025-07-02 22:57:45.616 +05:30 [INF] 💾 Saving all DB changes...
2025-07-02 22:57:45.622 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@p0='8163cf8b-45dc-4ff1-9db6-f870e1cf2ee4', @p1='c13be597-6ae2-42bb-9d43-925815f24ff8', @p2=NULL (DbType = Guid), @p3=NULL (DbType = Guid), @p4='01ffa7dc-8f65-4328-88bc-8021808a1001' (Nullable = true), @p5='8aac7c57-6699-4511-897b-4121b407eb1c' (Nullable = true), @p6='2025-07-02T17:27:45.6128112Z' (DbType = DateTime), @p7=NULL, @p8='False', @p9=NULL, @p10='flow_step_1' (Nullable = false), @p11='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSRUZCNzJDRTYwMERCMDEzMTEyAA==', @p12='{"messaging_product":"whatsapp","contacts":[{"input":"+917082156227","wa_id":"917082156227"}],"messages":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSRUZCNzJDRTYwMERCMDEzMTEyAA==","message_status":"accepted"}]}', @p13='+917082156227' (Nullable = false), @p14=NULL (DbType = Guid), @p15=NULL, @p16='2025-07-02T17:27:45.6128115Z' (Nullable = true) (DbType = DateTime), @p17=NULL, @p18='Sent' (Nullable = false), @p19='c2796b7b-3a0c-4600-9fa3-8dc273109ff4', @p20='True', @p21=NULL, @p22='00000000-0000-0000-0000-000000000000', @p23='01ffa7dc-8f65-4328-88bc-8021808a1001', @p24=NULL, @p25=NULL, @p26=NULL (DbType = DateTime), @p27='8aac7c57-6699-4511-897b-4121b407eb1c', @p28=NULL, @p29='2025-07-02T17:27:45.6142860Z' (DbType = DateTime), @p30='system', @p31=NULL (DbType = DateTime), @p32=NULL, @p33=NULL, @p34=NULL, @p35=NULL, @p36='False', @p37=NULL (DbType = DateTime), @p38=NULL, @p39=NULL, @p40='Hi 👋, would you like to explore our special offer?' (Nullable = false), @p41='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSRUZCNzJDRTYwMERCMDEzMTEyAA==', @p42='8163cf8b-45dc-4ff1-9db6-f870e1cf2ee4' (Nullable = true), @p43=NULL (DbType = DateTime), @p44='04e49bed-37c7-4d7f-bf61-bd21880d715e', @p45='0', @p46='Sent', @p47='2025-07-02T17:27:45.6142861Z' (Nullable = true) (DbType = DateTime), @p48=NULL, @p49='flow_step_1', @p50=NULL (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "MessageLogs" ("Id", "BusinessId", "CTAFlowConfigId", "CTAFlowStepId", "CampaignId", "ContactId", "CreatedAt", "ErrorMessage", "IsIncoming", "MediaUrl", "MessageContent", "MessageId", "RawResponse", "RecipientNumber", "RefMessageId", "RenderedBody", "SentAt", "Source", "Status")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
INSERT INTO "CampaignSendLogs" ("Id", "AllowRetry", "Browser", "BusinessId", "CampaignId", "City", "ClickType", "ClickedAt", "ContactId", "Country", "CreatedAt", "CreatedBy", "DeliveredAt", "DeviceInfo", "DeviceType", "ErrorMessage", "IpAddress", "IsClicked", "LastRetryAt", "LastRetryStatus", "MacAddress", "MessageBody", "MessageId", "MessageLogId", "ReadAt", "RecipientId", "RetryCount", "SendStatus", "SentAt", "SourceChannel", "TemplateId", "UserId")
VALUES (@p19, @p20, @p21, @p22, @p23, @p24, @p25, @p26, @p27, @p28, @p29, @p30, @p31, @p32, @p33, @p34, @p35, @p36, @p37, @p38, @p39, @p40, @p41, @p42, @p43, @p44, @p45, @p46, @p47, @p48, @p49, @p50);
2025-07-02 22:57:45.650 +05:30 [INF] ✅ All saved successfully.
2025-07-02 22:57:45.651 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Helpers.ResponseResult'.
2025-07-02 22:57:45.654 +05:30 [INF] Executed action xbytechat.api.Features.CampaignModule.Controllers.CampaignController.SendTemplateCampaign (xbytechat.api) in 2534.4604ms
2025-07-02 22:57:45.659 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.SendTemplateCampaign (xbytechat.api)'
2025-07-02 22:57:45.661 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/api/campaign/send-campaign/01ffa7dc-8f65-4328-88bc-8021808a1001 - 200 null application/json; charset=utf-8 2553.2754ms
2025-07-02 22:57:46.646 +05:30 [INF] Request starting HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - application/json 602
2025-07-02 22:57:46.650 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:57:46.651 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-07-02 22:57:46.655 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSRUZCNzJDRTYwMERCMDEzMTEyAA==","status":"sent","timestamp":"1751477269","recipient_id":"917082156227","conversation":{"id":"dd1147c2aa48396e794ff1368ae84f7a","expiration_timestamp":"1751477269","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-07-02 22:57:46.657 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-07-02 22:57:46.658 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSRUZCNzJDRTYwMERCMDEzMTEyAA==","status":"sent","timestamp":"1751477269","recipient_id":"917082156227","conversation":{"id":"dd1147c2aa48396e794ff1368ae84f7a","expiration_timestamp":"1751477269","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-07-02 22:57:46.658 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType73`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:57:46.660 +05:30 [INF] 📦 Routing to Status Processor
2025-07-02 22:57:46.662 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 8.0392ms
2025-07-02 22:57:46.666 +05:30 [WRN] 🔍 Incoming timestamp raw value: {"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSRUZCNzJDRTYwMERCMDEzMTEyAA==","status":"sent","timestamp":"1751477269","recipient_id":"917082156227","conversation":{"id":"dd1147c2aa48396e794ff1368ae84f7a","expiration_timestamp":"1751477269","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-07-02 22:57:46.667 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:57:46.672 +05:30 [INF] Request finished HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 26.5375ms
2025-07-02 22:57:46.673 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__messageId_0='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSRUZCNzJDRTYwMERCMDEzMTEyAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."MessageId" = @__messageId_0
LIMIT 1
2025-07-02 22:57:46.684 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__logId_Value_0='c2796b7b-3a0c-4600-9fa3-8dc273109ff4'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."Id" = @__logId_Value_0
LIMIT 1
2025-07-02 22:57:46.688 +05:30 [INF] ✅ CampaignSendLog updated for MessageId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSRUZCNzJDRTYwMERCMDEzMTEyAA== → sent
2025-07-02 22:57:47.036 +05:30 [INF] Request starting HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - application/json 571
2025-07-02 22:57:47.040 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:57:47.042 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-07-02 22:57:47.045 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSRUZCNzJDRTYwMERCMDEzMTEyAA==","status":"delivered","timestamp":"1751477270","recipient_id":"917082156227","conversation":{"id":"dd1147c2aa48396e794ff1368ae84f7a","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-07-02 22:57:47.047 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-07-02 22:57:47.047 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSRUZCNzJDRTYwMERCMDEzMTEyAA==","status":"delivered","timestamp":"1751477270","recipient_id":"917082156227","conversation":{"id":"dd1147c2aa48396e794ff1368ae84f7a","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-07-02 22:57:47.048 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType73`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:57:47.050 +05:30 [INF] 📦 Routing to Status Processor
2025-07-02 22:57:47.052 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 6.6601ms
2025-07-02 22:57:47.054 +05:30 [WRN] 🔍 Incoming timestamp raw value: {"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSRUZCNzJDRTYwMERCMDEzMTEyAA==","status":"delivered","timestamp":"1751477270","recipient_id":"917082156227","conversation":{"id":"dd1147c2aa48396e794ff1368ae84f7a","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-07-02 22:57:47.057 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:57:47.061 +05:30 [INF] Request finished HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 25.0514ms
2025-07-02 22:57:47.061 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__messageId_0='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSRUZCNzJDRTYwMERCMDEzMTEyAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."MessageId" = @__messageId_0
LIMIT 1
2025-07-02 22:57:47.070 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__logId_Value_0='c2796b7b-3a0c-4600-9fa3-8dc273109ff4'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."Id" = @__logId_Value_0
LIMIT 1
2025-07-02 22:57:47.094 +05:30 [INF] Executed DbCommand (20ms) [Parameters=[@p2='c2796b7b-3a0c-4600-9fa3-8dc273109ff4', @p0='2025-07-02T17:27:50.0000000Z' (Nullable = true) (DbType = DateTime), @p1='Delivered'], CommandType='"Text"', CommandTimeout='30']
UPDATE "CampaignSendLogs" SET "DeliveredAt" = @p0, "SendStatus" = @p1
WHERE "Id" = @p2;
2025-07-02 22:57:47.098 +05:30 [INF] ✅ CampaignSendLog updated for MessageId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSRUZCNzJDRTYwMERCMDEzMTEyAA== → delivered
2025-07-02 22:57:55.953 +05:30 [INF] Request starting HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - application/json 633
2025-07-02 22:57:55.956 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:57:55.958 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-07-02 22:57:55.960 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"contacts":[{"profile":{"name":"\ua9c1S.K\ua9c2"},"wa_id":"917082156227"}],"messages":[{"context":{"from":"15556395845","id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSRUZCNzJDRTYwMERCMDEzMTEyAA=="},"from":"917082156227","id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAEhggMDg2MDU3MzMwMkMxOUMxOEY5ODZGOUU4OTlBMjkyQzQA","timestamp":"1751477279","type":"button","button":{"payload":"Yes, show me","text":"Yes, show me"}}]},"field":"messages"}]}]}
2025-07-02 22:57:55.964 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-07-02 22:57:55.964 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"contacts":[{"profile":{"name":"\ua9c1S.K\ua9c2"},"wa_id":"917082156227"}],"messages":[{"context":{"from":"15556395845","id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSRUZCNzJDRTYwMERCMDEzMTEyAA=="},"from":"917082156227","id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAEhggMDg2MDU3MzMwMkMxOUMxOEY5ODZGOUU4OTlBMjkyQzQA","timestamp":"1751477279","type":"button","button":{"payload":"Yes, show me","text":"Yes, show me"}}]},"field":"messages"}]}]}
2025-07-02 22:57:55.965 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType73`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:57:55.968 +05:30 [INF] 👉 Routing to Click Processor
2025-07-02 22:57:55.970 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 9.7894ms
2025-07-02 22:57:55.974 +05:30 [WRN] 📥 [ENTERED CLICK PROCESSOR]
2025-07-02 22:57:55.976 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:57:55.977 +05:30 [INF] 🖱️ Button Click → From: 917082156227, ClickId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAEhggMDg2MDU3MzMwMkMxOUMxOEY5ODZGOUU4OTlBMjkyQzQA, OrigMsgId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSRUZCNzJDRTYwMERCMDEzMTEyAA==, Text: Yes, show me
2025-07-02 22:57:55.979 +05:30 [INF] Request finished HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 26.1056ms
2025-07-02 22:57:55.984 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__originalMessageId_0='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSRUZCNzJDRTYwMERCMDEzMTEyAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId", c0."Id", c0."BusinessId", c0."CampaignId", c0."CampaignType", c0."CreatedAt", c0."CreatedBy", c0."CtaId", c0."DeletedAt", c0."DeletedBy", c0."FollowUpTemplateId", c0."ImageCaption", c0."ImageUrl", c0."IsDeleted", c0."MessageBody", c0."MessageTemplate", c0."Name", c0."ScheduledAt", c0."SourceCampaignId", c0."Status", c0."TemplateId", c0."TemplateParameters", c0."UpdatedAt", c1."Id", c1."AssignedAgentId", c1."BusinessId", c1."CreatedAt", c1."Email", c1."Group", c1."IsActive", c1."IsArchived", c1."IsAutomationPaused", c1."IsFavorite", c1."LastCTAInteraction", c1."LastCTAType", c1."LastClickedProductId", c1."LastContactedAt", c1."LeadSource", c1."Name", c1."NextFollowUpAt", c1."Notes", c1."PhoneNumber", c1."Tags"
FROM "CampaignSendLogs" AS c
INNER JOIN "Campaigns" AS c0 ON c."CampaignId" = c0."Id"
INNER JOIN "Contacts" AS c1 ON c."ContactId" = c1."Id"
WHERE c."MessageId" = @__originalMessageId_0
LIMIT 1
2025-07-02 22:57:55.992 +05:30 [INF] 📊 CampaignSendLog matched via context.id
2025-07-02 22:57:56.898 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__dto_MessageId_0='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSRUZCNzJDRTYwMERCMDEzMTEyAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."CreatedAt", m."ErrorMessage", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."MessageId" = @__dto_MessageId_0 OR m."Id"::text = @__dto_MessageId_0
LIMIT 1
2025-07-02 22:57:56.919 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__dto_MessageId_0='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSRUZCNzJDRTYwMERCMDEzMTEyAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId", c0."Id", c0."BotId", c0."BusinessId", c0."CampaignId", c0."CategoryBrowsed", c0."ClickedCTA", c0."ContactId", c0."IsAutoTagged", c0."MessagePreview", c0."ProductBrowsed", c0."SentAt", c0."Status", c0."UpdatedAt"
FROM "CampaignSendLogs" AS c
INNER JOIN "CampaignRecipients" AS c0 ON c."RecipientId" = c0."Id"
WHERE c."MessageId" = @__dto_MessageId_0
LIMIT 1
2025-07-02 22:57:56.941 +05:30 [INF] Executed DbCommand (17ms) [Parameters=[@p3='c2796b7b-3a0c-4600-9fa3-8dc273109ff4', @p0='Yes, show me', @p1='2025-07-02T17:27:55.9948952Z' (Nullable = true) (DbType = DateTime), @p2='True'], CommandType='"Text"', CommandTimeout='30']
UPDATE "CampaignSendLogs" SET "ClickType" = @p0, "ClickedAt" = @p1, "IsClicked" = @p2
WHERE "Id" = @p3;
2025-07-02 22:57:56.956 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@p0='7cd794f4-76a6-42d6-adaa-177c60ccf72e', @p1='WhatsApp', @p2='c13be597-6ae2-42bb-9d43-925815f24ff8', @p3='Yes, show me', @p4='Yes, show me', @p5='01ffa7dc-8f65-4328-88bc-8021808a1001' (Nullable = true), @p6='c2796b7b-3a0c-4600-9fa3-8dc273109ff4' (Nullable = true), @p7=NULL, @p8='2025-07-02T17:27:55.9948952Z' (DbType = DateTime), @p9='webhook', @p10='8aac7c57-6699-4511-897b-4121b407eb1c' (Nullable = true), @p11='+917082156227', @p12='Unknown', @p13='Unknown', @p14='False', @p15='webhook', @p16='Clicked', @p17='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSRUZCNzJDRTYwMERCMDEzMTEyAA==', @p18='8163cf8b-45dc-4ff1-9db6-f870e1cf2ee4' (Nullable = true), @p19=NULL, @p20=NULL (DbType = Guid), @p21='01ffa7dc-8f65-4328-88bc-8021808a1001' (Nullable = true), @p22='campaign' (Nullable = false), @p23=NULL (DbType = Guid), @p24=NULL, @p25=NULL (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "TrackingLogs" ("Id", "Browser", "BusinessId", "ButtonText", "CTAType", "CampaignId", "CampaignSendLogId", "City", "ClickedAt", "ClickedVia", "ContactId", "ContactPhone", "Country", "DeviceType", "FollowUpSent", "IPAddress", "LastInteractionType", "MessageId", "MessageLogId", "Referrer", "SessionId", "SourceId", "SourceType", "StepId", "TemplateId", "ThreadId")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22, @p23, @p24, @p25);
2025-07-02 22:57:56.961 +05:30 [INF] 📥 Click Tracked → Result: CTA click tracked successfully.
2025-07-02 22:57:56.972 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__campaignId_0='01ffa7dc-8f65-4328-88bc-8021808a1001' (Nullable = true), @__normalizedButtonText_1='yes, show me', @__normalizedTemplateName_2='flow_step_1'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."ButtonText", c."CampaignId", c."CreatedAt", c."CreatedBy", c."OverrideNextTemplate", c."TemplateName"
FROM "CampaignFlowOverrides" AS c
WHERE c."CampaignId" = @__campaignId_0 AND lower(c."ButtonText") = @__normalizedButtonText_1 AND lower(c."TemplateName") = @__normalizedTemplateName_2
LIMIT 1
2025-07-02 22:57:56.976 +05:30 [INF] 🟡 No campaign override found for button 'yes, show me' on template 'flow_step_1'
2025-07-02 22:57:56.980 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__normalizedButtonText_1='yes, show me', @__normalizedButtonType_2='quick_reply'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."CTAFlowConfigId", c."PositionX", c."PositionY", c."RequiredSource", c."RequiredTag", c."StepOrder", c."TemplateToSend", c."TemplateType", c."TriggerButtonText", c."TriggerButtonType", c0."Id", c0."BusinessId", c0."CreatedAt", c0."CreatedBy", c0."FlowName", c0."IsActive", c0."IsPublished", c0."UpdatedAt"
FROM "CTAFlowSteps" AS c
INNER JOIN "CTAFlowConfigs" AS c0 ON c."CTAFlowConfigId" = c0."Id"
WHERE c0."BusinessId" = @__businessId_0 AND c0."IsActive" AND c0."IsPublished" AND lower(c."TriggerButtonText") = @__normalizedButtonText_1 AND lower(c."TriggerButtonType") = @__normalizedButtonType_2
LIMIT 1
2025-07-02 22:57:56.984 +05:30 [INF] ✅ Fallback flow step matched: StepId = "b2d0e1a3-846e-49aa-a954-8badae61643f", Flow = test01
2025-07-02 22:57:56.985 +05:30 [INF] 🔁 Matched CTA Step → "b2d0e1a3-846e-49aa-a954-8badae61643f"
2025-07-02 22:57:56.987 +05:30 [INF] 🚦 Executing Visual Flow → StepId: "b2d0e1a3-846e-49aa-a954-8badae61643f" | TrackingLogId: "7cd794f4-76a6-42d6-adaa-177c60ccf72e"
2025-07-02 22:57:56.994 +05:30 [INF] Executed DbCommand (5ms) [Parameters=[@__trackingLogId_0='7cd794f4-76a6-42d6-adaa-177c60ccf72e'], CommandType='"Text"', CommandTimeout='30']
SELECT t0."Id", t0."Browser", t0."BusinessId", t0."ButtonText", t0."CTAType", t0."CampaignId", t0."CampaignSendLogId", t0."City", t0."ClickedAt", t0."ClickedVia", t0."ContactId", t0."ContactPhone", t0."Country", t0."DeviceType", t0."FollowUpSent", t0."IPAddress", t0."LastInteractionType", t0."MessageId", t0."MessageLogId", t0."Referrer", t0."SessionId", t0."SourceId", t0."SourceType", t0."StepId", t0."TemplateId", t0."ThreadId", t0."Id0", t0."AssignedAgentId", t0."BusinessId0", t0."CreatedAt", t0."Email", t0."Group", t0."IsActive", t0."IsArchived", t0."IsAutomationPaused", t0."IsFavorite", t0."LastCTAInteraction", t0."LastCTAType", t0."LastClickedProductId", t0."LastContactedAt", t0."LeadSource", t0."Name", t0."NextFollowUpAt", t0."Notes", t0."PhoneNumber", t0."Tags", t1."Id", t1."AssignedAt", t1."AssignedBy", t1."BusinessId", t1."ContactId", t1."TagId", t1."Id0", t1."BusinessId0", t1."Category", t1."ColorHex", t1."CreatedAt", t1."IsActive", t1."IsSystemTag", t1."LastUsedAt", t1."Name", t1."Notes"
FROM (
    SELECT t."Id", t."Browser", t."BusinessId", t."ButtonText", t."CTAType", t."CampaignId", t."CampaignSendLogId", t."City", t."ClickedAt", t."ClickedVia", t."ContactId", t."ContactPhone", t."Country", t."DeviceType", t."FollowUpSent", t."IPAddress", t."LastInteractionType", t."MessageId", t."MessageLogId", t."Referrer", t."SessionId", t."SourceId", t."SourceType", t."StepId", t."TemplateId", t."ThreadId", c."Id" AS "Id0", c."AssignedAgentId", c."BusinessId" AS "BusinessId0", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."Tags"
    FROM "TrackingLogs" AS t
    LEFT JOIN "Contacts" AS c ON t."ContactId" = c."Id"
    WHERE t."Id" = @__trackingLogId_0
    LIMIT 1
) AS t0
LEFT JOIN (
    SELECT c0."Id", c0."AssignedAt", c0."AssignedBy", c0."BusinessId", c0."ContactId", c0."TagId", t2."Id" AS "Id0", t2."BusinessId" AS "BusinessId0", t2."Category", t2."ColorHex", t2."CreatedAt", t2."IsActive", t2."IsSystemTag", t2."LastUsedAt", t2."Name", t2."Notes"
    FROM "ContactTags" AS c0
    INNER JOIN "Tags" AS t2 ON c0."TagId" = t2."Id"
) AS t1 ON t0."Id0" = t1."ContactId"
ORDER BY t0."Id", t0."Id0", t1."Id"
2025-07-02 22:57:56.999 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__nextStepId_1='b2d0e1a3-846e-49aa-a954-8badae61643f' (Nullable = true)], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."BusinessId", t."CreatedAt", t."CreatedBy", t."FlowName", t."IsActive", t."IsPublished", t."UpdatedAt", c1."Id", c1."CTAFlowConfigId", c1."PositionX", c1."PositionY", c1."RequiredSource", c1."RequiredTag", c1."StepOrder", c1."TemplateToSend", c1."TemplateType", c1."TriggerButtonText", c1."TriggerButtonType"
FROM (
    SELECT c."Id", c."BusinessId", c."CreatedAt", c."CreatedBy", c."FlowName", c."IsActive", c."IsPublished", c."UpdatedAt"
    FROM "CTAFlowConfigs" AS c
    WHERE c."BusinessId" = @__businessId_0 AND EXISTS (
        SELECT 1
        FROM "CTAFlowSteps" AS c0
        WHERE c."Id" = c0."CTAFlowConfigId" AND c0."Id" = @__nextStepId_1)
    LIMIT 1
) AS t
LEFT JOIN "CTAFlowSteps" AS c1 ON t."Id" = c1."CTAFlowConfigId"
ORDER BY t."Id"
2025-07-02 22:57:57.003 +05:30 [INF] ✅ Follow-up step found and matched → StepId: "b2d0e1a3-846e-49aa-a954-8badae61643f", Template: flow_step_2
2025-07-02 22:57:57.005 +05:30 [INF] Start processing HTTP request POST https://graph.facebook.com/v22.0/601884673011340/messages
2025-07-02 22:57:57.007 +05:30 [INF] Sending HTTP request POST https://graph.facebook.com/v22.0/601884673011340/messages
2025-07-02 22:57:58.299 +05:30 [INF] Received HTTP response headers after 1291.1467ms - 200
2025-07-02 22:57:58.301 +05:30 [INF] End processing HTTP request after 1295.875ms - 200
2025-07-02 22:57:58.308 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@p0='8c8af8c4-b820-433c-8803-43a25e5ef3ac', @p1='c13be597-6ae2-42bb-9d43-925815f24ff8', @p2=NULL (DbType = Guid), @p3=NULL (DbType = Guid), @p4=NULL (DbType = Guid), @p5=NULL (DbType = Guid), @p6='2025-07-02T17:27:58.3044688Z' (DbType = DateTime), @p7=NULL, @p8='False', @p9=NULL, @p10='flow_step_2' (Nullable = false), @p11=NULL, @p12='{"Success":true,"Message":"✅ Message sent successfully","Data":null,"ErrorMessage":null,"RawResponse":"{\"messaging_product\":\"whatsapp\",\"contacts\":[{\"input\":\"+917082156227\",\"wa_id\":\"917082156227\"}],\"messages\":[{\"id\":\"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMDFGREI4QzNFOERDODA0QkVBAA==\",\"message_status\":\"accepted\"}]}","MessageId":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMDFGREI4QzNFOERDODA0QkVBAA==","LogId":null,"Token":null,"RefreshToken":null}', @p13='+917082156227' (Nullable = false), @p14=NULL (DbType = Guid), @p15='', @p16='2025-07-02T17:27:58.3044680Z' (Nullable = true) (DbType = DateTime), @p17=NULL, @p18='Sent' (Nullable = false)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "MessageLogs" ("Id", "BusinessId", "CTAFlowConfigId", "CTAFlowStepId", "CampaignId", "ContactId", "CreatedAt", "ErrorMessage", "IsIncoming", "MediaUrl", "MessageContent", "MessageId", "RawResponse", "RecipientNumber", "RefMessageId", "RenderedBody", "SentAt", "Source", "Status")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
2025-07-02 22:57:58.313 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@p0='7f8cd105-153b-472e-839e-98952bcb0683', @p1='c13be597-6ae2-42bb-9d43-925815f24ff8', @p2='+917082156227', @p3=NULL, @p4='2025-07-02T17:27:58.3110657Z' (DbType = DateTime), @p5='8c065950-26a3-4fac-a3a4-462879e809e6' (Nullable = true), @p6=NULL, @p7='b2d0e1a3-846e-49aa-a954-8badae61643f', @p8='' (Nullable = false), @p9='True', @p10='flow_step_2', @p11='text_template', @p12='7cd794f4-76a6-42d6-adaa-177c60ccf72e' (Nullable = true), @p13='Yes, show me'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "FlowExecutionLogs" ("Id", "BusinessId", "ContactPhone", "ErrorMessage", "ExecutedAt", "FlowId", "RawResponse", "StepId", "StepName", "Success", "TemplateName", "TemplateType", "TrackingLogId", "TriggeredByButton")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13);
2025-07-02 22:57:58.317 +05:30 [INF] ✅ Flow step executed → Template: flow_step_2 sent to +917082156227
2025-07-02 22:57:58.318 +05:30 [INF] ⚡ Visual flow triggered via CTA click.
2025-07-02 22:57:59.734 +05:30 [INF] Request starting HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - application/json 602
2025-07-02 22:57:59.737 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:57:59.739 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-07-02 22:57:59.741 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMDFGREI4QzNFOERDODA0QkVBAA==","status":"sent","timestamp":"1751477282","recipient_id":"917082156227","conversation":{"id":"017d58d11f80fce908b06156d633650f","expiration_timestamp":"1751477282","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-07-02 22:57:59.743 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-07-02 22:57:59.744 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMDFGREI4QzNFOERDODA0QkVBAA==","status":"sent","timestamp":"1751477282","recipient_id":"917082156227","conversation":{"id":"017d58d11f80fce908b06156d633650f","expiration_timestamp":"1751477282","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-07-02 22:57:59.745 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType73`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:57:59.747 +05:30 [INF] 📦 Routing to Status Processor
2025-07-02 22:57:59.748 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 7.4716ms
2025-07-02 22:57:59.750 +05:30 [WRN] 🔍 Incoming timestamp raw value: {"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMDFGREI4QzNFOERDODA0QkVBAA==","status":"sent","timestamp":"1751477282","recipient_id":"917082156227","conversation":{"id":"017d58d11f80fce908b06156d633650f","expiration_timestamp":"1751477282","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-07-02 22:57:59.751 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:57:59.755 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__messageId_0='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMDFGREI4QzNFOERDODA0QkVBAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."MessageId" = @__messageId_0
LIMIT 1
2025-07-02 22:57:59.756 +05:30 [INF] Request finished HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 22.3946ms
2025-07-02 22:57:59.760 +05:30 [WRN] ⚠️ CampaignSendLog not found for MessageId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMDFGREI4QzNFOERDODA0QkVBAA==
2025-07-02 22:57:59.765 +05:30 [WRN] ⚠️ No matching CampaignSendLog for MessageId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMDFGREI4QzNFOERDODA0QkVBAA==
2025-07-02 22:58:00.042 +05:30 [INF] Request starting HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - application/json 571
2025-07-02 22:58:00.048 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:58:00.049 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-07-02 22:58:00.052 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMDFGREI4QzNFOERDODA0QkVBAA==","status":"delivered","timestamp":"1751477283","recipient_id":"917082156227","conversation":{"id":"017d58d11f80fce908b06156d633650f","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-07-02 22:58:00.054 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-07-02 22:58:00.054 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMDFGREI4QzNFOERDODA0QkVBAA==","status":"delivered","timestamp":"1751477283","recipient_id":"917082156227","conversation":{"id":"017d58d11f80fce908b06156d633650f","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-07-02 22:58:00.055 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType73`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:58:00.057 +05:30 [INF] 📦 Routing to Status Processor
2025-07-02 22:58:00.059 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 7.1785ms
2025-07-02 22:58:00.060 +05:30 [WRN] 🔍 Incoming timestamp raw value: {"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMDFGREI4QzNFOERDODA0QkVBAA==","status":"delivered","timestamp":"1751477283","recipient_id":"917082156227","conversation":{"id":"017d58d11f80fce908b06156d633650f","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-07-02 22:58:00.062 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:58:00.066 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__messageId_0='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMDFGREI4QzNFOERDODA0QkVBAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."MessageId" = @__messageId_0
LIMIT 1
2025-07-02 22:58:00.066 +05:30 [INF] Request finished HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 24.5806ms
2025-07-02 22:58:00.069 +05:30 [WRN] ⚠️ CampaignSendLog not found for MessageId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMDFGREI4QzNFOERDODA0QkVBAA==
2025-07-02 22:58:00.074 +05:30 [WRN] ⚠️ No matching CampaignSendLog for MessageId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMDFGREI4QzNFOERDODA0QkVBAA==
2025-07-02 22:58:04.967 +05:30 [INF] Request starting HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - application/json 633
2025-07-02 22:58:04.971 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:58:04.973 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-07-02 22:58:04.976 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"contacts":[{"profile":{"name":"\ua9c1S.K\ua9c2"},"wa_id":"917082156227"}],"messages":[{"context":{"from":"15556395845","id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMDFGREI4QzNFOERDODA0QkVBAA=="},"from":"917082156227","id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAEhggMkNGRDZGQjI2QUU5RDgyRDA5N0IwRkZGQjQ0MzhCN0MA","timestamp":"1751477287","type":"button","button":{"payload":"More Options","text":"More Options"}}]},"field":"messages"}]}]}
2025-07-02 22:58:04.978 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-07-02 22:58:04.978 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"contacts":[{"profile":{"name":"\ua9c1S.K\ua9c2"},"wa_id":"917082156227"}],"messages":[{"context":{"from":"15556395845","id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMDFGREI4QzNFOERDODA0QkVBAA=="},"from":"917082156227","id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAEhggMkNGRDZGQjI2QUU5RDgyRDA5N0IwRkZGQjQ0MzhCN0MA","timestamp":"1751477287","type":"button","button":{"payload":"More Options","text":"More Options"}}]},"field":"messages"}]}]}
2025-07-02 22:58:04.979 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType73`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:58:04.981 +05:30 [INF] 👉 Routing to Click Processor
2025-07-02 22:58:04.982 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 7.1914ms
2025-07-02 22:58:04.983 +05:30 [WRN] 📥 [ENTERED CLICK PROCESSOR]
2025-07-02 22:58:04.985 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:58:04.986 +05:30 [INF] 🖱️ Button Click → From: 917082156227, ClickId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAEhggMkNGRDZGQjI2QUU5RDgyRDA5N0IwRkZGQjQ0MzhCN0MA, OrigMsgId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMDFGREI4QzNFOERDODA0QkVBAA==, Text: More Options
2025-07-02 22:58:04.987 +05:30 [INF] Request finished HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 19.6493ms
2025-07-02 22:58:04.995 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[@__originalMessageId_0='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMDFGREI4QzNFOERDODA0QkVBAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId", c0."Id", c0."BusinessId", c0."CampaignId", c0."CampaignType", c0."CreatedAt", c0."CreatedBy", c0."CtaId", c0."DeletedAt", c0."DeletedBy", c0."FollowUpTemplateId", c0."ImageCaption", c0."ImageUrl", c0."IsDeleted", c0."MessageBody", c0."MessageTemplate", c0."Name", c0."ScheduledAt", c0."SourceCampaignId", c0."Status", c0."TemplateId", c0."TemplateParameters", c0."UpdatedAt", c1."Id", c1."AssignedAgentId", c1."BusinessId", c1."CreatedAt", c1."Email", c1."Group", c1."IsActive", c1."IsArchived", c1."IsAutomationPaused", c1."IsFavorite", c1."LastCTAInteraction", c1."LastCTAType", c1."LastClickedProductId", c1."LastContactedAt", c1."LeadSource", c1."Name", c1."NextFollowUpAt", c1."Notes", c1."PhoneNumber", c1."Tags"
FROM "CampaignSendLogs" AS c
INNER JOIN "Campaigns" AS c0 ON c."CampaignId" = c0."Id"
INNER JOIN "Contacts" AS c1 ON c."ContactId" = c1."Id"
WHERE c."MessageId" = @__originalMessageId_0
LIMIT 1
2025-07-02 22:58:05.002 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__originalMessageId_0='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMDFGREI4QzNFOERDODA0QkVBAA==', @__originalMessageId_0_contains='%wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMDFGREI4QzNFOERDODA0QkVBAA==%'], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."CreatedAt", m."ErrorMessage", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."MessageId" = @__originalMessageId_0 OR m."Id"::text = @__originalMessageId_0 OR m."RawResponse" LIKE @__originalMessageId_0_contains
LIMIT 1
2025-07-02 22:58:05.005 +05:30 [INF] ✅ Fallback matched MessageLog. BusinessId: "c13be597-6ae2-42bb-9d43-925815f24ff8"
2025-07-02 22:58:06.311 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__dto_MessageId_0='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMDFGREI4QzNFOERDODA0QkVBAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."CreatedAt", m."ErrorMessage", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."MessageId" = @__dto_MessageId_0 OR m."Id"::text = @__dto_MessageId_0
LIMIT 1
2025-07-02 22:58:06.336 +05:30 [INF] Executed DbCommand (21ms) [Parameters=[@p0='8e53ef6f-5ca3-4fca-a5a7-6edbfda53551', @p1='WhatsApp', @p2='c13be597-6ae2-42bb-9d43-925815f24ff8', @p3='More Options', @p4='More Options', @p5=NULL (DbType = Guid), @p6=NULL (DbType = Guid), @p7=NULL, @p8='2025-07-02T17:28:05.0070114Z' (DbType = DateTime), @p9='webhook', @p10=NULL (DbType = Guid), @p11='+917082156227', @p12='Unknown', @p13='Unknown', @p14='False', @p15='webhook', @p16='Clicked', @p17='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMDFGREI4QzNFOERDODA0QkVBAA==', @p18=NULL (DbType = Guid), @p19=NULL, @p20=NULL (DbType = Guid), @p21=NULL (DbType = Guid), @p22='flow' (Nullable = false), @p23=NULL (DbType = Guid), @p24=NULL, @p25=NULL (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "TrackingLogs" ("Id", "Browser", "BusinessId", "ButtonText", "CTAType", "CampaignId", "CampaignSendLogId", "City", "ClickedAt", "ClickedVia", "ContactId", "ContactPhone", "Country", "DeviceType", "FollowUpSent", "IPAddress", "LastInteractionType", "MessageId", "MessageLogId", "Referrer", "SessionId", "SourceId", "SourceType", "StepId", "TemplateId", "ThreadId")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22, @p23, @p24, @p25);
2025-07-02 22:58:06.339 +05:30 [INF] 📥 Click Tracked → Result: CTA click tracked successfully.
2025-07-02 22:58:06.345 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__normalizedButtonText_1='more options', @__normalizedButtonType_2='quick_reply'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."CTAFlowConfigId", c."PositionX", c."PositionY", c."RequiredSource", c."RequiredTag", c."StepOrder", c."TemplateToSend", c."TemplateType", c."TriggerButtonText", c."TriggerButtonType", c0."Id", c0."BusinessId", c0."CreatedAt", c0."CreatedBy", c0."FlowName", c0."IsActive", c0."IsPublished", c0."UpdatedAt"
FROM "CTAFlowSteps" AS c
INNER JOIN "CTAFlowConfigs" AS c0 ON c."CTAFlowConfigId" = c0."Id"
WHERE c0."BusinessId" = @__businessId_0 AND c0."IsActive" AND c0."IsPublished" AND lower(c."TriggerButtonText") = @__normalizedButtonText_1 AND lower(c."TriggerButtonType") = @__normalizedButtonType_2
LIMIT 1
2025-07-02 22:58:06.348 +05:30 [WRN] ❌ No fallback step matched for button 'more options' of type 'quick_reply' in BusinessId: "c13be597-6ae2-42bb-9d43-925815f24ff8"
2025-07-02 22:58:06.351 +05:30 [INF] 🟡 No visual flow matched for this button: More Options
2025-07-02 22:58:21.246 +05:30 [INF] Request starting HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - application/json 581
2025-07-02 22:58:21.251 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:58:21.253 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-07-02 22:58:21.256 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSNkFDRUE4M0E1NzcyMTYxQzY5AA==","status":"sent","timestamp":"1751189938","recipient_id":"917082156227","conversation":{"id":"90b38ee00c6455dcc79733c1fd93f79a","expiration_timestamp":"1751269260","origin":{"type":"service"}},"pricing":{"billable":true,"pricing_model":"CBP","category":"service"}}]},"field":"messages"}]}]}
2025-07-02 22:58:21.258 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-07-02 22:58:21.259 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSNkFDRUE4M0E1NzcyMTYxQzY5AA==","status":"sent","timestamp":"1751189938","recipient_id":"917082156227","conversation":{"id":"90b38ee00c6455dcc79733c1fd93f79a","expiration_timestamp":"1751269260","origin":{"type":"service"}},"pricing":{"billable":true,"pricing_model":"CBP","category":"service"}}]},"field":"messages"}]}]}
2025-07-02 22:58:21.260 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType73`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:58:21.262 +05:30 [INF] 📦 Routing to Status Processor
2025-07-02 22:58:21.263 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 7.5134ms
2025-07-02 22:58:21.265 +05:30 [WRN] 🔍 Incoming timestamp raw value: {"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSNkFDRUE4M0E1NzcyMTYxQzY5AA==","status":"sent","timestamp":"1751189938","recipient_id":"917082156227","conversation":{"id":"90b38ee00c6455dcc79733c1fd93f79a","expiration_timestamp":"1751269260","origin":{"type":"service"}},"pricing":{"billable":true,"pricing_model":"CBP","category":"service"}}]},"field":"messages"}]}]}
2025-07-02 22:58:21.266 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:58:21.270 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__messageId_0='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSNkFDRUE4M0E1NzcyMTYxQzY5AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."MessageId" = @__messageId_0
LIMIT 1
2025-07-02 22:58:21.271 +05:30 [INF] Request finished HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 24.883ms
2025-07-02 22:58:21.273 +05:30 [WRN] ⚠️ CampaignSendLog not found for MessageId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSNkFDRUE4M0E1NzcyMTYxQzY5AA==
2025-07-02 22:58:21.279 +05:30 [WRN] ⚠️ No matching CampaignSendLog for MessageId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSNkFDRUE4M0E1NzcyMTYxQzY5AA==
2025-07-02 22:58:57.188 +05:30 [INF] Request starting HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - application/json 633
2025-07-02 22:58:57.191 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:58:57.193 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-07-02 22:58:57.195 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"contacts":[{"profile":{"name":"\ua9c1S.K\ua9c2"},"wa_id":"917082156227"}],"messages":[{"context":{"from":"15556395845","id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSOUI4MTFCQjYyNTYyNTFBQzAyAA=="},"from":"917082156227","id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAEhggMUQwMEExRjI4QzRBMTc0RDlBNjY0MDQxM0NCREUwREYA","timestamp":"1751477340","type":"button","button":{"payload":"Send Pricing","text":"Send Pricing"}}]},"field":"messages"}]}]}
2025-07-02 22:58:57.198 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-07-02 22:58:57.198 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"contacts":[{"profile":{"name":"\ua9c1S.K\ua9c2"},"wa_id":"917082156227"}],"messages":[{"context":{"from":"15556395845","id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSOUI4MTFCQjYyNTYyNTFBQzAyAA=="},"from":"917082156227","id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAEhggMUQwMEExRjI4QzRBMTc0RDlBNjY0MDQxM0NCREUwREYA","timestamp":"1751477340","type":"button","button":{"payload":"Send Pricing","text":"Send Pricing"}}]},"field":"messages"}]}]}
2025-07-02 22:58:57.201 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType73`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 22:58:57.204 +05:30 [INF] 👉 Routing to Click Processor
2025-07-02 22:58:57.207 +05:30 [WRN] 📥 [ENTERED CLICK PROCESSOR]
2025-07-02 22:58:57.208 +05:30 [INF] 🖱️ Button Click → From: 917082156227, ClickId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAEhggMUQwMEExRjI4QzRBMTc0RDlBNjY0MDQxM0NCREUwREYA, OrigMsgId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSOUI4MTFCQjYyNTYyNTFBQzAyAA==, Text: Send Pricing
2025-07-02 22:58:57.206 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 11.2751ms
2025-07-02 22:58:57.212 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__originalMessageId_0='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSOUI4MTFCQjYyNTYyNTFBQzAyAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId", c0."Id", c0."BusinessId", c0."CampaignId", c0."CampaignType", c0."CreatedAt", c0."CreatedBy", c0."CtaId", c0."DeletedAt", c0."DeletedBy", c0."FollowUpTemplateId", c0."ImageCaption", c0."ImageUrl", c0."IsDeleted", c0."MessageBody", c0."MessageTemplate", c0."Name", c0."ScheduledAt", c0."SourceCampaignId", c0."Status", c0."TemplateId", c0."TemplateParameters", c0."UpdatedAt", c1."Id", c1."AssignedAgentId", c1."BusinessId", c1."CreatedAt", c1."Email", c1."Group", c1."IsActive", c1."IsArchived", c1."IsAutomationPaused", c1."IsFavorite", c1."LastCTAInteraction", c1."LastCTAType", c1."LastClickedProductId", c1."LastContactedAt", c1."LeadSource", c1."Name", c1."NextFollowUpAt", c1."Notes", c1."PhoneNumber", c1."Tags"
FROM "CampaignSendLogs" AS c
INNER JOIN "Campaigns" AS c0 ON c."CampaignId" = c0."Id"
INNER JOIN "Contacts" AS c1 ON c."ContactId" = c1."Id"
WHERE c."MessageId" = @__originalMessageId_0
LIMIT 1
2025-07-02 22:58:57.219 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 22:58:57.224 +05:30 [INF] 📊 CampaignSendLog matched via context.id
2025-07-02 22:58:57.225 +05:30 [INF] Request finished HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 37.2716ms
2025-07-02 22:58:58.024 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__dto_MessageId_0='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSOUI4MTFCQjYyNTYyNTFBQzAyAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."CreatedAt", m."ErrorMessage", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."MessageId" = @__dto_MessageId_0 OR m."Id"::text = @__dto_MessageId_0
LIMIT 1
2025-07-02 22:58:58.029 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__dto_MessageId_0='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSOUI4MTFCQjYyNTYyNTFBQzAyAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId", c0."Id", c0."BotId", c0."BusinessId", c0."CampaignId", c0."CategoryBrowsed", c0."ClickedCTA", c0."ContactId", c0."IsAutoTagged", c0."MessagePreview", c0."ProductBrowsed", c0."SentAt", c0."Status", c0."UpdatedAt"
FROM "CampaignSendLogs" AS c
INNER JOIN "CampaignRecipients" AS c0 ON c."RecipientId" = c0."Id"
WHERE c."MessageId" = @__dto_MessageId_0
LIMIT 1
2025-07-02 22:58:58.054 +05:30 [INF] Executed DbCommand (20ms) [Parameters=[@p3='7af8335c-6b3b-4e49-a962-4390c4caf168', @p0='Send Pricing', @p1='2025-07-02T17:28:57.2269631Z' (Nullable = true) (DbType = DateTime), @p2='True'], CommandType='"Text"', CommandTimeout='30']
UPDATE "CampaignSendLogs" SET "ClickType" = @p0, "ClickedAt" = @p1, "IsClicked" = @p2
WHERE "Id" = @p3;
2025-07-02 22:58:58.062 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@p0='b8249333-1d19-49e6-90f8-064b93468375', @p1='WhatsApp', @p2='c13be597-6ae2-42bb-9d43-925815f24ff8', @p3='Send Pricing', @p4='Send Pricing', @p5='5b762111-ca31-42e3-aead-a65f67b4ff48' (Nullable = true), @p6='7af8335c-6b3b-4e49-a962-4390c4caf168' (Nullable = true), @p7=NULL, @p8='2025-07-02T17:28:57.2269631Z' (DbType = DateTime), @p9='webhook', @p10='8aac7c57-6699-4511-897b-4121b407eb1c' (Nullable = true), @p11='+917082156227', @p12='Unknown', @p13='Unknown', @p14='False', @p15='webhook', @p16='Clicked', @p17='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSOUI4MTFCQjYyNTYyNTFBQzAyAA==', @p18='8a5e4c33-a504-4e4a-afd1-4ed52534cd9b' (Nullable = true), @p19=NULL, @p20=NULL (DbType = Guid), @p21='5b762111-ca31-42e3-aead-a65f67b4ff48' (Nullable = true), @p22='campaign' (Nullable = false), @p23=NULL (DbType = Guid), @p24=NULL, @p25=NULL (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "TrackingLogs" ("Id", "Browser", "BusinessId", "ButtonText", "CTAType", "CampaignId", "CampaignSendLogId", "City", "ClickedAt", "ClickedVia", "ContactId", "ContactPhone", "Country", "DeviceType", "FollowUpSent", "IPAddress", "LastInteractionType", "MessageId", "MessageLogId", "Referrer", "SessionId", "SourceId", "SourceType", "StepId", "TemplateId", "ThreadId")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22, @p23, @p24, @p25);
2025-07-02 22:58:58.066 +05:30 [INF] 📥 Click Tracked → Result: CTA click tracked successfully.
2025-07-02 22:58:58.070 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__campaignId_0='5b762111-ca31-42e3-aead-a65f67b4ff48' (Nullable = true), @__normalizedButtonText_1='send pricing', @__normalizedTemplateName_2='flow_step_4'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."ButtonText", c."CampaignId", c."CreatedAt", c."CreatedBy", c."OverrideNextTemplate", c."TemplateName"
FROM "CampaignFlowOverrides" AS c
WHERE c."CampaignId" = @__campaignId_0 AND lower(c."ButtonText") = @__normalizedButtonText_1 AND lower(c."TemplateName") = @__normalizedTemplateName_2
LIMIT 1
2025-07-02 22:58:58.073 +05:30 [INF] 🟡 No campaign override found for button 'send pricing' on template 'flow_step_4'
2025-07-02 22:58:58.076 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__normalizedButtonText_1='send pricing', @__normalizedButtonType_2='quick_reply'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."CTAFlowConfigId", c."PositionX", c."PositionY", c."RequiredSource", c."RequiredTag", c."StepOrder", c."TemplateToSend", c."TemplateType", c."TriggerButtonText", c."TriggerButtonType", c0."Id", c0."BusinessId", c0."CreatedAt", c0."CreatedBy", c0."FlowName", c0."IsActive", c0."IsPublished", c0."UpdatedAt"
FROM "CTAFlowSteps" AS c
INNER JOIN "CTAFlowConfigs" AS c0 ON c."CTAFlowConfigId" = c0."Id"
WHERE c0."BusinessId" = @__businessId_0 AND c0."IsActive" AND c0."IsPublished" AND lower(c."TriggerButtonText") = @__normalizedButtonText_1 AND lower(c."TriggerButtonType") = @__normalizedButtonType_2
LIMIT 1
2025-07-02 22:58:58.079 +05:30 [WRN] ❌ No fallback step matched for button 'send pricing' of type 'quick_reply' in BusinessId: "c13be597-6ae2-42bb-9d43-925815f24ff8"
2025-07-02 22:58:58.082 +05:30 [INF] 🟡 No visual flow matched for this button: Send Pricing
2025-07-02 23:00:43.470 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/api/campaign/create-image-campaign - null null
2025-07-02 23:00:43.474 +05:30 [INF] CORS policy execution successful.
2025-07-02 23:00:43.476 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/api/campaign/create-image-campaign - 204 null null 5.6568ms
2025-07-02 23:00:43.478 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/api/campaign/create-image-campaign - application/json 468
2025-07-02 23:00:43.484 +05:30 [INF] CORS policy execution successful.
2025-07-02 23:00:43.485 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.CreateImageCampaign (xbytechat.api)'
2025-07-02 23:00:43.491 +05:30 [INF] Route matched with {action = "CreateImageCampaign", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateImageCampaign(xbytechat.api.Features.CampaignModule.DTOs.CampaignCreateDto) on controller xbytechat.api.Features.CampaignModule.Controllers.CampaignController (xbytechat.api).
2025-07-02 23:00:45.029 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@p0='d0f71321-88d2-4b99-91e0-5b5f0174400f', @p1='c13be597-6ae2-42bb-9d43-925815f24ff8', @p2=NULL (DbType = Guid), @p3='image', @p4='2025-07-02T17:30:45.0248323Z' (DbType = DateTime), @p5='system', @p6=NULL (DbType = Guid), @p7=NULL (DbType = DateTime), @p8=NULL, @p9=NULL, @p10='🔥 Hot Deals Inside!', @p11='https://picsum.photos/200/300', @p12='False', @p13=NULL, @p14='We’re excited to announce that we’re launching some amazing new products at [Your Company Name]! 🚀

Be the first to check them out and grab special launch offers!
If you’re interested, reply to this message or click here:' (Nullable = false), @p15='demo' (Nullable = false), @p16=NULL (DbType = DateTime), @p17=NULL (DbType = Guid), @p18='Draft' (Nullable = false), @p19=NULL, @p20=NULL, @p21='2025-07-02T17:30:45.0248325Z' (DbType = DateTime), @p22='b81a4f96-9fd5-4f1d-b04a-14de90f97c5e', @p23='d0f71321-88d2-4b99-91e0-5b5f0174400f', @p24='False', @p25='1', @p26='Know More' (Nullable = false), @p27='url' (Nullable = false), @p28='https://www.myntra.com/men-sweatshirts' (Nullable = false)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Campaigns" ("Id", "BusinessId", "CampaignId", "CampaignType", "CreatedAt", "CreatedBy", "CtaId", "DeletedAt", "DeletedBy", "FollowUpTemplateId", "ImageCaption", "ImageUrl", "IsDeleted", "MessageBody", "MessageTemplate", "Name", "ScheduledAt", "SourceCampaignId", "Status", "TemplateId", "TemplateParameters", "UpdatedAt")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21);
INSERT INTO "CampaignButtons" ("Id", "CampaignId", "IsFromTemplate", "Position", "Title", "Type", "Value")
VALUES (@p22, @p23, @p24, @p25, @p26, @p27, @p28);
2025-07-02 23:00:45.057 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType20`3[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 23:00:45.059 +05:30 [INF] Executed action xbytechat.api.Features.CampaignModule.Controllers.CampaignController.CreateImageCampaign (xbytechat.api) in 1566.3346ms
2025-07-02 23:00:45.061 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.CreateImageCampaign (xbytechat.api)'
2025-07-02 23:00:45.062 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/api/campaign/create-image-campaign - 200 null application/json; charset=utf-8 1584.5196ms
2025-07-02 23:00:45.148 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/campaign/d0f71321-88d2-4b99-91e0-5b5f0174400f - null null
2025-07-02 23:00:45.150 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/contacts?tab=all&page=1&pageSize=1000 - null null
2025-07-02 23:00:45.148 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/tags - null null
2025-07-02 23:00:45.158 +05:30 [INF] CORS policy execution successful.
2025-07-02 23:00:45.161 +05:30 [INF] CORS policy execution successful.
2025-07-02 23:00:45.164 +05:30 [INF] CORS policy execution successful.
2025-07-02 23:00:45.166 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetCampaignById (xbytechat.api)'
2025-07-02 23:00:45.166 +05:30 [INF] Executing endpoint 'xbytechat.api.CRM.Controllers.ContactsController.GetAllContacts (xbytechat.api)'
2025-07-02 23:00:45.167 +05:30 [INF] Executing endpoint 'xbytechat.api.CRM.Controllers.TagsController.GetAllTags (xbytechat.api)'
2025-07-02 23:00:45.168 +05:30 [INF] Route matched with {action = "GetCampaignById", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[xbytechat.api.Features.CampaignModule.DTOs.CampaignDto]] GetCampaignById(System.Guid) on controller xbytechat.api.Features.CampaignModule.Controllers.CampaignController (xbytechat.api).
2025-07-02 23:00:45.170 +05:30 [INF] Route matched with {action = "GetAllContacts", controller = "Contacts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllContacts(System.String, Int32, Int32) on controller xbytechat.api.CRM.Controllers.ContactsController (xbytechat.api).
2025-07-02 23:00:45.171 +05:30 [INF] Route matched with {action = "GetAllTags", controller = "Tags"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllTags() on controller xbytechat.api.CRM.Controllers.TagsController (xbytechat.api).
2025-07-02 23:00:45.178 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__campaignId_0='d0f71321-88d2-4b99-91e0-5b5f0174400f', @__businessId_1='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."BusinessId", t."CampaignId", t."CampaignType", t."CreatedAt", t."CreatedBy", t."CtaId", t."DeletedAt", t."DeletedBy", t."FollowUpTemplateId", t."ImageCaption", t."ImageUrl", t."IsDeleted", t."MessageBody", t."MessageTemplate", t."Name", t."ScheduledAt", t."SourceCampaignId", t."Status", t."TemplateId", t."TemplateParameters", t."UpdatedAt", t."Id0", t."BusinessId0", t."ButtonText", t."ButtonType", t."CreatedAt0", t."Description", t."IsActive", t."TargetUrl", t."Title", t."UpdatedAt0", c1."Id", c1."CampaignId", c1."IsFromTemplate", c1."Position", c1."Title", c1."Type", c1."Value"
FROM (
    SELECT c."Id", c."BusinessId", c."CampaignId", c."CampaignType", c."CreatedAt", c."CreatedBy", c."CtaId", c."DeletedAt", c."DeletedBy", c."FollowUpTemplateId", c."ImageCaption", c."ImageUrl", c."IsDeleted", c."MessageBody", c."MessageTemplate", c."Name", c."ScheduledAt", c."SourceCampaignId", c."Status", c."TemplateId", c."TemplateParameters", c."UpdatedAt", c0."Id" AS "Id0", c0."BusinessId" AS "BusinessId0", c0."ButtonText", c0."ButtonType", c0."CreatedAt" AS "CreatedAt0", c0."Description", c0."IsActive", c0."TargetUrl", c0."Title", c0."UpdatedAt" AS "UpdatedAt0"
    FROM "Campaigns" AS c
    LEFT JOIN "CTADefinitions" AS c0 ON c."CtaId" = c0."Id"
    WHERE c."Id" = @__campaignId_0 AND c."BusinessId" = @__businessId_1
    LIMIT 1
) AS t
LEFT JOIN "CampaignButtons" AS c1 ON t."Id" = c1."CampaignId"
ORDER BY t."Id", t."Id0"
2025-07-02 23:00:45.179 +05:30 [INF] GetPagedContactsAsync: businessId="c13be597-6ae2-42bb-9d43-925815f24ff8", tab=all, page=1, pageSize=1000
2025-07-02 23:00:45.191 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."Name", t."ColorHex", t."Category", t."Notes", t."IsSystemTag", t."IsActive", t."CreatedAt", t."LastUsedAt"
FROM "Tags" AS t
WHERE t."BusinessId" = @__businessId_0 AND t."IsActive"
ORDER BY t."CreatedAt" DESC
2025-07-02 23:00:45.194 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Features.CampaignModule.DTOs.CampaignDto'.
2025-07-02 23:00:45.199 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Contacts" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."IsActive"
2025-07-02 23:00:45.202 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Helpers.ResponseResult'.
2025-07-02 23:00:45.204 +05:30 [INF] Executed action xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetCampaignById (xbytechat.api) in 30.3756ms
2025-07-02 23:00:45.210 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__p_2='100', @__p_1='0'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."AssignedAgentId", t."BusinessId", t."CreatedAt", t."Email", t."Group", t."IsActive", t."IsArchived", t."IsAutomationPaused", t."IsFavorite", t."LastCTAInteraction", t."LastCTAType", t."LastClickedProductId", t."LastContactedAt", t."LeadSource", t."Name", t."NextFollowUpAt", t."Notes", t."PhoneNumber", t."Tags", t0."Id", t0."AssignedAt", t0."AssignedBy", t0."BusinessId", t0."ContactId", t0."TagId", t0."Id0", t0."BusinessId0", t0."Category", t0."ColorHex", t0."CreatedAt", t0."IsActive", t0."IsSystemTag", t0."LastUsedAt", t0."Name", t0."Notes"
FROM (
    SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."Tags"
    FROM "Contacts" AS c
    WHERE c."BusinessId" = @__businessId_0 AND c."IsActive"
    ORDER BY c."Name"
    LIMIT @__p_2 OFFSET @__p_1
) AS t
LEFT JOIN (
    SELECT c0."Id", c0."AssignedAt", c0."AssignedBy", c0."BusinessId", c0."ContactId", c0."TagId", t1."Id" AS "Id0", t1."BusinessId" AS "BusinessId0", t1."Category", t1."ColorHex", t1."CreatedAt", t1."IsActive", t1."IsSystemTag", t1."LastUsedAt", t1."Name", t1."Notes"
    FROM "ContactTags" AS c0
    INNER JOIN "Tags" AS t1 ON c0."TagId" = t1."Id"
) AS t0 ON t."Id" = t0."ContactId"
ORDER BY t."Name", t."Id", t0."Id"
2025-07-02 23:00:45.214 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/tags - null null
2025-07-02 23:00:45.209 +05:30 [INF] Executed action xbytechat.api.CRM.Controllers.TagsController.GetAllTags (xbytechat.api) in 21.0588ms
2025-07-02 23:00:45.219 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetCampaignById (xbytechat.api)'
2025-07-02 23:00:45.223 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Helpers.ResponseResult'.
2025-07-02 23:00:45.226 +05:30 [INF] CORS policy execution successful.
2025-07-02 23:00:45.227 +05:30 [INF] Executed endpoint 'xbytechat.api.CRM.Controllers.TagsController.GetAllTags (xbytechat.api)'
2025-07-02 23:00:45.229 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/campaign/d0f71321-88d2-4b99-91e0-5b5f0174400f - 200 null application/json; charset=utf-8 81.2619ms
2025-07-02 23:00:45.231 +05:30 [INF] Executed action xbytechat.api.CRM.Controllers.ContactsController.GetAllContacts (xbytechat.api) in 53.3939ms
2025-07-02 23:00:45.233 +05:30 [INF] Executing endpoint 'xbytechat.api.CRM.Controllers.TagsController.GetAllTags (xbytechat.api)'
2025-07-02 23:00:45.234 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/tags - 200 null application/json; charset=utf-8 86.5897ms
2025-07-02 23:00:45.242 +05:30 [INF] Executed endpoint 'xbytechat.api.CRM.Controllers.ContactsController.GetAllContacts (xbytechat.api)'
2025-07-02 23:00:45.244 +05:30 [INF] Route matched with {action = "GetAllTags", controller = "Tags"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllTags() on controller xbytechat.api.CRM.Controllers.TagsController (xbytechat.api).
2025-07-02 23:00:45.250 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/contacts?tab=all&page=1&pageSize=1000 - 200 null application/json; charset=utf-8 100.3779ms
2025-07-02 23:00:45.256 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."Name", t."ColorHex", t."Category", t."Notes", t."IsSystemTag", t."IsActive", t."CreatedAt", t."LastUsedAt"
FROM "Tags" AS t
WHERE t."BusinessId" = @__businessId_0 AND t."IsActive"
ORDER BY t."CreatedAt" DESC
2025-07-02 23:00:45.265 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Helpers.ResponseResult'.
2025-07-02 23:00:45.267 +05:30 [INF] Executed action xbytechat.api.CRM.Controllers.TagsController.GetAllTags (xbytechat.api) in 14.2832ms
2025-07-02 23:00:45.270 +05:30 [INF] Executed endpoint 'xbytechat.api.CRM.Controllers.TagsController.GetAllTags (xbytechat.api)'
2025-07-02 23:00:45.271 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/tags - 200 null application/json; charset=utf-8 57.1585ms
2025-07-02 23:00:51.046 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/api/campaign/d0f71321-88d2-4b99-91e0-5b5f0174400f/assign-contacts - null null
2025-07-02 23:00:51.049 +05:30 [INF] CORS policy execution successful.
2025-07-02 23:00:51.051 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/api/campaign/d0f71321-88d2-4b99-91e0-5b5f0174400f/assign-contacts - 204 null null 4.627ms
2025-07-02 23:00:51.053 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/api/campaign/d0f71321-88d2-4b99-91e0-5b5f0174400f/assign-contacts - application/json 55
2025-07-02 23:00:51.057 +05:30 [INF] CORS policy execution successful.
2025-07-02 23:00:51.059 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.AssignContactsToCampaign (xbytechat.api)'
2025-07-02 23:00:51.060 +05:30 [INF] Route matched with {action = "AssignContactsToCampaign", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AssignContactsToCampaign(System.Guid, xbytechat.api.Features.CampaignModule.DTOs.AssignContactsDto) on controller xbytechat.api.Features.CampaignModule.Controllers.CampaignController (xbytechat.api).
2025-07-02 23:00:52.645 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__campaignId_0='d0f71321-88d2-4b99-91e0-5b5f0174400f', @__businessId_1='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."BusinessId", t."CampaignId", t."CampaignType", t."CreatedAt", t."CreatedBy", t."CtaId", t."DeletedAt", t."DeletedBy", t."FollowUpTemplateId", t."ImageCaption", t."ImageUrl", t."IsDeleted", t."MessageBody", t."MessageTemplate", t."Name", t."ScheduledAt", t."SourceCampaignId", t."Status", t."TemplateId", t."TemplateParameters", t."UpdatedAt", c0."Id", c0."BotId", c0."BusinessId", c0."CampaignId", c0."CategoryBrowsed", c0."ClickedCTA", c0."ContactId", c0."IsAutoTagged", c0."MessagePreview", c0."ProductBrowsed", c0."SentAt", c0."Status", c0."UpdatedAt"
FROM (
    SELECT c."Id", c."BusinessId", c."CampaignId", c."CampaignType", c."CreatedAt", c."CreatedBy", c."CtaId", c."DeletedAt", c."DeletedBy", c."FollowUpTemplateId", c."ImageCaption", c."ImageUrl", c."IsDeleted", c."MessageBody", c."MessageTemplate", c."Name", c."ScheduledAt", c."SourceCampaignId", c."Status", c."TemplateId", c."TemplateParameters", c."UpdatedAt"
    FROM "Campaigns" AS c
    WHERE c."Id" = @__campaignId_0 AND c."BusinessId" = @__businessId_1
    LIMIT 1
) AS t
LEFT JOIN "CampaignRecipients" AS c0 ON t."Id" = c0."CampaignId"
ORDER BY t."Id"
2025-07-02 23:00:52.673 +05:30 [INF] Executed DbCommand (21ms) [Parameters=[@p0='c05cab06-f4d9-4175-bf4c-2b2fdab36f18', @p1=NULL, @p2='c13be597-6ae2-42bb-9d43-925815f24ff8', @p3='d0f71321-88d2-4b99-91e0-5b5f0174400f', @p4=NULL, @p5=NULL, @p6='8aac7c57-6699-4511-897b-4121b407eb1c', @p7='False', @p8=NULL, @p9=NULL, @p10='2025-07-02T17:30:52.6518212Z' (Nullable = true) (DbType = DateTime), @p11='Pending' (Nullable = false), @p12='2025-07-02T17:30:52.6518216Z' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "CampaignRecipients" ("Id", "BotId", "BusinessId", "CampaignId", "CategoryBrowsed", "ClickedCTA", "ContactId", "IsAutoTagged", "MessagePreview", "ProductBrowsed", "SentAt", "Status", "UpdatedAt")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12);
2025-07-02 23:00:52.676 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType16`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 23:00:52.678 +05:30 [INF] Executed action xbytechat.api.Features.CampaignModule.Controllers.CampaignController.AssignContactsToCampaign (xbytechat.api) in 1615.8687ms
2025-07-02 23:00:52.680 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.AssignContactsToCampaign (xbytechat.api)'
2025-07-02 23:00:52.682 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/api/campaign/d0f71321-88d2-4b99-91e0-5b5f0174400f/assign-contacts - 200 null application/json; charset=utf-8 1629.4769ms
2025-07-02 23:01:01.788 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/campaign/get-image-campaign - null null
2025-07-02 23:01:01.791 +05:30 [INF] CORS policy execution successful.
2025-07-02 23:01:01.793 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetAll (xbytechat.api)'
2025-07-02 23:01:01.794 +05:30 [INF] Route matched with {action = "GetAll", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAll(System.String) on controller xbytechat.api.Features.CampaignModule.Controllers.CampaignController (xbytechat.api).
2025-07-02 23:01:01.805 +05:30 [INF] Executed DbCommand (5ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Name", c."Status", c."ScheduledAt", c."CreatedAt", c."ImageUrl", c."ImageCaption", c0."Title" AS "CtaTitle", (
    SELECT count(*)::int
    FROM "CampaignRecipients" AS c1
    WHERE c."Id" = c1."CampaignId") AS "RecipientCount"
FROM "Campaigns" AS c
LEFT JOIN "CTADefinitions" AS c0 ON c."CtaId" = c0."Id"
WHERE c."BusinessId" = @__businessId_0
ORDER BY c."CreatedAt" DESC
2025-07-02 23:01:01.810 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.CampaignModule.DTOs.CampaignSummaryDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 23:01:01.812 +05:30 [INF] Executed action xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetAll (xbytechat.api) in 15.5004ms
2025-07-02 23:01:01.813 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetAll (xbytechat.api)'
2025-07-02 23:01:01.815 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/campaign/get-image-campaign - 200 null application/json; charset=utf-8 27.4109ms
2025-07-02 23:01:04.673 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/api/campaign/send-campaign/d0f71321-88d2-4b99-91e0-5b5f0174400f - null 0
2025-07-02 23:01:04.677 +05:30 [INF] CORS policy execution successful.
2025-07-02 23:01:04.678 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.SendTemplateCampaign (xbytechat.api)'
2025-07-02 23:01:04.680 +05:30 [INF] Route matched with {action = "SendTemplateCampaign", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendTemplateCampaign(System.Guid) on controller xbytechat.api.Features.CampaignModule.Controllers.CampaignController (xbytechat.api).
2025-07-02 23:01:04.690 +05:30 [INF] Executed DbCommand (5ms) [Parameters=[@__campaignId_0='d0f71321-88d2-4b99-91e0-5b5f0174400f'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."BusinessId", t."CampaignId", t."CampaignType", t."CreatedAt", t."CreatedBy", t."CtaId", t."DeletedAt", t."DeletedBy", t."FollowUpTemplateId", t."ImageCaption", t."ImageUrl", t."IsDeleted", t."MessageBody", t."MessageTemplate", t."Name", t."ScheduledAt", t."SourceCampaignId", t."Status", t."TemplateId", t."TemplateParameters", t."UpdatedAt", t0."Id", t0."BotId", t0."BusinessId", t0."CampaignId", t0."CategoryBrowsed", t0."ClickedCTA", t0."ContactId", t0."IsAutoTagged", t0."MessagePreview", t0."ProductBrowsed", t0."SentAt", t0."Status", t0."UpdatedAt", t0."Id0", t0."AssignedAgentId", t0."BusinessId0", t0."CreatedAt", t0."Email", t0."Group", t0."IsActive", t0."IsArchived", t0."IsAutomationPaused", t0."IsFavorite", t0."LastCTAInteraction", t0."LastCTAType", t0."LastClickedProductId", t0."LastContactedAt", t0."LeadSource", t0."Name", t0."NextFollowUpAt", t0."Notes", t0."PhoneNumber", t0."Tags", c2."Id", c2."CampaignId", c2."IsFromTemplate", c2."Position", c2."Title", c2."Type", c2."Value"
FROM (
    SELECT c."Id", c."BusinessId", c."CampaignId", c."CampaignType", c."CreatedAt", c."CreatedBy", c."CtaId", c."DeletedAt", c."DeletedBy", c."FollowUpTemplateId", c."ImageCaption", c."ImageUrl", c."IsDeleted", c."MessageBody", c."MessageTemplate", c."Name", c."ScheduledAt", c."SourceCampaignId", c."Status", c."TemplateId", c."TemplateParameters", c."UpdatedAt"
    FROM "Campaigns" AS c
    WHERE c."Id" = @__campaignId_0 AND NOT (c."IsDeleted")
    LIMIT 1
) AS t
LEFT JOIN (
    SELECT c0."Id", c0."BotId", c0."BusinessId", c0."CampaignId", c0."CategoryBrowsed", c0."ClickedCTA", c0."ContactId", c0."IsAutoTagged", c0."MessagePreview", c0."ProductBrowsed", c0."SentAt", c0."Status", c0."UpdatedAt", c1."Id" AS "Id0", c1."AssignedAgentId", c1."BusinessId" AS "BusinessId0", c1."CreatedAt", c1."Email", c1."Group", c1."IsActive", c1."IsArchived", c1."IsAutomationPaused", c1."IsFavorite", c1."LastCTAInteraction", c1."LastCTAType", c1."LastClickedProductId", c1."LastContactedAt", c1."LeadSource", c1."Name", c1."NextFollowUpAt", c1."Notes", c1."PhoneNumber", c1."Tags"
    FROM "CampaignRecipients" AS c0
    INNER JOIN "Contacts" AS c1 ON c0."ContactId" = c1."Id"
) AS t0 ON t."Id" = t0."CampaignId"
LEFT JOIN "CampaignButtons" AS c2 ON t."Id" = c2."CampaignId"
ORDER BY t."Id", t0."Id", t0."Id0"
2025-07-02 23:01:04.697 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiToken", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."IsActive" AND w."BusinessId" = @__businessId_0
LIMIT 1
2025-07-02 23:01:04.701 +05:30 [INF] Start processing HTTP request GET https://graph.facebook.com/v22.0/999432368375320/message_templates
2025-07-02 23:01:04.703 +05:30 [INF] Sending HTTP request GET https://graph.facebook.com/v22.0/999432368375320/message_templates
2025-07-02 23:01:06.012 +05:30 [INF] Received HTTP response headers after 1306.9213ms - 200
2025-07-02 23:01:06.015 +05:30 [INF] End processing HTTP request after 1314.3045ms - 200
2025-07-02 23:01:06.018 +05:30 [ERR] ❌ Could not fetch template metadata for null.
2025-07-02 23:01:06.039 +05:30 [INF] Executing BadRequestObjectResult, writing value of type 'xbytechat.api.Helpers.ResponseResult'.
2025-07-02 23:01:06.043 +05:30 [INF] Executed action xbytechat.api.Features.CampaignModule.Controllers.CampaignController.SendTemplateCampaign (xbytechat.api) in 1359.8478ms
2025-07-02 23:01:06.045 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.SendTemplateCampaign (xbytechat.api)'
2025-07-02 23:01:06.046 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/api/campaign/send-campaign/d0f71321-88d2-4b99-91e0-5b5f0174400f - 400 null application/json; charset=utf-8 1372.963ms
2025-07-02 23:01:41.714 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/whatsappsettings/me - null null
2025-07-02 23:01:41.724 +05:30 [INF] CORS policy execution successful.
2025-07-02 23:01:41.726 +05:30 [INF] Executing endpoint 'xbytechat_api.WhatsAppSettings.Controllers.WhatsAppSettingsController.GetMySettings (xbytechat.api)'
2025-07-02 23:01:41.738 +05:30 [INF] Route matched with {action = "GetMySettings", controller = "WhatsAppSettings"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMySettings() on controller xbytechat_api.WhatsAppSettings.Controllers.WhatsAppSettingsController (xbytechat.api).
2025-07-02 23:01:41.864 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiToken", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."BusinessId" = @__businessId_0 AND w."IsActive"
LIMIT 1
2025-07-02 23:01:41.868 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat_api.WhatsAppSettings.Models.WhatsAppSettingEntity'.
2025-07-02 23:01:41.872 +05:30 [INF] Executed action xbytechat_api.WhatsAppSettings.Controllers.WhatsAppSettingsController.GetMySettings (xbytechat.api) in 130.3848ms
2025-07-02 23:01:41.874 +05:30 [INF] Executed endpoint 'xbytechat_api.WhatsAppSettings.Controllers.WhatsAppSettingsController.GetMySettings (xbytechat.api)'
2025-07-02 23:01:41.876 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/whatsappsettings/me - 200 null application/json; charset=utf-8 161.5014ms
2025-07-02 23:01:46.585 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/api/whatsappsettings/update - null null
2025-07-02 23:01:46.590 +05:30 [INF] CORS policy execution successful.
2025-07-02 23:01:46.591 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/api/whatsappsettings/update - 204 null null 6.8699ms
2025-07-02 23:01:46.595 +05:30 [INF] Request starting HTTP/1.1 PUT http://localhost:7113/api/whatsappsettings/update - application/json 473
2025-07-02 23:01:46.601 +05:30 [INF] CORS policy execution successful.
2025-07-02 23:01:46.602 +05:30 [INF] Executing endpoint 'xbytechat_api.WhatsAppSettings.Controllers.WhatsAppSettingsController.UpdateSetting (xbytechat.api)'
2025-07-02 23:01:46.608 +05:30 [INF] Route matched with {action = "UpdateSetting", controller = "WhatsAppSettings"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] UpdateSetting(xbytechat_api.WhatsAppSettings.DTOs.SaveWhatsAppSettingDto) on controller xbytechat_api.WhatsAppSettings.Controllers.WhatsAppSettingsController (xbytechat.api).
2025-07-02 23:01:46.619 +05:30 [INF] 🔧 [UpdateSetting] Request received for WhatsApp settings update.
2025-07-02 23:01:46.621 +05:30 [INF] 💾 [UpdateSetting] Saving/updating WhatsApp settings for businessId="c13be597-6ae2-42bb-9d43-925815f24ff8".
2025-07-02 23:01:46.631 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__dto_BusinessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiToken", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."BusinessId" = @__dto_BusinessId_0
LIMIT 1
2025-07-02 23:01:46.659 +05:30 [INF] Executed DbCommand (21ms) [Parameters=[@p2='36de2595-f729-4b07-9958-11c8a56db12f', @p0='EAAIo1fBYKV8BO5qNmbeqD5qheAfKSt1KXQugsdzaZAw22vPvuY5CRBkCvs0ZCoSHxJFE7ywmVqHbPsBcqBtEO73XKlYkay6oxZCXN2M3BPDAHVLK8vrdrE3KcgZAtJiO4VcZBFaK6fFDm1KAeqRX5RZCJH5opyEqYW9N0dfFvEoXDIGPlNnuUsMrQuZCbZCyZBuaoCAem6XNMXTZCUsFVhpFWdr7fzXKTODpOx44BW5nH2wkCHUwCGZCAvVc1hw7Vs6s3cZD' (Nullable = false), @p1='2025-07-02T17:31:46.6382219Z' (Nullable = true) (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE "WhatsAppSettings" SET "ApiToken" = @p0, "UpdatedAt" = @p1
WHERE "Id" = @p2;
2025-07-02 23:01:46.665 +05:30 [INF] ✅ [UpdateSetting] WhatsApp settings updated successfully.
2025-07-02 23:01:46.666 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType16`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 23:01:46.668 +05:30 [INF] Executed action xbytechat_api.WhatsAppSettings.Controllers.WhatsAppSettingsController.UpdateSetting (xbytechat.api) in 57.7918ms
2025-07-02 23:01:46.669 +05:30 [INF] Executed endpoint 'xbytechat_api.WhatsAppSettings.Controllers.WhatsAppSettingsController.UpdateSetting (xbytechat.api)'
2025-07-02 23:01:46.671 +05:30 [INF] Request finished HTTP/1.1 PUT http://localhost:7113/api/whatsappsettings/update - 200 null application/json; charset=utf-8 76.1604ms
2025-07-02 23:01:47.751 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/api/whatsappsettings/test-connection - null null
2025-07-02 23:01:47.755 +05:30 [INF] CORS policy execution successful.
2025-07-02 23:01:47.757 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/api/whatsappsettings/test-connection - 204 null null 6.0087ms
2025-07-02 23:01:47.759 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/api/whatsappsettings/test-connection - application/json 473
2025-07-02 23:01:47.766 +05:30 [INF] CORS policy execution successful.
2025-07-02 23:01:47.767 +05:30 [INF] Executing endpoint 'xbytechat_api.WhatsAppSettings.Controllers.WhatsAppSettingsController.TestConnection (xbytechat.api)'
2025-07-02 23:01:47.772 +05:30 [INF] Route matched with {action = "TestConnection", controller = "WhatsAppSettings"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] TestConnection(xbytechat_api.WhatsAppSettings.DTOs.SaveWhatsAppSettingDto) on controller xbytechat_api.WhatsAppSettings.Controllers.WhatsAppSettingsController (xbytechat.api).
2025-07-02 23:01:49.010 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType16`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 23:01:49.013 +05:30 [INF] Executed action xbytechat_api.WhatsAppSettings.Controllers.WhatsAppSettingsController.TestConnection (xbytechat.api) in 1237.5287ms
2025-07-02 23:01:49.016 +05:30 [INF] Executed endpoint 'xbytechat_api.WhatsAppSettings.Controllers.WhatsAppSettingsController.TestConnection (xbytechat.api)'
2025-07-02 23:01:49.017 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/api/whatsappsettings/test-connection - 200 null application/json; charset=utf-8 1257.9573ms
2025-07-02 23:01:59.859 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/campaign/get-image-campaign - null null
2025-07-02 23:01:59.874 +05:30 [INF] CORS policy execution successful.
2025-07-02 23:01:59.876 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetAll (xbytechat.api)'
2025-07-02 23:01:59.877 +05:30 [INF] Route matched with {action = "GetAll", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAll(System.String) on controller xbytechat.api.Features.CampaignModule.Controllers.CampaignController (xbytechat.api).
2025-07-02 23:01:59.887 +05:30 [INF] Executed DbCommand (6ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Name", c."Status", c."ScheduledAt", c."CreatedAt", c."ImageUrl", c."ImageCaption", c0."Title" AS "CtaTitle", (
    SELECT count(*)::int
    FROM "CampaignRecipients" AS c1
    WHERE c."Id" = c1."CampaignId") AS "RecipientCount"
FROM "Campaigns" AS c
LEFT JOIN "CTADefinitions" AS c0 ON c."CtaId" = c0."Id"
WHERE c."BusinessId" = @__businessId_0
ORDER BY c."CreatedAt" DESC
2025-07-02 23:01:59.893 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.CampaignModule.DTOs.CampaignSummaryDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 23:01:59.896 +05:30 [INF] Executed action xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetAll (xbytechat.api) in 16.6535ms
2025-07-02 23:01:59.899 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetAll (xbytechat.api)'
2025-07-02 23:01:59.901 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/campaign/get-image-campaign - 200 null application/json; charset=utf-8 41.4659ms
2025-07-02 23:02:02.836 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/api/campaign/send-campaign/d0f71321-88d2-4b99-91e0-5b5f0174400f - null 0
2025-07-02 23:02:02.840 +05:30 [INF] CORS policy execution successful.
2025-07-02 23:02:02.841 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.SendTemplateCampaign (xbytechat.api)'
2025-07-02 23:02:02.843 +05:30 [INF] Route matched with {action = "SendTemplateCampaign", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendTemplateCampaign(System.Guid) on controller xbytechat.api.Features.CampaignModule.Controllers.CampaignController (xbytechat.api).
2025-07-02 23:02:02.853 +05:30 [INF] Executed DbCommand (5ms) [Parameters=[@__campaignId_0='d0f71321-88d2-4b99-91e0-5b5f0174400f'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."BusinessId", t."CampaignId", t."CampaignType", t."CreatedAt", t."CreatedBy", t."CtaId", t."DeletedAt", t."DeletedBy", t."FollowUpTemplateId", t."ImageCaption", t."ImageUrl", t."IsDeleted", t."MessageBody", t."MessageTemplate", t."Name", t."ScheduledAt", t."SourceCampaignId", t."Status", t."TemplateId", t."TemplateParameters", t."UpdatedAt", t0."Id", t0."BotId", t0."BusinessId", t0."CampaignId", t0."CategoryBrowsed", t0."ClickedCTA", t0."ContactId", t0."IsAutoTagged", t0."MessagePreview", t0."ProductBrowsed", t0."SentAt", t0."Status", t0."UpdatedAt", t0."Id0", t0."AssignedAgentId", t0."BusinessId0", t0."CreatedAt", t0."Email", t0."Group", t0."IsActive", t0."IsArchived", t0."IsAutomationPaused", t0."IsFavorite", t0."LastCTAInteraction", t0."LastCTAType", t0."LastClickedProductId", t0."LastContactedAt", t0."LeadSource", t0."Name", t0."NextFollowUpAt", t0."Notes", t0."PhoneNumber", t0."Tags", c2."Id", c2."CampaignId", c2."IsFromTemplate", c2."Position", c2."Title", c2."Type", c2."Value"
FROM (
    SELECT c."Id", c."BusinessId", c."CampaignId", c."CampaignType", c."CreatedAt", c."CreatedBy", c."CtaId", c."DeletedAt", c."DeletedBy", c."FollowUpTemplateId", c."ImageCaption", c."ImageUrl", c."IsDeleted", c."MessageBody", c."MessageTemplate", c."Name", c."ScheduledAt", c."SourceCampaignId", c."Status", c."TemplateId", c."TemplateParameters", c."UpdatedAt"
    FROM "Campaigns" AS c
    WHERE c."Id" = @__campaignId_0 AND NOT (c."IsDeleted")
    LIMIT 1
) AS t
LEFT JOIN (
    SELECT c0."Id", c0."BotId", c0."BusinessId", c0."CampaignId", c0."CategoryBrowsed", c0."ClickedCTA", c0."ContactId", c0."IsAutoTagged", c0."MessagePreview", c0."ProductBrowsed", c0."SentAt", c0."Status", c0."UpdatedAt", c1."Id" AS "Id0", c1."AssignedAgentId", c1."BusinessId" AS "BusinessId0", c1."CreatedAt", c1."Email", c1."Group", c1."IsActive", c1."IsArchived", c1."IsAutomationPaused", c1."IsFavorite", c1."LastCTAInteraction", c1."LastCTAType", c1."LastClickedProductId", c1."LastContactedAt", c1."LeadSource", c1."Name", c1."NextFollowUpAt", c1."Notes", c1."PhoneNumber", c1."Tags"
    FROM "CampaignRecipients" AS c0
    INNER JOIN "Contacts" AS c1 ON c0."ContactId" = c1."Id"
) AS t0 ON t."Id" = t0."CampaignId"
LEFT JOIN "CampaignButtons" AS c2 ON t."Id" = c2."CampaignId"
ORDER BY t."Id", t0."Id", t0."Id0"
2025-07-02 23:02:02.859 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiToken", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."IsActive" AND w."BusinessId" = @__businessId_0
LIMIT 1
2025-07-02 23:02:02.863 +05:30 [INF] Start processing HTTP request GET https://graph.facebook.com/v22.0/999432368375320/message_templates
2025-07-02 23:02:02.865 +05:30 [INF] Sending HTTP request GET https://graph.facebook.com/v22.0/999432368375320/message_templates
2025-07-02 23:02:03.755 +05:30 [INF] Received HTTP response headers after 888.7114ms - 200
2025-07-02 23:02:03.757 +05:30 [INF] End processing HTTP request after 894.3578ms - 200
2025-07-02 23:02:03.760 +05:30 [ERR] ❌ Could not fetch template metadata for null.
2025-07-02 23:02:03.761 +05:30 [INF] Executing BadRequestObjectResult, writing value of type 'xbytechat.api.Helpers.ResponseResult'.
2025-07-02 23:02:03.763 +05:30 [INF] Executed action xbytechat.api.Features.CampaignModule.Controllers.CampaignController.SendTemplateCampaign (xbytechat.api) in 917.1885ms
2025-07-02 23:02:03.769 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.SendTemplateCampaign (xbytechat.api)'
2025-07-02 23:02:03.771 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/api/campaign/send-campaign/d0f71321-88d2-4b99-91e0-5b5f0174400f - 400 null application/json; charset=utf-8 934.9359ms
2025-07-02 23:02:06.870 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/auth/session - null null
2025-07-02 23:02:06.873 +05:30 [INF] Executing endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 23:02:06.875 +05:30 [INF] Route matched with {action = "GetSession", controller = "Auth"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetSession() on controller xbytechat.api.AuthModule.Controllers.AuthController (xbytechat.api).
2025-07-02 23:02:06.877 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`4[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 23:02:06.879 +05:30 [INF] Executed action xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api) in 2.2148ms
2025-07-02 23:02:06.883 +05:30 [INF] Executed endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 23:02:06.886 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/auth/session - 200 null application/json; charset=utf-8 16.1631ms
2025-07-02 23:02:06.975 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/feature-access/me - null null
2025-07-02 23:02:06.983 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 23:02:06.986 +05:30 [INF] Route matched with {action = "GetMyFeatures", controller = "FeatureAccess"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto]]] GetMyFeatures() on controller xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController (xbytechat.api).
2025-07-02 23:02:07.000 +05:30 [INF] Executed DbCommand (9ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT b."Id", b."Address", b."ApprovedAt", b."ApprovedBy", b."BusinessEmail", b."BusinessName", b."CompanyName", b."CompanyPhone", b."CreatedAt", b."CreatedBy", b."CreatedByPartnerId", b."DeletedAt", b."DeletedBy", b."Industry", b."IsApproved", b."IsDeleted", b."LastLoginAt", b."LogoUrl", b."Notes", b."Phone", b."RepresentativeName", b."Source", b."Status", b."Tags", b."Website", b0."Id", b0."BusinessId", b0."CreatedAt", b0."Plan", b0."QuotaResetDate", b0."RemainingMessages", b0."TotalMonthlyQuota", b0."UpdatedAt", b0."WalletBalance"
FROM "Businesses" AS b
LEFT JOIN "BusinessPlanInfos" AS b0 ON b."Id" = b0."BusinessId"
WHERE b."Id" = @__businessId_0
LIMIT 1
2025-07-02 23:02:07.011 +05:30 [INF] 📦 Resolved plan for Business "c13be597-6ae2-42bb-9d43-925815f24ff8": Smart
2025-07-02 23:02:07.016 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."BusinessId", f."CreatedAt", f."Description", f."FeatureName", f."Group", f."IsEnabled", f."Notes", f."Plan"
FROM "FeatureAccess" AS f
WHERE f."BusinessId" = @__businessId_0
2025-07-02 23:02:07.020 +05:30 [INF] 🔧 Feature override: AddProduct = False
2025-07-02 23:02:07.021 +05:30 [INF] 🔧 Feature override: Automation = True
2025-07-02 23:02:07.022 +05:30 [INF] 🔧 Feature override: Campaigns = True
2025-07-02 23:02:07.023 +05:30 [INF] 🔧 Feature override: Catalog = True
2025-07-02 23:02:07.024 +05:30 [INF] 🔧 Feature override: CRM = True
2025-07-02 23:02:07.025 +05:30 [INF] 🔧 Feature override: CRMInsights = True
2025-07-02 23:02:07.027 +05:30 [INF] 🔧 Feature override: CTAFlow = True
2025-07-02 23:02:07.028 +05:30 [INF] 🔧 Feature override: FlowInsights = True
2025-07-02 23:02:07.029 +05:30 [INF] 🔧 Feature override: Messaging = True
2025-07-02 23:02:07.030 +05:30 [INF] 🔧 Feature override: ProfileCompletion = True
2025-07-02 23:02:07.032 +05:30 [INF] 🔧 Feature override: UpgradePlan = True
2025-07-02 23:02:07.033 +05:30 [INF] 🔧 Feature override: WhatsAppSettings = True
2025-07-02 23:02:07.035 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 23:02:07.037 +05:30 [INF] Executed action xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api) in 47.8535ms
2025-07-02 23:02:07.039 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 23:02:07.041 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/feature-access/me - 200 null application/json; charset=utf-8 65.7098ms
2025-07-02 23:02:07.084 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/campaign/get-image-campaign - null null
2025-07-02 23:02:07.088 +05:30 [INF] CORS policy execution successful.
2025-07-02 23:02:07.089 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetAll (xbytechat.api)'
2025-07-02 23:02:07.091 +05:30 [INF] Route matched with {action = "GetAll", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAll(System.String) on controller xbytechat.api.Features.CampaignModule.Controllers.CampaignController (xbytechat.api).
2025-07-02 23:02:07.099 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Name", c."Status", c."ScheduledAt", c."CreatedAt", c."ImageUrl", c."ImageCaption", c0."Title" AS "CtaTitle", (
    SELECT count(*)::int
    FROM "CampaignRecipients" AS c1
    WHERE c."Id" = c1."CampaignId") AS "RecipientCount"
FROM "Campaigns" AS c
LEFT JOIN "CTADefinitions" AS c0 ON c."CtaId" = c0."Id"
WHERE c."BusinessId" = @__businessId_0
ORDER BY c."CreatedAt" DESC
2025-07-02 23:02:07.104 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.CampaignModule.DTOs.CampaignSummaryDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 23:02:07.106 +05:30 [INF] Executed action xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetAll (xbytechat.api) in 11.4826ms
2025-07-02 23:02:07.109 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetAll (xbytechat.api)'
2025-07-02 23:02:07.110 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/campaign/get-image-campaign - 200 null application/json; charset=utf-8 26.3035ms
2025-07-02 23:02:08.842 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/api/campaign/send-campaign/d0f71321-88d2-4b99-91e0-5b5f0174400f - null 0
2025-07-02 23:02:08.846 +05:30 [INF] CORS policy execution successful.
2025-07-02 23:02:08.848 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.SendTemplateCampaign (xbytechat.api)'
2025-07-02 23:02:08.850 +05:30 [INF] Route matched with {action = "SendTemplateCampaign", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendTemplateCampaign(System.Guid) on controller xbytechat.api.Features.CampaignModule.Controllers.CampaignController (xbytechat.api).
2025-07-02 23:02:08.859 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__campaignId_0='d0f71321-88d2-4b99-91e0-5b5f0174400f'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."BusinessId", t."CampaignId", t."CampaignType", t."CreatedAt", t."CreatedBy", t."CtaId", t."DeletedAt", t."DeletedBy", t."FollowUpTemplateId", t."ImageCaption", t."ImageUrl", t."IsDeleted", t."MessageBody", t."MessageTemplate", t."Name", t."ScheduledAt", t."SourceCampaignId", t."Status", t."TemplateId", t."TemplateParameters", t."UpdatedAt", t0."Id", t0."BotId", t0."BusinessId", t0."CampaignId", t0."CategoryBrowsed", t0."ClickedCTA", t0."ContactId", t0."IsAutoTagged", t0."MessagePreview", t0."ProductBrowsed", t0."SentAt", t0."Status", t0."UpdatedAt", t0."Id0", t0."AssignedAgentId", t0."BusinessId0", t0."CreatedAt", t0."Email", t0."Group", t0."IsActive", t0."IsArchived", t0."IsAutomationPaused", t0."IsFavorite", t0."LastCTAInteraction", t0."LastCTAType", t0."LastClickedProductId", t0."LastContactedAt", t0."LeadSource", t0."Name", t0."NextFollowUpAt", t0."Notes", t0."PhoneNumber", t0."Tags", c2."Id", c2."CampaignId", c2."IsFromTemplate", c2."Position", c2."Title", c2."Type", c2."Value"
FROM (
    SELECT c."Id", c."BusinessId", c."CampaignId", c."CampaignType", c."CreatedAt", c."CreatedBy", c."CtaId", c."DeletedAt", c."DeletedBy", c."FollowUpTemplateId", c."ImageCaption", c."ImageUrl", c."IsDeleted", c."MessageBody", c."MessageTemplate", c."Name", c."ScheduledAt", c."SourceCampaignId", c."Status", c."TemplateId", c."TemplateParameters", c."UpdatedAt"
    FROM "Campaigns" AS c
    WHERE c."Id" = @__campaignId_0 AND NOT (c."IsDeleted")
    LIMIT 1
) AS t
LEFT JOIN (
    SELECT c0."Id", c0."BotId", c0."BusinessId", c0."CampaignId", c0."CategoryBrowsed", c0."ClickedCTA", c0."ContactId", c0."IsAutoTagged", c0."MessagePreview", c0."ProductBrowsed", c0."SentAt", c0."Status", c0."UpdatedAt", c1."Id" AS "Id0", c1."AssignedAgentId", c1."BusinessId" AS "BusinessId0", c1."CreatedAt", c1."Email", c1."Group", c1."IsActive", c1."IsArchived", c1."IsAutomationPaused", c1."IsFavorite", c1."LastCTAInteraction", c1."LastCTAType", c1."LastClickedProductId", c1."LastContactedAt", c1."LeadSource", c1."Name", c1."NextFollowUpAt", c1."Notes", c1."PhoneNumber", c1."Tags"
    FROM "CampaignRecipients" AS c0
    INNER JOIN "Contacts" AS c1 ON c0."ContactId" = c1."Id"
) AS t0 ON t."Id" = t0."CampaignId"
LEFT JOIN "CampaignButtons" AS c2 ON t."Id" = c2."CampaignId"
ORDER BY t."Id", t0."Id", t0."Id0"
2025-07-02 23:02:08.866 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiToken", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."IsActive" AND w."BusinessId" = @__businessId_0
LIMIT 1
2025-07-02 23:02:08.869 +05:30 [INF] Start processing HTTP request GET https://graph.facebook.com/v22.0/999432368375320/message_templates
2025-07-02 23:02:08.871 +05:30 [INF] Sending HTTP request GET https://graph.facebook.com/v22.0/999432368375320/message_templates
2025-07-02 23:02:09.592 +05:30 [INF] Received HTTP response headers after 719.1217ms - 200
2025-07-02 23:02:09.594 +05:30 [INF] End processing HTTP request after 725.2253ms - 200
2025-07-02 23:02:09.596 +05:30 [ERR] ❌ Could not fetch template metadata for null.
2025-07-02 23:02:09.598 +05:30 [INF] Executing BadRequestObjectResult, writing value of type 'xbytechat.api.Helpers.ResponseResult'.
2025-07-02 23:02:09.600 +05:30 [INF] Executed action xbytechat.api.Features.CampaignModule.Controllers.CampaignController.SendTemplateCampaign (xbytechat.api) in 746.1101ms
2025-07-02 23:02:09.602 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.SendTemplateCampaign (xbytechat.api)'
2025-07-02 23:02:09.604 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/api/campaign/send-campaign/d0f71321-88d2-4b99-91e0-5b5f0174400f - 400 null application/json; charset=utf-8 762.2232ms
2025-07-02 23:03:19.094 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/api/autoreplyflows/save - application/json 610
2025-07-02 23:03:19.103 +05:30 [INF] CORS policy execution failed.
2025-07-02 23:03:19.104 +05:30 [INF] Request origin http://localhost:7113/ does not have permission to access the resource.
2025-07-02 23:03:19.106 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.AutoReplyBuilder.Flows.Controllers.AutoReplyFlowsController.SaveFlow (xbytechat.api)'
2025-07-02 23:03:19.112 +05:30 [INF] Route matched with {action = "SaveFlow", controller = "AutoReplyFlows"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SaveFlow(xbytechat.api.Features.AutoReplyBuilder.Flows.DTOs.SaveFlowDto) on controller xbytechat.api.Features.AutoReplyBuilder.Flows.Controllers.AutoReplyFlowsController (xbytechat.api).
2025-07-02 23:03:19.139 +05:30 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-07-02 23:03:19.142 +05:30 [INF] Executed action xbytechat.api.Features.AutoReplyBuilder.Flows.Controllers.AutoReplyFlowsController.SaveFlow (xbytechat.api) in 26.8874ms
2025-07-02 23:03:19.144 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.AutoReplyBuilder.Flows.Controllers.AutoReplyFlowsController.SaveFlow (xbytechat.api)'
2025-07-02 23:03:19.145 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/api/autoreplyflows/save - 400 null application/problem+json; charset=utf-8 51.8064ms
2025-07-02 23:03:33.468 +05:30 [INF] Request starting HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - application/json 491
2025-07-02 23:03:33.473 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 23:03:33.474 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-07-02 23:03:33.477 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"contacts":[{"profile":{"name":"\ua9c1S.K\ua9c2"},"wa_id":"917082156227"}],"messages":[{"from":"917082156227","id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAEhggRTlEMjE0QjBFQTdFN0RDNEQ0MkI5RUQ4RjYyQUMyOUUA","timestamp":"1751477616","text":{"body":"hi"},"type":"text"}]},"field":"messages"}]}]}
2025-07-02 23:03:33.479 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-07-02 23:03:33.480 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"contacts":[{"profile":{"name":"\ua9c1S.K\ua9c2"},"wa_id":"917082156227"}],"messages":[{"from":"917082156227","id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAEhggRTlEMjE0QjBFQTdFN0RDNEQ0MkI5RUQ4RjYyQUMyOUUA","timestamp":"1751477616","text":{"body":"hi"},"type":"text"}]},"field":"messages"}]}]}
2025-07-02 23:03:33.481 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType73`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 23:03:33.483 +05:30 [INF] 💬 Routing to InboundMessageProcessor (type: text)
2025-07-02 23:03:33.484 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 7.8175ms
2025-07-02 23:03:33.488 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 23:03:33.489 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessNumber_0='15556395845'], CommandType='"Text"', CommandTimeout='30']
SELECT b."Id", b."Address", b."ApprovedAt", b."ApprovedBy", b."BusinessEmail", b."BusinessName", b."CompanyName", b."CompanyPhone", b."CreatedAt", b."CreatedBy", b."CreatedByPartnerId", b."DeletedAt", b."DeletedBy", b."Industry", b."IsApproved", b."IsDeleted", b."LastLoginAt", b."LogoUrl", b."Notes", b."Phone", b."RepresentativeName", b."Source", b."Status", b."Tags", b."Website", w."Id", w."ApiToken", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WhatsAppBusinessNumber"
FROM "Businesses" AS b
LEFT JOIN "WhatsAppSettings" AS w ON b."Id" = w."BusinessId"
WHERE w."WhatsAppBusinessNumber" = @__businessNumber_0
LIMIT 1
2025-07-02 23:03:33.497 +05:30 [INF] Request finished HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 28.5213ms
2025-07-02 23:03:33.500 +05:30 [INF] FindOrCreateAsync: businessId="c13be597-6ae2-42bb-9d43-925815f24ff8", phoneNumber=917082156227
2025-07-02 23:03:33.507 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__phoneNumber_1='917082156227'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."Tags"
FROM "Contacts" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."PhoneNumber" = @__phoneNumber_1
LIMIT 1
2025-07-02 23:03:33.510 +05:30 [INF] Contact already exists: contactId="0876f654-a362-420f-a912-6bce793436a5"
2025-07-02 23:03:33.513 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__contactId_1='0876f654-a362-420f-a912-6bce793436a5'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."BusinessId", c."ContactId", c."LastUpdatedAt", c."Mode", c."UpdatedBy"
FROM "ChatSessionStates" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."ContactId" = @__contactId_1
LIMIT 1
2025-07-02 23:03:33.540 +05:30 [INF] Executed DbCommand (23ms) [Parameters=[@p0='2ca8a311-e3a7-40f3-992b-e9a11924bc2b', @p1='c13be597-6ae2-42bb-9d43-925815f24ff8', @p2=NULL (DbType = Guid), @p3=NULL (DbType = Guid), @p4=NULL (DbType = Guid), @p5='0876f654-a362-420f-a912-6bce793436a5' (Nullable = true), @p6='2025-07-02T17:33:33.5164188Z' (DbType = DateTime), @p7=NULL, @p8='True', @p9=NULL, @p10='hi' (Nullable = false), @p11=NULL, @p12=NULL, @p13='917082156227' (Nullable = false), @p14=NULL (DbType = Guid), @p15=NULL, @p16='2025-07-02T17:33:33.5164189Z' (Nullable = true) (DbType = DateTime), @p17=NULL, @p18='received' (Nullable = false)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "MessageLogs" ("Id", "BusinessId", "CTAFlowConfigId", "CTAFlowStepId", "CampaignId", "ContactId", "CreatedAt", "ErrorMessage", "IsIncoming", "MediaUrl", "MessageContent", "MessageId", "RawResponse", "RecipientNumber", "RefMessageId", "RenderedBody", "SentAt", "Source", "Status")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
2025-07-02 23:03:33.545 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."BusinessId", a."CreatedAt", a."FlowId", a."FlowName", a."IsActive", a."MediaUrl", a."Priority", a."ReplyMessage", a."TriggerKeyword", a."UpdatedAt"
FROM "AutoReplyRules" AS a
WHERE a."BusinessId" = @__businessId_0 AND a."IsActive"
2025-07-02 23:03:33.548 +05:30 [INF] 🔍 No flow match found or FlowId is null. Trying fallback auto-reply...
2025-07-02 23:03:33.551 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__incomingMessage_1='hi'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."BusinessId", a."CreatedAt", a."FlowId", a."FlowName", a."IsActive", a."MediaUrl", a."Priority", a."ReplyMessage", a."TriggerKeyword", a."UpdatedAt"
FROM "AutoReplyRules" AS a
WHERE a."BusinessId" = @__businessId_0 AND a."IsActive" AND strpos(@__incomingMessage_1, a."TriggerKeyword") > 0
ORDER BY a."Priority"
LIMIT 1
2025-07-02 23:03:33.555 +05:30 [INF] ❌ No fallback rule matched for: hi
2025-07-02 23:03:36.221 +05:30 [INF] Executed DbCommand (21ms) [Parameters=[@p0='1eda63c0-b0dc-4b05-b803-b7636f862b77', @p1='c13be597-6ae2-42bb-9d43-925815f24ff8', @p2=NULL (DbType = Guid), @p3=NULL (DbType = Guid), @p4=NULL (DbType = Guid), @p5='0876f654-a362-420f-a912-6bce793436a5' (Nullable = true), @p6='2025-07-02T17:33:36.1994607Z' (DbType = DateTime), @p7=NULL, @p8='True', @p9=NULL, @p10='hi' (Nullable = false), @p11=NULL, @p12=NULL, @p13='917082156227' (Nullable = false), @p14=NULL (DbType = Guid), @p15=NULL, @p16=NULL (DbType = DateTime), @p17=NULL, @p18='Queued' (Nullable = false)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "MessageLogs" ("Id", "BusinessId", "CTAFlowConfigId", "CTAFlowStepId", "CampaignId", "ContactId", "CreatedAt", "ErrorMessage", "IsIncoming", "MediaUrl", "MessageContent", "MessageId", "RawResponse", "RecipientNumber", "RefMessageId", "RenderedBody", "SentAt", "Source", "Status")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
2025-07-02 23:03:47.085 +05:30 [INF] Request starting HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - application/json 491
2025-07-02 23:03:47.088 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 23:03:47.090 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-07-02 23:03:47.092 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"contacts":[{"profile":{"name":"\ua9c1S.K\ua9c2"},"wa_id":"917082156227"}],"messages":[{"from":"917082156227","id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAEhggRDQzODgyNzI3RTNDM0YxRjUyN0Q0MEREMkI1QUVBRTcA","timestamp":"1751477629","text":{"body":"hi"},"type":"text"}]},"field":"messages"}]}]}
2025-07-02 23:03:47.094 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-07-02 23:03:47.095 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"contacts":[{"profile":{"name":"\ua9c1S.K\ua9c2"},"wa_id":"917082156227"}],"messages":[{"from":"917082156227","id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAEhggRDQzODgyNzI3RTNDM0YxRjUyN0Q0MEREMkI1QUVBRTcA","timestamp":"1751477629","text":{"body":"hi"},"type":"text"}]},"field":"messages"}]}]}
2025-07-02 23:03:47.095 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType73`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 23:03:47.097 +05:30 [INF] 💬 Routing to InboundMessageProcessor (type: text)
2025-07-02 23:03:47.099 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 6.9596ms
2025-07-02 23:03:47.105 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 23:03:47.103 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessNumber_0='15556395845'], CommandType='"Text"', CommandTimeout='30']
SELECT b."Id", b."Address", b."ApprovedAt", b."ApprovedBy", b."BusinessEmail", b."BusinessName", b."CompanyName", b."CompanyPhone", b."CreatedAt", b."CreatedBy", b."CreatedByPartnerId", b."DeletedAt", b."DeletedBy", b."Industry", b."IsApproved", b."IsDeleted", b."LastLoginAt", b."LogoUrl", b."Notes", b."Phone", b."RepresentativeName", b."Source", b."Status", b."Tags", b."Website", w."Id", w."ApiToken", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WhatsAppBusinessNumber"
FROM "Businesses" AS b
LEFT JOIN "WhatsAppSettings" AS w ON b."Id" = w."BusinessId"
WHERE w."WhatsAppBusinessNumber" = @__businessNumber_0
LIMIT 1
2025-07-02 23:03:47.107 +05:30 [INF] Request finished HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 21.8816ms
2025-07-02 23:03:47.112 +05:30 [INF] FindOrCreateAsync: businessId="c13be597-6ae2-42bb-9d43-925815f24ff8", phoneNumber=917082156227
2025-07-02 23:03:47.119 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__phoneNumber_1='917082156227'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."Tags"
FROM "Contacts" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."PhoneNumber" = @__phoneNumber_1
LIMIT 1
2025-07-02 23:03:47.123 +05:30 [INF] Contact already exists: contactId="0876f654-a362-420f-a912-6bce793436a5"
2025-07-02 23:03:47.126 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__contactId_1='0876f654-a362-420f-a912-6bce793436a5'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."BusinessId", c."ContactId", c."LastUpdatedAt", c."Mode", c."UpdatedBy"
FROM "ChatSessionStates" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."ContactId" = @__contactId_1
LIMIT 1
2025-07-02 23:03:47.149 +05:30 [INF] Executed DbCommand (19ms) [Parameters=[@p0='a8fa3adf-44de-47e9-9423-924d0609d204', @p1='c13be597-6ae2-42bb-9d43-925815f24ff8', @p2=NULL (DbType = Guid), @p3=NULL (DbType = Guid), @p4=NULL (DbType = Guid), @p5='0876f654-a362-420f-a912-6bce793436a5' (Nullable = true), @p6='2025-07-02T17:33:47.1297034Z' (DbType = DateTime), @p7=NULL, @p8='True', @p9=NULL, @p10='hi' (Nullable = false), @p11=NULL, @p12=NULL, @p13='917082156227' (Nullable = false), @p14=NULL (DbType = Guid), @p15=NULL, @p16='2025-07-02T17:33:47.1297035Z' (Nullable = true) (DbType = DateTime), @p17=NULL, @p18='received' (Nullable = false)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "MessageLogs" ("Id", "BusinessId", "CTAFlowConfigId", "CTAFlowStepId", "CampaignId", "ContactId", "CreatedAt", "ErrorMessage", "IsIncoming", "MediaUrl", "MessageContent", "MessageId", "RawResponse", "RecipientNumber", "RefMessageId", "RenderedBody", "SentAt", "Source", "Status")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
2025-07-02 23:03:47.156 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."BusinessId", a."CreatedAt", a."FlowId", a."FlowName", a."IsActive", a."MediaUrl", a."Priority", a."ReplyMessage", a."TriggerKeyword", a."UpdatedAt"
FROM "AutoReplyRules" AS a
WHERE a."BusinessId" = @__businessId_0 AND a."IsActive"
2025-07-02 23:03:47.158 +05:30 [INF] 🔍 No flow match found or FlowId is null. Trying fallback auto-reply...
2025-07-02 23:03:47.161 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__incomingMessage_1='hi'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."BusinessId", a."CreatedAt", a."FlowId", a."FlowName", a."IsActive", a."MediaUrl", a."Priority", a."ReplyMessage", a."TriggerKeyword", a."UpdatedAt"
FROM "AutoReplyRules" AS a
WHERE a."BusinessId" = @__businessId_0 AND a."IsActive" AND strpos(@__incomingMessage_1, a."TriggerKeyword") > 0
ORDER BY a."Priority"
LIMIT 1
2025-07-02 23:03:47.164 +05:30 [INF] ❌ No fallback rule matched for: hi
2025-07-02 23:03:49.343 +05:30 [INF] Executed DbCommand (22ms) [Parameters=[@p0='52c1712c-64d1-4437-9c5d-b95f61a37da2', @p1='c13be597-6ae2-42bb-9d43-925815f24ff8', @p2=NULL (DbType = Guid), @p3=NULL (DbType = Guid), @p4=NULL (DbType = Guid), @p5='0876f654-a362-420f-a912-6bce793436a5' (Nullable = true), @p6='2025-07-02T17:33:49.3185666Z' (DbType = DateTime), @p7=NULL, @p8='True', @p9=NULL, @p10='hi' (Nullable = false), @p11=NULL, @p12=NULL, @p13='917082156227' (Nullable = false), @p14=NULL (DbType = Guid), @p15=NULL, @p16=NULL (DbType = DateTime), @p17=NULL, @p18='Queued' (Nullable = false)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "MessageLogs" ("Id", "BusinessId", "CTAFlowConfigId", "CTAFlowStepId", "CampaignId", "ContactId", "CreatedAt", "ErrorMessage", "IsIncoming", "MediaUrl", "MessageContent", "MessageId", "RawResponse", "RecipientNumber", "RefMessageId", "RenderedBody", "SentAt", "Source", "Status")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
2025-07-02 23:04:10.128 +05:30 [INF] Request starting HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - application/json 550
2025-07-02 23:04:10.142 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 23:04:10.144 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-07-02 23:04:10.147 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMTVGNEY4QUYwOURDOUU0NzZEAA==","status":"delivered","timestamp":"1751182895","recipient_id":"917082156227","conversation":{"id":"90b38ee00c6455dcc79733c1fd93f79a","origin":{"type":"service"}},"pricing":{"billable":true,"pricing_model":"CBP","category":"service"}}]},"field":"messages"}]}]}
2025-07-02 23:04:10.150 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-07-02 23:04:10.151 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMTVGNEY4QUYwOURDOUU0NzZEAA==","status":"delivered","timestamp":"1751182895","recipient_id":"917082156227","conversation":{"id":"90b38ee00c6455dcc79733c1fd93f79a","origin":{"type":"service"}},"pricing":{"billable":true,"pricing_model":"CBP","category":"service"}}]},"field":"messages"}]}]}
2025-07-02 23:04:10.152 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType73`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 23:04:10.154 +05:30 [INF] 📦 Routing to Status Processor
2025-07-02 23:04:10.157 +05:30 [WRN] 🔍 Incoming timestamp raw value: {"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMTVGNEY4QUYwOURDOUU0NzZEAA==","status":"delivered","timestamp":"1751182895","recipient_id":"917082156227","conversation":{"id":"90b38ee00c6455dcc79733c1fd93f79a","origin":{"type":"service"}},"pricing":{"billable":true,"pricing_model":"CBP","category":"service"}}]},"field":"messages"}]}]}
2025-07-02 23:04:10.155 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 8.7611ms
2025-07-02 23:04:10.161 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 23:04:10.161 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__messageId_0='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMTVGNEY4QUYwOURDOUU0NzZEAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."MessageId" = @__messageId_0
LIMIT 1
2025-07-02 23:04:10.165 +05:30 [WRN] ⚠️ CampaignSendLog not found for MessageId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMTVGNEY4QUYwOURDOUU0NzZEAA==
2025-07-02 23:04:10.166 +05:30 [WRN] ⚠️ No matching CampaignSendLog for MessageId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMTVGNEY4QUYwOURDOUU0NzZEAA==
2025-07-02 23:04:10.163 +05:30 [INF] Request finished HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 35.7344ms
2025-07-02 23:04:25.098 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/api/autoreplyflows/save - application/json 642
2025-07-02 23:04:25.103 +05:30 [INF] CORS policy execution failed.
2025-07-02 23:04:25.104 +05:30 [INF] Request origin http://localhost:7113/ does not have permission to access the resource.
2025-07-02 23:04:25.106 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.AutoReplyBuilder.Flows.Controllers.AutoReplyFlowsController.SaveFlow (xbytechat.api)'
2025-07-02 23:04:25.107 +05:30 [INF] Route matched with {action = "SaveFlow", controller = "AutoReplyFlows"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SaveFlow(xbytechat.api.Features.AutoReplyBuilder.Flows.DTOs.SaveFlowDto) on controller xbytechat.api.Features.AutoReplyBuilder.Flows.Controllers.AutoReplyFlowsController (xbytechat.api).
2025-07-02 23:04:25.113 +05:30 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-07-02 23:04:25.115 +05:30 [INF] Executed action xbytechat.api.Features.AutoReplyBuilder.Flows.Controllers.AutoReplyFlowsController.SaveFlow (xbytechat.api) in 6.0422ms
2025-07-02 23:04:25.122 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.AutoReplyBuilder.Flows.Controllers.AutoReplyFlowsController.SaveFlow (xbytechat.api)'
2025-07-02 23:04:25.124 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/api/autoreplyflows/save - 400 null application/problem+json; charset=utf-8 26.5644ms
2025-07-02 23:04:37.978 +05:30 [INF] Request starting HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - application/json 491
2025-07-02 23:04:37.981 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 23:04:37.982 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-07-02 23:04:37.985 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"contacts":[{"profile":{"name":"\ua9c1S.K\ua9c2"},"wa_id":"917082156227"}],"messages":[{"from":"917082156227","id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAEhggODMyRjJCQTAzQjgyMUIyQ0VFQ0QxRkRBOTMzNjA0MTkA","timestamp":"1751477680","text":{"body":"hi"},"type":"text"}]},"field":"messages"}]}]}
2025-07-02 23:04:37.987 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-07-02 23:04:37.987 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"contacts":[{"profile":{"name":"\ua9c1S.K\ua9c2"},"wa_id":"917082156227"}],"messages":[{"from":"917082156227","id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAEhggODMyRjJCQTAzQjgyMUIyQ0VFQ0QxRkRBOTMzNjA0MTkA","timestamp":"1751477680","text":{"body":"hi"},"type":"text"}]},"field":"messages"}]}]}
2025-07-02 23:04:37.988 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType73`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 23:04:37.990 +05:30 [INF] 💬 Routing to InboundMessageProcessor (type: text)
2025-07-02 23:04:37.991 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 6.6252ms
2025-07-02 23:04:37.996 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__businessNumber_0='15556395845'], CommandType='"Text"', CommandTimeout='30']
SELECT b."Id", b."Address", b."ApprovedAt", b."ApprovedBy", b."BusinessEmail", b."BusinessName", b."CompanyName", b."CompanyPhone", b."CreatedAt", b."CreatedBy", b."CreatedByPartnerId", b."DeletedAt", b."DeletedBy", b."Industry", b."IsApproved", b."IsDeleted", b."LastLoginAt", b."LogoUrl", b."Notes", b."Phone", b."RepresentativeName", b."Source", b."Status", b."Tags", b."Website", w."Id", w."ApiToken", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WhatsAppBusinessNumber"
FROM "Businesses" AS b
LEFT JOIN "WhatsAppSettings" AS w ON b."Id" = w."BusinessId"
WHERE w."WhatsAppBusinessNumber" = @__businessNumber_0
LIMIT 1
2025-07-02 23:04:38.001 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 23:04:38.007 +05:30 [INF] FindOrCreateAsync: businessId="c13be597-6ae2-42bb-9d43-925815f24ff8", phoneNumber=917082156227
2025-07-02 23:04:38.008 +05:30 [INF] Request finished HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 29.6583ms
2025-07-02 23:04:38.012 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__phoneNumber_1='917082156227'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."Tags"
FROM "Contacts" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."PhoneNumber" = @__phoneNumber_1
LIMIT 1
2025-07-02 23:04:38.018 +05:30 [INF] Contact already exists: contactId="0876f654-a362-420f-a912-6bce793436a5"
2025-07-02 23:04:38.022 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__contactId_1='0876f654-a362-420f-a912-6bce793436a5'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."BusinessId", c."ContactId", c."LastUpdatedAt", c."Mode", c."UpdatedBy"
FROM "ChatSessionStates" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."ContactId" = @__contactId_1
LIMIT 1
2025-07-02 23:04:38.045 +05:30 [INF] Executed DbCommand (20ms) [Parameters=[@p0='ac338ca6-5a0c-4909-b9b2-0d29fceef1ae', @p1='c13be597-6ae2-42bb-9d43-925815f24ff8', @p2=NULL (DbType = Guid), @p3=NULL (DbType = Guid), @p4=NULL (DbType = Guid), @p5='0876f654-a362-420f-a912-6bce793436a5' (Nullable = true), @p6='2025-07-02T17:34:38.0248658Z' (DbType = DateTime), @p7=NULL, @p8='True', @p9=NULL, @p10='hi' (Nullable = false), @p11=NULL, @p12=NULL, @p13='917082156227' (Nullable = false), @p14=NULL (DbType = Guid), @p15=NULL, @p16='2025-07-02T17:34:38.0248661Z' (Nullable = true) (DbType = DateTime), @p17=NULL, @p18='received' (Nullable = false)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "MessageLogs" ("Id", "BusinessId", "CTAFlowConfigId", "CTAFlowStepId", "CampaignId", "ContactId", "CreatedAt", "ErrorMessage", "IsIncoming", "MediaUrl", "MessageContent", "MessageId", "RawResponse", "RecipientNumber", "RefMessageId", "RenderedBody", "SentAt", "Source", "Status")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
2025-07-02 23:04:38.049 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."BusinessId", a."CreatedAt", a."FlowId", a."FlowName", a."IsActive", a."MediaUrl", a."Priority", a."ReplyMessage", a."TriggerKeyword", a."UpdatedAt"
FROM "AutoReplyRules" AS a
WHERE a."BusinessId" = @__businessId_0 AND a."IsActive"
2025-07-02 23:04:38.052 +05:30 [INF] 🔍 No flow match found or FlowId is null. Trying fallback auto-reply...
2025-07-02 23:04:38.055 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__incomingMessage_1='hi'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."BusinessId", a."CreatedAt", a."FlowId", a."FlowName", a."IsActive", a."MediaUrl", a."Priority", a."ReplyMessage", a."TriggerKeyword", a."UpdatedAt"
FROM "AutoReplyRules" AS a
WHERE a."BusinessId" = @__businessId_0 AND a."IsActive" AND strpos(@__incomingMessage_1, a."TriggerKeyword") > 0
ORDER BY a."Priority"
LIMIT 1
2025-07-02 23:04:38.058 +05:30 [INF] ❌ No fallback rule matched for: hi
2025-07-02 23:04:48.541 +05:30 [INF] Executed DbCommand (25ms) [Parameters=[@p0='ca329c44-e15f-4640-b89d-c2688729de3d', @p1='c13be597-6ae2-42bb-9d43-925815f24ff8', @p2=NULL (DbType = Guid), @p3=NULL (DbType = Guid), @p4=NULL (DbType = Guid), @p5='0876f654-a362-420f-a912-6bce793436a5' (Nullable = true), @p6='2025-07-02T17:34:44.6765378Z' (DbType = DateTime), @p7=NULL, @p8='True', @p9=NULL, @p10='hi' (Nullable = false), @p11=NULL, @p12=NULL, @p13='917082156227' (Nullable = false), @p14=NULL (DbType = Guid), @p15=NULL, @p16=NULL (DbType = DateTime), @p17=NULL, @p18='Queued' (Nullable = false)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "MessageLogs" ("Id", "BusinessId", "CTAFlowConfigId", "CTAFlowStepId", "CampaignId", "ContactId", "CreatedAt", "ErrorMessage", "IsIncoming", "MediaUrl", "MessageContent", "MessageId", "RawResponse", "RecipientNumber", "RefMessageId", "RenderedBody", "SentAt", "Source", "Status")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
2025-07-02 23:14:02.216 +05:30 [INF] User profile is available. Using 'C:\Users\sunde\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-07-02 23:14:02.282 +05:30 [INF] 🚀 Webhook Queue Worker started.
2025-07-02 23:14:02.304 +05:30 [INF] 🧹 FailedWebhookLogCleanupService started.
2025-07-02 23:14:03.402 +05:30 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2025-07-02 23:14:03.959 +05:30 [WRN] The query uses the 'First'/'FirstOrDefault' operator without 'OrderBy' and filter operators. This may lead to unpredictable results.
2025-07-02 23:14:04.134 +05:30 [INF] Now listening on: http://localhost:7113
2025-07-02 23:14:04.135 +05:30 [INF] Now listening on: http://localhost:5295
2025-07-02 23:14:04.137 +05:30 [INF] Application started. Press Ctrl+C to shut down.
2025-07-02 23:14:04.138 +05:30 [INF] Hosting environment: Development
2025-07-02 23:14:04.139 +05:30 [INF] Content root path: D:\xbytechat\xbytechat-api\xbytechat-api
2025-07-02 23:14:04.152 +05:30 [INF] Executed DbCommand (23ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."AutoCleanupEnabled", w."LastCleanupAt"
FROM "WebhookSettings" AS w
LIMIT 1
2025-07-02 23:14:04.175 +05:30 [INF] Executed DbCommand (39ms) [Parameters=[@__cutoff_0='2025-06-25T17:44:02.4546450Z' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."CreatedAt", f."ErrorMessage", f."FailureType", f."RawJson", f."SourceModule"
FROM "FailedWebhookLogs" AS f
WHERE f."CreatedAt" < @__cutoff_0
2025-07-02 23:14:06.625 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/swagger/index.html - null null
2025-07-02 23:14:06.998 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/swagger/index.html - 200 null text/html;charset=utf-8 389.4573ms
2025-07-02 23:14:07.023 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/_framework/aspnetcore-browser-refresh.js - null null
2025-07-02 23:14:07.042 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/_framework/aspnetcore-browser-refresh.js - 200 13762 application/javascript; charset=utf-8 19.9366ms
2025-07-02 23:14:07.137 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/_vs/browserLink - null null
2025-07-02 23:14:07.214 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/_vs/browserLink - 200 null text/javascript; charset=UTF-8 76.7371ms
2025-07-02 23:14:07.424 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/swagger/v1/swagger.json - null null
2025-07-02 23:14:07.748 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 324.2655ms
2025-07-02 23:14:34.351 +05:30 [INF] Request starting HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - application/json 581
2025-07-02 23:14:34.360 +05:30 [WRN] Failed to determine the https port for redirect.
2025-07-02 23:14:34.436 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 23:14:34.453 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-07-02 23:14:34.483 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSQjJFREVDNDM5RjEzRDFFMEZBAA==","status":"sent","timestamp":"1751189959","recipient_id":"917082156227","conversation":{"id":"90b38ee00c6455dcc79733c1fd93f79a","expiration_timestamp":"1751269260","origin":{"type":"service"}},"pricing":{"billable":true,"pricing_model":"CBP","category":"service"}}]},"field":"messages"}]}]}
2025-07-02 23:14:34.488 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-07-02 23:14:34.497 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType73`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 23:14:34.513 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 52.353ms
2025-07-02 23:14:34.517 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 23:14:34.520 +05:30 [INF] Request finished HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 168.9526ms
2025-07-02 23:14:34.663 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSQjJFREVDNDM5RjEzRDFFMEZBAA==","status":"sent","timestamp":"1751189959","recipient_id":"917082156227","conversation":{"id":"90b38ee00c6455dcc79733c1fd93f79a","expiration_timestamp":"1751269260","origin":{"type":"service"}},"pricing":{"billable":true,"pricing_model":"CBP","category":"service"}}]},"field":"messages"}]}]}
2025-07-02 23:14:34.667 +05:30 [INF] 📦 Routing to Status Processor
2025-07-02 23:14:34.669 +05:30 [WRN] 🔍 Incoming timestamp raw value: {"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSQjJFREVDNDM5RjEzRDFFMEZBAA==","status":"sent","timestamp":"1751189959","recipient_id":"917082156227","conversation":{"id":"90b38ee00c6455dcc79733c1fd93f79a","expiration_timestamp":"1751269260","origin":{"type":"service"}},"pricing":{"billable":true,"pricing_model":"CBP","category":"service"}}]},"field":"messages"}]}]}
2025-07-02 23:14:34.778 +05:30 [INF] Executed DbCommand (6ms) [Parameters=[@__messageId_0='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSQjJFREVDNDM5RjEzRDFFMEZBAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."MessageId" = @__messageId_0
LIMIT 1
2025-07-02 23:14:34.784 +05:30 [WRN] ⚠️ CampaignSendLog not found for MessageId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSQjJFREVDNDM5RjEzRDFFMEZBAA==
2025-07-02 23:14:34.786 +05:30 [WRN] ⚠️ No matching CampaignSendLog for MessageId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSQjJFREVDNDM5RjEzRDFFMEZBAA==
2025-07-02 23:14:40.233 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/auth/session - null null
2025-07-02 23:14:40.347 +05:30 [INF] Executing endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 23:14:40.350 +05:30 [INF] Route matched with {action = "GetSession", controller = "Auth"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetSession() on controller xbytechat.api.AuthModule.Controllers.AuthController (xbytechat.api).
2025-07-02 23:14:40.357 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`4[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 23:14:40.361 +05:30 [INF] Executed action xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api) in 8.5047ms
2025-07-02 23:14:40.363 +05:30 [INF] Executed endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 23:14:40.365 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/auth/session - 200 null application/json; charset=utf-8 132.5484ms
2025-07-02 23:14:40.375 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/feature-access/me - null null
2025-07-02 23:14:40.382 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 23:14:40.387 +05:30 [INF] Route matched with {action = "GetMyFeatures", controller = "FeatureAccess"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto]]] GetMyFeatures() on controller xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController (xbytechat.api).
2025-07-02 23:14:40.469 +05:30 [INF] Executed DbCommand (6ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT b."Id", b."Address", b."ApprovedAt", b."ApprovedBy", b."BusinessEmail", b."BusinessName", b."CompanyName", b."CompanyPhone", b."CreatedAt", b."CreatedBy", b."CreatedByPartnerId", b."DeletedAt", b."DeletedBy", b."Industry", b."IsApproved", b."IsDeleted", b."LastLoginAt", b."LogoUrl", b."Notes", b."Phone", b."RepresentativeName", b."Source", b."Status", b."Tags", b."Website", b0."Id", b0."BusinessId", b0."CreatedAt", b0."Plan", b0."QuotaResetDate", b0."RemainingMessages", b0."TotalMonthlyQuota", b0."UpdatedAt", b0."WalletBalance"
FROM "Businesses" AS b
LEFT JOIN "BusinessPlanInfos" AS b0 ON b."Id" = b0."BusinessId"
WHERE b."Id" = @__businessId_0
LIMIT 1
2025-07-02 23:14:40.598 +05:30 [INF] 📦 Resolved plan for Business "c13be597-6ae2-42bb-9d43-925815f24ff8": Smart
2025-07-02 23:14:40.608 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."BusinessId", f."CreatedAt", f."Description", f."FeatureName", f."Group", f."IsEnabled", f."Notes", f."Plan"
FROM "FeatureAccess" AS f
WHERE f."BusinessId" = @__businessId_0
2025-07-02 23:14:40.625 +05:30 [INF] 🔧 Feature override: AddProduct = False
2025-07-02 23:14:40.626 +05:30 [INF] 🔧 Feature override: Automation = True
2025-07-02 23:14:40.627 +05:30 [INF] 🔧 Feature override: Campaigns = True
2025-07-02 23:14:40.628 +05:30 [INF] 🔧 Feature override: Catalog = True
2025-07-02 23:14:40.629 +05:30 [INF] 🔧 Feature override: CRM = True
2025-07-02 23:14:40.630 +05:30 [INF] 🔧 Feature override: CRMInsights = True
2025-07-02 23:14:40.631 +05:30 [INF] 🔧 Feature override: CTAFlow = True
2025-07-02 23:14:40.632 +05:30 [INF] 🔧 Feature override: FlowInsights = True
2025-07-02 23:14:40.633 +05:30 [INF] 🔧 Feature override: Messaging = True
2025-07-02 23:14:40.634 +05:30 [INF] 🔧 Feature override: ProfileCompletion = True
2025-07-02 23:14:40.635 +05:30 [INF] 🔧 Feature override: UpgradePlan = True
2025-07-02 23:14:40.636 +05:30 [INF] 🔧 Feature override: WhatsAppSettings = True
2025-07-02 23:14:40.643 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 23:14:40.652 +05:30 [INF] Executed action xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api) in 262.0102ms
2025-07-02 23:14:40.654 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 23:14:40.659 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/feature-access/me - 200 null application/json; charset=utf-8 284.1639ms
2025-07-02 23:14:48.421 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/api/auth/login - null null
2025-07-02 23:14:48.431 +05:30 [INF] CORS policy execution successful.
2025-07-02 23:14:48.435 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/api/auth/login - 204 null null 14.3841ms
2025-07-02 23:14:48.437 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/api/auth/login - application/json 47
2025-07-02 23:14:48.446 +05:30 [INF] CORS policy execution successful.
2025-07-02 23:14:48.448 +05:30 [INF] Executing endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.Login (xbytechat.api)'
2025-07-02 23:14:48.458 +05:30 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(xbytechat.api.AuthModule.DTOs.UserLoginDto) on controller xbytechat.api.AuthModule.Controllers.AuthController (xbytechat.api).
2025-07-02 23:14:48.489 +05:30 [INF] 🔑 Login attempt for email: ratan@tcs.com
2025-07-02 23:14:48.518 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__dto_Email_0='ratan@tcs.com', @__hashedPassword_1='JAvlGPq9JyTdtvBO6x2llnRI1+gxwIyPqCKAn3THIKk='], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."BusinessId", u."CreatedAt", u."DeletedAt", u."Email", u."IsDeleted", u."Name", u."PasswordHash", u."RefreshToken", u."RefreshTokenExpiry", u."RoleId", u."Status", r."Id", r."CreatedAt", r."Description", r."IsActive", r."IsSystemDefined", r."Name"
FROM "Users" AS u
LEFT JOIN "Roles" AS r ON u."RoleId" = r."Id"
WHERE u."Email" = @__dto_Email_0 AND u."PasswordHash" = @__hashedPassword_1 AND NOT (u."IsDeleted")
LIMIT 1
2025-07-02 23:14:48.585 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__user_BusinessId_Value_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT b."Id", b."Address", b."ApprovedAt", b."ApprovedBy", b."BusinessEmail", b."BusinessName", b."CompanyName", b."CompanyPhone", b."CreatedAt", b."CreatedBy", b."CreatedByPartnerId", b."DeletedAt", b."DeletedBy", b."Industry", b."IsApproved", b."IsDeleted", b."LastLoginAt", b."LogoUrl", b."Notes", b."Phone", b."RepresentativeName", b."Source", b."Status", b."Tags", b."Website", b0."Id", b0."BusinessId", b0."CreatedAt", b0."Plan", b0."QuotaResetDate", b0."RemainingMessages", b0."TotalMonthlyQuota", b0."UpdatedAt", b0."WalletBalance"
FROM "Businesses" AS b
LEFT JOIN "BusinessPlanInfos" AS b0 ON b."Id" = b0."BusinessId"
WHERE b."Id" = @__user_BusinessId_Value_0
LIMIT 1
2025-07-02 23:14:48.611 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__user_RoleId_0='00000000-0000-0000-0000-000000000004' (Nullable = true)], CommandType='"Text"', CommandTimeout='30']
SELECT r."Id", r."AssignedAt", r."AssignedBy", r."IsActive", r."IsRevoked", r."PermissionId", r."RoleId"
FROM "RolePermissions" AS r
WHERE r."RoleId" = @__user_RoleId_0 AND NOT (r."IsRevoked")
2025-07-02 23:14:48.640 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__userId_0='2870e1d8-0e80-4b12-88bd-70a8113307d6'], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."AssignedAt", u."AssignedBy", u."IsGranted", u."IsRevoked", u."PermissionId", u."UserId"
FROM "UserPermissions" AS u
WHERE u."UserId" = @__userId_0 AND NOT (u."IsRevoked")
2025-07-02 23:14:48.764 +05:30 [INF] Executed DbCommand (68ms) [Parameters=[@__permissionIds_0={ '30000000-0000-0000-0000-000000000000', '30000000-0000-0000-0000-000000000004', '30000000-0000-0000-0000-000000000001', '30000000-0000-0000-0000-000000000007' } (DbType = Object)], CommandType='"Text"', CommandTimeout='30']
SELECT p."Id", p."Code", p."CreatedAt", p."Description", p."Group", p."IsActive", p."Name"
FROM "Permissions" AS p
WHERE p."Id" = ANY (@__permissionIds_0)
2025-07-02 23:14:48.795 +05:30 [INF] ✅ Token generated for: ratan@tcs.com
2025-07-02 23:14:48.807 +05:30 [INF] ✅ Login successful for ratan@tcs.com, Role: business, Plan: Smart
2025-07-02 23:14:48.813 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`3[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 23:14:48.829 +05:30 [INF] Executed action xbytechat.api.AuthModule.Controllers.AuthController.Login (xbytechat.api) in 367.5599ms
2025-07-02 23:14:48.831 +05:30 [INF] Executed endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.Login (xbytechat.api)'
2025-07-02 23:14:48.833 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/api/auth/login - 200 null application/json; charset=utf-8 395.8413ms
2025-07-02 23:14:48.844 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/auth/session - null null
2025-07-02 23:14:48.849 +05:30 [INF] Executing endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 23:14:48.851 +05:30 [INF] Route matched with {action = "GetSession", controller = "Auth"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetSession() on controller xbytechat.api.AuthModule.Controllers.AuthController (xbytechat.api).
2025-07-02 23:14:48.864 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`4[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 23:14:48.867 +05:30 [INF] Executed action xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api) in 13.752ms
2025-07-02 23:14:48.870 +05:30 [INF] Executed endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 23:14:48.871 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/auth/session - 200 null application/json; charset=utf-8 27.3902ms
2025-07-02 23:14:49.184 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/feature-access/me - null null
2025-07-02 23:14:49.189 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 23:14:49.191 +05:30 [INF] Route matched with {action = "GetMyFeatures", controller = "FeatureAccess"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto]]] GetMyFeatures() on controller xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController (xbytechat.api).
2025-07-02 23:14:49.201 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT b."Id", b."Address", b."ApprovedAt", b."ApprovedBy", b."BusinessEmail", b."BusinessName", b."CompanyName", b."CompanyPhone", b."CreatedAt", b."CreatedBy", b."CreatedByPartnerId", b."DeletedAt", b."DeletedBy", b."Industry", b."IsApproved", b."IsDeleted", b."LastLoginAt", b."LogoUrl", b."Notes", b."Phone", b."RepresentativeName", b."Source", b."Status", b."Tags", b."Website", b0."Id", b0."BusinessId", b0."CreatedAt", b0."Plan", b0."QuotaResetDate", b0."RemainingMessages", b0."TotalMonthlyQuota", b0."UpdatedAt", b0."WalletBalance"
FROM "Businesses" AS b
LEFT JOIN "BusinessPlanInfos" AS b0 ON b."Id" = b0."BusinessId"
WHERE b."Id" = @__businessId_0
LIMIT 1
2025-07-02 23:14:49.208 +05:30 [INF] 📦 Resolved plan for Business "c13be597-6ae2-42bb-9d43-925815f24ff8": Smart
2025-07-02 23:14:49.214 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."BusinessId", f."CreatedAt", f."Description", f."FeatureName", f."Group", f."IsEnabled", f."Notes", f."Plan"
FROM "FeatureAccess" AS f
WHERE f."BusinessId" = @__businessId_0
2025-07-02 23:14:49.217 +05:30 [INF] 🔧 Feature override: AddProduct = False
2025-07-02 23:14:49.220 +05:30 [INF] 🔧 Feature override: Automation = True
2025-07-02 23:14:49.222 +05:30 [INF] 🔧 Feature override: Campaigns = True
2025-07-02 23:14:49.224 +05:30 [INF] 🔧 Feature override: Catalog = True
2025-07-02 23:14:49.225 +05:30 [INF] 🔧 Feature override: CRM = True
2025-07-02 23:14:49.236 +05:30 [INF] 🔧 Feature override: CRMInsights = True
2025-07-02 23:14:49.239 +05:30 [INF] 🔧 Feature override: CTAFlow = True
2025-07-02 23:14:49.240 +05:30 [INF] 🔧 Feature override: FlowInsights = True
2025-07-02 23:14:49.242 +05:30 [INF] 🔧 Feature override: Messaging = True
2025-07-02 23:14:49.243 +05:30 [INF] 🔧 Feature override: ProfileCompletion = True
2025-07-02 23:14:49.244 +05:30 [INF] 🔧 Feature override: UpgradePlan = True
2025-07-02 23:14:49.245 +05:30 [INF] 🔧 Feature override: WhatsAppSettings = True
2025-07-02 23:14:49.248 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 23:14:49.249 +05:30 [INF] Executed action xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api) in 57.1374ms
2025-07-02 23:14:49.251 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 23:14:49.252 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/feature-access/me - 200 null application/json; charset=utf-8 68.6988ms
2025-07-02 23:15:00.743 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/Campaign/paginated?page=1&pageSize=10&status= - null null
2025-07-02 23:15:00.760 +05:30 [INF] CORS policy execution successful.
2025-07-02 23:15:00.772 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetPaginatedCampaigns (xbytechat.api)'
2025-07-02 23:15:00.788 +05:30 [INF] Route matched with {action = "GetPaginatedCampaigns", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPaginatedCampaigns(xbytechat.api.Shared.PaginatedRequest) on controller xbytechat.api.Features.CampaignModule.Controllers.CampaignController (xbytechat.api).
2025-07-02 23:15:00.852 +05:30 [INF] Executed DbCommand (6ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Campaigns" AS c
WHERE c."BusinessId" = @__businessId_0
2025-07-02 23:15:00.880 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__p_2='10', @__p_1='0'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Name", c."Status", c."ScheduledAt", c."CreatedAt"
FROM "Campaigns" AS c
WHERE c."BusinessId" = @__businessId_0
ORDER BY c."CreatedAt" DESC
LIMIT @__p_2 OFFSET @__p_1
2025-07-02 23:15:00.886 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Shared.PaginatedResponse`1[[xbytechat.api.Features.CampaignModule.DTOs.CampaignSummaryDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 23:15:00.900 +05:30 [INF] Executed action xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetPaginatedCampaigns (xbytechat.api) in 108.8766ms
2025-07-02 23:15:00.902 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetPaginatedCampaigns (xbytechat.api)'
2025-07-02 23:15:00.904 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/Campaign/paginated?page=1&pageSize=10&status= - 200 null application/json; charset=utf-8 160.9774ms
2025-07-02 23:15:05.531 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/api/campaign/send/d0f71321-88d2-4b99-91e0-5b5f0174400f - null 0
2025-07-02 23:15:05.538 +05:30 [INF] CORS policy execution successful.
2025-07-02 23:15:05.540 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.SendCampaign (xbytechat.api)'
2025-07-02 23:15:05.549 +05:30 [INF] Route matched with {action = "SendCampaign", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendCampaign(System.Guid) on controller xbytechat.api.Features.CampaignModule.Controllers.CampaignController (xbytechat.api).
2025-07-02 23:15:05.639 +05:30 [INF] Executed DbCommand (6ms) [Parameters=[@__campaignId_0='d0f71321-88d2-4b99-91e0-5b5f0174400f'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."BusinessId", t."CampaignId", t."CampaignType", t."CreatedAt", t."CreatedBy", t."CtaId", t."DeletedAt", t."DeletedBy", t."FollowUpTemplateId", t."ImageCaption", t."ImageUrl", t."IsDeleted", t."MessageBody", t."MessageTemplate", t."Name", t."ScheduledAt", t."SourceCampaignId", t."Status", t."TemplateId", t."TemplateParameters", t."UpdatedAt", t0."Id", t0."BotId", t0."BusinessId", t0."CampaignId", t0."CategoryBrowsed", t0."ClickedCTA", t0."ContactId", t0."IsAutoTagged", t0."MessagePreview", t0."ProductBrowsed", t0."SentAt", t0."Status", t0."UpdatedAt", t0."Id0", t0."AssignedAgentId", t0."BusinessId0", t0."CreatedAt", t0."Email", t0."Group", t0."IsActive", t0."IsArchived", t0."IsAutomationPaused", t0."IsFavorite", t0."LastCTAInteraction", t0."LastCTAType", t0."LastClickedProductId", t0."LastContactedAt", t0."LeadSource", t0."Name", t0."NextFollowUpAt", t0."Notes", t0."PhoneNumber", t0."Tags"
FROM (
    SELECT c."Id", c."BusinessId", c."CampaignId", c."CampaignType", c."CreatedAt", c."CreatedBy", c."CtaId", c."DeletedAt", c."DeletedBy", c."FollowUpTemplateId", c."ImageCaption", c."ImageUrl", c."IsDeleted", c."MessageBody", c."MessageTemplate", c."Name", c."ScheduledAt", c."SourceCampaignId", c."Status", c."TemplateId", c."TemplateParameters", c."UpdatedAt"
    FROM "Campaigns" AS c
    WHERE c."Id" = @__campaignId_0
    LIMIT 1
) AS t
LEFT JOIN (
    SELECT c0."Id", c0."BotId", c0."BusinessId", c0."CampaignId", c0."CategoryBrowsed", c0."ClickedCTA", c0."ContactId", c0."IsAutoTagged", c0."MessagePreview", c0."ProductBrowsed", c0."SentAt", c0."Status", c0."UpdatedAt", c1."Id" AS "Id0", c1."AssignedAgentId", c1."BusinessId" AS "BusinessId0", c1."CreatedAt", c1."Email", c1."Group", c1."IsActive", c1."IsArchived", c1."IsAutomationPaused", c1."IsFavorite", c1."LastCTAInteraction", c1."LastCTAType", c1."LastClickedProductId", c1."LastContactedAt", c1."LeadSource", c1."Name", c1."NextFollowUpAt", c1."Notes", c1."PhoneNumber", c1."Tags"
    FROM "CampaignRecipients" AS c0
    INNER JOIN "Contacts" AS c1 ON c0."ContactId" = c1."Id"
) AS t0 ON t."Id" = t0."CampaignId"
ORDER BY t."Id", t0."Id"
2025-07-02 23:15:05.918 +05:30 [INF] Executed DbCommand (9ms) [Parameters=[@p2='d0f71321-88d2-4b99-91e0-5b5f0174400f', @p0='Sending' (Nullable = false), @p1='2025-07-02T17:45:05.7785539Z' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Campaigns" SET "Status" = @p0, "UpdatedAt" = @p1
WHERE "Id" = @p2;
2025-07-02 23:15:06.002 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT b."Id", b."Address", b."ApprovedAt", b."ApprovedBy", b."BusinessEmail", b."BusinessName", b."CompanyName", b."CompanyPhone", b."CreatedAt", b."CreatedBy", b."CreatedByPartnerId", b."DeletedAt", b."DeletedBy", b."Industry", b."IsApproved", b."IsDeleted", b."LastLoginAt", b."LogoUrl", b."Notes", b."Phone", b."RepresentativeName", b."Source", b."Status", b."Tags", b."Website", w."Id", w."ApiToken", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WhatsAppBusinessNumber"
FROM "Businesses" AS b
LEFT JOIN "WhatsAppSettings" AS w ON b."Id" = w."BusinessId"
WHERE b."Id" = @__businessId_0
LIMIT 1
2025-07-02 23:15:06.172 +05:30 [INF] Start processing HTTP request POST https://graph.facebook.com/v22.0/601884673011340/messages
2025-07-02 23:15:06.176 +05:30 [INF] Sending HTTP request POST https://graph.facebook.com/v22.0/601884673011340/messages
2025-07-02 23:15:07.348 +05:30 [INF] Received HTTP response headers after 1167.4682ms - 404
2025-07-02 23:15:07.352 +05:30 [INF] End processing HTTP request after 1181.1425ms - 404
2025-07-02 23:15:07.508 +05:30 [INF] Executed DbCommand (10ms) [Parameters=[@p0='bb4d0d23-148b-4cff-8b22-3d188dbe467b', @p1='c13be597-6ae2-42bb-9d43-925815f24ff8', @p2=NULL (DbType = Guid), @p3=NULL (DbType = Guid), @p4=NULL (DbType = Guid), @p5=NULL (DbType = Guid), @p6='2025-07-02T17:45:07.3659008Z' (DbType = DateTime), @p7=NULL, @p8='False', @p9=NULL, @p10='We’re excited to announce that we’re launching some amazing new products at [Your Company Name]! 🚀

Be the first to check them out and grab special launch offers!
If you’re interested, reply to this message or click here:' (Nullable = false), @p11=NULL, @p12='{"Success":false,"Message":"❌ WhatsApp API returned an error.","Data":null,"ErrorMessage":"API returned error","RawResponse":"{\"error\":{\"message\":\"(#132001) Template name does not exist in the translation\",\"type\":\"OAuthException\",\"code\":132001,\"error_data\":{\"messaging_product\":\"whatsapp\",\"details\":\"template name (We\\u2019re excited to announce that we\\u2019re launching some amazing new products at [Your Company Name]! \\ufffd\\n\\nBe the first to check them out and grab special launch offers!\\nIf you\\u2019re interested, reply to this message or click here:) does not exist in en_US\"},\"fbtrace_id\":\"A1dAXNwlvxVBueNZ5teM0-R\"}}","MessageId":null,"LogId":null,"Token":null,"RefreshToken":null}', @p13='+917082156227' (Nullable = false), @p14=NULL (DbType = Guid), @p15='', @p16='2025-07-02T17:45:07.3658244Z' (Nullable = true) (DbType = DateTime), @p17=NULL, @p18='Sent' (Nullable = false)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "MessageLogs" ("Id", "BusinessId", "CTAFlowConfigId", "CTAFlowStepId", "CampaignId", "ContactId", "CreatedAt", "ErrorMessage", "IsIncoming", "MediaUrl", "MessageContent", "MessageId", "RawResponse", "RecipientNumber", "RefMessageId", "RenderedBody", "SentAt", "Source", "Status")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
2025-07-02 23:15:07.588 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__recipient_Id_0='c05cab06-f4d9-4175-bf4c-2b2fdab36f18'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."BotId", c."BusinessId", c."CampaignId", c."CategoryBrowsed", c."ClickedCTA", c."ContactId", c."IsAutoTagged", c."MessagePreview", c."ProductBrowsed", c."SentAt", c."Status", c."UpdatedAt"
FROM "CampaignRecipients" AS c
WHERE c."Id" = @__recipient_Id_0
LIMIT 1
2025-07-02 23:15:07.629 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[@p4='c05cab06-f4d9-4175-bf4c-2b2fdab36f18', @p0='We’re excited to announce that we’re launching some amazing new products at [Your Company Name]! 🚀

Be the first to check them out and grab special launch offers!
If you’re interested, reply to this message or click here:', @p1='2025-07-02T17:45:07.5948695Z' (Nullable = true) (DbType = DateTime), @p2='Sent' (Nullable = false), @p3='2025-07-02T17:45:07.5949643Z' (DbType = DateTime), @p5='d6ce0226-ac86-4cf8-98e2-13f48438ac83', @p6='True', @p7=NULL, @p8='00000000-0000-0000-0000-000000000000', @p9='d0f71321-88d2-4b99-91e0-5b5f0174400f', @p10=NULL, @p11=NULL, @p12=NULL (DbType = DateTime), @p13='8aac7c57-6699-4511-897b-4121b407eb1c', @p14=NULL, @p15='2025-07-02T17:45:07.5150098Z' (DbType = DateTime), @p16=NULL, @p17=NULL (DbType = DateTime), @p18='Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/137.0.0.0 Safari/537.36', @p19=NULL, @p20='✅ Template sent successfully.', @p21='::1', @p22='False', @p23=NULL (DbType = DateTime), @p24=NULL, @p25=NULL, @p26='We’re excited to announce that we’re launching some amazing new products at [Your Company Name]! 🚀

Be the first to check them out and grab special launch offers!
If you’re interested, reply to this message or click here:' (Nullable = false), @p27=NULL, @p28=NULL (DbType = Guid), @p29=NULL (DbType = DateTime), @p30='c05cab06-f4d9-4175-bf4c-2b2fdab36f18', @p31='0', @p32='Sent', @p33='2025-07-02T17:45:07.5149691Z' (Nullable = true) (DbType = DateTime), @p34='whatsapp', @p35=NULL, @p36=NULL (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
UPDATE "CampaignRecipients" SET "MessagePreview" = @p0, "SentAt" = @p1, "Status" = @p2, "UpdatedAt" = @p3
WHERE "Id" = @p4;
INSERT INTO "CampaignSendLogs" ("Id", "AllowRetry", "Browser", "BusinessId", "CampaignId", "City", "ClickType", "ClickedAt", "ContactId", "Country", "CreatedAt", "CreatedBy", "DeliveredAt", "DeviceInfo", "DeviceType", "ErrorMessage", "IpAddress", "IsClicked", "LastRetryAt", "LastRetryStatus", "MacAddress", "MessageBody", "MessageId", "MessageLogId", "ReadAt", "RecipientId", "RetryCount", "SendStatus", "SentAt", "SourceChannel", "TemplateId", "UserId")
VALUES (@p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22, @p23, @p24, @p25, @p26, @p27, @p28, @p29, @p30, @p31, @p32, @p33, @p34, @p35, @p36);
2025-07-02 23:15:07.656 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@p2='d0f71321-88d2-4b99-91e0-5b5f0174400f', @p0='Sent' (Nullable = false), @p1='2025-07-02T17:45:07.6526224Z' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Campaigns" SET "Status" = @p0, "UpdatedAt" = @p1
WHERE "Id" = @p2;
2025-07-02 23:15:07.660 +05:30 [INF] 📤 Campaign "d0f71321-88d2-4b99-91e0-5b5f0174400f" sent via template to 1 recipients
2025-07-02 23:15:07.666 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType1`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 23:15:07.669 +05:30 [INF] Executed action xbytechat.api.Features.CampaignModule.Controllers.CampaignController.SendCampaign (xbytechat.api) in 2117.6062ms
2025-07-02 23:15:07.671 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.SendCampaign (xbytechat.api)'
2025-07-02 23:15:07.672 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/api/campaign/send/d0f71321-88d2-4b99-91e0-5b5f0174400f - 200 null application/json; charset=utf-8 2141.5598ms
2025-07-02 23:15:07.679 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/Campaign/paginated?page=1&pageSize=10&status= - null null
2025-07-02 23:15:07.686 +05:30 [INF] CORS policy execution successful.
2025-07-02 23:15:07.687 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetPaginatedCampaigns (xbytechat.api)'
2025-07-02 23:15:07.692 +05:30 [INF] Route matched with {action = "GetPaginatedCampaigns", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPaginatedCampaigns(xbytechat.api.Shared.PaginatedRequest) on controller xbytechat.api.Features.CampaignModule.Controllers.CampaignController (xbytechat.api).
2025-07-02 23:15:07.708 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Campaigns" AS c
WHERE c."BusinessId" = @__businessId_0
2025-07-02 23:15:07.718 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__p_2='10', @__p_1='0'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Name", c."Status", c."ScheduledAt", c."CreatedAt"
FROM "Campaigns" AS c
WHERE c."BusinessId" = @__businessId_0
ORDER BY c."CreatedAt" DESC
LIMIT @__p_2 OFFSET @__p_1
2025-07-02 23:15:07.722 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Shared.PaginatedResponse`1[[xbytechat.api.Features.CampaignModule.DTOs.CampaignSummaryDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 23:15:07.726 +05:30 [INF] Executed action xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetPaginatedCampaigns (xbytechat.api) in 30.8704ms
2025-07-02 23:15:07.728 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetPaginatedCampaigns (xbytechat.api)'
2025-07-02 23:15:07.730 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/Campaign/paginated?page=1&pageSize=10&status= - 200 null application/json; charset=utf-8 51.4598ms
2025-07-02 23:15:10.583 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/main.438c347ba48e08e41fee.hot-update.json - null null
2025-07-02 23:15:10.588 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/main.438c347ba48e08e41fee.hot-update.json - 404 0 null 5.3544ms
2025-07-02 23:15:10.594 +05:30 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:7113/main.438c347ba48e08e41fee.hot-update.json, Response status code: 404
2025-07-02 23:15:11.746 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/auth/session - null null
2025-07-02 23:15:11.751 +05:30 [INF] Executing endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 23:15:11.753 +05:30 [INF] Route matched with {action = "GetSession", controller = "Auth"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetSession() on controller xbytechat.api.AuthModule.Controllers.AuthController (xbytechat.api).
2025-07-02 23:15:11.756 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`4[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 23:15:11.759 +05:30 [INF] Executed action xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api) in 3.1516ms
2025-07-02 23:15:11.760 +05:30 [INF] Executed endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.GetSession (xbytechat.api)'
2025-07-02 23:15:11.762 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/auth/session - 200 null application/json; charset=utf-8 15.4853ms
2025-07-02 23:15:11.782 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/feature-access/me - null null
2025-07-02 23:15:11.787 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 23:15:11.789 +05:30 [INF] Route matched with {action = "GetMyFeatures", controller = "FeatureAccess"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto]]] GetMyFeatures() on controller xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController (xbytechat.api).
2025-07-02 23:15:11.796 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT b."Id", b."Address", b."ApprovedAt", b."ApprovedBy", b."BusinessEmail", b."BusinessName", b."CompanyName", b."CompanyPhone", b."CreatedAt", b."CreatedBy", b."CreatedByPartnerId", b."DeletedAt", b."DeletedBy", b."Industry", b."IsApproved", b."IsDeleted", b."LastLoginAt", b."LogoUrl", b."Notes", b."Phone", b."RepresentativeName", b."Source", b."Status", b."Tags", b."Website", b0."Id", b0."BusinessId", b0."CreatedAt", b0."Plan", b0."QuotaResetDate", b0."RemainingMessages", b0."TotalMonthlyQuota", b0."UpdatedAt", b0."WalletBalance"
FROM "Businesses" AS b
LEFT JOIN "BusinessPlanInfos" AS b0 ON b."Id" = b0."BusinessId"
WHERE b."Id" = @__businessId_0
LIMIT 1
2025-07-02 23:15:11.801 +05:30 [INF] 📦 Resolved plan for Business "c13be597-6ae2-42bb-9d43-925815f24ff8": Smart
2025-07-02 23:15:11.805 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."BusinessId", f."CreatedAt", f."Description", f."FeatureName", f."Group", f."IsEnabled", f."Notes", f."Plan"
FROM "FeatureAccess" AS f
WHERE f."BusinessId" = @__businessId_0
2025-07-02 23:15:11.809 +05:30 [INF] 🔧 Feature override: AddProduct = False
2025-07-02 23:15:11.810 +05:30 [INF] 🔧 Feature override: Automation = True
2025-07-02 23:15:11.811 +05:30 [INF] 🔧 Feature override: Campaigns = True
2025-07-02 23:15:11.812 +05:30 [INF] 🔧 Feature override: Catalog = True
2025-07-02 23:15:11.814 +05:30 [INF] 🔧 Feature override: CRM = True
2025-07-02 23:15:11.815 +05:30 [INF] 🔧 Feature override: CRMInsights = True
2025-07-02 23:15:11.816 +05:30 [INF] 🔧 Feature override: CTAFlow = True
2025-07-02 23:15:11.817 +05:30 [INF] 🔧 Feature override: FlowInsights = True
2025-07-02 23:15:11.818 +05:30 [INF] 🔧 Feature override: Messaging = True
2025-07-02 23:15:11.820 +05:30 [INF] 🔧 Feature override: ProfileCompletion = True
2025-07-02 23:15:11.822 +05:30 [INF] 🔧 Feature override: UpgradePlan = True
2025-07-02 23:15:11.822 +05:30 [INF] 🔧 Feature override: WhatsAppSettings = True
2025-07-02 23:15:11.824 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.FeatureAccess.DTOs.FeatureStatusDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 23:15:11.827 +05:30 [INF] Executed action xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api) in 35.2914ms
2025-07-02 23:15:11.829 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.FeatureAccessModule.Controllers.FeatureAccessController.GetMyFeatures (xbytechat.api)'
2025-07-02 23:15:11.831 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/feature-access/me - 200 null application/json; charset=utf-8 49.1744ms
2025-07-02 23:15:21.265 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/api/campaign/send/01ffa7dc-8f65-4328-88bc-8021808a1001 - null 0
2025-07-02 23:15:21.270 +05:30 [INF] CORS policy execution successful.
2025-07-02 23:15:21.272 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.SendCampaign (xbytechat.api)'
2025-07-02 23:15:21.273 +05:30 [INF] Route matched with {action = "SendCampaign", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendCampaign(System.Guid) on controller xbytechat.api.Features.CampaignModule.Controllers.CampaignController (xbytechat.api).
2025-07-02 23:15:21.281 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__campaignId_0='01ffa7dc-8f65-4328-88bc-8021808a1001'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."BusinessId", t."CampaignId", t."CampaignType", t."CreatedAt", t."CreatedBy", t."CtaId", t."DeletedAt", t."DeletedBy", t."FollowUpTemplateId", t."ImageCaption", t."ImageUrl", t."IsDeleted", t."MessageBody", t."MessageTemplate", t."Name", t."ScheduledAt", t."SourceCampaignId", t."Status", t."TemplateId", t."TemplateParameters", t."UpdatedAt", t0."Id", t0."BotId", t0."BusinessId", t0."CampaignId", t0."CategoryBrowsed", t0."ClickedCTA", t0."ContactId", t0."IsAutoTagged", t0."MessagePreview", t0."ProductBrowsed", t0."SentAt", t0."Status", t0."UpdatedAt", t0."Id0", t0."AssignedAgentId", t0."BusinessId0", t0."CreatedAt", t0."Email", t0."Group", t0."IsActive", t0."IsArchived", t0."IsAutomationPaused", t0."IsFavorite", t0."LastCTAInteraction", t0."LastCTAType", t0."LastClickedProductId", t0."LastContactedAt", t0."LeadSource", t0."Name", t0."NextFollowUpAt", t0."Notes", t0."PhoneNumber", t0."Tags"
FROM (
    SELECT c."Id", c."BusinessId", c."CampaignId", c."CampaignType", c."CreatedAt", c."CreatedBy", c."CtaId", c."DeletedAt", c."DeletedBy", c."FollowUpTemplateId", c."ImageCaption", c."ImageUrl", c."IsDeleted", c."MessageBody", c."MessageTemplate", c."Name", c."ScheduledAt", c."SourceCampaignId", c."Status", c."TemplateId", c."TemplateParameters", c."UpdatedAt"
    FROM "Campaigns" AS c
    WHERE c."Id" = @__campaignId_0
    LIMIT 1
) AS t
LEFT JOIN (
    SELECT c0."Id", c0."BotId", c0."BusinessId", c0."CampaignId", c0."CategoryBrowsed", c0."ClickedCTA", c0."ContactId", c0."IsAutoTagged", c0."MessagePreview", c0."ProductBrowsed", c0."SentAt", c0."Status", c0."UpdatedAt", c1."Id" AS "Id0", c1."AssignedAgentId", c1."BusinessId" AS "BusinessId0", c1."CreatedAt", c1."Email", c1."Group", c1."IsActive", c1."IsArchived", c1."IsAutomationPaused", c1."IsFavorite", c1."LastCTAInteraction", c1."LastCTAType", c1."LastClickedProductId", c1."LastContactedAt", c1."LeadSource", c1."Name", c1."NextFollowUpAt", c1."Notes", c1."PhoneNumber", c1."Tags"
    FROM "CampaignRecipients" AS c0
    INNER JOIN "Contacts" AS c1 ON c0."ContactId" = c1."Id"
) AS t0 ON t."Id" = t0."CampaignId"
ORDER BY t."Id", t0."Id"
2025-07-02 23:15:21.291 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@p2='01ffa7dc-8f65-4328-88bc-8021808a1001', @p0='Sending' (Nullable = false), @p1='2025-07-02T17:45:21.2879999Z' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Campaigns" SET "Status" = @p0, "UpdatedAt" = @p1
WHERE "Id" = @p2;
2025-07-02 23:15:21.299 +05:30 [INF] Start processing HTTP request POST https://graph.facebook.com/v22.0/601884673011340/messages
2025-07-02 23:15:21.301 +05:30 [INF] Sending HTTP request POST https://graph.facebook.com/v22.0/601884673011340/messages
2025-07-02 23:15:22.185 +05:30 [INF] Received HTTP response headers after 882.4564ms - 400
2025-07-02 23:15:22.187 +05:30 [INF] End processing HTTP request after 888.4589ms - 400
2025-07-02 23:15:22.196 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[@p0='92336759-1dda-4e72-9fbf-2d21417f7748', @p1='c13be597-6ae2-42bb-9d43-925815f24ff8', @p2=NULL (DbType = Guid), @p3=NULL (DbType = Guid), @p4=NULL (DbType = Guid), @p5=NULL (DbType = Guid), @p6='2025-07-02T17:45:22.1912445Z' (DbType = DateTime), @p7=NULL, @p8='False', @p9=NULL, @p10='flow_step_1' (Nullable = false), @p11=NULL, @p12='{"Success":false,"Message":"❌ WhatsApp API returned an error.","Data":null,"ErrorMessage":"API returned error","RawResponse":"{\"error\":{\"message\":\"(#132000) Number of parameters does not match the expected number of params\",\"type\":\"OAuthException\",\"code\":132000,\"error_data\":{\"messaging_product\":\"whatsapp\",\"details\":\"body: number of localizable_params (1) does not match the expected number of params (0)\"},\"fbtrace_id\":\"ANFRqs5aGJMcLy6yxnQEF0M\"}}","MessageId":null,"LogId":null,"Token":null,"RefreshToken":null}', @p13='+917082156227' (Nullable = false), @p14=NULL (DbType = Guid), @p15='', @p16='2025-07-02T17:45:22.1912440Z' (Nullable = true) (DbType = DateTime), @p17=NULL, @p18='Sent' (Nullable = false)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "MessageLogs" ("Id", "BusinessId", "CTAFlowConfigId", "CTAFlowStepId", "CampaignId", "ContactId", "CreatedAt", "ErrorMessage", "IsIncoming", "MediaUrl", "MessageContent", "MessageId", "RawResponse", "RecipientNumber", "RefMessageId", "RenderedBody", "SentAt", "Source", "Status")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
2025-07-02 23:15:22.202 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__recipient_Id_0='04e49bed-37c7-4d7f-bf61-bd21880d715e'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."BotId", c."BusinessId", c."CampaignId", c."CategoryBrowsed", c."ClickedCTA", c."ContactId", c."IsAutoTagged", c."MessagePreview", c."ProductBrowsed", c."SentAt", c."Status", c."UpdatedAt"
FROM "CampaignRecipients" AS c
WHERE c."Id" = @__recipient_Id_0
LIMIT 1
2025-07-02 23:15:22.208 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@p4='04e49bed-37c7-4d7f-bf61-bd21880d715e', @p0='flow_step_1', @p1='2025-07-02T17:45:22.2054346Z' (Nullable = true) (DbType = DateTime), @p2='Sent' (Nullable = false), @p3='2025-07-02T17:45:22.2054350Z' (DbType = DateTime), @p5='1d501aae-6299-4496-89d6-4c47ed0589f9', @p6='True', @p7=NULL, @p8='00000000-0000-0000-0000-000000000000', @p9='01ffa7dc-8f65-4328-88bc-8021808a1001', @p10=NULL, @p11=NULL, @p12=NULL (DbType = DateTime), @p13='8aac7c57-6699-4511-897b-4121b407eb1c', @p14=NULL, @p15='2025-07-02T17:45:22.1998983Z' (DbType = DateTime), @p16=NULL, @p17=NULL (DbType = DateTime), @p18='Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/137.0.0.0 Safari/537.36', @p19=NULL, @p20='✅ Template sent successfully.', @p21='::1', @p22='False', @p23=NULL (DbType = DateTime), @p24=NULL, @p25=NULL, @p26='flow_step_1' (Nullable = false), @p27=NULL, @p28=NULL (DbType = Guid), @p29=NULL (DbType = DateTime), @p30='04e49bed-37c7-4d7f-bf61-bd21880d715e', @p31='0', @p32='Sent', @p33='2025-07-02T17:45:22.1998979Z' (Nullable = true) (DbType = DateTime), @p34='whatsapp', @p35='flow_step_1', @p36=NULL (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
UPDATE "CampaignRecipients" SET "MessagePreview" = @p0, "SentAt" = @p1, "Status" = @p2, "UpdatedAt" = @p3
WHERE "Id" = @p4;
INSERT INTO "CampaignSendLogs" ("Id", "AllowRetry", "Browser", "BusinessId", "CampaignId", "City", "ClickType", "ClickedAt", "ContactId", "Country", "CreatedAt", "CreatedBy", "DeliveredAt", "DeviceInfo", "DeviceType", "ErrorMessage", "IpAddress", "IsClicked", "LastRetryAt", "LastRetryStatus", "MacAddress", "MessageBody", "MessageId", "MessageLogId", "ReadAt", "RecipientId", "RetryCount", "SendStatus", "SentAt", "SourceChannel", "TemplateId", "UserId")
VALUES (@p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22, @p23, @p24, @p25, @p26, @p27, @p28, @p29, @p30, @p31, @p32, @p33, @p34, @p35, @p36);
2025-07-02 23:15:22.216 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@p2='01ffa7dc-8f65-4328-88bc-8021808a1001', @p0='Sent' (Nullable = false), @p1='2025-07-02T17:45:22.2134755Z' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Campaigns" SET "Status" = @p0, "UpdatedAt" = @p1
WHERE "Id" = @p2;
2025-07-02 23:15:22.219 +05:30 [INF] 📤 Campaign "01ffa7dc-8f65-4328-88bc-8021808a1001" sent via template to 1 recipients
2025-07-02 23:15:22.221 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType1`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 23:15:22.223 +05:30 [INF] Executed action xbytechat.api.Features.CampaignModule.Controllers.CampaignController.SendCampaign (xbytechat.api) in 947.7409ms
2025-07-02 23:15:22.225 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.SendCampaign (xbytechat.api)'
2025-07-02 23:15:22.227 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/api/campaign/send/01ffa7dc-8f65-4328-88bc-8021808a1001 - 200 null application/json; charset=utf-8 961.9034ms
2025-07-02 23:15:22.232 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/Campaign/paginated?page=1&pageSize=10&status= - null null
2025-07-02 23:15:22.236 +05:30 [INF] CORS policy execution successful.
2025-07-02 23:15:22.237 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetPaginatedCampaigns (xbytechat.api)'
2025-07-02 23:15:22.239 +05:30 [INF] Route matched with {action = "GetPaginatedCampaigns", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPaginatedCampaigns(xbytechat.api.Shared.PaginatedRequest) on controller xbytechat.api.Features.CampaignModule.Controllers.CampaignController (xbytechat.api).
2025-07-02 23:15:22.245 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Campaigns" AS c
WHERE c."BusinessId" = @__businessId_0
2025-07-02 23:15:22.251 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__p_2='10', @__p_1='0'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Name", c."Status", c."ScheduledAt", c."CreatedAt"
FROM "Campaigns" AS c
WHERE c."BusinessId" = @__businessId_0
ORDER BY c."CreatedAt" DESC
LIMIT @__p_2 OFFSET @__p_1
2025-07-02 23:15:22.255 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Shared.PaginatedResponse`1[[xbytechat.api.Features.CampaignModule.DTOs.CampaignSummaryDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 23:15:22.257 +05:30 [INF] Executed action xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetPaginatedCampaigns (xbytechat.api) in 15.812ms
2025-07-02 23:15:22.259 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetPaginatedCampaigns (xbytechat.api)'
2025-07-02 23:15:22.261 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/Campaign/paginated?page=1&pageSize=10&status= - 200 null application/json; charset=utf-8 28.6798ms
2025-07-02 23:15:43.183 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/campaign/get-image-campaign - null null
2025-07-02 23:15:43.186 +05:30 [INF] CORS policy execution successful.
2025-07-02 23:15:43.187 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetAll (xbytechat.api)'
2025-07-02 23:15:43.202 +05:30 [INF] Route matched with {action = "GetAll", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAll(System.String) on controller xbytechat.api.Features.CampaignModule.Controllers.CampaignController (xbytechat.api).
2025-07-02 23:15:43.249 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Name", c."Status", c."ScheduledAt", c."CreatedAt", c."ImageUrl", c."ImageCaption", c0."Title" AS "CtaTitle", (
    SELECT count(*)::int
    FROM "CampaignRecipients" AS c1
    WHERE c."Id" = c1."CampaignId") AS "RecipientCount"
FROM "Campaigns" AS c
LEFT JOIN "CTADefinitions" AS c0 ON c."CtaId" = c0."Id"
WHERE c."BusinessId" = @__businessId_0
ORDER BY c."CreatedAt" DESC
2025-07-02 23:15:43.253 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.CampaignModule.DTOs.CampaignSummaryDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-02 23:15:43.257 +05:30 [INF] Executed action xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetAll (xbytechat.api) in 42.8621ms
2025-07-02 23:15:43.259 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetAll (xbytechat.api)'
2025-07-02 23:15:43.260 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/campaign/get-image-campaign - 200 null application/json; charset=utf-8 77.7152ms
2025-07-02 23:15:53.720 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/api/campaign/send-campaign/5b762111-ca31-42e3-aead-a65f67b4ff48 - null 0
2025-07-02 23:15:53.725 +05:30 [INF] CORS policy execution successful.
2025-07-02 23:15:53.727 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.SendTemplateCampaign (xbytechat.api)'
2025-07-02 23:15:53.735 +05:30 [INF] Route matched with {action = "SendTemplateCampaign", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendTemplateCampaign(System.Guid) on controller xbytechat.api.Features.CampaignModule.Controllers.CampaignController (xbytechat.api).
2025-07-02 23:15:53.771 +05:30 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-07-02 23:15:53.784 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[@__campaignId_0='5b762111-ca31-42e3-aead-a65f67b4ff48'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."BusinessId", t."CampaignId", t."CampaignType", t."CreatedAt", t."CreatedBy", t."CtaId", t."DeletedAt", t."DeletedBy", t."FollowUpTemplateId", t."ImageCaption", t."ImageUrl", t."IsDeleted", t."MessageBody", t."MessageTemplate", t."Name", t."ScheduledAt", t."SourceCampaignId", t."Status", t."TemplateId", t."TemplateParameters", t."UpdatedAt", t0."Id", t0."BotId", t0."BusinessId", t0."CampaignId", t0."CategoryBrowsed", t0."ClickedCTA", t0."ContactId", t0."IsAutoTagged", t0."MessagePreview", t0."ProductBrowsed", t0."SentAt", t0."Status", t0."UpdatedAt", t0."Id0", t0."AssignedAgentId", t0."BusinessId0", t0."CreatedAt", t0."Email", t0."Group", t0."IsActive", t0."IsArchived", t0."IsAutomationPaused", t0."IsFavorite", t0."LastCTAInteraction", t0."LastCTAType", t0."LastClickedProductId", t0."LastContactedAt", t0."LeadSource", t0."Name", t0."NextFollowUpAt", t0."Notes", t0."PhoneNumber", t0."Tags", c2."Id", c2."CampaignId", c2."IsFromTemplate", c2."Position", c2."Title", c2."Type", c2."Value"
FROM (
    SELECT c."Id", c."BusinessId", c."CampaignId", c."CampaignType", c."CreatedAt", c."CreatedBy", c."CtaId", c."DeletedAt", c."DeletedBy", c."FollowUpTemplateId", c."ImageCaption", c."ImageUrl", c."IsDeleted", c."MessageBody", c."MessageTemplate", c."Name", c."ScheduledAt", c."SourceCampaignId", c."Status", c."TemplateId", c."TemplateParameters", c."UpdatedAt"
    FROM "Campaigns" AS c
    WHERE c."Id" = @__campaignId_0 AND NOT (c."IsDeleted")
    LIMIT 1
) AS t
LEFT JOIN (
    SELECT c0."Id", c0."BotId", c0."BusinessId", c0."CampaignId", c0."CategoryBrowsed", c0."ClickedCTA", c0."ContactId", c0."IsAutoTagged", c0."MessagePreview", c0."ProductBrowsed", c0."SentAt", c0."Status", c0."UpdatedAt", c1."Id" AS "Id0", c1."AssignedAgentId", c1."BusinessId" AS "BusinessId0", c1."CreatedAt", c1."Email", c1."Group", c1."IsActive", c1."IsArchived", c1."IsAutomationPaused", c1."IsFavorite", c1."LastCTAInteraction", c1."LastCTAType", c1."LastClickedProductId", c1."LastContactedAt", c1."LeadSource", c1."Name", c1."NextFollowUpAt", c1."Notes", c1."PhoneNumber", c1."Tags"
    FROM "CampaignRecipients" AS c0
    INNER JOIN "Contacts" AS c1 ON c0."ContactId" = c1."Id"
) AS t0 ON t."Id" = t0."CampaignId"
LEFT JOIN "CampaignButtons" AS c2 ON t."Id" = c2."CampaignId"
ORDER BY t."Id", t0."Id", t0."Id0"
2025-07-02 23:15:53.853 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiToken", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."IsActive" AND w."BusinessId" = @__businessId_0
LIMIT 1
2025-07-02 23:15:53.859 +05:30 [INF] Start processing HTTP request GET https://graph.facebook.com/v22.0/999432368375320/message_templates
2025-07-02 23:15:53.861 +05:30 [INF] Sending HTTP request GET https://graph.facebook.com/v22.0/999432368375320/message_templates
2025-07-02 23:15:55.161 +05:30 [INF] Received HTTP response headers after 1298.4225ms - 200
2025-07-02 23:15:55.163 +05:30 [INF] End processing HTTP request after 1304.2495ms - 200
2025-07-02 23:15:55.309 +05:30 [INF] 📨 Preparing to send to +917082156227
2025-07-02 23:15:55.312 +05:30 [INF] ⏩ Skipping static button 'Send Pricing' as it requires no parameters
2025-07-02 23:15:55.313 +05:30 [INF] ⏩ Skipping static button 'Back to Products' as it requires no parameters
2025-07-02 23:15:55.318 +05:30 [INF] Start processing HTTP request POST https://graph.facebook.com/v22.0/601884673011340/messages
2025-07-02 23:15:55.320 +05:30 [INF] Sending HTTP request POST https://graph.facebook.com/v22.0/601884673011340/messages
2025-07-02 23:15:56.587 +05:30 [INF] Received HTTP response headers after 1265.2355ms - 200
2025-07-02 23:15:56.588 +05:30 [INF] End processing HTTP request after 1270.0502ms - 200
2025-07-02 23:15:56.606 +05:30 [INF] 📬 Send result: {"Success":true,"Message":"✅ Message sent successfully","Data":null,"ErrorMessage":null,"RawResponse":"{\"messaging_product\":\"whatsapp\",\"contacts\":[{\"input\":\"+917082156227\",\"wa_id\":\"917082156227\"}],\"messages\":[{\"id\":\"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSQ0ZCMzhBRTUwOEI3QTZENkEwAA==\",\"message_status\":\"accepted\"}]}","MessageId":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSQ0ZCMzhBRTUwOEI3QTZENkEwAA==","LogId":null,"Token":null,"RefreshToken":null}
2025-07-02 23:15:56.610 +05:30 [INF] ✅ Added MessageLog for +917082156227
2025-07-02 23:15:56.616 +05:30 [INF] 📘 Added CampaignSendLog for recipient "47d878cb-ca41-4265-bfd4-fd8d6fd80b5b"
2025-07-02 23:15:56.618 +05:30 [INF] 💾 Saving all DB changes...
2025-07-02 23:15:56.638 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[@p0='98ad9c9a-8cc1-4030-acad-d04356bcac25', @p1='c13be597-6ae2-42bb-9d43-925815f24ff8', @p2=NULL (DbType = Guid), @p3=NULL (DbType = Guid), @p4='5b762111-ca31-42e3-aead-a65f67b4ff48' (Nullable = true), @p5='8aac7c57-6699-4511-897b-4121b407eb1c' (Nullable = true), @p6='2025-07-02T17:45:56.6087592Z' (DbType = DateTime), @p7=NULL, @p8='False', @p9=NULL, @p10='flow_step_4' (Nullable = false), @p11='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSQ0ZCMzhBRTUwOEI3QTZENkEwAA==', @p12='{"messaging_product":"whatsapp","contacts":[{"input":"+917082156227","wa_id":"917082156227"}],"messages":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSQ0ZCMzhBRTUwOEI3QTZENkEwAA==","message_status":"accepted"}]}', @p13='+917082156227' (Nullable = false), @p14=NULL (DbType = Guid), @p15=NULL, @p16='2025-07-02T17:45:56.6087596Z' (Nullable = true) (DbType = DateTime), @p17=NULL, @p18='Sent' (Nullable = false), @p19='e3cbdeee-7f0d-4550-8faa-2aff0fbf73b9', @p20='True', @p21=NULL, @p22='00000000-0000-0000-0000-000000000000', @p23='5b762111-ca31-42e3-aead-a65f67b4ff48', @p24=NULL, @p25=NULL, @p26=NULL (DbType = DateTime), @p27='8aac7c57-6699-4511-897b-4121b407eb1c', @p28=NULL, @p29='2025-07-02T17:45:56.6134925Z' (DbType = DateTime), @p30='system', @p31=NULL (DbType = DateTime), @p32=NULL, @p33=NULL, @p34=NULL, @p35=NULL, @p36='False', @p37=NULL (DbType = DateTime), @p38=NULL, @p39=NULL, @p40='Would you like pricing details for your selected product?' (Nullable = false), @p41='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSQ0ZCMzhBRTUwOEI3QTZENkEwAA==', @p42='98ad9c9a-8cc1-4030-acad-d04356bcac25' (Nullable = true), @p43=NULL (DbType = DateTime), @p44='47d878cb-ca41-4265-bfd4-fd8d6fd80b5b', @p45='0', @p46='Sent', @p47='2025-07-02T17:45:56.6134928Z' (Nullable = true) (DbType = DateTime), @p48=NULL, @p49='flow_step_4', @p50=NULL (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "MessageLogs" ("Id", "BusinessId", "CTAFlowConfigId", "CTAFlowStepId", "CampaignId", "ContactId", "CreatedAt", "ErrorMessage", "IsIncoming", "MediaUrl", "MessageContent", "MessageId", "RawResponse", "RecipientNumber", "RefMessageId", "RenderedBody", "SentAt", "Source", "Status")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
INSERT INTO "CampaignSendLogs" ("Id", "AllowRetry", "Browser", "BusinessId", "CampaignId", "City", "ClickType", "ClickedAt", "ContactId", "Country", "CreatedAt", "CreatedBy", "DeliveredAt", "DeviceInfo", "DeviceType", "ErrorMessage", "IpAddress", "IsClicked", "LastRetryAt", "LastRetryStatus", "MacAddress", "MessageBody", "MessageId", "MessageLogId", "ReadAt", "RecipientId", "RetryCount", "SendStatus", "SentAt", "SourceChannel", "TemplateId", "UserId")
VALUES (@p19, @p20, @p21, @p22, @p23, @p24, @p25, @p26, @p27, @p28, @p29, @p30, @p31, @p32, @p33, @p34, @p35, @p36, @p37, @p38, @p39, @p40, @p41, @p42, @p43, @p44, @p45, @p46, @p47, @p48, @p49, @p50);
2025-07-02 23:15:56.663 +05:30 [INF] ✅ All saved successfully.
2025-07-02 23:15:56.665 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Helpers.ResponseResult'.
2025-07-02 23:15:56.675 +05:30 [INF] Executed action xbytechat.api.Features.CampaignModule.Controllers.CampaignController.SendTemplateCampaign (xbytechat.api) in 2934.7591ms
2025-07-02 23:15:56.678 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.SendTemplateCampaign (xbytechat.api)'
2025-07-02 23:15:56.679 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/api/campaign/send-campaign/5b762111-ca31-42e3-aead-a65f67b4ff48 - 200 null application/json; charset=utf-8 2959.2399ms
2025-07-02 23:15:58.340 +05:30 [INF] Request starting HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - application/json 602
2025-07-02 23:15:58.354 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 23:15:58.357 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-07-02 23:15:58.367 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSQ0ZCMzhBRTUwOEI3QTZENkEwAA==","status":"sent","timestamp":"1751478361","recipient_id":"917082156227","conversation":{"id":"71dc6b16772469d8f5b2075c9c6631a2","expiration_timestamp":"1751478361","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-07-02 23:15:58.369 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-07-02 23:15:58.371 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType73`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 23:15:58.373 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSQ0ZCMzhBRTUwOEI3QTZENkEwAA==","status":"sent","timestamp":"1751478361","recipient_id":"917082156227","conversation":{"id":"71dc6b16772469d8f5b2075c9c6631a2","expiration_timestamp":"1751478361","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-07-02 23:15:58.377 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 13.0372ms
2025-07-02 23:15:58.383 +05:30 [INF] 📦 Routing to Status Processor
2025-07-02 23:15:58.385 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 23:15:58.386 +05:30 [WRN] 🔍 Incoming timestamp raw value: {"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSQ0ZCMzhBRTUwOEI3QTZENkEwAA==","status":"sent","timestamp":"1751478361","recipient_id":"917082156227","conversation":{"id":"71dc6b16772469d8f5b2075c9c6631a2","expiration_timestamp":"1751478361","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-07-02 23:15:58.387 +05:30 [INF] Request finished HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 46.7272ms
2025-07-02 23:15:58.392 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__messageId_0='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSQ0ZCMzhBRTUwOEI3QTZENkEwAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."MessageId" = @__messageId_0
LIMIT 1
2025-07-02 23:15:58.409 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__logId_Value_0='e3cbdeee-7f0d-4550-8faa-2aff0fbf73b9'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."Id" = @__logId_Value_0
LIMIT 1
2025-07-02 23:15:58.413 +05:30 [INF] ✅ CampaignSendLog updated for MessageId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSQ0ZCMzhBRTUwOEI3QTZENkEwAA== → sent
2025-07-02 23:15:58.586 +05:30 [INF] Request starting HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - application/json 571
2025-07-02 23:15:58.590 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 23:15:58.592 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-07-02 23:15:58.595 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSQ0ZCMzhBRTUwOEI3QTZENkEwAA==","status":"delivered","timestamp":"1751478361","recipient_id":"917082156227","conversation":{"id":"71dc6b16772469d8f5b2075c9c6631a2","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-07-02 23:15:58.597 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-07-02 23:15:58.603 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType73`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 23:15:58.606 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 11.8451ms
2025-07-02 23:15:58.606 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSQ0ZCMzhBRTUwOEI3QTZENkEwAA==","status":"delivered","timestamp":"1751478361","recipient_id":"917082156227","conversation":{"id":"71dc6b16772469d8f5b2075c9c6631a2","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-07-02 23:15:58.607 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 23:15:58.609 +05:30 [INF] 📦 Routing to Status Processor
2025-07-02 23:15:58.611 +05:30 [INF] Request finished HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 24.6383ms
2025-07-02 23:15:58.612 +05:30 [WRN] 🔍 Incoming timestamp raw value: {"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSQ0ZCMzhBRTUwOEI3QTZENkEwAA==","status":"delivered","timestamp":"1751478361","recipient_id":"917082156227","conversation":{"id":"71dc6b16772469d8f5b2075c9c6631a2","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-07-02 23:15:58.624 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__messageId_0='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSQ0ZCMzhBRTUwOEI3QTZENkEwAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."MessageId" = @__messageId_0
LIMIT 1
2025-07-02 23:15:58.629 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__logId_Value_0='e3cbdeee-7f0d-4550-8faa-2aff0fbf73b9'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."Id" = @__logId_Value_0
LIMIT 1
2025-07-02 23:15:58.659 +05:30 [INF] Executed DbCommand (21ms) [Parameters=[@p2='e3cbdeee-7f0d-4550-8faa-2aff0fbf73b9', @p0='2025-07-02T17:46:01.0000000Z' (Nullable = true) (DbType = DateTime), @p1='Delivered'], CommandType='"Text"', CommandTimeout='30']
UPDATE "CampaignSendLogs" SET "DeliveredAt" = @p0, "SendStatus" = @p1
WHERE "Id" = @p2;
2025-07-02 23:15:58.665 +05:30 [INF] ✅ CampaignSendLog updated for MessageId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSQ0ZCMzhBRTUwOEI3QTZENkEwAA== → delivered
2025-07-02 23:16:02.939 +05:30 [INF] Request starting HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - application/json 633
2025-07-02 23:16:02.943 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 23:16:02.945 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-07-02 23:16:02.948 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"contacts":[{"profile":{"name":"\ua9c1S.K\ua9c2"},"wa_id":"917082156227"}],"messages":[{"context":{"from":"15556395845","id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSQ0ZCMzhBRTUwOEI3QTZENkEwAA=="},"from":"917082156227","id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAEhggNTU2MTJGRkMwNzJEODE4REY1Q0NCNjIzQ0NBQjM2RjUA","timestamp":"1751478365","type":"button","button":{"payload":"Send Pricing","text":"Send Pricing"}}]},"field":"messages"}]}]}
2025-07-02 23:16:02.951 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-07-02 23:16:02.951 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"contacts":[{"profile":{"name":"\ua9c1S.K\ua9c2"},"wa_id":"917082156227"}],"messages":[{"context":{"from":"15556395845","id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSQ0ZCMzhBRTUwOEI3QTZENkEwAA=="},"from":"917082156227","id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAEhggNTU2MTJGRkMwNzJEODE4REY1Q0NCNjIzQ0NBQjM2RjUA","timestamp":"1751478365","type":"button","button":{"payload":"Send Pricing","text":"Send Pricing"}}]},"field":"messages"}]}]}
2025-07-02 23:16:02.954 +05:30 [INF] 👉 Routing to Click Processor
2025-07-02 23:16:02.952 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType73`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 23:16:02.957 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 9.9696ms
2025-07-02 23:16:02.960 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 23:16:02.961 +05:30 [WRN] 📥 [ENTERED CLICK PROCESSOR]
2025-07-02 23:16:02.961 +05:30 [INF] Request finished HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 22.1149ms
2025-07-02 23:16:02.963 +05:30 [INF] 🖱️ Button Click → From: 917082156227, ClickId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAEhggNTU2MTJGRkMwNzJEODE4REY1Q0NCNjIzQ0NBQjM2RjUA, OrigMsgId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSQ0ZCMzhBRTUwOEI3QTZENkEwAA==, Text: Send Pricing
2025-07-02 23:16:02.992 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__originalMessageId_0='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSQ0ZCMzhBRTUwOEI3QTZENkEwAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId", c0."Id", c0."BusinessId", c0."CampaignId", c0."CampaignType", c0."CreatedAt", c0."CreatedBy", c0."CtaId", c0."DeletedAt", c0."DeletedBy", c0."FollowUpTemplateId", c0."ImageCaption", c0."ImageUrl", c0."IsDeleted", c0."MessageBody", c0."MessageTemplate", c0."Name", c0."ScheduledAt", c0."SourceCampaignId", c0."Status", c0."TemplateId", c0."TemplateParameters", c0."UpdatedAt", c1."Id", c1."AssignedAgentId", c1."BusinessId", c1."CreatedAt", c1."Email", c1."Group", c1."IsActive", c1."IsArchived", c1."IsAutomationPaused", c1."IsFavorite", c1."LastCTAInteraction", c1."LastCTAType", c1."LastClickedProductId", c1."LastContactedAt", c1."LeadSource", c1."Name", c1."NextFollowUpAt", c1."Notes", c1."PhoneNumber", c1."Tags"
FROM "CampaignSendLogs" AS c
INNER JOIN "Campaigns" AS c0 ON c."CampaignId" = c0."Id"
INNER JOIN "Contacts" AS c1 ON c."ContactId" = c1."Id"
WHERE c."MessageId" = @__originalMessageId_0
LIMIT 1
2025-07-02 23:16:02.997 +05:30 [INF] 📊 CampaignSendLog matched via context.id
2025-07-02 23:16:04.097 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__dto_MessageId_0='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSQ0ZCMzhBRTUwOEI3QTZENkEwAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."CreatedAt", m."ErrorMessage", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."MessageId" = @__dto_MessageId_0 OR m."Id"::text = @__dto_MessageId_0
LIMIT 1
2025-07-02 23:16:04.118 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__dto_MessageId_0='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSQ0ZCMzhBRTUwOEI3QTZENkEwAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId", c0."Id", c0."BotId", c0."BusinessId", c0."CampaignId", c0."CategoryBrowsed", c0."ClickedCTA", c0."ContactId", c0."IsAutoTagged", c0."MessagePreview", c0."ProductBrowsed", c0."SentAt", c0."Status", c0."UpdatedAt"
FROM "CampaignSendLogs" AS c
INNER JOIN "CampaignRecipients" AS c0 ON c."RecipientId" = c0."Id"
WHERE c."MessageId" = @__dto_MessageId_0
LIMIT 1
2025-07-02 23:16:04.133 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@p3='e3cbdeee-7f0d-4550-8faa-2aff0fbf73b9', @p0='Send Pricing', @p1='2025-07-02T17:46:03.0018459Z' (Nullable = true) (DbType = DateTime), @p2='True'], CommandType='"Text"', CommandTimeout='30']
UPDATE "CampaignSendLogs" SET "ClickType" = @p0, "ClickedAt" = @p1, "IsClicked" = @p2
WHERE "Id" = @p3;
2025-07-02 23:16:04.214 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[@p0='2f0dd12f-f19d-48cf-bb82-8a430c33a0ab', @p1='WhatsApp', @p2='c13be597-6ae2-42bb-9d43-925815f24ff8', @p3='Send Pricing', @p4='Send Pricing', @p5='5b762111-ca31-42e3-aead-a65f67b4ff48' (Nullable = true), @p6='e3cbdeee-7f0d-4550-8faa-2aff0fbf73b9' (Nullable = true), @p7=NULL, @p8='2025-07-02T17:46:03.0018459Z' (DbType = DateTime), @p9='webhook', @p10='8aac7c57-6699-4511-897b-4121b407eb1c' (Nullable = true), @p11='+917082156227', @p12='Unknown', @p13='Unknown', @p14='False', @p15='webhook', @p16='Clicked', @p17='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSQ0ZCMzhBRTUwOEI3QTZENkEwAA==', @p18='98ad9c9a-8cc1-4030-acad-d04356bcac25' (Nullable = true), @p19=NULL, @p20=NULL (DbType = Guid), @p21='5b762111-ca31-42e3-aead-a65f67b4ff48' (Nullable = true), @p22='campaign' (Nullable = false), @p23=NULL (DbType = Guid), @p24=NULL, @p25=NULL (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "TrackingLogs" ("Id", "Browser", "BusinessId", "ButtonText", "CTAType", "CampaignId", "CampaignSendLogId", "City", "ClickedAt", "ClickedVia", "ContactId", "ContactPhone", "Country", "DeviceType", "FollowUpSent", "IPAddress", "LastInteractionType", "MessageId", "MessageLogId", "Referrer", "SessionId", "SourceId", "SourceType", "StepId", "TemplateId", "ThreadId")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22, @p23, @p24, @p25);
2025-07-02 23:16:04.220 +05:30 [INF] 📥 Click Tracked → Result: CTA click tracked successfully.
2025-07-02 23:16:04.238 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__campaignId_0='5b762111-ca31-42e3-aead-a65f67b4ff48' (Nullable = true), @__normalizedButtonText_1='send pricing', @__normalizedTemplateName_2='flow_step_4'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."ButtonText", c."CampaignId", c."CreatedAt", c."CreatedBy", c."OverrideNextTemplate", c."TemplateName"
FROM "CampaignFlowOverrides" AS c
WHERE c."CampaignId" = @__campaignId_0 AND lower(c."ButtonText") = @__normalizedButtonText_1 AND lower(c."TemplateName") = @__normalizedTemplateName_2
LIMIT 1
2025-07-02 23:16:04.242 +05:30 [INF] 🟡 No campaign override found for button 'send pricing' on template 'flow_step_4'
2025-07-02 23:16:04.261 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__normalizedButtonText_1='send pricing', @__normalizedButtonType_2='quick_reply'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."CTAFlowConfigId", c."PositionX", c."PositionY", c."RequiredSource", c."RequiredTag", c."StepOrder", c."TemplateToSend", c."TemplateType", c."TriggerButtonText", c."TriggerButtonType", c0."Id", c0."BusinessId", c0."CreatedAt", c0."CreatedBy", c0."FlowName", c0."IsActive", c0."IsPublished", c0."UpdatedAt"
FROM "CTAFlowSteps" AS c
INNER JOIN "CTAFlowConfigs" AS c0 ON c."CTAFlowConfigId" = c0."Id"
WHERE c0."BusinessId" = @__businessId_0 AND c0."IsActive" AND c0."IsPublished" AND lower(c."TriggerButtonText") = @__normalizedButtonText_1 AND lower(c."TriggerButtonType") = @__normalizedButtonType_2
LIMIT 1
2025-07-02 23:16:04.265 +05:30 [WRN] ❌ No fallback step matched for button 'send pricing' of type 'quick_reply' in BusinessId: "c13be597-6ae2-42bb-9d43-925815f24ff8"
2025-07-02 23:16:04.267 +05:30 [INF] 🟡 No visual flow matched for this button: Send Pricing
2025-07-02 23:16:19.463 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/api/campaign/send-campaign/01ffa7dc-8f65-4328-88bc-8021808a1001 - null 0
2025-07-02 23:16:19.470 +05:30 [INF] CORS policy execution successful.
2025-07-02 23:16:19.472 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.SendTemplateCampaign (xbytechat.api)'
2025-07-02 23:16:19.474 +05:30 [INF] Route matched with {action = "SendTemplateCampaign", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendTemplateCampaign(System.Guid) on controller xbytechat.api.Features.CampaignModule.Controllers.CampaignController (xbytechat.api).
2025-07-02 23:16:19.484 +05:30 [INF] Executed DbCommand (6ms) [Parameters=[@__campaignId_0='01ffa7dc-8f65-4328-88bc-8021808a1001'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."BusinessId", t."CampaignId", t."CampaignType", t."CreatedAt", t."CreatedBy", t."CtaId", t."DeletedAt", t."DeletedBy", t."FollowUpTemplateId", t."ImageCaption", t."ImageUrl", t."IsDeleted", t."MessageBody", t."MessageTemplate", t."Name", t."ScheduledAt", t."SourceCampaignId", t."Status", t."TemplateId", t."TemplateParameters", t."UpdatedAt", t0."Id", t0."BotId", t0."BusinessId", t0."CampaignId", t0."CategoryBrowsed", t0."ClickedCTA", t0."ContactId", t0."IsAutoTagged", t0."MessagePreview", t0."ProductBrowsed", t0."SentAt", t0."Status", t0."UpdatedAt", t0."Id0", t0."AssignedAgentId", t0."BusinessId0", t0."CreatedAt", t0."Email", t0."Group", t0."IsActive", t0."IsArchived", t0."IsAutomationPaused", t0."IsFavorite", t0."LastCTAInteraction", t0."LastCTAType", t0."LastClickedProductId", t0."LastContactedAt", t0."LeadSource", t0."Name", t0."NextFollowUpAt", t0."Notes", t0."PhoneNumber", t0."Tags", c2."Id", c2."CampaignId", c2."IsFromTemplate", c2."Position", c2."Title", c2."Type", c2."Value"
FROM (
    SELECT c."Id", c."BusinessId", c."CampaignId", c."CampaignType", c."CreatedAt", c."CreatedBy", c."CtaId", c."DeletedAt", c."DeletedBy", c."FollowUpTemplateId", c."ImageCaption", c."ImageUrl", c."IsDeleted", c."MessageBody", c."MessageTemplate", c."Name", c."ScheduledAt", c."SourceCampaignId", c."Status", c."TemplateId", c."TemplateParameters", c."UpdatedAt"
    FROM "Campaigns" AS c
    WHERE c."Id" = @__campaignId_0 AND NOT (c."IsDeleted")
    LIMIT 1
) AS t
LEFT JOIN (
    SELECT c0."Id", c0."BotId", c0."BusinessId", c0."CampaignId", c0."CategoryBrowsed", c0."ClickedCTA", c0."ContactId", c0."IsAutoTagged", c0."MessagePreview", c0."ProductBrowsed", c0."SentAt", c0."Status", c0."UpdatedAt", c1."Id" AS "Id0", c1."AssignedAgentId", c1."BusinessId" AS "BusinessId0", c1."CreatedAt", c1."Email", c1."Group", c1."IsActive", c1."IsArchived", c1."IsAutomationPaused", c1."IsFavorite", c1."LastCTAInteraction", c1."LastCTAType", c1."LastClickedProductId", c1."LastContactedAt", c1."LeadSource", c1."Name", c1."NextFollowUpAt", c1."Notes", c1."PhoneNumber", c1."Tags"
    FROM "CampaignRecipients" AS c0
    INNER JOIN "Contacts" AS c1 ON c0."ContactId" = c1."Id"
) AS t0 ON t."Id" = t0."CampaignId"
LEFT JOIN "CampaignButtons" AS c2 ON t."Id" = c2."CampaignId"
ORDER BY t."Id", t0."Id", t0."Id0"
2025-07-02 23:16:19.492 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiToken", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."IsActive" AND w."BusinessId" = @__businessId_0
LIMIT 1
2025-07-02 23:16:19.495 +05:30 [INF] Start processing HTTP request GET https://graph.facebook.com/v22.0/999432368375320/message_templates
2025-07-02 23:16:19.496 +05:30 [INF] Sending HTTP request GET https://graph.facebook.com/v22.0/999432368375320/message_templates
2025-07-02 23:16:20.344 +05:30 [INF] Received HTTP response headers after 845.9042ms - 200
2025-07-02 23:16:20.346 +05:30 [INF] End processing HTTP request after 851.2982ms - 200
2025-07-02 23:16:20.351 +05:30 [INF] 📨 Preparing to send to +917082156227
2025-07-02 23:16:20.352 +05:30 [INF] ⏩ Skipping static button 'No, thanks' as it requires no parameters
2025-07-02 23:16:20.353 +05:30 [INF] ⏩ Skipping static button 'Yes, show me' as it requires no parameters
2025-07-02 23:16:20.356 +05:30 [INF] Start processing HTTP request POST https://graph.facebook.com/v22.0/601884673011340/messages
2025-07-02 23:16:20.357 +05:30 [INF] Sending HTTP request POST https://graph.facebook.com/v22.0/601884673011340/messages
2025-07-02 23:16:21.367 +05:30 [INF] Received HTTP response headers after 1007.586ms - 200
2025-07-02 23:16:21.369 +05:30 [INF] End processing HTTP request after 1012.993ms - 200
2025-07-02 23:16:21.372 +05:30 [INF] 📬 Send result: {"Success":true,"Message":"✅ Message sent successfully","Data":null,"ErrorMessage":null,"RawResponse":"{\"messaging_product\":\"whatsapp\",\"contacts\":[{\"input\":\"+917082156227\",\"wa_id\":\"917082156227\"}],\"messages\":[{\"id\":\"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMTFFRDQyNzRFQ0Y5RjJFMDhEAA==\",\"message_status\":\"accepted\"}]}","MessageId":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMTFFRDQyNzRFQ0Y5RjJFMDhEAA==","LogId":null,"Token":null,"RefreshToken":null}
2025-07-02 23:16:21.374 +05:30 [INF] ✅ Added MessageLog for +917082156227
2025-07-02 23:16:21.375 +05:30 [INF] 📘 Added CampaignSendLog for recipient "04e49bed-37c7-4d7f-bf61-bd21880d715e"
2025-07-02 23:16:21.377 +05:30 [INF] 💾 Saving all DB changes...
2025-07-02 23:16:21.382 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@p0='5892c2bc-e3a9-4d02-a3ee-ab94964290c2', @p1='c13be597-6ae2-42bb-9d43-925815f24ff8', @p2=NULL (DbType = Guid), @p3=NULL (DbType = Guid), @p4='01ffa7dc-8f65-4328-88bc-8021808a1001' (Nullable = true), @p5='8aac7c57-6699-4511-897b-4121b407eb1c' (Nullable = true), @p6='2025-07-02T17:46:21.3740176Z' (DbType = DateTime), @p7=NULL, @p8='False', @p9=NULL, @p10='flow_step_1' (Nullable = false), @p11='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMTFFRDQyNzRFQ0Y5RjJFMDhEAA==', @p12='{"messaging_product":"whatsapp","contacts":[{"input":"+917082156227","wa_id":"917082156227"}],"messages":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMTFFRDQyNzRFQ0Y5RjJFMDhEAA==","message_status":"accepted"}]}', @p13='+917082156227' (Nullable = false), @p14=NULL (DbType = Guid), @p15=NULL, @p16='2025-07-02T17:46:21.3740179Z' (Nullable = true) (DbType = DateTime), @p17=NULL, @p18='Sent' (Nullable = false), @p19='5097a41b-7494-4a7f-8899-4f6bf6801304', @p20='True', @p21=NULL, @p22='00000000-0000-0000-0000-000000000000', @p23='01ffa7dc-8f65-4328-88bc-8021808a1001', @p24=NULL, @p25=NULL, @p26=NULL (DbType = DateTime), @p27='8aac7c57-6699-4511-897b-4121b407eb1c', @p28=NULL, @p29='2025-07-02T17:46:21.3755425Z' (DbType = DateTime), @p30='system', @p31=NULL (DbType = DateTime), @p32=NULL, @p33=NULL, @p34=NULL, @p35=NULL, @p36='False', @p37=NULL (DbType = DateTime), @p38=NULL, @p39=NULL, @p40='Hi 👋, would you like to explore our special offer?' (Nullable = false), @p41='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMTFFRDQyNzRFQ0Y5RjJFMDhEAA==', @p42='5892c2bc-e3a9-4d02-a3ee-ab94964290c2' (Nullable = true), @p43=NULL (DbType = DateTime), @p44='04e49bed-37c7-4d7f-bf61-bd21880d715e', @p45='0', @p46='Sent', @p47='2025-07-02T17:46:21.3755425Z' (Nullable = true) (DbType = DateTime), @p48=NULL, @p49='flow_step_1', @p50=NULL (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "MessageLogs" ("Id", "BusinessId", "CTAFlowConfigId", "CTAFlowStepId", "CampaignId", "ContactId", "CreatedAt", "ErrorMessage", "IsIncoming", "MediaUrl", "MessageContent", "MessageId", "RawResponse", "RecipientNumber", "RefMessageId", "RenderedBody", "SentAt", "Source", "Status")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
INSERT INTO "CampaignSendLogs" ("Id", "AllowRetry", "Browser", "BusinessId", "CampaignId", "City", "ClickType", "ClickedAt", "ContactId", "Country", "CreatedAt", "CreatedBy", "DeliveredAt", "DeviceInfo", "DeviceType", "ErrorMessage", "IpAddress", "IsClicked", "LastRetryAt", "LastRetryStatus", "MacAddress", "MessageBody", "MessageId", "MessageLogId", "ReadAt", "RecipientId", "RetryCount", "SendStatus", "SentAt", "SourceChannel", "TemplateId", "UserId")
VALUES (@p19, @p20, @p21, @p22, @p23, @p24, @p25, @p26, @p27, @p28, @p29, @p30, @p31, @p32, @p33, @p34, @p35, @p36, @p37, @p38, @p39, @p40, @p41, @p42, @p43, @p44, @p45, @p46, @p47, @p48, @p49, @p50);
2025-07-02 23:16:21.388 +05:30 [INF] ✅ All saved successfully.
2025-07-02 23:16:21.389 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Helpers.ResponseResult'.
2025-07-02 23:16:21.391 +05:30 [INF] Executed action xbytechat.api.Features.CampaignModule.Controllers.CampaignController.SendTemplateCampaign (xbytechat.api) in 1915.0382ms
2025-07-02 23:16:21.393 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.SendTemplateCampaign (xbytechat.api)'
2025-07-02 23:16:21.395 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/api/campaign/send-campaign/01ffa7dc-8f65-4328-88bc-8021808a1001 - 200 null application/json; charset=utf-8 1932.2236ms
2025-07-02 23:16:22.604 +05:30 [INF] Request starting HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - application/json 602
2025-07-02 23:16:22.608 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 23:16:22.610 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-07-02 23:16:22.614 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMTFFRDQyNzRFQ0Y5RjJFMDhEAA==","status":"sent","timestamp":"1751478385","recipient_id":"917082156227","conversation":{"id":"0d8265e877a401a7821e401dd9533268","expiration_timestamp":"1751478385","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-07-02 23:16:22.617 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-07-02 23:16:22.617 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMTFFRDQyNzRFQ0Y5RjJFMDhEAA==","status":"sent","timestamp":"1751478385","recipient_id":"917082156227","conversation":{"id":"0d8265e877a401a7821e401dd9533268","expiration_timestamp":"1751478385","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-07-02 23:16:22.618 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType73`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 23:16:22.620 +05:30 [INF] 📦 Routing to Status Processor
2025-07-02 23:16:22.622 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 8.5995ms
2025-07-02 23:16:22.623 +05:30 [WRN] 🔍 Incoming timestamp raw value: {"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMTFFRDQyNzRFQ0Y5RjJFMDhEAA==","status":"sent","timestamp":"1751478385","recipient_id":"917082156227","conversation":{"id":"0d8265e877a401a7821e401dd9533268","expiration_timestamp":"1751478385","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-07-02 23:16:22.624 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 23:16:22.627 +05:30 [INF] Request finished HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 23.3353ms
2025-07-02 23:16:22.630 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__messageId_0='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMTFFRDQyNzRFQ0Y5RjJFMDhEAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."MessageId" = @__messageId_0
LIMIT 1
2025-07-02 23:16:22.640 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__logId_Value_0='5097a41b-7494-4a7f-8899-4f6bf6801304'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."Id" = @__logId_Value_0
LIMIT 1
2025-07-02 23:16:22.643 +05:30 [INF] ✅ CampaignSendLog updated for MessageId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMTFFRDQyNzRFQ0Y5RjJFMDhEAA== → sent
2025-07-02 23:16:22.769 +05:30 [INF] Request starting HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - application/json 571
2025-07-02 23:16:22.773 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 23:16:22.775 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-07-02 23:16:22.781 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMTFFRDQyNzRFQ0Y5RjJFMDhEAA==","status":"delivered","timestamp":"1751478386","recipient_id":"917082156227","conversation":{"id":"0d8265e877a401a7821e401dd9533268","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-07-02 23:16:22.784 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-07-02 23:16:22.784 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMTFFRDQyNzRFQ0Y5RjJFMDhEAA==","status":"delivered","timestamp":"1751478386","recipient_id":"917082156227","conversation":{"id":"0d8265e877a401a7821e401dd9533268","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-07-02 23:16:22.785 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType73`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 23:16:22.787 +05:30 [INF] 📦 Routing to Status Processor
2025-07-02 23:16:22.789 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 8.9031ms
2025-07-02 23:16:22.790 +05:30 [WRN] 🔍 Incoming timestamp raw value: {"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMTFFRDQyNzRFQ0Y5RjJFMDhEAA==","status":"delivered","timestamp":"1751478386","recipient_id":"917082156227","conversation":{"id":"0d8265e877a401a7821e401dd9533268","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-07-02 23:16:22.793 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 23:16:22.799 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__messageId_0='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMTFFRDQyNzRFQ0Y5RjJFMDhEAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."MessageId" = @__messageId_0
LIMIT 1
2025-07-02 23:16:22.800 +05:30 [INF] Request finished HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 30.8613ms
2025-07-02 23:16:22.805 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__logId_Value_0='5097a41b-7494-4a7f-8899-4f6bf6801304'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."Id" = @__logId_Value_0
LIMIT 1
2025-07-02 23:16:22.815 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@p2='5097a41b-7494-4a7f-8899-4f6bf6801304', @p0='2025-07-02T17:46:26.0000000Z' (Nullable = true) (DbType = DateTime), @p1='Delivered'], CommandType='"Text"', CommandTimeout='30']
UPDATE "CampaignSendLogs" SET "DeliveredAt" = @p0, "SendStatus" = @p1
WHERE "Id" = @p2;
2025-07-02 23:16:22.818 +05:30 [INF] ✅ CampaignSendLog updated for MessageId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMTFFRDQyNzRFQ0Y5RjJFMDhEAA== → delivered
2025-07-02 23:16:26.294 +05:30 [INF] Request starting HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - application/json 633
2025-07-02 23:16:26.298 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 23:16:26.300 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-07-02 23:16:26.304 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"contacts":[{"profile":{"name":"\ua9c1S.K\ua9c2"},"wa_id":"917082156227"}],"messages":[{"context":{"from":"15556395845","id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMTFFRDQyNzRFQ0Y5RjJFMDhEAA=="},"from":"917082156227","id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAEhggMjU1RUFCMUQ1MTM4OUJFRjhEQzExQzNEMDE4ODMxQTEA","timestamp":"1751478389","type":"button","button":{"payload":"Yes, show me","text":"Yes, show me"}}]},"field":"messages"}]}]}
2025-07-02 23:16:26.307 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-07-02 23:16:26.307 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"contacts":[{"profile":{"name":"\ua9c1S.K\ua9c2"},"wa_id":"917082156227"}],"messages":[{"context":{"from":"15556395845","id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMTFFRDQyNzRFQ0Y5RjJFMDhEAA=="},"from":"917082156227","id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAEhggMjU1RUFCMUQ1MTM4OUJFRjhEQzExQzNEMDE4ODMxQTEA","timestamp":"1751478389","type":"button","button":{"payload":"Yes, show me","text":"Yes, show me"}}]},"field":"messages"}]}]}
2025-07-02 23:16:26.308 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType73`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 23:16:26.312 +05:30 [INF] 👉 Routing to Click Processor
2025-07-02 23:16:26.314 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 10.9794ms
2025-07-02 23:16:26.316 +05:30 [WRN] 📥 [ENTERED CLICK PROCESSOR]
2025-07-02 23:16:26.317 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 23:16:26.318 +05:30 [INF] 🖱️ Button Click → From: 917082156227, ClickId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAEhggMjU1RUFCMUQ1MTM4OUJFRjhEQzExQzNEMDE4ODMxQTEA, OrigMsgId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMTFFRDQyNzRFQ0Y5RjJFMDhEAA==, Text: Yes, show me
2025-07-02 23:16:26.319 +05:30 [INF] Request finished HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 25.5139ms
2025-07-02 23:16:26.325 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__originalMessageId_0='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMTFFRDQyNzRFQ0Y5RjJFMDhEAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId", c0."Id", c0."BusinessId", c0."CampaignId", c0."CampaignType", c0."CreatedAt", c0."CreatedBy", c0."CtaId", c0."DeletedAt", c0."DeletedBy", c0."FollowUpTemplateId", c0."ImageCaption", c0."ImageUrl", c0."IsDeleted", c0."MessageBody", c0."MessageTemplate", c0."Name", c0."ScheduledAt", c0."SourceCampaignId", c0."Status", c0."TemplateId", c0."TemplateParameters", c0."UpdatedAt", c1."Id", c1."AssignedAgentId", c1."BusinessId", c1."CreatedAt", c1."Email", c1."Group", c1."IsActive", c1."IsArchived", c1."IsAutomationPaused", c1."IsFavorite", c1."LastCTAInteraction", c1."LastCTAType", c1."LastClickedProductId", c1."LastContactedAt", c1."LeadSource", c1."Name", c1."NextFollowUpAt", c1."Notes", c1."PhoneNumber", c1."Tags"
FROM "CampaignSendLogs" AS c
INNER JOIN "Campaigns" AS c0 ON c."CampaignId" = c0."Id"
INNER JOIN "Contacts" AS c1 ON c."ContactId" = c1."Id"
WHERE c."MessageId" = @__originalMessageId_0
LIMIT 1
2025-07-02 23:16:26.335 +05:30 [INF] 📊 CampaignSendLog matched via context.id
2025-07-02 23:16:27.128 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__dto_MessageId_0='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMTFFRDQyNzRFQ0Y5RjJFMDhEAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."CreatedAt", m."ErrorMessage", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."MessageId" = @__dto_MessageId_0 OR m."Id"::text = @__dto_MessageId_0
LIMIT 1
2025-07-02 23:16:27.134 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__dto_MessageId_0='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMTFFRDQyNzRFQ0Y5RjJFMDhEAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId", c0."Id", c0."BotId", c0."BusinessId", c0."CampaignId", c0."CategoryBrowsed", c0."ClickedCTA", c0."ContactId", c0."IsAutoTagged", c0."MessagePreview", c0."ProductBrowsed", c0."SentAt", c0."Status", c0."UpdatedAt"
FROM "CampaignSendLogs" AS c
INNER JOIN "CampaignRecipients" AS c0 ON c."RecipientId" = c0."Id"
WHERE c."MessageId" = @__dto_MessageId_0
LIMIT 1
2025-07-02 23:16:27.157 +05:30 [INF] Executed DbCommand (19ms) [Parameters=[@p3='5097a41b-7494-4a7f-8899-4f6bf6801304', @p0='Yes, show me', @p1='2025-07-02T17:46:26.3369867Z' (Nullable = true) (DbType = DateTime), @p2='True'], CommandType='"Text"', CommandTimeout='30']
UPDATE "CampaignSendLogs" SET "ClickType" = @p0, "ClickedAt" = @p1, "IsClicked" = @p2
WHERE "Id" = @p3;
2025-07-02 23:16:27.164 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@p0='5c87691f-9681-44f4-ab92-1a4434b5953d', @p1='WhatsApp', @p2='c13be597-6ae2-42bb-9d43-925815f24ff8', @p3='Yes, show me', @p4='Yes, show me', @p5='01ffa7dc-8f65-4328-88bc-8021808a1001' (Nullable = true), @p6='5097a41b-7494-4a7f-8899-4f6bf6801304' (Nullable = true), @p7=NULL, @p8='2025-07-02T17:46:26.3369867Z' (DbType = DateTime), @p9='webhook', @p10='8aac7c57-6699-4511-897b-4121b407eb1c' (Nullable = true), @p11='+917082156227', @p12='Unknown', @p13='Unknown', @p14='False', @p15='webhook', @p16='Clicked', @p17='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSMTFFRDQyNzRFQ0Y5RjJFMDhEAA==', @p18='5892c2bc-e3a9-4d02-a3ee-ab94964290c2' (Nullable = true), @p19=NULL, @p20=NULL (DbType = Guid), @p21='01ffa7dc-8f65-4328-88bc-8021808a1001' (Nullable = true), @p22='campaign' (Nullable = false), @p23=NULL (DbType = Guid), @p24=NULL, @p25=NULL (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "TrackingLogs" ("Id", "Browser", "BusinessId", "ButtonText", "CTAType", "CampaignId", "CampaignSendLogId", "City", "ClickedAt", "ClickedVia", "ContactId", "ContactPhone", "Country", "DeviceType", "FollowUpSent", "IPAddress", "LastInteractionType", "MessageId", "MessageLogId", "Referrer", "SessionId", "SourceId", "SourceType", "StepId", "TemplateId", "ThreadId")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22, @p23, @p24, @p25);
2025-07-02 23:16:27.167 +05:30 [INF] 📥 Click Tracked → Result: CTA click tracked successfully.
2025-07-02 23:16:27.171 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__campaignId_0='01ffa7dc-8f65-4328-88bc-8021808a1001' (Nullable = true), @__normalizedButtonText_1='yes, show me', @__normalizedTemplateName_2='flow_step_1'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."ButtonText", c."CampaignId", c."CreatedAt", c."CreatedBy", c."OverrideNextTemplate", c."TemplateName"
FROM "CampaignFlowOverrides" AS c
WHERE c."CampaignId" = @__campaignId_0 AND lower(c."ButtonText") = @__normalizedButtonText_1 AND lower(c."TemplateName") = @__normalizedTemplateName_2
LIMIT 1
2025-07-02 23:16:27.174 +05:30 [INF] 🟡 No campaign override found for button 'yes, show me' on template 'flow_step_1'
2025-07-02 23:16:27.179 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__normalizedButtonText_1='yes, show me', @__normalizedButtonType_2='quick_reply'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."CTAFlowConfigId", c."PositionX", c."PositionY", c."RequiredSource", c."RequiredTag", c."StepOrder", c."TemplateToSend", c."TemplateType", c."TriggerButtonText", c."TriggerButtonType", c0."Id", c0."BusinessId", c0."CreatedAt", c0."CreatedBy", c0."FlowName", c0."IsActive", c0."IsPublished", c0."UpdatedAt"
FROM "CTAFlowSteps" AS c
INNER JOIN "CTAFlowConfigs" AS c0 ON c."CTAFlowConfigId" = c0."Id"
WHERE c0."BusinessId" = @__businessId_0 AND c0."IsActive" AND c0."IsPublished" AND lower(c."TriggerButtonText") = @__normalizedButtonText_1 AND lower(c."TriggerButtonType") = @__normalizedButtonType_2
LIMIT 1
2025-07-02 23:16:27.229 +05:30 [INF] ✅ Fallback flow step matched: StepId = "b2d0e1a3-846e-49aa-a954-8badae61643f", Flow = test01
2025-07-02 23:16:27.233 +05:30 [INF] 🔁 Matched CTA Step → "b2d0e1a3-846e-49aa-a954-8badae61643f"
2025-07-02 23:16:27.237 +05:30 [INF] 🚦 Executing Visual Flow → StepId: "b2d0e1a3-846e-49aa-a954-8badae61643f" | TrackingLogId: "5c87691f-9681-44f4-ab92-1a4434b5953d"
2025-07-02 23:16:27.271 +05:30 [INF] Executed DbCommand (5ms) [Parameters=[@__trackingLogId_0='5c87691f-9681-44f4-ab92-1a4434b5953d'], CommandType='"Text"', CommandTimeout='30']
SELECT t0."Id", t0."Browser", t0."BusinessId", t0."ButtonText", t0."CTAType", t0."CampaignId", t0."CampaignSendLogId", t0."City", t0."ClickedAt", t0."ClickedVia", t0."ContactId", t0."ContactPhone", t0."Country", t0."DeviceType", t0."FollowUpSent", t0."IPAddress", t0."LastInteractionType", t0."MessageId", t0."MessageLogId", t0."Referrer", t0."SessionId", t0."SourceId", t0."SourceType", t0."StepId", t0."TemplateId", t0."ThreadId", t0."Id0", t0."AssignedAgentId", t0."BusinessId0", t0."CreatedAt", t0."Email", t0."Group", t0."IsActive", t0."IsArchived", t0."IsAutomationPaused", t0."IsFavorite", t0."LastCTAInteraction", t0."LastCTAType", t0."LastClickedProductId", t0."LastContactedAt", t0."LeadSource", t0."Name", t0."NextFollowUpAt", t0."Notes", t0."PhoneNumber", t0."Tags", t1."Id", t1."AssignedAt", t1."AssignedBy", t1."BusinessId", t1."ContactId", t1."TagId", t1."Id0", t1."BusinessId0", t1."Category", t1."ColorHex", t1."CreatedAt", t1."IsActive", t1."IsSystemTag", t1."LastUsedAt", t1."Name", t1."Notes"
FROM (
    SELECT t."Id", t."Browser", t."BusinessId", t."ButtonText", t."CTAType", t."CampaignId", t."CampaignSendLogId", t."City", t."ClickedAt", t."ClickedVia", t."ContactId", t."ContactPhone", t."Country", t."DeviceType", t."FollowUpSent", t."IPAddress", t."LastInteractionType", t."MessageId", t."MessageLogId", t."Referrer", t."SessionId", t."SourceId", t."SourceType", t."StepId", t."TemplateId", t."ThreadId", c."Id" AS "Id0", c."AssignedAgentId", c."BusinessId" AS "BusinessId0", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."Tags"
    FROM "TrackingLogs" AS t
    LEFT JOIN "Contacts" AS c ON t."ContactId" = c."Id"
    WHERE t."Id" = @__trackingLogId_0
    LIMIT 1
) AS t0
LEFT JOIN (
    SELECT c0."Id", c0."AssignedAt", c0."AssignedBy", c0."BusinessId", c0."ContactId", c0."TagId", t2."Id" AS "Id0", t2."BusinessId" AS "BusinessId0", t2."Category", t2."ColorHex", t2."CreatedAt", t2."IsActive", t2."IsSystemTag", t2."LastUsedAt", t2."Name", t2."Notes"
    FROM "ContactTags" AS c0
    INNER JOIN "Tags" AS t2 ON c0."TagId" = t2."Id"
) AS t1 ON t0."Id0" = t1."ContactId"
ORDER BY t0."Id", t0."Id0", t1."Id"
2025-07-02 23:16:27.298 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__nextStepId_1='b2d0e1a3-846e-49aa-a954-8badae61643f' (Nullable = true)], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."BusinessId", t."CreatedAt", t."CreatedBy", t."FlowName", t."IsActive", t."IsPublished", t."UpdatedAt", c1."Id", c1."CTAFlowConfigId", c1."PositionX", c1."PositionY", c1."RequiredSource", c1."RequiredTag", c1."StepOrder", c1."TemplateToSend", c1."TemplateType", c1."TriggerButtonText", c1."TriggerButtonType"
FROM (
    SELECT c."Id", c."BusinessId", c."CreatedAt", c."CreatedBy", c."FlowName", c."IsActive", c."IsPublished", c."UpdatedAt"
    FROM "CTAFlowConfigs" AS c
    WHERE c."BusinessId" = @__businessId_0 AND EXISTS (
        SELECT 1
        FROM "CTAFlowSteps" AS c0
        WHERE c."Id" = c0."CTAFlowConfigId" AND c0."Id" = @__nextStepId_1)
    LIMIT 1
) AS t
LEFT JOIN "CTAFlowSteps" AS c1 ON t."Id" = c1."CTAFlowConfigId"
ORDER BY t."Id"
2025-07-02 23:16:27.305 +05:30 [INF] ✅ Follow-up step found and matched → StepId: "b2d0e1a3-846e-49aa-a954-8badae61643f", Template: flow_step_2
2025-07-02 23:16:27.308 +05:30 [INF] Start processing HTTP request POST https://graph.facebook.com/v22.0/601884673011340/messages
2025-07-02 23:16:27.310 +05:30 [INF] Sending HTTP request POST https://graph.facebook.com/v22.0/601884673011340/messages
2025-07-02 23:16:28.433 +05:30 [INF] Received HTTP response headers after 1121.536ms - 200
2025-07-02 23:16:28.435 +05:30 [INF] End processing HTTP request after 1126.9774ms - 200
2025-07-02 23:16:28.476 +05:30 [INF] Executed DbCommand (19ms) [Parameters=[@p0='6d71e531-df57-4bd0-bd18-8f6bbfed5b1e', @p1='c13be597-6ae2-42bb-9d43-925815f24ff8', @p2=NULL (DbType = Guid), @p3=NULL (DbType = Guid), @p4=NULL (DbType = Guid), @p5=NULL (DbType = Guid), @p6='2025-07-02T17:46:28.4390402Z' (DbType = DateTime), @p7=NULL, @p8='False', @p9=NULL, @p10='flow_step_2' (Nullable = false), @p11=NULL, @p12='{"Success":true,"Message":"✅ Message sent successfully","Data":null,"ErrorMessage":null,"RawResponse":"{\"messaging_product\":\"whatsapp\",\"contacts\":[{\"input\":\"+917082156227\",\"wa_id\":\"917082156227\"}],\"messages\":[{\"id\":\"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSOTJBRUY3MjIxQTU1MjY2MTBFAA==\",\"message_status\":\"accepted\"}]}","MessageId":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSOTJBRUY3MjIxQTU1MjY2MTBFAA==","LogId":null,"Token":null,"RefreshToken":null}', @p13='+917082156227' (Nullable = false), @p14=NULL (DbType = Guid), @p15='', @p16='2025-07-02T17:46:28.4390397Z' (Nullable = true) (DbType = DateTime), @p17=NULL, @p18='Sent' (Nullable = false)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "MessageLogs" ("Id", "BusinessId", "CTAFlowConfigId", "CTAFlowStepId", "CampaignId", "ContactId", "CreatedAt", "ErrorMessage", "IsIncoming", "MediaUrl", "MessageContent", "MessageId", "RawResponse", "RecipientNumber", "RefMessageId", "RenderedBody", "SentAt", "Source", "Status")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
2025-07-02 23:16:28.520 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@p0='25204aac-378b-4c2f-9347-aebc8ef8c72c', @p1='c13be597-6ae2-42bb-9d43-925815f24ff8', @p2='+917082156227', @p3=NULL, @p4='2025-07-02T17:46:28.4826536Z' (DbType = DateTime), @p5='8c065950-26a3-4fac-a3a4-462879e809e6' (Nullable = true), @p6=NULL, @p7='b2d0e1a3-846e-49aa-a954-8badae61643f', @p8='' (Nullable = false), @p9='True', @p10='flow_step_2', @p11='text_template', @p12='5c87691f-9681-44f4-ab92-1a4434b5953d' (Nullable = true), @p13='Yes, show me'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "FlowExecutionLogs" ("Id", "BusinessId", "ContactPhone", "ErrorMessage", "ExecutedAt", "FlowId", "RawResponse", "StepId", "StepName", "Success", "TemplateName", "TemplateType", "TrackingLogId", "TriggeredByButton")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13);
2025-07-02 23:16:28.525 +05:30 [INF] ✅ Flow step executed → Template: flow_step_2 sent to +917082156227
2025-07-02 23:16:28.527 +05:30 [INF] ⚡ Visual flow triggered via CTA click.
2025-07-02 23:16:29.567 +05:30 [INF] Request starting HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - application/json 602
2025-07-02 23:16:29.572 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 23:16:29.574 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-07-02 23:16:29.577 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSOTJBRUY3MjIxQTU1MjY2MTBFAA==","status":"sent","timestamp":"1751478392","recipient_id":"917082156227","conversation":{"id":"1434b72a90f0b6ddc04b5043a1b0bbfe","expiration_timestamp":"1751478392","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-07-02 23:16:29.579 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-07-02 23:16:29.580 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSOTJBRUY3MjIxQTU1MjY2MTBFAA==","status":"sent","timestamp":"1751478392","recipient_id":"917082156227","conversation":{"id":"1434b72a90f0b6ddc04b5043a1b0bbfe","expiration_timestamp":"1751478392","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-07-02 23:16:29.580 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType73`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 23:16:29.582 +05:30 [INF] 📦 Routing to Status Processor
2025-07-02 23:16:29.585 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 8.727ms
2025-07-02 23:16:29.586 +05:30 [WRN] 🔍 Incoming timestamp raw value: {"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSOTJBRUY3MjIxQTU1MjY2MTBFAA==","status":"sent","timestamp":"1751478392","recipient_id":"917082156227","conversation":{"id":"1434b72a90f0b6ddc04b5043a1b0bbfe","expiration_timestamp":"1751478392","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-07-02 23:16:29.588 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 23:16:29.592 +05:30 [INF] Request finished HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 24.4014ms
2025-07-02 23:16:29.592 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__messageId_0='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSOTJBRUY3MjIxQTU1MjY2MTBFAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."MessageId" = @__messageId_0
LIMIT 1
2025-07-02 23:16:29.600 +05:30 [WRN] ⚠️ CampaignSendLog not found for MessageId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSOTJBRUY3MjIxQTU1MjY2MTBFAA==
2025-07-02 23:16:29.601 +05:30 [WRN] ⚠️ No matching CampaignSendLog for MessageId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSOTJBRUY3MjIxQTU1MjY2MTBFAA==
2025-07-02 23:16:29.973 +05:30 [INF] Request starting HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - application/json 571
2025-07-02 23:16:29.977 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 23:16:29.978 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-07-02 23:16:29.981 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSOTJBRUY3MjIxQTU1MjY2MTBFAA==","status":"delivered","timestamp":"1751478393","recipient_id":"917082156227","conversation":{"id":"1434b72a90f0b6ddc04b5043a1b0bbfe","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-07-02 23:16:29.983 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-07-02 23:16:29.983 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSOTJBRUY3MjIxQTU1MjY2MTBFAA==","status":"delivered","timestamp":"1751478393","recipient_id":"917082156227","conversation":{"id":"1434b72a90f0b6ddc04b5043a1b0bbfe","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-07-02 23:16:29.984 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType73`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 23:16:29.986 +05:30 [INF] 📦 Routing to Status Processor
2025-07-02 23:16:29.990 +05:30 [WRN] 🔍 Incoming timestamp raw value: {"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSOTJBRUY3MjIxQTU1MjY2MTBFAA==","status":"delivered","timestamp":"1751478393","recipient_id":"917082156227","conversation":{"id":"1434b72a90f0b6ddc04b5043a1b0bbfe","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-07-02 23:16:29.988 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 7.6116ms
2025-07-02 23:16:29.994 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__messageId_0='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSOTJBRUY3MjIxQTU1MjY2MTBFAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."MessageId" = @__messageId_0
LIMIT 1
2025-07-02 23:16:29.994 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 23:16:29.996 +05:30 [WRN] ⚠️ CampaignSendLog not found for MessageId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSOTJBRUY3MjIxQTU1MjY2MTBFAA==
2025-07-02 23:16:29.997 +05:30 [INF] Request finished HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 24.6012ms
2025-07-02 23:16:29.999 +05:30 [WRN] ⚠️ No matching CampaignSendLog for MessageId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSOTJBRUY3MjIxQTU1MjY2MTBFAA==
2025-07-02 23:16:32.223 +05:30 [INF] Request starting HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - application/json 633
2025-07-02 23:16:32.227 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 23:16:32.229 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-07-02 23:16:32.232 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"contacts":[{"profile":{"name":"\ua9c1S.K\ua9c2"},"wa_id":"917082156227"}],"messages":[{"context":{"from":"15556395845","id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSOTJBRUY3MjIxQTU1MjY2MTBFAA=="},"from":"917082156227","id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAEhggNEU5OTAwQ0QwMTEwODM3NUU4RjE4QUNBRTUwNEE4MUUA","timestamp":"1751478395","type":"button","button":{"payload":"More Options","text":"More Options"}}]},"field":"messages"}]}]}
2025-07-02 23:16:32.234 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-07-02 23:16:32.234 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"contacts":[{"profile":{"name":"\ua9c1S.K\ua9c2"},"wa_id":"917082156227"}],"messages":[{"context":{"from":"15556395845","id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSOTJBRUY3MjIxQTU1MjY2MTBFAA=="},"from":"917082156227","id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAEhggNEU5OTAwQ0QwMTEwODM3NUU4RjE4QUNBRTUwNEE4MUUA","timestamp":"1751478395","type":"button","button":{"payload":"More Options","text":"More Options"}}]},"field":"messages"}]}]}
2025-07-02 23:16:32.237 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType73`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 23:16:32.239 +05:30 [INF] 👉 Routing to Click Processor
2025-07-02 23:16:32.241 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 9.8976ms
2025-07-02 23:16:32.245 +05:30 [WRN] 📥 [ENTERED CLICK PROCESSOR]
2025-07-02 23:16:32.247 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 23:16:32.248 +05:30 [INF] 🖱️ Button Click → From: 917082156227, ClickId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAEhggNEU5OTAwQ0QwMTEwODM3NUU4RjE4QUNBRTUwNEE4MUUA, OrigMsgId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSOTJBRUY3MjIxQTU1MjY2MTBFAA==, Text: More Options
2025-07-02 23:16:32.249 +05:30 [INF] Request finished HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 26.1055ms
2025-07-02 23:16:32.257 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__originalMessageId_0='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSOTJBRUY3MjIxQTU1MjY2MTBFAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId", c0."Id", c0."BusinessId", c0."CampaignId", c0."CampaignType", c0."CreatedAt", c0."CreatedBy", c0."CtaId", c0."DeletedAt", c0."DeletedBy", c0."FollowUpTemplateId", c0."ImageCaption", c0."ImageUrl", c0."IsDeleted", c0."MessageBody", c0."MessageTemplate", c0."Name", c0."ScheduledAt", c0."SourceCampaignId", c0."Status", c0."TemplateId", c0."TemplateParameters", c0."UpdatedAt", c1."Id", c1."AssignedAgentId", c1."BusinessId", c1."CreatedAt", c1."Email", c1."Group", c1."IsActive", c1."IsArchived", c1."IsAutomationPaused", c1."IsFavorite", c1."LastCTAInteraction", c1."LastCTAType", c1."LastClickedProductId", c1."LastContactedAt", c1."LeadSource", c1."Name", c1."NextFollowUpAt", c1."Notes", c1."PhoneNumber", c1."Tags"
FROM "CampaignSendLogs" AS c
INNER JOIN "Campaigns" AS c0 ON c."CampaignId" = c0."Id"
INNER JOIN "Contacts" AS c1 ON c."ContactId" = c1."Id"
WHERE c."MessageId" = @__originalMessageId_0
LIMIT 1
2025-07-02 23:16:32.296 +05:30 [INF] Executed DbCommand (22ms) [Parameters=[@__originalMessageId_0='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSOTJBRUY3MjIxQTU1MjY2MTBFAA==', @__originalMessageId_0_contains='%wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSOTJBRUY3MjIxQTU1MjY2MTBFAA==%'], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."CreatedAt", m."ErrorMessage", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."MessageId" = @__originalMessageId_0 OR m."Id"::text = @__originalMessageId_0 OR m."RawResponse" LIKE @__originalMessageId_0_contains
LIMIT 1
2025-07-02 23:16:32.300 +05:30 [INF] ✅ Fallback matched MessageLog. BusinessId: "c13be597-6ae2-42bb-9d43-925815f24ff8"
2025-07-02 23:16:33.083 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__dto_MessageId_0='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSOTJBRUY3MjIxQTU1MjY2MTBFAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."CreatedAt", m."ErrorMessage", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."MessageId" = @__dto_MessageId_0 OR m."Id"::text = @__dto_MessageId_0
LIMIT 1
2025-07-02 23:16:33.107 +05:30 [INF] Executed DbCommand (19ms) [Parameters=[@p0='d99d4f2b-77da-46aa-918f-10b691a54662', @p1='WhatsApp', @p2='c13be597-6ae2-42bb-9d43-925815f24ff8', @p3='More Options', @p4='More Options', @p5=NULL (DbType = Guid), @p6=NULL (DbType = Guid), @p7=NULL, @p8='2025-07-02T17:46:32.3022442Z' (DbType = DateTime), @p9='webhook', @p10=NULL (DbType = Guid), @p11='+917082156227', @p12='Unknown', @p13='Unknown', @p14='False', @p15='webhook', @p16='Clicked', @p17='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSOTJBRUY3MjIxQTU1MjY2MTBFAA==', @p18=NULL (DbType = Guid), @p19=NULL, @p20=NULL (DbType = Guid), @p21=NULL (DbType = Guid), @p22='flow' (Nullable = false), @p23=NULL (DbType = Guid), @p24=NULL, @p25=NULL (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "TrackingLogs" ("Id", "Browser", "BusinessId", "ButtonText", "CTAType", "CampaignId", "CampaignSendLogId", "City", "ClickedAt", "ClickedVia", "ContactId", "ContactPhone", "Country", "DeviceType", "FollowUpSent", "IPAddress", "LastInteractionType", "MessageId", "MessageLogId", "Referrer", "SessionId", "SourceId", "SourceType", "StepId", "TemplateId", "ThreadId")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22, @p23, @p24, @p25);
2025-07-02 23:16:33.111 +05:30 [INF] 📥 Click Tracked → Result: CTA click tracked successfully.
2025-07-02 23:16:33.114 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__normalizedButtonText_1='more options', @__normalizedButtonType_2='quick_reply'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."CTAFlowConfigId", c."PositionX", c."PositionY", c."RequiredSource", c."RequiredTag", c."StepOrder", c."TemplateToSend", c."TemplateType", c."TriggerButtonText", c."TriggerButtonType", c0."Id", c0."BusinessId", c0."CreatedAt", c0."CreatedBy", c0."FlowName", c0."IsActive", c0."IsPublished", c0."UpdatedAt"
FROM "CTAFlowSteps" AS c
INNER JOIN "CTAFlowConfigs" AS c0 ON c."CTAFlowConfigId" = c0."Id"
WHERE c0."BusinessId" = @__businessId_0 AND c0."IsActive" AND c0."IsPublished" AND lower(c."TriggerButtonText") = @__normalizedButtonText_1 AND lower(c."TriggerButtonType") = @__normalizedButtonType_2
LIMIT 1
2025-07-02 23:16:33.117 +05:30 [WRN] ❌ No fallback step matched for button 'more options' of type 'quick_reply' in BusinessId: "c13be597-6ae2-42bb-9d43-925815f24ff8"
2025-07-02 23:16:33.119 +05:30 [INF] 🟡 No visual flow matched for this button: More Options
2025-07-02 23:16:45.235 +05:30 [INF] Request starting HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - application/json 491
2025-07-02 23:16:45.239 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 23:16:45.242 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-07-02 23:16:45.245 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"contacts":[{"profile":{"name":"\ua9c1S.K\ua9c2"},"wa_id":"917082156227"}],"messages":[{"from":"917082156227","id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAEhggQkRGQjlCOTFFOEE1NUYxQjk2MEM1RjQwNERDRTkzRTQA","timestamp":"1751478408","text":{"body":"hi"},"type":"text"}]},"field":"messages"}]}]}
2025-07-02 23:16:45.247 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-07-02 23:16:45.248 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"contacts":[{"profile":{"name":"\ua9c1S.K\ua9c2"},"wa_id":"917082156227"}],"messages":[{"from":"917082156227","id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAEhggQkRGQjlCOTFFOEE1NUYxQjk2MEM1RjQwNERDRTkzRTQA","timestamp":"1751478408","text":{"body":"hi"},"type":"text"}]},"field":"messages"}]}]}
2025-07-02 23:16:45.248 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType73`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 23:16:45.250 +05:30 [INF] 💬 Routing to InboundMessageProcessor (type: text)
2025-07-02 23:16:45.252 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 8.2858ms
2025-07-02 23:16:45.255 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 23:16:45.257 +05:30 [INF] Request finished HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 21.2969ms
2025-07-02 23:16:45.272 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessNumber_0='15556395845'], CommandType='"Text"', CommandTimeout='30']
SELECT b."Id", b."Address", b."ApprovedAt", b."ApprovedBy", b."BusinessEmail", b."BusinessName", b."CompanyName", b."CompanyPhone", b."CreatedAt", b."CreatedBy", b."CreatedByPartnerId", b."DeletedAt", b."DeletedBy", b."Industry", b."IsApproved", b."IsDeleted", b."LastLoginAt", b."LogoUrl", b."Notes", b."Phone", b."RepresentativeName", b."Source", b."Status", b."Tags", b."Website", w."Id", w."ApiToken", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WhatsAppBusinessNumber"
FROM "Businesses" AS b
LEFT JOIN "WhatsAppSettings" AS w ON b."Id" = w."BusinessId"
WHERE w."WhatsAppBusinessNumber" = @__businessNumber_0
LIMIT 1
2025-07-02 23:16:45.278 +05:30 [INF] FindOrCreateAsync: businessId="c13be597-6ae2-42bb-9d43-925815f24ff8", phoneNumber=917082156227
2025-07-02 23:16:45.288 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__phoneNumber_1='917082156227'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."Tags"
FROM "Contacts" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."PhoneNumber" = @__phoneNumber_1
LIMIT 1
2025-07-02 23:16:45.291 +05:30 [INF] Contact already exists: contactId="0876f654-a362-420f-a912-6bce793436a5"
2025-07-02 23:16:45.301 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__contactId_1='0876f654-a362-420f-a912-6bce793436a5'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."BusinessId", c."ContactId", c."LastUpdatedAt", c."Mode", c."UpdatedBy"
FROM "ChatSessionStates" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."ContactId" = @__contactId_1
LIMIT 1
2025-07-02 23:16:45.326 +05:30 [INF] Executed DbCommand (20ms) [Parameters=[@p0='31de5e5a-7d30-4c2a-8fe2-e0be07b747ef', @p1='c13be597-6ae2-42bb-9d43-925815f24ff8', @p2=NULL (DbType = Guid), @p3=NULL (DbType = Guid), @p4=NULL (DbType = Guid), @p5='0876f654-a362-420f-a912-6bce793436a5' (Nullable = true), @p6='2025-07-02T17:46:45.3051272Z' (DbType = DateTime), @p7=NULL, @p8='True', @p9=NULL, @p10='hi' (Nullable = false), @p11=NULL, @p12=NULL, @p13='917082156227' (Nullable = false), @p14=NULL (DbType = Guid), @p15=NULL, @p16='2025-07-02T17:46:45.3051276Z' (Nullable = true) (DbType = DateTime), @p17=NULL, @p18='received' (Nullable = false)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "MessageLogs" ("Id", "BusinessId", "CTAFlowConfigId", "CTAFlowStepId", "CampaignId", "ContactId", "CreatedAt", "ErrorMessage", "IsIncoming", "MediaUrl", "MessageContent", "MessageId", "RawResponse", "RecipientNumber", "RefMessageId", "RenderedBody", "SentAt", "Source", "Status")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
2025-07-02 23:16:45.338 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."BusinessId", a."CreatedAt", a."FlowId", a."FlowName", a."IsActive", a."MediaUrl", a."Priority", a."ReplyMessage", a."TriggerKeyword", a."UpdatedAt"
FROM "AutoReplyRules" AS a
WHERE a."BusinessId" = @__businessId_0 AND a."IsActive"
2025-07-02 23:16:45.341 +05:30 [INF] 🔍 No flow match found or FlowId is null. Trying fallback auto-reply...
2025-07-02 23:16:45.356 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__incomingMessage_1='hi'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."BusinessId", a."CreatedAt", a."FlowId", a."FlowName", a."IsActive", a."MediaUrl", a."Priority", a."ReplyMessage", a."TriggerKeyword", a."UpdatedAt"
FROM "AutoReplyRules" AS a
WHERE a."BusinessId" = @__businessId_0 AND a."IsActive" AND strpos(@__incomingMessage_1, a."TriggerKeyword") > 0
ORDER BY a."Priority"
LIMIT 1
2025-07-02 23:16:45.359 +05:30 [INF] ❌ No fallback rule matched for: hi
2025-07-02 23:16:48.463 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@p0='835fe348-4330-4bdf-9fdd-1bbd6cf3203b', @p1='c13be597-6ae2-42bb-9d43-925815f24ff8', @p2=NULL (DbType = Guid), @p3=NULL (DbType = Guid), @p4=NULL (DbType = Guid), @p5='0876f654-a362-420f-a912-6bce793436a5' (Nullable = true), @p6='2025-07-02T17:46:48.4575277Z' (DbType = DateTime), @p7=NULL, @p8='True', @p9=NULL, @p10='hi' (Nullable = false), @p11=NULL, @p12=NULL, @p13='917082156227' (Nullable = false), @p14=NULL (DbType = Guid), @p15=NULL, @p16=NULL (DbType = DateTime), @p17=NULL, @p18='Queued' (Nullable = false)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "MessageLogs" ("Id", "BusinessId", "CTAFlowConfigId", "CTAFlowStepId", "CampaignId", "ContactId", "CreatedAt", "ErrorMessage", "IsIncoming", "MediaUrl", "MessageContent", "MessageId", "RawResponse", "RecipientNumber", "RefMessageId", "RenderedBody", "SentAt", "Source", "Status")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
2025-07-02 23:17:20.461 +05:30 [INF] Request starting HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - application/json 491
2025-07-02 23:17:20.466 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 23:17:20.468 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-07-02 23:17:20.472 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"contacts":[{"profile":{"name":"\ua9c1S.K\ua9c2"},"wa_id":"917082156227"}],"messages":[{"from":"917082156227","id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAEhggQ0QxMzNENDJGMkRBNzVFMjMxOEIzMjk4RDMxQUFFOTgA","timestamp":"1751478443","text":{"body":"hi"},"type":"text"}]},"field":"messages"}]}]}
2025-07-02 23:17:20.474 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-07-02 23:17:20.474 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"contacts":[{"profile":{"name":"\ua9c1S.K\ua9c2"},"wa_id":"917082156227"}],"messages":[{"from":"917082156227","id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAEhggQ0QxMzNENDJGMkRBNzVFMjMxOEIzMjk4RDMxQUFFOTgA","timestamp":"1751478443","text":{"body":"hi"},"type":"text"}]},"field":"messages"}]}]}
2025-07-02 23:17:20.475 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType73`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 23:17:20.478 +05:30 [INF] 💬 Routing to InboundMessageProcessor (type: text)
2025-07-02 23:17:20.481 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 10.1633ms
2025-07-02 23:17:20.493 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 23:17:20.494 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessNumber_0='15556395845'], CommandType='"Text"', CommandTimeout='30']
SELECT b."Id", b."Address", b."ApprovedAt", b."ApprovedBy", b."BusinessEmail", b."BusinessName", b."CompanyName", b."CompanyPhone", b."CreatedAt", b."CreatedBy", b."CreatedByPartnerId", b."DeletedAt", b."DeletedBy", b."Industry", b."IsApproved", b."IsDeleted", b."LastLoginAt", b."LogoUrl", b."Notes", b."Phone", b."RepresentativeName", b."Source", b."Status", b."Tags", b."Website", w."Id", w."ApiToken", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WhatsAppBusinessNumber"
FROM "Businesses" AS b
LEFT JOIN "WhatsAppSettings" AS w ON b."Id" = w."BusinessId"
WHERE w."WhatsAppBusinessNumber" = @__businessNumber_0
LIMIT 1
2025-07-02 23:17:20.500 +05:30 [INF] Request finished HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 38.7065ms
2025-07-02 23:17:20.507 +05:30 [INF] FindOrCreateAsync: businessId="c13be597-6ae2-42bb-9d43-925815f24ff8", phoneNumber=917082156227
2025-07-02 23:17:20.519 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__phoneNumber_1='917082156227'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."Tags"
FROM "Contacts" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."PhoneNumber" = @__phoneNumber_1
LIMIT 1
2025-07-02 23:17:20.523 +05:30 [INF] Contact already exists: contactId="0876f654-a362-420f-a912-6bce793436a5"
2025-07-02 23:17:20.526 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__contactId_1='0876f654-a362-420f-a912-6bce793436a5'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."BusinessId", c."ContactId", c."LastUpdatedAt", c."Mode", c."UpdatedBy"
FROM "ChatSessionStates" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."ContactId" = @__contactId_1
LIMIT 1
2025-07-02 23:17:20.552 +05:30 [INF] Executed DbCommand (20ms) [Parameters=[@p0='2798a7cf-63ab-493a-b360-69e2ffd0c544', @p1='c13be597-6ae2-42bb-9d43-925815f24ff8', @p2=NULL (DbType = Guid), @p3=NULL (DbType = Guid), @p4=NULL (DbType = Guid), @p5='0876f654-a362-420f-a912-6bce793436a5' (Nullable = true), @p6='2025-07-02T17:47:20.5307065Z' (DbType = DateTime), @p7=NULL, @p8='True', @p9=NULL, @p10='hi' (Nullable = false), @p11=NULL, @p12=NULL, @p13='917082156227' (Nullable = false), @p14=NULL (DbType = Guid), @p15=NULL, @p16='2025-07-02T17:47:20.5307069Z' (Nullable = true) (DbType = DateTime), @p17=NULL, @p18='received' (Nullable = false)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "MessageLogs" ("Id", "BusinessId", "CTAFlowConfigId", "CTAFlowStepId", "CampaignId", "ContactId", "CreatedAt", "ErrorMessage", "IsIncoming", "MediaUrl", "MessageContent", "MessageId", "RawResponse", "RecipientNumber", "RefMessageId", "RenderedBody", "SentAt", "Source", "Status")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
2025-07-02 23:17:20.559 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."BusinessId", a."CreatedAt", a."FlowId", a."FlowName", a."IsActive", a."MediaUrl", a."Priority", a."ReplyMessage", a."TriggerKeyword", a."UpdatedAt"
FROM "AutoReplyRules" AS a
WHERE a."BusinessId" = @__businessId_0 AND a."IsActive"
2025-07-02 23:17:20.562 +05:30 [INF] 🔍 No flow match found or FlowId is null. Trying fallback auto-reply...
2025-07-02 23:17:20.566 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='c13be597-6ae2-42bb-9d43-925815f24ff8', @__incomingMessage_1='hi'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."BusinessId", a."CreatedAt", a."FlowId", a."FlowName", a."IsActive", a."MediaUrl", a."Priority", a."ReplyMessage", a."TriggerKeyword", a."UpdatedAt"
FROM "AutoReplyRules" AS a
WHERE a."BusinessId" = @__businessId_0 AND a."IsActive" AND strpos(@__incomingMessage_1, a."TriggerKeyword") > 0
ORDER BY a."Priority"
LIMIT 1
2025-07-02 23:17:20.570 +05:30 [INF] ❌ No fallback rule matched for: hi
2025-07-02 23:17:22.618 +05:30 [INF] Executed DbCommand (20ms) [Parameters=[@p0='278939bc-73c8-401f-87f6-5dfc0b5a963a', @p1='c13be597-6ae2-42bb-9d43-925815f24ff8', @p2=NULL (DbType = Guid), @p3=NULL (DbType = Guid), @p4=NULL (DbType = Guid), @p5='0876f654-a362-420f-a912-6bce793436a5' (Nullable = true), @p6='2025-07-02T17:47:22.5949936Z' (DbType = DateTime), @p7=NULL, @p8='True', @p9=NULL, @p10='hi' (Nullable = false), @p11=NULL, @p12=NULL, @p13='917082156227' (Nullable = false), @p14=NULL (DbType = Guid), @p15=NULL, @p16=NULL (DbType = DateTime), @p17=NULL, @p18='Queued' (Nullable = false)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "MessageLogs" ("Id", "BusinessId", "CTAFlowConfigId", "CTAFlowStepId", "CampaignId", "ContactId", "CreatedAt", "ErrorMessage", "IsIncoming", "MediaUrl", "MessageContent", "MessageId", "RawResponse", "RecipientNumber", "RefMessageId", "RenderedBody", "SentAt", "Source", "Status")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
2025-07-02 23:19:04.092 +05:30 [INF] Request starting HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - application/json 581
2025-07-02 23:19:04.096 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 23:19:04.097 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-07-02 23:19:04.102 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSQjJGN0NFNzQ3MUJBNTE4QjBGAA==","status":"sent","timestamp":"1751292638","recipient_id":"917082156227","conversation":{"id":"74e9b5306f97217d0f99f0bc2192b179","expiration_timestamp":"1751379060","origin":{"type":"utility"}},"pricing":{"billable":true,"pricing_model":"CBP","category":"utility"}}]},"field":"messages"}]}]}
2025-07-02 23:19:04.104 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-07-02 23:19:04.104 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSQjJGN0NFNzQ3MUJBNTE4QjBGAA==","status":"sent","timestamp":"1751292638","recipient_id":"917082156227","conversation":{"id":"74e9b5306f97217d0f99f0bc2192b179","expiration_timestamp":"1751379060","origin":{"type":"utility"}},"pricing":{"billable":true,"pricing_model":"CBP","category":"utility"}}]},"field":"messages"}]}]}
2025-07-02 23:19:04.105 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType73`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-02 23:19:04.108 +05:30 [INF] 📦 Routing to Status Processor
2025-07-02 23:19:04.110 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 8.858ms
2025-07-02 23:19:04.112 +05:30 [WRN] 🔍 Incoming timestamp raw value: {"object":"whatsapp_business_account","entry":[{"id":"999432368375320","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15556395845","phone_number_id":"601884673011340"},"statuses":[{"id":"wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSQjJGN0NFNzQ3MUJBNTE4QjBGAA==","status":"sent","timestamp":"1751292638","recipient_id":"917082156227","conversation":{"id":"74e9b5306f97217d0f99f0bc2192b179","expiration_timestamp":"1751379060","origin":{"type":"utility"}},"pricing":{"billable":true,"pricing_model":"CBP","category":"utility"}}]},"field":"messages"}]}]}
2025-07-02 23:19:04.114 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-07-02 23:19:04.117 +05:30 [INF] Request finished HTTP/1.1 POST http://47f6-2401-4900-5f38-2d39-e857-7c7-3ffe-8ab5.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 25.7068ms
2025-07-02 23:19:04.118 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__messageId_0='wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSQjJGN0NFNzQ3MUJBNTE4QjBGAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."MessageId" = @__messageId_0
LIMIT 1
2025-07-02 23:19:04.136 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__logId_Value_0='bf0a214c-aca2-44a3-a315-bb1e46696b5a'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."Id" = @__logId_Value_0
LIMIT 1
2025-07-02 23:19:04.161 +05:30 [INF] Executed DbCommand (21ms) [Parameters=[@p1='bf0a214c-aca2-44a3-a315-bb1e46696b5a', @p0='Sent'], CommandType='"Text"', CommandTimeout='30']
UPDATE "CampaignSendLogs" SET "SendStatus" = @p0
WHERE "Id" = @p1;
2025-07-02 23:19:04.165 +05:30 [INF] ✅ CampaignSendLog updated for MessageId: wamid.HBgMOTE3MDgyMTU2MjI3FQIAERgSQjJGN0NFNzQ3MUJBNTE4QjBGAA== → sent
2025-07-02 23:20:09.877 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/api/autoreplyflows/save - application/json 634
2025-07-02 23:20:09.881 +05:30 [INF] CORS policy execution failed.
2025-07-02 23:20:09.883 +05:30 [INF] Request origin http://localhost:7113/ does not have permission to access the resource.
2025-07-02 23:20:09.885 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.AutoReplyBuilder.Flows.Controllers.AutoReplyFlowsController.SaveFlow (xbytechat.api)'
2025-07-02 23:20:09.890 +05:30 [INF] Route matched with {action = "SaveFlow", controller = "AutoReplyFlows"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SaveFlow(xbytechat.api.Features.AutoReplyBuilder.Flows.DTOs.SaveFlowDto) on controller xbytechat.api.Features.AutoReplyBuilder.Flows.Controllers.AutoReplyFlowsController (xbytechat.api).
2025-07-02 23:20:09.914 +05:30 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-07-02 23:20:09.932 +05:30 [INF] Executed action xbytechat.api.Features.AutoReplyBuilder.Flows.Controllers.AutoReplyFlowsController.SaveFlow (xbytechat.api) in 39.7083ms
2025-07-02 23:20:09.935 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.AutoReplyBuilder.Flows.Controllers.AutoReplyFlowsController.SaveFlow (xbytechat.api)'
2025-07-02 23:20:09.936 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/api/autoreplyflows/save - 400 null application/problem+json; charset=utf-8 59.3672ms
2025-07-02 23:20:24.538 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/api/autoreplyflows/save - application/json 634
2025-07-02 23:20:24.542 +05:30 [INF] CORS policy execution failed.
2025-07-02 23:20:24.544 +05:30 [INF] Request origin http://localhost:7113/ does not have permission to access the resource.
2025-07-02 23:20:24.546 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.AutoReplyBuilder.Flows.Controllers.AutoReplyFlowsController.SaveFlow (xbytechat.api)'
2025-07-02 23:20:24.547 +05:30 [INF] Route matched with {action = "SaveFlow", controller = "AutoReplyFlows"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SaveFlow(xbytechat.api.Features.AutoReplyBuilder.Flows.DTOs.SaveFlowDto) on controller xbytechat.api.Features.AutoReplyBuilder.Flows.Controllers.AutoReplyFlowsController (xbytechat.api).
2025-07-02 23:20:24.553 +05:30 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-07-02 23:20:24.555 +05:30 [INF] Executed action xbytechat.api.Features.AutoReplyBuilder.Flows.Controllers.AutoReplyFlowsController.SaveFlow (xbytechat.api) in 5.2165ms
2025-07-02 23:20:24.557 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.AutoReplyBuilder.Flows.Controllers.AutoReplyFlowsController.SaveFlow (xbytechat.api)'
2025-07-02 23:20:24.558 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/api/autoreplyflows/save - 400 null application/problem+json; charset=utf-8 20.0431ms
